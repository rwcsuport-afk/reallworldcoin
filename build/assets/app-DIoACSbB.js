const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/secp256k1--dMZLd6c.js","assets/sha2-CLbs85S0.js","assets/embedded-wallet-tzMmeq4m.js","assets/index-dvHJPhjQ.js","assets/index-C3z0_pdE.js","assets/if-defined-Bza0gpUt.js","assets/ref-OiMdmpgB.js","assets/index--AN0k4ud.js","assets/HelpersUtil-DYgajdVZ.js","assets/index-DPnUaIC8.js","assets/index-EOmJq6UJ.js","assets/index-hFiq2mAL.js","assets/index-Bh8h-e_j.js","assets/index-CmqgLBow.js","assets/NavigationUtil-DmfK5sOV.js","assets/email-k_qrNLKJ.js","assets/index-DNawzNPH.js","assets/index-DEnr7aYh.js","assets/socials-PyxQvOiF.js","assets/index-CF4bW1GU.js","assets/index-BscYYsv0.js","assets/index-BQ_-rviJ.js","assets/index-jXa9tKNC.js","assets/index-Dgyb5TzX.js","assets/swaps-C56Z5MXw.js","assets/index-DziNShQ2.js","assets/index-e4gm4XjG.js","assets/SwapController-D329YMTU.js","assets/index-CZ42Ubgn.js","assets/send-C_0PhHCV.js","assets/ConstantsUtil-Dmg8YACJ.js","assets/index-Cl1aY2Gp.js","assets/index-CY9C1Gtk.js","assets/index-Ce4TRCkD.js","assets/receive-Wk-3rqoV.js","assets/onramp-CXav3Na5.js","assets/index-DPwY6Z2e.js","assets/index-DCNlnKA4.js","assets/index-Dk5z0Jlt.js","assets/ExchangeController-BFqW_C5x.js","assets/pay-with-exchange-OXDisRyT.js","assets/transactions-BXmHuJwv.js","assets/index-DVo4qmXK.js","assets/index-C-EC7NX3.js","assets/index-z9L2kMcK.js","assets/data-capture-Ccl8rDQd.js","assets/features-GlrDLqZQ.js","assets/index-BWfdoXnG.js","assets/index-Da13svT5.js","assets/w3m-modal-BuPrIOmb.js","assets/SafeProvider-YgSjvcj1.js","assets/index-H-Ckw-g_.js","assets/sha3-ChG6mytw.js","assets/index-CAnVjETY.js","assets/index-CjE2T-ii.js"])))=>i.map(i=>d[i]);
window._=require("lodash");window.axios=require("axios");window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const bC=Symbol(),gb=Object.getPrototypeOf,Dp=new WeakMap,yC=r=>r&&(Dp.has(r)?Dp.get(r):gb(r)===Object.prototype||gb(r)===Array.prototype),wC=r=>yC(r)&&r[bC]||null,mb=(r,e=!0)=>{Dp.set(r,e)},vf={},Xg=r=>typeof r=="object"&&r!==null,xC=r=>Xg(r)&&!Ju.has(r)&&(Array.isArray(r)||!(Symbol.iterator in r))&&!(r instanceof WeakMap)&&!(r instanceof WeakSet)&&!(r instanceof Error)&&!(r instanceof Number)&&!(r instanceof Date)&&!(r instanceof String)&&!(r instanceof RegExp)&&!(r instanceof ArrayBuffer)&&!(r instanceof Promise),Sv=(r,e)=>{const t=Mp.get(r);if(t?.[0]===e)return t[1];const n=Array.isArray(r)?[]:Object.create(Object.getPrototypeOf(r));return mb(n,!0),Mp.set(r,[e,n]),Reflect.ownKeys(r).forEach(i=>{if(Object.getOwnPropertyDescriptor(n,i))return;const s=Reflect.get(r,i),{enumerable:o}=Reflect.getOwnPropertyDescriptor(r,i),a={value:s,enumerable:o,configurable:!0};if(Ju.has(s))mb(s,!1);else if(vo.has(s)){const[c,l]=vo.get(s);a.value=Sv(c,l())}Object.defineProperty(n,i,a)}),Object.preventExtensions(n)},vC=(r,e,t,n)=>({deleteProperty(i,s){const o=Reflect.get(i,s);t(s);const a=Reflect.deleteProperty(i,s);return a&&n(["delete",[s],o]),a},set(i,s,o,a){const c=!r()&&Reflect.has(i,s),l=Reflect.get(i,s,a);if(c&&(bb(l,o)||Zl.has(o)&&bb(l,Zl.get(o))))return!0;t(s),Xg(o)&&(o=wC(o)||o);const u=!vo.has(o)&&AC(o)?It(o):o;return e(s,u),Reflect.set(i,s,u,a),n(["set",[s],o,l]),!0}}),vo=new WeakMap,Ju=new WeakSet,Mp=new WeakMap,Sl=[1,1],Zl=new WeakMap;let bb=Object.is,EC=(r,e)=>new Proxy(r,e),AC=xC,_C=Sv,CC=vC;function It(r={}){if(!Xg(r))throw new Error("object required");const e=Zl.get(r);if(e)return e;let t=Sl[0];const n=new Set,i=(y,C=++Sl[0])=>{t!==C&&(t=C,n.forEach(T=>T(y,C)))};let s=Sl[1];const o=(y=++Sl[1])=>(s!==y&&!n.size&&(s=y,c.forEach(([C])=>{const T=C[1](y);T>t&&(t=T)})),t),a=y=>(C,T)=>{const I=[...C];I[1]=[y,...I[1]],i(I,T)},c=new Map,l=(y,C)=>{const T=!Ju.has(C)&&vo.get(C);if(T){if((vf?"production":void 0)!=="production"&&c.has(y))throw new Error("prop listener already exists");if(n.size){const I=T[2](a(y));c.set(y,[T,I])}else c.set(y,[T])}},u=y=>{var C;const T=c.get(y);T&&(c.delete(y),(C=T[1])==null||C.call(T))},d=y=>(n.add(y),n.size===1&&c.forEach(([T,I],k)=>{if((vf?"production":void 0)!=="production"&&I)throw new Error("remove already exists");const P=T[2](a(k));c.set(k,[T,P])}),()=>{n.delete(y),n.size===0&&c.forEach(([T,I],k)=>{I&&(I(),c.set(k,[T]))})});let p=!0;const x=CC(()=>p,l,u,i),w=EC(r,x);Zl.set(r,w);const b=[r,o,d];return vo.set(w,b),Reflect.ownKeys(r).forEach(y=>{const C=Object.getOwnPropertyDescriptor(r,y);"value"in C&&C.writable&&(w[y]=r[y])}),p=!1,w}function Lr(r,e,t){const n=vo.get(r);(vf?"production":void 0)!=="production"&&!n&&console.warn("Please use proxy object");let i;const s=[],o=n[2];let a=!1;const l=o(u=>{s.push(u),i||(i=Promise.resolve().then(()=>{i=void 0,a&&e(s.splice(0))}))});return a=!0,()=>{a=!1,l()}}function Xl(r){const e=vo.get(r);(vf?"production":void 0)!=="production"&&!e&&console.warn("Please use proxy object");const[t,n]=e;return _C(t,n())}function ma(r){return Ju.add(r),r}function SC(){return{proxyStateMap:vo,refSet:Ju,snapCache:Mp,versionHolder:Sl,proxyCache:Zl}}function en(r,e,t,n){let i=r[e];return Lr(r,()=>{const s=r[e];Object.is(i,s)||t(i=s)})}const{proxyStateMap:NC,snapCache:IC}=SC(),wd=r=>NC.has(r);function TC(r){const e=[];let t=0;const n=new Map,i=new WeakMap,s=()=>{const l=IC.get(a),u=l?.[1];if(u&&!i.has(u)){const d=new Map(n);i.set(u,d)}},o=l=>i.get(l)||n,a={data:e,index:t,epoch:0,get size(){return wd(this)||s(),o(this).size},get(l){const d=o(this).get(l);if(d===void 0){this.epoch;return}return this.data[d]},has(l){const u=o(this);return this.epoch,u.has(l)},set(l,u){if(!wd(this))throw new Error("Cannot perform mutations on a snapshot");const d=n.get(l);return d===void 0?(n.set(l,this.index),this.data[this.index++]=u):this.data[d]=u,this.epoch++,this},delete(l){if(!wd(this))throw new Error("Cannot perform mutations on a snapshot");const u=n.get(l);return u===void 0?!1:(delete this.data[u],n.delete(l),this.epoch++,!0)},clear(){if(!wd(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,n.clear()},forEach(l){this.epoch,o(this).forEach((d,p)=>{l(this.data[d],p,this)})},*entries(){this.epoch;const l=o(this);for(const[u,d]of l)yield[u,this.data[d]]},*keys(){this.epoch;const l=o(this);for(const u of l.keys())yield u},*values(){this.epoch;const l=o(this);for(const u of l.values())yield this.data[u]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},c=It(a);return Object.defineProperties(c,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(c),c}var Ei=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qs(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function nr(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function n(){var i=!1;try{i=this instanceof n}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}),t}var yb={};const Y={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos",sui:"Sui",stacks:"Stacks"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],SOLANA_SPL_TOKEN_ADDRESSES:{SOL:"So11111111111111111111111111111111111111112"},HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof yb<"u"?yb.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}}}},Nv={caipNetworkIdToNumber(r){return r?Number(r.split(":")[1]):void 0},parseEvmChainId(r){return typeof r=="string"?this.caipNetworkIdToNumber(r):r},getNetworksByNamespace(r,e){return r?.filter(t=>t.chainNamespace===e)||[]},getFirstNetworkByNamespace(r,e){return this.getNetworksByNamespace(r,e)[0]},getNetworkNameByCaipNetworkId(r,e){if(!e)return;const t=r.find(i=>i.caipNetworkId===e);if(t)return t.name;const[n]=e.split(":");return Y.CHAIN_NAME_MAP?.[n]||void 0}},Iv=["eip155","solana","polkadot","bip122","cosmos","sui","stacks"];var PC=20,RC=1,ba=1e6,wb=1e6,OC=-7,kC=21,DC=!1,Zu="[big.js] ",Ta=Zu+"Invalid ",ch=Ta+"decimal places",MC=Ta+"rounding mode",Tv=Zu+"Division by zero",bt={},ns=void 0,UC=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function Pv(){function r(e){var t=this;if(!(t instanceof r))return e===ns?Pv():new r(e);if(e instanceof r)t.s=e.s,t.e=e.e,t.c=e.c.slice();else{if(typeof e!="string"){if(r.strict===!0&&typeof e!="bigint")throw TypeError(Ta+"value");e=e===0&&1/e<0?"-0":String(e)}BC(t,e)}t.constructor=r}return r.prototype=bt,r.DP=PC,r.RM=RC,r.NE=OC,r.PE=kC,r.strict=DC,r.roundDown=0,r.roundHalfUp=1,r.roundHalfEven=2,r.roundUp=3,r}function BC(r,e){var t,n,i;if(!UC.test(e))throw Error(Ta+"number");for(r.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(t=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(t<0&&(t=n),t+=+e.slice(n+1),e=e.substring(0,n)):t<0&&(t=e.length),i=e.length,n=0;n<i&&e.charAt(n)=="0";)++n;if(n==i)r.c=[r.e=0];else{for(;i>0&&e.charAt(--i)=="0";);for(r.e=t-n-1,r.c=[],t=0;n<=i;)r.c[t++]=+e.charAt(n++)}return r}function Pa(r,e,t,n){var i=r.c;if(t===ns&&(t=r.constructor.RM),t!==0&&t!==1&&t!==2&&t!==3)throw Error(MC);if(e<1)n=t===3&&(n||!!i[0])||e===0&&(t===1&&i[0]>=5||t===2&&(i[0]>5||i[0]===5&&(n||i[1]!==ns))),i.length=1,n?(r.e=r.e-e+1,i[0]=1):i[0]=r.e=0;else if(e<i.length){if(n=t===1&&i[e]>=5||t===2&&(i[e]>5||i[e]===5&&(n||i[e+1]!==ns||i[e-1]&1))||t===3&&(n||!!i[0]),i.length=e,n){for(;++i[--e]>9;)if(i[e]=0,e===0){++r.e,i.unshift(1);break}}for(e=i.length;!i[--e];)i.pop()}return r}function Ra(r,e,t){var n=r.e,i=r.c.join(""),s=i.length;if(e)i=i.charAt(0)+(s>1?"."+i.slice(1):"")+(n<0?"e":"e+")+n;else if(n<0){for(;++n;)i="0"+i;i="0."+i}else if(n>0)if(++n>s)for(n-=s;n--;)i+="0";else n<s&&(i=i.slice(0,n)+"."+i.slice(n));else s>1&&(i=i.charAt(0)+"."+i.slice(1));return r.s<0&&t?"-"+i:i}bt.abs=function(){var r=new this.constructor(this);return r.s=1,r};bt.cmp=function(r){var e,t=this,n=t.c,i=(r=new t.constructor(r)).c,s=t.s,o=r.s,a=t.e,c=r.e;if(!n[0]||!i[0])return n[0]?s:i[0]?-o:0;if(s!=o)return s;if(e=s<0,a!=c)return a>c^e?1:-1;for(o=(a=n.length)<(c=i.length)?a:c,s=-1;++s<o;)if(n[s]!=i[s])return n[s]>i[s]^e?1:-1;return a==c?0:a>c^e?1:-1};bt.div=function(r){var e=this,t=e.constructor,n=e.c,i=(r=new t(r)).c,s=e.s==r.s?1:-1,o=t.DP;if(o!==~~o||o<0||o>ba)throw Error(ch);if(!i[0])throw Error(Tv);if(!n[0])return r.s=s,r.c=[r.e=0],r;var a,c,l,u,d,p=i.slice(),x=a=i.length,w=n.length,b=n.slice(0,a),y=b.length,C=r,T=C.c=[],I=0,k=o+(C.e=e.e-r.e)+1;for(C.s=s,s=k<0?0:k,p.unshift(0);y++<a;)b.push(0);do{for(l=0;l<10;l++){if(a!=(y=b.length))u=a>y?1:-1;else for(d=-1,u=0;++d<a;)if(i[d]!=b[d]){u=i[d]>b[d]?1:-1;break}if(u<0){for(c=y==a?i:p;y;){if(b[--y]<c[y]){for(d=y;d&&!b[--d];)b[d]=9;--b[d],b[y]+=10}b[y]-=c[y]}for(;!b[0];)b.shift()}else break}T[I++]=u?l:++l,b[0]&&u?b[y]=n[x]||0:b=[n[x]]}while((x++<w||b[0]!==ns)&&s--);return!T[0]&&I!=1&&(T.shift(),C.e--,k--),I>k&&Pa(C,k,t.RM,b[0]!==ns),C};bt.eq=function(r){return this.cmp(r)===0};bt.gt=function(r){return this.cmp(r)>0};bt.gte=function(r){return this.cmp(r)>-1};bt.lt=function(r){return this.cmp(r)<0};bt.lte=function(r){return this.cmp(r)<1};bt.minus=bt.sub=function(r){var e,t,n,i,s=this,o=s.constructor,a=s.s,c=(r=new o(r)).s;if(a!=c)return r.s=-c,s.plus(r);var l=s.c.slice(),u=s.e,d=r.c,p=r.e;if(!l[0]||!d[0])return d[0]?r.s=-c:l[0]?r=new o(s):r.s=1,r;if(a=u-p){for((i=a<0)?(a=-a,n=l):(p=u,n=d),n.reverse(),c=a;c--;)n.push(0);n.reverse()}else for(t=((i=l.length<d.length)?l:d).length,a=c=0;c<t;c++)if(l[c]!=d[c]){i=l[c]<d[c];break}if(i&&(n=l,l=d,d=n,r.s=-r.s),(c=(t=d.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;t>a;){if(l[--t]<d[t]){for(e=t;e&&!l[--e];)l[e]=9;--l[e],l[t]+=10}l[t]-=d[t]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--p;return l[0]||(r.s=1,l=[p=0]),r.c=l,r.e=p,r};bt.mod=function(r){var e,t=this,n=t.constructor,i=t.s,s=(r=new n(r)).s;if(!r.c[0])throw Error(Tv);return t.s=r.s=1,e=r.cmp(t)==1,t.s=i,r.s=s,e?new n(t):(i=n.DP,s=n.RM,n.DP=n.RM=0,t=t.div(r),n.DP=i,n.RM=s,this.minus(t.times(r)))};bt.neg=function(){var r=new this.constructor(this);return r.s=-r.s,r};bt.plus=bt.add=function(r){var e,t,n,i=this,s=i.constructor;if(r=new s(r),i.s!=r.s)return r.s=-r.s,i.minus(r);var o=i.e,a=i.c,c=r.e,l=r.c;if(!a[0]||!l[0])return l[0]||(a[0]?r=new s(i):r.s=i.s),r;if(a=a.slice(),e=o-c){for(e>0?(c=o,n=l):(e=-e,n=a),n.reverse();e--;)n.push(0);n.reverse()}for(a.length-l.length<0&&(n=l,l=a,a=n),e=l.length,t=0;e;a[e]%=10)t=(a[--e]=a[e]+l[e]+t)/10|0;for(t&&(a.unshift(t),++c),e=a.length;a[--e]===0;)a.pop();return r.c=a,r.e=c,r};bt.pow=function(r){var e=this,t=new e.constructor("1"),n=t,i=r<0;if(r!==~~r||r<-wb||r>wb)throw Error(Ta+"exponent");for(i&&(r=-r);r&1&&(n=n.times(e)),r>>=1,!!r;)e=e.times(e);return i?t.div(n):n};bt.prec=function(r,e){if(r!==~~r||r<1||r>ba)throw Error(Ta+"precision");return Pa(new this.constructor(this),r,e)};bt.round=function(r,e){if(r===ns)r=0;else if(r!==~~r||r<-ba||r>ba)throw Error(ch);return Pa(new this.constructor(this),r+this.e+1,e)};bt.sqrt=function(){var r,e,t,n=this,i=n.constructor,s=n.s,o=n.e,a=new i("0.5");if(!n.c[0])return new i(n);if(s<0)throw Error(Zu+"No square root");s=Math.sqrt(+Ra(n,!0,!0)),s===0||s===1/0?(e=n.c.join(""),e.length+o&1||(e+="0"),s=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),r=new i((s==1/0?"5e":(s=s.toExponential()).slice(0,s.indexOf("e")+1))+o)):r=new i(s+""),o=r.e+(i.DP+=4);do t=r,r=a.times(t.plus(n.div(t)));while(t.c.slice(0,o).join("")!==r.c.slice(0,o).join(""));return Pa(r,(i.DP-=4)+r.e+1,i.RM)};bt.times=bt.mul=function(r){var e,t=this,n=t.constructor,i=t.c,s=(r=new n(r)).c,o=i.length,a=s.length,c=t.e,l=r.e;if(r.s=t.s==r.s?1:-1,!i[0]||!s[0])return r.c=[r.e=0],r;for(r.e=c+l,o<a&&(e=i,i=s,s=e,l=o,o=a,a=l),e=new Array(l=o+a);l--;)e[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=e[l]+s[c]*i[l-c-1]+a,e[l--]=a%10,a=a/10|0;e[l]=a}for(a?++r.e:e.shift(),c=e.length;!e[--c];)e.pop();return r.c=e,r};bt.toExponential=function(r,e){var t=this,n=t.c[0];if(r!==ns){if(r!==~~r||r<0||r>ba)throw Error(ch);for(t=Pa(new t.constructor(t),++r,e);t.c.length<r;)t.c.push(0)}return Ra(t,!0,!!n)};bt.toFixed=function(r,e){var t=this,n=t.c[0];if(r!==ns){if(r!==~~r||r<0||r>ba)throw Error(ch);for(t=Pa(new t.constructor(t),r+t.e+1,e),r=r+t.e+1;t.c.length<r;)t.c.push(0)}return Ra(t,!1,!!n)};bt[Symbol.for("nodejs.util.inspect.custom")]=bt.toJSON=bt.toString=function(){var r=this,e=r.constructor;return Ra(r,r.e<=e.NE||r.e>=e.PE,!!r.c[0])};bt.toNumber=function(){var r=+Ra(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(r.toString()))throw Error(Zu+"Imprecise conversion");return r};bt.toPrecision=function(r,e){var t=this,n=t.constructor,i=t.c[0];if(r!==ns){if(r!==~~r||r<1||r>ba)throw Error(Ta+"precision");for(t=Pa(new n(t),r,e);t.c.length<r;)t.c.push(0)}return Ra(t,r<=t.e||t.e<=n.NE||t.e>=n.PE,!!i)};bt.valueOf=function(){var r=this,e=r.constructor;if(e.strict===!0)throw Error(Zu+"valueOf disallowed");return Ra(r,r.e<=e.NE||r.e>=e.PE,!0)};var Ys=Pv();const $C={bigNumber(r){return r?new Ys(r):new Ys(0)},multiply(r,e){if(r===void 0||e===void 0)return new Ys(0);const t=new Ys(r),n=new Ys(e);return t.times(n)},toFixed(r,e=2){return r===void 0||r===""?new Ys(0).toFixed(e):new Ys(r).toFixed(e)},formatNumberToLocalString(r,e=2){return r===void 0||r===""?"0.00":typeof r=="number"?r.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"}):parseFloat(r).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"})},parseLocalStringToNumber(r){if(r===void 0||r==="")return 0;const e=r.replace(/,/gu,"");return new Ys(e).toNumber()}},LC=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],FC=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],jC=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],qC={getERC20Abi:r=>Y.USDT_CONTRACT_ADDRESSES.includes(r)?jC:LC,getSwapAbi:()=>FC},on={validateCaipAddress(r){if(r.split(":")?.length!==3)throw new Error("Invalid CAIP Address");return r},parseCaipAddress(r){const e=r.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${r}`);const[t,n,i]=e;if(!t||!n||!i)throw new Error(`Invalid CAIP-10 address: ${r}`);return{chainNamespace:t,chainId:n,address:i}},parseCaipNetworkId(r){const e=r.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${r}`);const[t,n]=e;if(!t||!n)throw new Error(`Invalid CAIP-2 network id: ${r}`);return{chainNamespace:t,chainId:n}}},Se={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids",HISTORY_TRANSACTIONS_CACHE:"@appkit/history_transactions_cache",TOKEN_PRICE_CACHE:"@appkit/token_price_cache",RECENT_EMAILS:"@appkit/recent_emails"};function r0(r){if(!r)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${r}:connected_connector_id`}const Ae={setItem(r,e){wc()&&e!==void 0&&localStorage.setItem(r,e)},getItem(r){if(wc())return localStorage.getItem(r)||void 0},removeItem(r){wc()&&localStorage.removeItem(r)},clear(){wc()&&localStorage.clear()}};function wc(){return typeof window<"u"&&typeof localStorage<"u"}function Ql(r,e){return e==="light"?{"--w3m-accent":r?.["--w3m-accent"]||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":r?.["--w3m-accent"]||"hsla(230, 100%, 67%, 1)","--w3m-background":"#202020"}}var xb={};const n0=(typeof process<"u"&&typeof xb<"u"?xb.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",Rv=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],HC="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",Ge={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:n0,SECURE_SITE_DASHBOARD:`${n0}/dashboard`,SECURE_SITE_FAVICON:`${n0}/images/favicon.png`,RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:[Y.CHAIN.EVM,Y.CHAIN.SOLANA],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:[Y.CHAIN.EVM],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:[Y.CHAIN.EVM,Y.CHAIN.SOLANA],PAY_WITH_EXCHANGE_SUPPORTED_CHAIN_NAMESPACES:[Y.CHAIN.EVM,Y.CHAIN.SOLANA],ACTIVITY_ENABLED_CHAIN_NAMESPACES:[Y.CHAIN.EVM],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x",sui:"0x",stacks:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[Y.CHAIN.EVM,Y.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1,emailCapture:!1,payWithExchange:!1,payments:!1,reownAuthentication:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1,emailCapture:!1,reownAuthentication:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1,reownAuthentication:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"},SIWX_DEFAULTS:{signOutOnDisconnect:!0}},Q={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5,transactionsHistory:15e3,tokenPrice:15e3},isCacheExpired(r,e){return Date.now()-r>e},getActiveNetworkProps(){const r=Q.getActiveNamespace(),e=Q.getActiveCaipNetworkId(),t=e?e.split(":")[1]:void 0,n=t?isNaN(Number(t))?t:Number(t):void 0;return{namespace:r,caipNetworkId:e,chainId:n}},setWalletConnectDeepLink({name:r,href:e}){try{Ae.setItem(Se.DEEPLINK_CHOICE,JSON.stringify({href:e,name:r}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const r=Ae.getItem(Se.DEEPLINK_CHOICE);if(r)return JSON.parse(r)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{Ae.removeItem(Se.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(r){try{Ae.setItem(Se.ACTIVE_NAMESPACE,r)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(r){try{Ae.setItem(Se.ACTIVE_CAIP_NETWORK_ID,r),Q.setActiveNamespace(r.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return Ae.getItem(Se.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{Ae.removeItem(Se.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(r){try{const e=r0(r);Ae.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(r){try{const e=Q.getRecentWallets();e.find(n=>n.id===r.id)||(e.unshift(r),e.length>2&&e.pop(),Ae.setItem(Se.RECENT_WALLETS,JSON.stringify(e)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const r=Ae.getItem(Se.RECENT_WALLETS);return r?JSON.parse(r):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(r,e){try{const t=r0(r);Ae.setItem(t,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return Ae.getItem(Se.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(r){if(r)try{const e=r0(r);return Ae.getItem(e)}catch{console.info("Unable to get connected connector id in namespace",r)}},setConnectedSocialProvider(r){try{Ae.setItem(Se.CONNECTED_SOCIAL,r)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return Ae.getItem(Se.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{Ae.removeItem(Se.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return Ae.getItem(Se.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){return Ae.getItem(Se.ACTIVE_CAIP_NETWORK_ID)?.split(":")?.[1]},setConnectionStatus(r){try{Ae.setItem(Se.CONNECTION_STATUS,r)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return Ae.getItem(Se.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const r=Ae.getItem(Se.CONNECTED_NAMESPACES);return r?.length?r.split(","):[]}catch{return[]}},setConnectedNamespaces(r){try{const e=Array.from(new Set(r));Ae.setItem(Se.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(r){try{const e=Q.getConnectedNamespaces();e.includes(r)||(e.push(r),Q.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(r){try{const e=Q.getConnectedNamespaces(),t=e.indexOf(r);t>-1&&(e.splice(t,1),Q.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return Ae.getItem(Se.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(r){try{Ae.setItem(Se.TELEGRAM_SOCIAL_PROVIDER,r)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{Ae.removeItem(Se.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let r={};try{const e=Ae.getItem(Se.PORTFOLIO_CACHE);r=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return r},removeAddressFromBalanceCache(r){try{const e=Q.getBalanceCache();Ae.setItem(Se.PORTFOLIO_CACHE,JSON.stringify({...e,[r]:void 0}))}catch{console.info("Unable to remove address from balance cache",r)}},getBalanceCacheForCaipAddress(r){try{const t=Q.getBalanceCache()[r];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.portfolio))return t.balance;Q.removeAddressFromBalanceCache(r)}catch{console.info("Unable to get balance cache for address",r)}},updateBalanceCache(r){try{const e=Q.getBalanceCache();e[r.caipAddress]=r,Ae.setItem(Se.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",r)}},getNativeBalanceCache(){let r={};try{const e=Ae.getItem(Se.NATIVE_BALANCE_CACHE);r=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return r},removeAddressFromNativeBalanceCache(r){try{const e=Q.getBalanceCache();Ae.setItem(Se.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[r]:void 0}))}catch{console.info("Unable to remove address from balance cache",r)}},getNativeBalanceCacheForCaipAddress(r){try{const t=Q.getNativeBalanceCache()[r];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.nativeBalance))return t;console.info("Discarding cache for address",r),Q.removeAddressFromBalanceCache(r)}catch{console.info("Unable to get balance cache for address",r)}},updateNativeBalanceCache(r){try{const e=Q.getNativeBalanceCache();e[r.caipAddress]=r,Ae.setItem(Se.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",r)}},getEnsCache(){let r={};try{const e=Ae.getItem(Se.ENS_CACHE);r=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return r},getEnsFromCacheForAddress(r){try{const t=Q.getEnsCache()[r];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.ens))return t.ens;Q.removeEnsFromCache(r)}catch{console.info("Unable to get ens name from cache",r)}},updateEnsCache(r){try{const e=Q.getEnsCache();e[r.address]=r,Ae.setItem(Se.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",r)}},removeEnsFromCache(r){try{const e=Q.getEnsCache();Ae.setItem(Se.ENS_CACHE,JSON.stringify({...e,[r]:void 0}))}catch{console.info("Unable to remove ens name from cache",r)}},getIdentityCache(){let r={};try{const e=Ae.getItem(Se.IDENTITY_CACHE);r=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return r},getIdentityFromCacheForAddress(r){try{const t=Q.getIdentityCache()[r];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.identity))return t.identity;Q.removeIdentityFromCache(r)}catch{console.info("Unable to get identity from cache",r)}},updateIdentityCache(r){try{const e=Q.getIdentityCache();e[r.address]={identity:r.identity,timestamp:r.timestamp},Ae.setItem(Se.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",r)}},removeIdentityFromCache(r){try{const e=Q.getIdentityCache();Ae.setItem(Se.IDENTITY_CACHE,JSON.stringify({...e,[r]:void 0}))}catch{console.info("Unable to remove identity from cache",r)}},clearAddressCache(){try{Ae.removeItem(Se.PORTFOLIO_CACHE),Ae.removeItem(Se.NATIVE_BALANCE_CACHE),Ae.removeItem(Se.ENS_CACHE),Ae.removeItem(Se.IDENTITY_CACHE),Ae.removeItem(Se.HISTORY_TRANSACTIONS_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(r){try{Ae.setItem(Se.PREFERRED_ACCOUNT_TYPES,JSON.stringify(r))}catch{console.info("Unable to set preferred account types",r)}},getPreferredAccountTypes(){try{const r=Ae.getItem(Se.PREFERRED_ACCOUNT_TYPES);return r?JSON.parse(r):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(r,e){try{const t=Q.getConnections(),n=t[e]??[],i=new Map;for(const o of n)i.set(o.connectorId,{...o});for(const o of r){const a=i.get(o.connectorId),c=o.connectorId===Y.CONNECTOR_ID.AUTH;if(a&&!c){const l=new Set(a.accounts.map(d=>d.address.toLowerCase())),u=o.accounts.filter(d=>!l.has(d.address.toLowerCase()));a.accounts.push(...u)}else i.set(o.connectorId,{...o})}const s={...t,[e]:Array.from(i.values())};Ae.setItem(Se.CONNECTIONS,JSON.stringify(s))}catch(t){console.error("Unable to sync connections to storage",t)}},getConnections(){try{const r=Ae.getItem(Se.CONNECTIONS);return r?JSON.parse(r):{}}catch(r){return console.error("Unable to get connections from storage",r),{}}},deleteAddressFromConnection({connectorId:r,address:e,namespace:t}){try{const n=Q.getConnections(),i=n[t]??[],s=new Map(i.map(a=>[a.connectorId,a])),o=s.get(r);o&&(o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase()).length===0?s.delete(r):s.set(r,{...o,accounts:o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase())})),Ae.setItem(Se.CONNECTIONS,JSON.stringify({...n,[t]:Array.from(s.values())}))}catch{console.error(`Unable to remove address "${e}" from connector "${r}" in namespace "${t}"`)}},getDisconnectedConnectorIds(){try{const r=Ae.getItem(Se.DISCONNECTED_CONNECTOR_IDS);return r?JSON.parse(r):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(r,e){try{const t=Q.getDisconnectedConnectorIds(),n=t[e]??[];n.push(r),Ae.setItem(Se.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...t,[e]:Array.from(new Set(n))}))}catch{console.error(`Unable to set disconnected connector id "${r}" for namespace "${e}"`)}},removeDisconnectedConnectorId(r,e){try{const t=Q.getDisconnectedConnectorIds();let n=t[e]??[];n=n.filter(i=>i.toLowerCase()!==r.toLowerCase()),Ae.setItem(Se.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...t,[e]:Array.from(new Set(n))}))}catch{console.error(`Unable to remove disconnected connector id "${r}" for namespace "${e}"`)}},isConnectorDisconnected(r,e){try{return(Q.getDisconnectedConnectorIds()[e]??[]).some(i=>i.toLowerCase()===r.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${r}" for namespace "${e}"`)}return!1},getTransactionsCache(){try{const r=Ae.getItem(Se.HISTORY_TRANSACTIONS_CACHE);return r?JSON.parse(r):{}}catch{console.info("Unable to get transactions cache")}return{}},getTransactionsCacheForAddress({address:r,chainId:e=""}){try{const n=Q.getTransactionsCache()[r]?.[e];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.transactionsHistory))return n.transactions;Q.removeTransactionsCache({address:r,chainId:e})}catch{console.info("Unable to get transactions cache")}},updateTransactionsCache({address:r,chainId:e="",timestamp:t,transactions:n}){try{const i=Q.getTransactionsCache();i[r]={...i[r],[e]:{timestamp:t,transactions:n}},Ae.setItem(Se.HISTORY_TRANSACTIONS_CACHE,JSON.stringify(i))}catch{console.info("Unable to update transactions cache",{address:r,chainId:e,timestamp:t,transactions:n})}},removeTransactionsCache({address:r,chainId:e}){try{const t=Q.getTransactionsCache(),n=t?.[r]||{},{[e]:i,...s}=n;Ae.setItem(Se.HISTORY_TRANSACTIONS_CACHE,JSON.stringify({...t,[r]:s}))}catch{console.info("Unable to remove transactions cache",{address:r,chainId:e})}},getTokenPriceCache(){try{const r=Ae.getItem(Se.TOKEN_PRICE_CACHE);return r?JSON.parse(r):{}}catch{console.info("Unable to get token price cache")}return{}},getTokenPriceCacheForAddresses(r){try{const t=Q.getTokenPriceCache()[r.join(",")];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.tokenPrice))return t.tokenPrice;Q.removeTokenPriceCache(r)}catch{console.info("Unable to get token price cache for addresses",r)}},updateTokenPriceCache(r){try{const e=Q.getTokenPriceCache();e[r.addresses.join(",")]={timestamp:r.timestamp,tokenPrice:r.tokenPrice},Ae.setItem(Se.TOKEN_PRICE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update token price cache",r)}},removeTokenPriceCache(r){try{const e=Q.getTokenPriceCache();Ae.setItem(Se.TOKEN_PRICE_CACHE,JSON.stringify({...e,[r.join(",")]:void 0}))}catch{console.info("Unable to remove token price cache",r)}}},be={isMobile(){return this.isClient()?!!(window?.matchMedia&&typeof window.matchMedia=="function"&&window.matchMedia("(pointer:coarse)")?.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(r,e=""){return r?.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const r=window?.navigator.userAgent.toLowerCase();return be.isMobile()&&r.includes("android")},isIos(){if(!this.isMobile())return!1;const r=window?.navigator.userAgent.toLowerCase();return r.includes("iphone")||r.includes("ipad")},isSafari(){return this.isClient()?(window?.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(r){return r?r-Date.now()<=Ge.TEN_SEC_MS:!0},isAllowedRetry(r,e=Ge.ONE_SEC_MS){return Date.now()-r>=e},copyToClopboard(r){navigator.clipboard.writeText(r)},isIframe(){try{return window?.self!==window?.top}catch{return!1}},isSafeApp(){if(be.isClient()&&window.self!==window.top)try{const r=window?.location?.ancestorOrigins?.[0],e="https://app.safe.global";if(r){const t=new URL(r),n=new URL(e);return t.hostname===n.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+Ge.FOUR_MINUTES_MS},getNetworkId(r){return r?.split(":")[1]},getPlainAddress(r){return r?.split(":")[2]},async wait(r){return new Promise(e=>{setTimeout(e,r)})},debounce(r,e=500){let t;return(...n)=>{function i(){r(...n)}t&&clearTimeout(t),t=setTimeout(i,e)}},isHttpUrl(r){return r.startsWith("http://")||r.startsWith("https://")},formatNativeUrl(r,e,t=null){if(be.isHttpUrl(r))return this.formatUniversalUrl(r,e);let n=r,i=t;n.includes("://")||(n=r.replaceAll("/","").replaceAll(":",""),n=`${n}://`),n.endsWith("/")||(n=`${n}/`),i&&!i?.endsWith("/")&&(i=`${i}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const s=encodeURIComponent(e);return{redirect:`${n}wc?uri=${s}`,redirectUniversalLink:i?`${i}wc?uri=${s}`:void 0,href:n}},formatUniversalUrl(r,e){if(!be.isHttpUrl(r))return this.formatNativeUrl(r,e);let t=r;t.endsWith("/")||(t=`${t}/`);const n=encodeURIComponent(e);return{redirect:`${t}wc?uri=${n}`,href:t}},getOpenTargetForPlatform(r){return r==="popupWindow"?r:this.isTelegram()?Q.getTelegramSocialProvider()?"_top":"_blank":r},openHref(r,e,t){window?.open(r,this.getOpenTargetForPlatform(e),t||"noreferrer noopener")},returnOpenHref(r,e,t){return window?.open(r,this.getOpenTargetForPlatform(e),t||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){if(typeof window>"u")return!1;const r=window?.matchMedia&&typeof window.matchMedia=="function"?window.matchMedia("(display-mode: standalone)")?.matches:!1,e=window?.navigator?.standalone;return!!(r||e)},async preloadImage(r){const e=new Promise((t,n)=>{const i=new Image;i.onload=t,i.onerror=n,i.crossOrigin="anonymous",i.src=r});return Promise.race([e,be.wait(2e3)])},parseBalance(r,e){let t="0.000";if(typeof r=="string"){const c=Number(r);if(!isNaN(c)){const l=(Math.floor(c*1e3)/1e3).toFixed(3);l&&(t=l)}}const[n,i]=t.split("."),s=n||"0",o=i||"000";return{formattedText:`${s}.${o}${e?` ${e}`:""}`,value:s,decimals:o,symbol:e}},getApiUrl(){return Y.W3M_API_URL},getBlockchainApiUrl(){return Y.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return Y.PULSE_API_URL},getUUID(){return crypto?.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})},parseError(r){return typeof r=="string"?r:typeof r?.issues?.[0]?.message=="string"?r.issues[0].message:r instanceof Error?r.message:"Unknown error"},sortRequestedNetworks(r,e=[]){const t={};return e&&r&&(r.forEach((n,i)=>{t[n]=i}),e.sort((n,i)=>{const s=t[n.id],o=t[i.id];return s!==void 0&&o!==void 0?s-o:s!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(r){let e=0;for(const t of r)e+=t.value??0;return e},formatTokenBalance(r){const e=r.toFixed(2),[t,n]=e.split(".");return{dollars:t,pennies:n}},isAddress(r,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(r)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(r)||/^(?:0x)?[0-9A-F]{40}$/iu.test(r))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(r);default:return!1}},uniqueBy(r,e){const t=new Set;return r.filter(n=>{const i=n[e];return t.has(i)?!1:(t.add(i),!0)})},generateSdkVersion(r,e,t){const i=r.length===0?Ge.ADAPTER_TYPES.UNIVERSAL:r.map(s=>s.adapterType).join(",");return`${e}-${i}-${t}`},createAccount(r,e,t,n,i){return{namespace:r,address:e,type:t,publicKey:n,path:i}},isCaipAddress(r){if(typeof r!="string")return!1;const e=r.split(":"),t=e[0];return e.filter(Boolean).length===3&&t in Y.CHAIN_NAME_MAP},getAccount(r){return r?typeof r=="string"?{address:r,chainId:void 0}:{address:r.address,chainId:r.chainId}:{address:void 0,chainId:void 0}},isMac(){const r=window?.navigator.userAgent.toLowerCase();return r.includes("macintosh")&&!r.includes("safari")},formatTelegramSocialLoginUrl(r){const e=`--${encodeURIComponent(window?.location.href)}`,t="state=";if(new URL(r).host==="auth.magic.link"){const i="provider_authorization_url=",s=r.substring(r.indexOf(i)+i.length),o=this.injectIntoUrl(decodeURIComponent(s),t,e);return r.replace(s,encodeURIComponent(o))}return this.injectIntoUrl(r,t,e)},injectIntoUrl(r,e,t){const n=r.indexOf(e);if(n===-1)throw new Error(`${e} parameter not found in the URL: ${r}`);const i=r.indexOf("&",n),s=e.length,o=i!==-1?i:r.length,a=r.substring(0,n+s),c=r.substring(n+s,o),l=r.substring(i),u=c+t;return a+u+l}};async function il(...r){const e=await fetch(...r);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class Xu{constructor({baseUrl:e,clientId:t}){this.baseUrl=e,this.clientId=t}async get({headers:e,signal:t,cache:n,...i}){const s=this.createUrl(i);return(await il(s,{method:"GET",headers:e,signal:t,cache:n})).json()}async getBlob({headers:e,signal:t,...n}){const i=this.createUrl(n);return(await il(i,{method:"GET",headers:e,signal:t})).blob()}async post({body:e,headers:t,signal:n,...i}){const s=this.createUrl(i);return(await il(s,{method:"POST",headers:t,body:e?JSON.stringify(e):void 0,signal:n})).json()}async put({body:e,headers:t,signal:n,...i}){const s=this.createUrl(i);return(await il(s,{method:"PUT",headers:t,body:e?JSON.stringify(e):void 0,signal:n})).json()}async delete({body:e,headers:t,signal:n,...i}){const s=this.createUrl(i);return(await il(s,{method:"DELETE",headers:t,body:e?JSON.stringify(e):void 0,signal:n})).json()}createUrl({path:e,params:t}){const n=new URL(e,this.baseUrl);return t&&Object.entries(t).forEach(([i,s])=>{s&&n.searchParams.append(i,s)}),this.clientId&&n.searchParams.append("clientId",this.clientId),n}}const WC={getFeatureValue(r,e){const t=e?.[r];return t===void 0?Ge.DEFAULT_FEATURES[r]:t},filterSocialsByPlatform(r){if(!r||!r.length)return r;if(be.isTelegram()){if(be.isIos())return r.filter(e=>e!=="google");if(be.isMac())return r.filter(e=>e!=="x");if(be.isAndroid())return r.filter(e=>!["facebook","x"].includes(e))}return r}},Ee=It({features:Ge.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:Ge.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{}}),Z={state:Ee,subscribeKey(r,e){return en(Ee,r,e)},setOptions(r){Object.assign(Ee,r)},setRemoteFeatures(r){if(!r)return;const e={...Ee.remoteFeatures,...r};Ee.remoteFeatures=e,Ee.remoteFeatures?.socials&&(Ee.remoteFeatures.socials=WC.filterSocialsByPlatform(Ee.remoteFeatures.socials)),Ee.features?.pay&&(Ee.remoteFeatures.email=!1,Ee.remoteFeatures.socials=!1)},setFeatures(r){if(!r)return;Ee.features||(Ee.features=Ge.DEFAULT_FEATURES);const e={...Ee.features,...r};Ee.features=e,Ee.features?.pay&&Ee.remoteFeatures&&(Ee.remoteFeatures.email=!1,Ee.remoteFeatures.socials=!1)},setProjectId(r){Ee.projectId=r},setCustomRpcUrls(r){Ee.customRpcUrls=r},setAllWallets(r){Ee.allWallets=r},setIncludeWalletIds(r){Ee.includeWalletIds=r},setExcludeWalletIds(r){Ee.excludeWalletIds=r},setFeaturedWalletIds(r){Ee.featuredWalletIds=r},setTokens(r){Ee.tokens=r},setTermsConditionsUrl(r){Ee.termsConditionsUrl=r},setPrivacyPolicyUrl(r){Ee.privacyPolicyUrl=r},setCustomWallets(r){Ee.customWallets=r},setIsSiweEnabled(r){Ee.isSiweEnabled=r},setIsUniversalProvider(r){Ee.isUniversalProvider=r},setSdkVersion(r){Ee.sdkVersion=r},setMetadata(r){Ee.metadata=r},setDisableAppend(r){Ee.disableAppend=r},setEIP6963Enabled(r){Ee.enableEIP6963=r},setDebug(r){Ee.debug=r},setEnableWalletConnect(r){Ee.enableWalletConnect=r},setEnableWalletGuide(r){Ee.enableWalletGuide=r},setEnableAuthLogger(r){Ee.enableAuthLogger=r},setEnableWallets(r){Ee.enableWallets=r},setPreferUniversalLinks(r){Ee.experimental_preferUniversalLinks=r},setSIWX(r){if(r)for(const[e,t]of Object.entries(Ge.SIWX_DEFAULTS))r[e]??=t;Ee.siwx=r},setConnectMethodsOrder(r){Ee.features={...Ee.features,connectMethodsOrder:r}},setWalletFeaturesOrder(r){Ee.features={...Ee.features,walletFeaturesOrder:r}},setSocialsOrder(r){Ee.remoteFeatures={...Ee.remoteFeatures,socials:r}},setCollapseWallets(r){Ee.features={...Ee.features,collapseWallets:r}},setEnableEmbedded(r){Ee.enableEmbedded=r},setAllowUnsupportedChain(r){Ee.allowUnsupportedChain=r},setManualWCControl(r){Ee.manualWCControl=r},setEnableNetworkSwitch(r){Ee.enableNetworkSwitch=r},setEnableReconnect(r){Ee.enableReconnect=r},setDefaultAccountTypes(r={}){Object.entries(r).forEach(([e,t])=>{t&&(Ee.defaultAccountTypes[e]=t)})},setUniversalProviderConfigOverride(r){Ee.universalProviderConfigOverride=r},getUniversalProviderConfigOverride(){return Ee.universalProviderConfigOverride},getSnapshot(){return Xl(Ee)}},zC=Object.freeze({enabled:!0,events:[]}),KC=new Xu({baseUrl:be.getAnalyticsUrl(),clientId:null}),VC=5,GC=60*1e3,Js=It({...zC}),YC={state:Js,subscribeKey(r,e){return en(Js,r,e)},async sendError(r,e){if(!Js.enabled)return;const t=Date.now();if(Js.events.filter(s=>{const o=new Date(s.properties.timestamp||"").getTime();return t-o<GC}).length>=VC)return;const i={type:"error",event:e,properties:{errorType:r.name,errorMessage:r.message,stackTrace:r.stack,timestamp:new Date().toISOString()}};Js.events.push(i);try{if(typeof window>"u")return;const{projectId:s,sdkType:o,sdkVersion:a}=Z.state;await KC.post({path:"/e",params:{projectId:s,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:be.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:r.name,errorMessage:r.message,stackTrace:r.stack}}})}catch{}},enable(){Js.enabled=!0},disable(){Js.enabled=!1},clearEvents(){Js.events=[]}};class Rc extends Error{constructor(e,t,n){super(e),this.name="AppKitError",this.category=t,this.originalError=n,Object.setPrototypeOf(this,Rc.prototype);let i=!1;if(n instanceof Error&&typeof n.stack=="string"&&n.stack){const s=n.stack,o=s.indexOf(`
`);if(o>-1){const a=s.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,i=!0}}i||(Error.captureStackTrace?Error.captureStackTrace(this,Rc):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function vb(r,e){let t="";try{r instanceof Error?t=r.message:typeof r=="string"?t=r:typeof r=="object"&&r!==null?t=JSON.stringify(r):t=String(r)}catch(i){t="Unknown error",console.error("Error parsing error message",i)}const n=r instanceof Rc?r:new Rc(t,e,r);throw YC.sendError(n,n.category),n}function Wn(r,e="INTERNAL_SDK_ERROR"){const t={};return Object.keys(r).forEach(n=>{const i=r[n];if(typeof i=="function"){let s=i;i.constructor.name==="AsyncFunction"?s=async(...o)=>{try{return await i(...o)}catch(a){return vb(a,e)}}:s=(...o)=>{try{return i(...o)}catch(a){return vb(a,e)}},t[n]=s}else t[n]=i}),t}var Oc={};const JC="https://secure.walletconnect.org/sdk",ZC=(typeof process<"u"&&typeof Oc<"u"?Oc.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||JC,XC=(typeof process<"u"&&typeof Oc<"u"?Oc.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",QC=(typeof process<"u"&&typeof Oc<"u"?Oc.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",xe={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",APP_RPC_ABORT:"@w3m-app/RPC_ABORT",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",FRAME_RPC_ABORT_SUCCESS:"@w3m-frame/RPC_ABORT_SUCCESS",FRAME_RPC_ABORT_ERROR:"@w3m-frame/RPC_ABORT_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},_r={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},sn={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"},BINANCE:{id:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25",appId:"yFK5FCqYprrXDiVFbhyRx7",deeplink:"bnc://app.binance.com/mp/app",url:"https://app.binance.com/en/download"}},e3={handleMobileDeeplinkRedirect(r,e){const t=window.location.href,n=encodeURIComponent(t);if(r===sn.PHANTOM.id&&!("phantom"in window)){const i=t.startsWith("https")?"https":"http",s=t.split("/")[2],o=encodeURIComponent(`${i}://${s}`);window.location.href=`${sn.PHANTOM.url}/ul/browse/${n}?ref=${o}`}if(r===sn.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${sn.SOLFLARE.url}/ul/v1/browse/${n}?ref=${n}`),e===Y.CHAIN.SOLANA&&r===sn.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${sn.COINBASE.url}/dapp?cb_url=${n}`),e===Y.CHAIN.BITCOIN&&r===sn.BINANCE.id&&!("binancew3w"in window)){const i=$.state.activeCaipNetwork,s=window.btoa("/pages/browser/index"),o=window.btoa(`url=${n}&defaultChainId=${i?.id??1}`),a=new URL(sn.BINANCE.deeplink);a.searchParams.set("appId",sn.BINANCE.appId),a.searchParams.set("startPagePath",s),a.searchParams.set("startPageQuery",o);const c=new URL(sn.BINANCE.url);c.searchParams.set("_dp",window.btoa(a.toString())),window.location.href=c.toString()}}},kn=It({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),t3={state:kn,subscribeNetworkImages(r){return Lr(kn.networkImages,()=>r(kn.networkImages))},subscribeKey(r,e){return en(kn,r,e)},subscribe(r){return Lr(kn,()=>r(kn))},setWalletImage(r,e){kn.walletImages[r]=e},setNetworkImage(r,e){kn.networkImages[r]=e},setChainImage(r,e){kn.chainImages[r]=e},setConnectorImage(r,e){kn.connectorImages={...kn.connectorImages,[r]:e}},setTokenImage(r,e){kn.tokenImages[r]=e},setCurrencyImage(r,e){kn.currencyImages[r]=e}},Ai=Wn(t3),r3={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:"",sui:"",stacks:""},i0=It({networkImagePromises:{}}),Ov={async fetchWalletImage(r){if(r)return await _e._fetchWalletImage(r),this.getWalletImageById(r)},async fetchNetworkImage(r){if(!r)return;const e=this.getNetworkImageById(r);return e||(i0.networkImagePromises[r]||(i0.networkImagePromises[r]=_e._fetchNetworkImage(r)),await i0.networkImagePromises[r],this.getNetworkImageById(r))},getWalletImageById(r){if(r)return Ai.state.walletImages[r]},getWalletImage(r){if(r?.image_url)return r?.image_url;if(r?.image_id)return Ai.state.walletImages[r.image_id]},getNetworkImage(r){if(r?.assets?.imageUrl)return r?.assets?.imageUrl;if(r?.assets?.imageId)return Ai.state.networkImages[r.assets.imageId]},getNetworkImageById(r){if(r)return Ai.state.networkImages[r]},getConnectorImage(r){if(r?.imageUrl)return r.imageUrl;if(r?.info?.icon)return r.info.icon;if(r?.imageId)return Ai.state.connectorImages[r.imageId]},getChainImage(r){return Ai.state.networkImages[r3[r]]}},hi=It({message:"",variant:"info",open:!1}),n3={state:hi,subscribeKey(r,e){return en(hi,r,e)},open(r,e){const{debug:t}=Z.state,{code:n,displayMessage:i,debugMessage:s}=r;i&&t&&(hi.message=i,hi.variant=e,hi.open=!0),s&&console.error(typeof s=="function"?s():s,n?{code:n}:void 0)},warn(r,e,t){hi.open=!0,hi.message=r,hi.variant="warning",e&&console.warn(e,t)},close(){hi.open=!1,hi.message="",hi.variant="info"}},Br=Wn(n3),i3=be.getAnalyticsUrl(),s3=new Xu({baseUrl:i3,clientId:null}),o3=["MODAL_CREATED"],gs=It({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),Qe={state:gs,subscribe(r){return Lr(gs,()=>r(gs))},getSdkProperties(){const{projectId:r,sdkType:e,sdkVersion:t}=Z.state;return{projectId:r,st:e,sv:t||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(r){try{let e=ye.state.address;if("address"in r.data&&r.data.address&&(e=r.data.address),o3.includes(r.data.event)||typeof window>"u")return;const t=$.getActiveCaipNetwork()?.caipNetworkId;await s3.post({path:"/e",params:Qe.getSdkProperties(),body:{eventId:be.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:r.timestamp,props:{...r.data,address:e,properties:{..."properties"in r.data?r.data.properties:{},caipNetworkId:t}}}}),gs.reportedErrors.FORBIDDEN=!1}catch(e){e instanceof Error&&e.cause instanceof Response&&e.cause.status===Y.HTTP_STATUS_CODES.FORBIDDEN&&!gs.reportedErrors.FORBIDDEN&&(Br.open({displayMessage:"Invalid App Configuration",debugMessage:`Origin ${wc()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),gs.reportedErrors.FORBIDDEN=!0)}},sendEvent(r){gs.timestamp=Date.now(),gs.data=r;const e=["INITIALIZE","CONNECT_SUCCESS","SOCIAL_LOGIN_SUCCESS"];(Z.state.features?.analytics||e.includes(r.event))&&Qe._sendAnalyticsEvent(gs)}},a3=be.getApiUrl(),fn=new Xu({baseUrl:a3,clientId:null}),c3=40,Eb=4,l3=20,De=It({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),_e={state:De,subscribeKey(r,e){return en(De,r,e)},_getSdkProperties(){const{projectId:r,sdkType:e,sdkVersion:t}=Z.state;return{projectId:r,st:e||"appkit",sv:t||"html-wagmi-4.2.2"}},_filterOutExtensions(r){return Z.state.isUniversalProvider?r.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):r},async _fetchWalletImage(r){const e=`${fn.baseUrl}/getWalletImage/${r}`,t=await fn.getBlob({path:e,params:_e._getSdkProperties()});Ai.setWalletImage(r,URL.createObjectURL(t))},async _fetchNetworkImage(r){const e=`${fn.baseUrl}/public/getAssetImage/${r}`,t=await fn.getBlob({path:e,params:_e._getSdkProperties()});Ai.setNetworkImage(r,URL.createObjectURL(t))},async _fetchConnectorImage(r){const e=`${fn.baseUrl}/public/getAssetImage/${r}`,t=await fn.getBlob({path:e,params:_e._getSdkProperties()});Ai.setConnectorImage(r,URL.createObjectURL(t))},async _fetchCurrencyImage(r){const e=`${fn.baseUrl}/public/getCurrencyImage/${r}`,t=await fn.getBlob({path:e,params:_e._getSdkProperties()});Ai.setCurrencyImage(r,URL.createObjectURL(t))},async _fetchTokenImage(r){const e=`${fn.baseUrl}/public/getTokenImage/${r}`,t=await fn.getBlob({path:e,params:_e._getSdkProperties()});Ai.setTokenImage(r,URL.createObjectURL(t))},_filterWalletsByPlatform(r){return be.isMobile()?r?.filter(t=>t.mobile_link||t.id===sn.COINBASE.id||t.id===sn.BINANCE.id?!0:$.state.activeChain==="solana"&&(t.id===sn.SOLFLARE.id||t.id===sn.PHANTOM.id)):r},async fetchProjectConfig(){return(await fn.get({path:"/appkit/v1/config",params:_e._getSdkProperties()})).features},async fetchAllowedOrigins(){try{const{allowedOrigins:r}=await fn.get({path:"/projects/v1/origins",params:_e._getSdkProperties()});return r}catch(r){if(r instanceof Error&&r.cause instanceof Response){const e=r.cause.status;if(e===Y.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:r});if(e>=Y.HTTP_STATUS_CODES.SERVER_ERROR&&e<600)throw new Error("SERVER_ERROR",{cause:r});return[]}return[]}},async fetchNetworkImages(){const e=$.getAllRequestedCaipNetworks()?.map(({assets:t})=>t?.imageId).filter(Boolean).filter(t=>!Ov.getNetworkImageById(t));e&&await Promise.allSettled(e.map(t=>_e._fetchNetworkImage(t)))},async fetchConnectorImages(){const{connectors:r}=ae.state,e=r.map(({imageId:t})=>t).filter(Boolean);await Promise.allSettled(e.map(t=>_e._fetchConnectorImage(t)))},async fetchCurrencyImages(r=[]){await Promise.allSettled(r.map(e=>_e._fetchCurrencyImage(e)))},async fetchTokenImages(r=[]){await Promise.allSettled(r.map(e=>_e._fetchTokenImage(e)))},async fetchWallets(r){const e=r.exclude??[];_e._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(sn).map(s=>s.id));const n=await fn.get({path:"/getWallets",params:{..._e._getSdkProperties(),...r,page:String(r.page),entries:String(r.entries),include:r.include?.join(","),exclude:e.join(",")}});return{data:_e._filterWalletsByPlatform(n?.data)||[],count:n?.count}},async fetchFeaturedWallets(){const{featuredWalletIds:r}=Z.state;if(r?.length){const e={..._e._getSdkProperties(),page:1,entries:r?.length??Eb,include:r},{data:t}=await _e.fetchWallets(e),n=[...t].sort((s,o)=>r.indexOf(s.id)-r.indexOf(o.id)),i=n.map(s=>s.image_id).filter(Boolean);await Promise.allSettled(i.map(s=>_e._fetchWalletImage(s))),De.featured=n,De.allFeatured=n}},async fetchRecommendedWallets(){try{De.isFetchingRecommendedWallets=!0;const{includeWalletIds:r,excludeWalletIds:e,featuredWalletIds:t}=Z.state,n=[...e??[],...t??[]].filter(Boolean),i=$.getRequestedCaipNetworkIds().join(","),s={page:1,entries:Eb,include:r,exclude:n,chains:i},{data:o,count:a}=await _e.fetchWallets(s),c=Q.getRecentWallets(),l=o.map(d=>d.image_id).filter(Boolean),u=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(d=>_e._fetchWalletImage(d))),De.recommended=o,De.allRecommended=o,De.count=a??0}catch{}finally{De.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:r}){const{includeWalletIds:e,excludeWalletIds:t,featuredWalletIds:n}=Z.state,i=$.getRequestedCaipNetworkIds().join(","),s=[...De.recommended.map(({id:u})=>u),...t??[],...n??[]].filter(Boolean),o={page:r,entries:c3,include:e,exclude:s,chains:i},{data:a,count:c}=await _e.fetchWallets(o),l=a.slice(0,l3).map(u=>u.image_id).filter(Boolean);await Promise.allSettled(l.map(u=>_e._fetchWalletImage(u))),De.wallets=be.uniqueBy([...De.wallets,..._e._filterOutExtensions(a)],"id").filter(u=>u.chains?.some(d=>i.includes(d))),De.count=c>De.count?c:De.count,De.page=r},async initializeExcludedWallets({ids:r}){const e={page:1,entries:r.length,include:r},{data:t}=await _e.fetchWallets(e);t&&t.forEach(n=>{De.excludedWallets.push({rdns:n.rdns,name:n.name})})},async searchWallet({search:r,badge:e}){const{includeWalletIds:t,excludeWalletIds:n}=Z.state,i=$.getRequestedCaipNetworkIds().join(",");De.search=[];const s={page:1,entries:100,search:r?.trim(),badge_type:e,include:t,exclude:n,chains:i},{data:o}=await _e.fetchWallets(s);Qe.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:r??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>_e._fetchWalletImage(c)),be.wait(300)]),De.search=_e._filterOutExtensions(o)},initPromise(r,e){const t=De.promises[r];return t||(De.promises[r]=e())},prefetch({fetchConnectorImages:r=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:t=!0,fetchNetworkImages:n=!0}={}){const i=[r&&_e.initPromise("connectorImages",_e.fetchConnectorImages),e&&_e.initPromise("featuredWallets",_e.fetchFeaturedWallets),t&&_e.initPromise("recommendedWallets",_e.fetchRecommendedWallets),n&&_e.initPromise("networkImages",_e.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(i)},prefetchAnalyticsConfig(){Z.state.features?.analytics&&_e.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:r}=await fn.get({path:"/getAnalyticsConfig",params:_e._getSdkProperties()});Z.setFeatures({analytics:r})}catch{Z.setFeatures({analytics:!1})}},filterByNamespaces(r){if(!r?.length){De.featured=De.allFeatured,De.recommended=De.allRecommended;return}const e=$.getRequestedCaipNetworkIds().join(",");De.featured=De.allFeatured.filter(t=>t.chains?.some(n=>e.includes(n))),De.recommended=De.allRecommended.filter(t=>t.chains?.some(n=>e.includes(n))),De.filteredWallets=De.wallets.filter(t=>t.chains?.some(n=>e.includes(n)))},clearFilterByNamespaces(){De.filteredWallets=[]},setFilterByNamespace(r){if(!r){De.featured=De.allFeatured,De.recommended=De.allRecommended;return}const e=$.getRequestedCaipNetworkIds().join(",");De.featured=De.allFeatured.filter(t=>t.chains?.some(n=>e.includes(n))),De.recommended=De.allRecommended.filter(t=>t.chains?.some(n=>e.includes(n))),De.filteredWallets=De.wallets.filter(t=>t.chains?.some(n=>e.includes(n)))}},yt=It({view:"Connect",history:["Connect"],transactionStack:[]}),u3={state:yt,subscribeKey(r,e){return en(yt,r,e)},pushTransactionStack(r){yt.transactionStack.push(r)},popTransactionStack(r){const e=yt.transactionStack.pop();if(!e)return;const{onSuccess:t,onError:n,onCancel:i}=e;switch(r){case"success":t?.();break;case"error":n?.(),Te.goBack();break;case"cancel":i?.(),Te.goBack();break}},push(r,e){r!==yt.view&&(yt.view=r,yt.history.push(r),yt.data=e)},reset(r,e){yt.view=r,yt.history=[r],yt.data=e},replace(r,e){yt.history.at(-1)===r||(yt.view=r,yt.history[yt.history.length-1]=r,yt.data=e)},goBack(){const r=$.state.activeCaipAddress,e=Te.state.view==="ConnectingFarcaster",t=!r&&e;if(yt.history.length>1){yt.history.pop();const[n]=yt.history.slice(-1);n&&(r&&n==="Connect"?yt.view="Account":yt.view=n)}else He.close();yt.data?.wallet&&(yt.data.wallet=void 0),setTimeout(()=>{if(t){ye.setFarcasterUrl(void 0,$.state.activeChain);const n=ae.getAuthConnector();n?.provider?.reload();const i=Xl(Z.state);n?.provider?.syncDappData?.({metadata:i.metadata,sdkVersion:i.sdkVersion,projectId:i.projectId,sdkType:i.sdkType})}},100)},goBackToIndex(r){if(yt.history.length>1){yt.history=yt.history.slice(0,r+1);const[e]=yt.history.slice(-1);e&&(yt.view=e)}},goBackOrCloseModal(){Te.state.history.length>1?Te.goBack():He.close()}},Te=Wn(u3),ms=It({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),Up={state:ms,subscribe(r){return Lr(ms,()=>r(ms))},setThemeMode(r){ms.themeMode=r;try{const e=ae.getAuthConnector();if(e){const t=Up.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:r,themeVariables:t,w3mThemeVariables:Ql(t,r)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(r){ms.themeVariables={...ms.themeVariables,...r};try{const e=ae.getAuthConnector();if(e){const t=Up.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:t,w3mThemeVariables:Ql(ms.themeVariables,ms.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return Xl(ms)}},vn=Wn(Up),kv=Object.fromEntries(Iv.map(r=>[r,void 0])),d3=Object.fromEntries(Iv.map(r=>[r,!0])),rt=It({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:kv,filterByNamespaceMap:d3}),f3={state:rt,subscribe(r){return Lr(rt,()=>{r(rt)})},subscribeKey(r,e){return en(rt,r,e)},initialize(r){r.forEach(e=>{const t=Q.getConnectedConnectorId(e);t&&ae.setConnectorId(t,e)})},setActiveConnector(r){r&&(rt.activeConnector=ma(r))},setConnectors(r){r.filter(i=>!rt.allConnectors.some(s=>s.id===i.id&&ae.getConnectorName(s.name)===ae.getConnectorName(i.name)&&s.chain===i.chain)).forEach(i=>{i.type!=="MULTI_CHAIN"&&rt.allConnectors.push(ma(i))});const t=ae.getEnabledNamespaces(),n=ae.getEnabledConnectors(t);rt.connectors=ae.mergeMultiChainConnectors(n)},filterByNamespaces(r){Object.keys(rt.filterByNamespaceMap).forEach(e=>{rt.filterByNamespaceMap[e]=!1}),r.forEach(e=>{rt.filterByNamespaceMap[e]=!0}),ae.updateConnectorsForEnabledNamespaces()},filterByNamespace(r,e){rt.filterByNamespaceMap[r]=e,ae.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const r=ae.getEnabledNamespaces(),e=ae.getEnabledConnectors(r),t=ae.areAllNamespacesEnabled();rt.connectors=ae.mergeMultiChainConnectors(e),t?_e.clearFilterByNamespaces():_e.filterByNamespaces(r)},getEnabledNamespaces(){return Object.entries(rt.filterByNamespaceMap).filter(([r,e])=>e).map(([r])=>r)},getEnabledConnectors(r){return rt.allConnectors.filter(e=>r.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(rt.filterByNamespaceMap).every(r=>r)},mergeMultiChainConnectors(r){const e=ae.generateConnectorMapByName(r),t=[];return e.forEach(n=>{const i=n[0],s=i?.id===Y.CONNECTOR_ID.AUTH;n.length>1&&i?t.push({name:i.name,imageUrl:i.imageUrl,imageId:i.imageId,connectors:[...n],type:s?"AUTH":"MULTI_CHAIN",chain:"eip155",id:i?.id||""}):i&&t.push(i)}),t},generateConnectorMapByName(r){const e=new Map;return r.forEach(t=>{const{name:n}=t,i=ae.getConnectorName(n);if(!i)return;const s=e.get(i)||[];s.find(a=>a.chain===t.chain)||s.push(t),e.set(i,s)}),e},getConnectorName(r){return r&&({"Trust Wallet":"Trust"}[r]||r)},getUniqueConnectorsByName(r){const e=[];return r.forEach(t=>{e.find(n=>n.chain===t.chain)||e.push(t)}),e},addConnector(r){if(r.id===Y.CONNECTOR_ID.AUTH){const e=r,t=Xl(Z.state),n=vn.getSnapshot().themeMode,i=vn.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:t.metadata,sdkVersion:t.sdkVersion,projectId:t.projectId,sdkType:t.sdkType}),e?.provider?.syncTheme({themeMode:n,themeVariables:i,w3mThemeVariables:Ql(i,n)}),ae.setConnectors([r])}else ae.setConnectors([r])},getAuthConnector(r){const e=r||$.state.activeChain,t=rt.connectors.find(n=>n.id===Y.CONNECTOR_ID.AUTH);if(t)return t?.connectors?.length?t.connectors.find(i=>i.chain===e):t},getAnnouncedConnectorRdns(){return rt.connectors.filter(r=>r.type==="ANNOUNCED").map(r=>r.info?.rdns)},getConnectorById(r){return rt.allConnectors.find(e=>e.id===r)},getConnector({id:r,rdns:e,namespace:t}){const n=t||$.state.activeChain;return rt.allConnectors.filter(s=>s.chain===n).find(s=>s.explorerId===r||s.info?.rdns===e)},syncIfAuthConnector(r){if(r.id!=="ID_AUTH")return;const e=r,t=Xl(Z.state),n=vn.getSnapshot().themeMode,i=vn.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:t.metadata,sdkVersion:t.sdkVersion,sdkType:t.sdkType,projectId:t.projectId}),e.provider.syncTheme({themeMode:n,themeVariables:i,w3mThemeVariables:Ql(i,n)})},getConnectorsByNamespace(r){const e=rt.allConnectors.filter(t=>t.chain===r);return ae.mergeMultiChainConnectors(e)},canSwitchToSmartAccount(r){return $.checkIfSmartAccountEnabled()&&qn(r)===_r.ACCOUNT_TYPES.EOA},selectWalletConnector(r){const e=ae.getConnector({id:r.id,rdns:r.rdns});e3.handleMobileDeeplinkRedirect(e?.explorerId||r.id,$.state.activeChain),e?Te.push("ConnectingExternal",{connector:e,wallet:r}):Te.push("ConnectingWalletConnect",{wallet:r})},getConnectors(r){return r?ae.getConnectorsByNamespace(r):ae.mergeMultiChainConnectors(rt.allConnectors)},setFilterByNamespace(r){rt.filterByNamespace=r,rt.connectors=ae.getConnectors(r),_e.setFilterByNamespace(r)},setConnectorId(r,e){r&&(rt.activeConnectorIds={...rt.activeConnectorIds,[e]:r},Q.setConnectedConnectorId(e,r))},removeConnectorId(r){rt.activeConnectorIds={...rt.activeConnectorIds,[r]:void 0},Q.deleteConnectedConnectorId(r)},getConnectorId(r){if(r)return rt.activeConnectorIds[r]},isConnected(r){return r?!!rt.activeConnectorIds[r]:Object.values(rt.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){rt.activeConnectorIds={...kv}}},ae=Wn(f3),h3=1e3,sl={checkNamespaceConnectorId(r,e){return ae.getConnectorId(r)===e},isSocialProvider(r){return Ge.DEFAULT_REMOTE_FEATURES.socials.includes(r)},connectWalletConnect({walletConnect:r,connector:e,closeModalOnConnect:t=!0,redirectViewOnModalClose:n="Connect",onOpen:i,onConnect:s}){return new Promise((o,a)=>{if(r&&ae.setActiveConnector(e),i?.(be.isMobile()&&r),n){const l=He.subscribeKey("open",u=>{u||(Te.state.view!==n&&Te.replace(n),l(),a(new Error("Modal closed")))})}const c=$.subscribeKey("activeCaipAddress",l=>{l&&(s?.(),t&&He.close(),c(),o(on.parseCaipAddress(l)))})})},connectExternal(r){return new Promise((e,t)=>{const n=$.subscribeKey("activeCaipAddress",i=>{i&&(He.close(),n(),e(on.parseCaipAddress(i)))});de.connectExternal(r,r.chain).catch(()=>{n(),t(new Error("Connection rejected"))})})},connectSocial({social:r,namespace:e,closeModalOnConnect:t=!0,onOpenFarcaster:n,onConnect:i}){let s=ye.state.socialWindow,o=ye.state.socialProvider,a=!1,c=null;const l=e||$.state.activeChain,u=$.subscribeKey("activeCaipAddress",d=>{d&&(t&&He.close(),u())});return new Promise((d,p)=>{async function x(b){if(b.data?.resultUri)if(b.origin===Y.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",x,!1);try{const y=ae.getAuthConnector(l);if(y&&!a){s&&(s.close(),ye.setSocialWindow(void 0,l),s=ye.state.socialWindow),a=!0;const C=b.data.resultUri;if(o&&Qe.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:o}}),o){Q.setConnectedSocialProvider(o),await de.connectExternal({id:y.id,type:y.type,socialUri:C},y.chain);const T=$.state.activeCaipAddress;if(!T){p(new Error("Failed to connect"));return}d(on.parseCaipAddress(T)),Qe.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:o}})}}}catch{o&&Qe.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:o}}),p(new Error("Failed to connect"))}}else o&&Qe.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:o}})}async function w(){if(r&&(ye.setSocialProvider(r,l),o=ye.state.socialProvider,Qe.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:o}})),o==="farcaster"){n?.();const b=He.subscribeKey("open",C=>{!C&&r==="farcaster"&&(p(new Error("Popup closed")),i?.(),b())}),y=ae.getAuthConnector();if(y&&!ye.state.farcasterUrl)try{const{url:C}=await y.provider.getFarcasterUri();ye.setFarcasterUrl(C,l)}catch{p(new Error("Failed to connect to farcaster"))}}else{const b=ae.getAuthConnector();c=be.returnOpenHref(`${Y.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(b&&o){const{uri:y}=await b.provider.getSocialRedirectUri({provider:o});if(c&&y){ye.setSocialWindow(c,l),s=ye.state.socialWindow,c.location.href=y;const C=setInterval(()=>{s?.closed&&!a&&(p(new Error("Popup closed")),clearInterval(C))},1e3);window.addEventListener("message",x,!1)}else c?.close(),p(new Error("Failed to initiate social connection"))}}catch{p(new Error("Failed to initiate social connection")),c?.close()}}}w()})},connectEmail({closeModalOnConnect:r=!0,redirectViewOnModalClose:e="Connect",onOpen:t,onConnect:n}){return new Promise((i,s)=>{if(t?.(),e){const a=He.subscribeKey("open",c=>{c||(Te.state.view!==e&&Te.replace(e),a(),s(new Error("Modal closed")))})}const o=$.subscribeKey("activeCaipAddress",a=>{a&&(n?.(),r&&He.close(),o(),i(on.parseCaipAddress(a)))})})},async updateEmail(){const r=Q.getConnectedConnectorId($.state.activeChain),e=ae.getAuthConnector();if(!e)throw new Error("No auth connector found");if(r!==Y.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const t=e.provider.getEmail()??"";return await He.open({view:"UpdateEmailWallet",data:{email:t,redirectView:void 0}}),new Promise((n,i)=>{const s=setInterval(()=>{const a=e.provider.getEmail()??"";a!==t&&(He.close(),clearInterval(s),o(),n({email:a}))},h3),o=He.subscribeKey("open",a=>{a||(Te.state.view!=="Connect"&&Te.push("Connect"),clearInterval(s),o(),i(new Error("Modal closed")))})})},canSwitchToSmartAccount(r){return $.checkIfSmartAccountEnabled()&&qn(r)===_r.ACCOUNT_TYPES.EOA}};function Dv(){const r=$.state.activeCaipNetwork?.chainNamespace||"eip155",e=$.state.activeCaipNetwork?.id||1,t=Ge.NATIVE_TOKEN_ADDRESS[r];return`${r}:${e}:${t}`}function qn(r){return $.getAccountData(r)?.preferredAccountType}function Nl(r){return r?$.state.chains.get(r)?.networkState?.caipNetwork:$.state.activeCaipNetwork}const Ef={getConnectionStatus(r,e){const t=ae.state.activeConnectorIds[e],n=de.getConnections(e);return!!t&&r.connectorId===t?"connected":n.some(o=>o.connectorId.toLowerCase()===r.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:r,connectorId:e,addresses:t}){return r.map(n=>{if((e?n.connectorId.toLowerCase()===e.toLowerCase():!1)&&t){const s=n.accounts.filter(o=>!t.some(c=>c.toLowerCase()===o.address.toLowerCase()));return{...n,accounts:s}}return n})},excludeExistingConnections(r,e){const t=new Set(r);return e.filter(n=>!t.has(n.connectorId))},getConnectionsByConnectorId(r,e){return r.filter(t=>t.connectorId.toLowerCase()===e.toLowerCase())},getConnectionsData(r){const e=!!Z.state.remoteFeatures?.multiWallet,t=ae.state.activeConnectorIds[r],n=de.getConnections(r),s=(de.state.recentConnections.get(r)??[]).filter(a=>ae.getConnectorById(a.connectorId)),o=Ef.excludeExistingConnections([...n.map(a=>a.connectorId),...t?[t]:[]],s);return e?{connections:n,recentConnections:o}:{connections:n.filter(a=>a.connectorId.toLowerCase()===t?.toLowerCase()),recentConnections:[]}}},Yo=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),br=It({...Yo}),p3={state:br,subscribeKey(r,e){return en(br,r,e)},showLoading(r,e={}){this._showMessage({message:r,variant:"loading",...e})},showSuccess(r){this._showMessage({message:r,variant:"success"})},showSvg(r,e){this._showMessage({message:r,svg:e})},showError(r){const e=be.parseError(r);this._showMessage({message:e,variant:"error"})},hide(){br.message=Yo.message,br.variant=Yo.variant,br.svg=Yo.svg,br.open=Yo.open,br.autoClose=Yo.autoClose},_showMessage({message:r,svg:e,variant:t="success",autoClose:n=Yo.autoClose}){br.open?(br.open=!1,setTimeout(()=>{br.message=r,br.variant=t,br.svg=e,br.open=!0,br.autoClose=n},150)):(br.message=r,br.variant=t,br.svg=e,br.open=!0,br.autoClose=n)}},Xi=p3,Xt=It({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),g3={state:Xt,subscribe(r){return Lr(Xt,()=>r(Xt))},setLastNetworkInView(r){Xt.lastNetworkInView=r},async fetchTransactions(r){if(!r)throw new Error("Transactions can't be fetched without an accountAddress");Xt.loading=!0;try{const e=await Ie.fetchTransactions({account:r,cursor:Xt.next,chainId:$.state.activeCaipNetwork?.caipNetworkId}),t=Xd.filterSpamTransactions(e.data),n=Xd.filterByConnectedChain(t),i=[...Xt.transactions,...n];Xt.loading=!1,Xt.transactions=i,Xt.transactionsByYear=Xd.groupTransactionsByYearAndMonth(Xt.transactionsByYear,n),Xt.empty=i.length===0,Xt.next=e.next?e.next:void 0}catch{const t=$.state.activeChain;Qe.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:r,projectId:Z.state.projectId,cursor:Xt.next,isSmartAccount:qn(t)===_r.ACCOUNT_TYPES.SMART_ACCOUNT}}),Xi.showError("Failed to fetch transactions"),Xt.loading=!1,Xt.empty=!0,Xt.next=void 0}},groupTransactionsByYearAndMonth(r={},e=[]){const t=r;return e.forEach(n=>{const i=new Date(n.metadata.minedAt).getFullYear(),s=new Date(n.metadata.minedAt).getMonth(),o=t[i]??{},c=(o[s]??[]).filter(l=>l.id!==n.id);t[i]={...o,[s]:[...c,n].sort((l,u)=>new Date(u.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),t},filterSpamTransactions(r){return r.filter(e=>!e.transfers.every(n=>n.nft_info?.flags.is_spam===!0))},filterByConnectedChain(r){const e=$.state.activeCaipNetwork?.caipNetworkId;return r.filter(n=>n.metadata.chain===e)},clearCursor(){Xt.next=void 0},resetTransactions(){Xt.transactions=[],Xt.transactionsByYear={},Xt.lastNetworkInView=void 0,Xt.loading=!1,Xt.empty=!1,Xt.next=void 0}},Xd=Wn(g3,"API_ERROR"),nt=It({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,buffering:!1,status:"disconnected"});let qo;const m3={state:nt,subscribe(r){return Lr(nt,()=>r(nt))},subscribeKey(r,e){return en(nt,r,e)},_getClient(){return nt._client},setClient(r){nt._client=ma(r)},initialize(r){const e=r.filter(t=>!!t.namespace).map(t=>t.namespace);de.syncStorageConnections(e)},syncStorageConnections(r){const e=Q.getConnections(),t=r??Array.from($.state.chains.keys());for(const n of t){const i=e[n]??[],s=new Map(nt.recentConnections);s.set(n,i),nt.recentConnections=s}},getConnections(r){return r?nt.connections.get(r)??[]:[]},hasAnyConnection(r){const e=de.state.connections;return Array.from(e.values()).flatMap(t=>t).some(({connectorId:t})=>t===r)},async connectWalletConnect({cache:r="auto"}={}){const e=be.isTelegram()||be.isSafari()&&be.isIos();if(r==="always"||r==="auto"&&e){if(qo){await qo,qo=void 0;return}if(!be.isPairingExpired(nt?.wcPairingExpiry)){const t=nt.wcUri;nt.wcUri=t;return}qo=de._getClient()?.connectWalletConnect?.().catch(()=>{}),de.state.status="connecting",await qo,qo=void 0,nt.wcPairingExpiry=void 0,de.state.status="connected"}else await de._getClient()?.connectWalletConnect?.()},async connectExternal(r,e,t=!0){const n=await de._getClient()?.connectExternal?.(r);return t&&$.setActiveNamespace(e),n},async reconnectExternal(r){await de._getClient()?.reconnectExternal?.(r);const e=r.chain||$.state.activeChain;e&&ae.setConnectorId(r.id,e)},async setPreferredAccountType(r,e){if(!e)return;He.setLoading(!0,$.state.activeChain);const t=ae.getAuthConnector();t&&(ye.setPreferredAccountType(r,e),await t.provider.setPreferredAccount(r),Q.setPreferredAccountTypes(Object.entries($.state.chains).reduce((n,[i,s])=>{const o=i,a=qn(o);return a!==void 0&&(n[o]=a),n},{})),await de.reconnectExternal(t),He.setLoading(!1,$.state.activeChain),Qe.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:r,network:$.state.activeCaipNetwork?.caipNetworkId||""}}))},async signMessage(r){return de._getClient()?.signMessage(r)},parseUnits(r,e){return de._getClient()?.parseUnits(r,e)},formatUnits(r,e){return de._getClient()?.formatUnits(r,e)},updateBalance(r){return de._getClient()?.updateBalance(r)},async sendTransaction(r){return de._getClient()?.sendTransaction(r)},async getCapabilities(r){return de._getClient()?.getCapabilities(r)},async grantPermissions(r){return de._getClient()?.grantPermissions(r)},async walletGetAssets(r){return de._getClient()?.walletGetAssets(r)??{}},async estimateGas(r){return de._getClient()?.estimateGas(r)},async writeContract(r){return de._getClient()?.writeContract(r)},async getEnsAddress(r){return de._getClient()?.getEnsAddress(r)},async getEnsAvatar(r){return de._getClient()?.getEnsAvatar(r)},checkInstalled(r){return de._getClient()?.checkInstalled?.(r)||!1},resetWcConnection(){nt.wcUri=void 0,nt.wcPairingExpiry=void 0,nt.wcLinking=void 0,nt.recentWallet=void 0,nt.status="disconnected",Xd.resetTransactions(),Q.deleteWalletConnectDeepLink()},resetUri(){nt.wcUri=void 0,nt.wcPairingExpiry=void 0,qo=void 0},finalizeWcConnection(r){const{wcLinking:e,recentWallet:t}=de.state;e&&Q.setWalletConnectDeepLink(e),t&&Q.setAppKitRecent(t),r&&Qe.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:r,properties:{method:e?"mobile":"qrcode",name:Te.state.data?.wallet?.name||"Unknown"}})},setWcBasic(r){nt.wcBasic=r},setUri(r){nt.wcUri=r,nt.wcPairingExpiry=be.getPairingExpiry()},setWcLinking(r){nt.wcLinking=r},setWcError(r){nt.wcError=r,nt.buffering=!1},setRecentWallet(r){nt.recentWallet=r},setBuffering(r){nt.buffering=r},setStatus(r){nt.status=r},setIsSwitchingConnection(r){nt.isSwitchingConnection=r},async disconnect({id:r,namespace:e,initialDisconnect:t}={}){try{await de._getClient()?.disconnect({id:r,chainNamespace:e,initialDisconnect:t})}catch(n){throw new Rc("Failed to disconnect","INTERNAL_SDK_ERROR",n)}},setConnections(r,e){const t=new Map(nt.connections);t.set(e,r),nt.connections=t},async handleAuthAccountSwitch({address:r,namespace:e}){const t=ye.state.user?.accounts?.find(i=>i.type==="smartAccount"),n=t&&t.address.toLowerCase()===r.toLowerCase()&&sl.canSwitchToSmartAccount(e)?"smartAccount":"eoa";await de.setPreferredAccountType(n,e)},async handleActiveConnection({connection:r,namespace:e,address:t}){const n=ae.getConnectorById(r.connectorId),i=r.connectorId===Y.CONNECTOR_ID.AUTH;if(!n)throw new Error(`No connector found for connection: ${r.connectorId}`);if(i)i&&t&&await de.handleAuthAccountSwitch({address:t,namespace:e});else return(await de.connectExternal({id:n.id,type:n.type,provider:n.provider,address:t,chain:e},e))?.address;return t},async handleDisconnectedConnection({connection:r,namespace:e,address:t,closeModalOnConnect:n}){const i=ae.getConnectorById(r.connectorId),s=r.auth?.name?.toLowerCase(),o=r.connectorId===Y.CONNECTOR_ID.AUTH,a=r.connectorId===Y.CONNECTOR_ID.WALLET_CONNECT;if(!i)throw new Error(`No connector found for connection: ${r.connectorId}`);let c;if(o)if(s&&sl.isSocialProvider(s)){const{address:l}=await sl.connectSocial({social:s,closeModalOnConnect:n,onOpenFarcaster(){He.open({view:"ConnectingFarcaster"})},onConnect(){Te.replace("ProfileWallets")}});c=l}else{const{address:l}=await sl.connectEmail({closeModalOnConnect:n,onOpen(){He.open({view:"EmailLogin"})},onConnect(){Te.replace("ProfileWallets")}});c=l}else if(a){const{address:l}=await sl.connectWalletConnect({walletConnect:!0,connector:i,closeModalOnConnect:n,onOpen(u){const d=u?"AllWallets":"ConnectingWalletConnect";He.state.open?Te.push(d):He.open({view:d})},onConnect(){Te.replace("ProfileWallets")}});c=l}else{const l=await de.connectExternal({id:i.id,type:i.type,provider:i.provider,chain:e},e);l&&(c=l.address)}return o&&t&&await de.handleAuthAccountSwitch({address:t,namespace:e}),c},async switchConnection({connection:r,address:e,namespace:t,closeModalOnConnect:n,onChange:i}){let s;const o=ye.getCaipAddress(t);if(o){const{address:c}=on.parseCaipAddress(o);s=c}const a=Ef.getConnectionStatus(r,t);switch(a){case"connected":case"active":{const c=await de.handleActiveConnection({connection:r,namespace:t,address:e});if(s&&c){const l=c.toLowerCase()!==s.toLowerCase();i?.({address:c,namespace:t,hasSwitchedAccount:l,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const c=await de.handleDisconnectedConnection({connection:r,namespace:t,address:e,closeModalOnConnect:n});c&&i?.({address:c,namespace:t,hasSwitchedAccount:!0,hasSwitchedWallet:!0});break}default:throw new Error(`Invalid connection status: ${a}`)}}},de=Wn(m3),ja=It({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),Ni={state:ja,subscribe(r){return Lr(ja,()=>r(ja))},subscribeOpen(r){return en(ja,"open",r)},set(r){Object.assign(ja,{...ja,...r})}},b3={async getTokenList(r){return(await Ie.fetchSwapTokens({chainId:r}))?.tokens?.map(n=>({...n,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0}))||[]},async fetchGasPrice(){const r=$.state.activeCaipNetwork;if(!r)return null;try{switch(r.chainNamespace){case"solana":const e=(await de?.estimateGas({chainNamespace:"solana"}))?.toString();return{standard:e,fast:e,instant:e};case"eip155":default:return await Ie.fetchGasPrice({chainId:r.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:r,userAddress:e,sourceTokenAmount:t,sourceTokenDecimals:n}){const i=await Ie.fetchSwapAllowance({tokenAddress:r,userAddress:e});if(i?.allowance&&t&&n){const s=de.parseUnits(t,n)||0;return BigInt(i.allowance)>=s}return!1},async getMyTokensWithBalance(r){const e=await im.getMyTokensWithBalance(r);return ye.setTokenBalance(e,$.state.activeChain),this.mapBalancesToSwapTokens(e)},mapBalancesToSwapTokens(r){return r?.map(e=>({...e,address:e?.address?e.address:Dv(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1}))||[]}},gt=It({tokenBalances:[],loading:!1}),y3={state:gt,subscribe(r){return Lr(gt,()=>r(gt))},subscribeKey(r,e){return en(gt,r,e)},setToken(r){r&&(gt.token=ma(r))},setTokenAmount(r){gt.sendTokenAmount=r},setReceiverAddress(r){gt.receiverAddress=r},setReceiverProfileImageUrl(r){gt.receiverProfileImageUrl=r},setReceiverProfileName(r){gt.receiverProfileName=r},setNetworkBalanceInUsd(r){gt.networkBalanceInUSD=r},setLoading(r){gt.loading=r},async sendToken(){try{switch(Ke.setLoading(!0),$.state.activeCaipNetwork?.chainNamespace){case"eip155":await Ke.sendEvmToken();return;case"solana":await Ke.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}finally{Ke.setLoading(!1)}},async sendEvmToken(){const r=$.state.activeChain;if(!r)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const e=qn(r);if(!Ke.state.sendTokenAmount||!Ke.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!Ke.state.token)throw new Error("A token is required");Ke.state.token?.address?(Qe.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===_r.ACCOUNT_TYPES.SMART_ACCOUNT,token:Ke.state.token.address,amount:Ke.state.sendTokenAmount,network:$.state.activeCaipNetwork?.caipNetworkId||""}}),await Ke.sendERC20Token({receiverAddress:Ke.state.receiverAddress,tokenAddress:Ke.state.token.address,sendTokenAmount:Ke.state.sendTokenAmount,decimals:Ke.state.token.quantity.decimals})):(Qe.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===_r.ACCOUNT_TYPES.SMART_ACCOUNT,token:Ke.state.token.symbol||"",amount:Ke.state.sendTokenAmount,network:$.state.activeCaipNetwork?.caipNetworkId||""}}),await Ke.sendNativeToken({receiverAddress:Ke.state.receiverAddress,sendTokenAmount:Ke.state.sendTokenAmount,decimals:Ke.state.token.quantity.decimals}))},async fetchTokenBalance(r){gt.loading=!0;const e=$.state.activeChain,t=$.state.activeCaipNetwork?.caipNetworkId,n=$.state.activeCaipNetwork?.chainNamespace,i=ye.getCaipAddress(e)??$.state.activeCaipAddress,s=i?be.getPlainAddress(i):void 0;if(gt.lastRetry&&!be.isAllowedRetry(gt.lastRetry,30*Ge.ONE_SEC_MS))return gt.loading=!1,[];try{if(s&&t&&n){const o=await im.getMyTokensWithBalance();return gt.tokenBalances=o,gt.lastRetry=void 0,o}}catch(o){gt.lastRetry=Date.now(),r?.(o),Xi.showError("Token Balance Unavailable")}finally{gt.loading=!1}return[]},fetchNetworkBalance(){if(gt.tokenBalances.length===0)return;const r=b3.mapBalancesToSwapTokens(gt.tokenBalances);if(!r)return;const e=r.find(t=>t.address===Dv());e&&(gt.networkBalanceInUSD=e?$C.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(r){Te.pushTransactionStack({});const e=r.receiverAddress,t=ye.state.address,n=de.parseUnits(r.sendTokenAmount.toString(),Number(r.decimals));await de.sendTransaction({chainNamespace:Y.CHAIN.EVM,to:e,address:t,data:"0x",value:n??BigInt(0)}),Qe.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:qn("eip155")===_r.ACCOUNT_TYPES.SMART_ACCOUNT,token:Ke.state.token?.symbol||"",amount:r.sendTokenAmount,network:$.state.activeCaipNetwork?.caipNetworkId||""}}),de._getClient()?.updateBalance("eip155"),Ke.resetSend()},async sendERC20Token(r){Te.pushTransactionStack({onSuccess(){Te.replace("Account")}});const e=de.parseUnits(r.sendTokenAmount.toString(),Number(r.decimals));if(ye.state.address&&r.sendTokenAmount&&r.receiverAddress&&r.tokenAddress){const t=be.getPlainAddress(r.tokenAddress);if(!t)throw new Error("SendController:sendERC20Token - tokenAddress is required");await de.writeContract({fromAddress:ye.state.address,tokenAddress:t,args:[r.receiverAddress,e??BigInt(0)],method:"transfer",abi:qC.getERC20Abi(t),chainNamespace:Y.CHAIN.EVM}),Ke.resetSend()}},async sendSolanaToken(){if(!Ke.state.sendTokenAmount||!Ke.state.receiverAddress)throw new Error("An amount and receiver address are required");Te.pushTransactionStack({onSuccess(){Te.replace("Account")}});let r;if(Ke.state.token&&be.isCaipAddress(Ke.state.token.address)){const[,,e]=Ke.state.token.address.split(":");r=e}await de.sendTransaction({chainNamespace:"solana",tokenMint:r,to:Ke.state.receiverAddress,value:Ke.state.sendTokenAmount}),de._getClient()?.updateBalance("solana"),Ke.resetSend()},resetSend(){gt.token=void 0,gt.sendTokenAmount=void 0,gt.receiverAddress=void 0,gt.receiverProfileImageUrl=void 0,gt.receiverProfileName=void 0,gt.loading=!1,gt.tokenBalances=[]}},Ke=Wn(y3),s0={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},xd={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},fe=It({chains:TC(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),w3={state:fe,subscribe(r){return Lr(fe,()=>{r(fe)})},subscribeKey(r,e){return en(fe,r,e)},subscribeChainProp(r,e,t){let n;return Lr(fe.chains,()=>{const i=t||fe.activeChain;if(i){const s=fe.chains.get(i)?.[r];n!==s&&(n=s,e(s))}})},initialize(r,e,t){const{chainId:n,namespace:i}=Q.getActiveNetworkProps(),s=e?.find(u=>u.id.toString()===n?.toString()),a=r.find(u=>u?.namespace===i)||r?.[0],c=r.map(u=>u.namespace).filter(u=>u!==void 0),l=Z.state.enableEmbedded?new Set([...c]):new Set([...e?.map(u=>u.chainNamespace)??[]]);(r?.length===0||!a)&&(fe.noAdapters=!0),fe.noAdapters||(fe.activeChain=a?.namespace,fe.activeCaipNetwork=s,$.setChainNetworkData(a?.namespace,{caipNetwork:s}),fe.activeChain&&Ni.set({activeChain:a?.namespace})),l.forEach(u=>{const d=e?.filter(w=>w.chainNamespace===u),p=Q.getPreferredAccountTypes()||{},x={...Z.state.defaultAccountTypes,...p};$.state.chains.set(u,{namespace:u,networkState:It({...xd,caipNetwork:d?.[0]}),accountState:It({...s0,preferredAccountType:x[u]}),caipNetworks:d??[],...t}),$.setRequestedCaipNetworks(d??[],u)})},removeAdapter(r){if(fe.activeChain===r){const e=Array.from(fe.chains.entries()).find(([t])=>t!==r);if(e){const t=e[1]?.caipNetworks?.[0];t&&$.setActiveCaipNetwork(t)}}fe.chains.delete(r)},addAdapter(r,{networkControllerClient:e,connectionControllerClient:t},n){if(!r.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");fe.chains.set(r.namespace,{namespace:r.namespace,networkState:{...xd,caipNetwork:n[0]},accountState:s0,caipNetworks:n,connectionControllerClient:t,networkControllerClient:e}),$.setRequestedCaipNetworks(n?.filter(i=>i.chainNamespace===r.namespace)??[],r.namespace)},addNetwork(r){const e=fe.chains.get(r.chainNamespace);if(e){const t=[...e.caipNetworks||[]];e.caipNetworks?.find(n=>n.id===r.id)||t.push(r),fe.chains.set(r.chainNamespace,{...e,caipNetworks:t}),$.setRequestedCaipNetworks(t,r.chainNamespace),ae.filterByNamespace(r.chainNamespace,!0)}},removeNetwork(r,e){const t=fe.chains.get(r);if(t){const n=fe.activeCaipNetwork?.id===e,i=[...t.caipNetworks?.filter(s=>s.id!==e)||[]];n&&t?.caipNetworks?.[0]&&$.setActiveCaipNetwork(t.caipNetworks[0]),fe.chains.set(r,{...t,caipNetworks:i}),$.setRequestedCaipNetworks(i||[],r),i.length===0&&ae.filterByNamespace(r,!1)}},setAdapterNetworkState(r,e){const t=fe.chains.get(r);t&&(t.networkState={...t.networkState||xd,...e},fe.chains.set(r,t))},setChainAccountData(r,e,t=!0){if(!r)throw new Error("Chain is required to update chain account data");const n=fe.chains.get(r);if(n){const i={...n.accountState||s0,...e};fe.chains.set(r,{...n,accountState:i}),(fe.chains.size===1||fe.activeChain===r)&&(e.caipAddress&&(fe.activeCaipAddress=e.caipAddress),ye.replaceState(i))}},setChainNetworkData(r,e){if(!r)return;const t=fe.chains.get(r);if(t){const n={...t.networkState||xd,...e};fe.chains.set(r,{...t,networkState:n})}},setAccountProp(r,e,t,n=!0){$.setChainAccountData(t,{[r]:e},n)},setActiveNamespace(r){fe.activeChain=r;const e=r?fe.chains.get(r):void 0,t=e?.networkState?.caipNetwork;t?.id&&r&&(fe.activeCaipAddress=e?.accountState?.caipAddress,fe.activeCaipNetwork=t,$.setChainNetworkData(r,{caipNetwork:t}),Q.setActiveCaipNetworkId(t?.caipNetworkId),Ni.set({activeChain:r,selectedNetworkId:t?.caipNetworkId}))},setActiveCaipNetwork(r){if(!r)return;fe.activeChain!==r.chainNamespace&&$.setIsSwitchingNamespace(!0);const e=fe.chains.get(r.chainNamespace);fe.activeChain=r.chainNamespace,fe.activeCaipNetwork=r,$.setChainNetworkData(r.chainNamespace,{caipNetwork:r}),e?.accountState?.address?fe.activeCaipAddress=`${r.chainNamespace}:${r.id}:${e?.accountState?.address}`:fe.activeCaipAddress=void 0,$.setAccountProp("caipAddress",fe.activeCaipAddress,r.chainNamespace),e&&ye.replaceState(e.accountState),Ke.resetSend(),Ni.set({activeChain:fe.activeChain,selectedNetworkId:fe.activeCaipNetwork?.caipNetworkId}),Q.setActiveCaipNetworkId(r.caipNetworkId),!$.checkIfSupportedNetwork(r.chainNamespace)&&Z.state.enableNetworkSwitch&&!Z.state.allowUnsupportedChain&&!de.state.wcBasic&&$.showUnsupportedChainUI()},addCaipNetwork(r){if(!r)return;const e=fe.chains.get(r.chainNamespace);e&&e?.caipNetworks?.push(r)},async switchActiveNamespace(r){if(!r)return;const e=r!==$.state.activeChain,t=$.getNetworkData(r)?.caipNetwork,n=$.getCaipNetworkByNamespace(r,t?.id);e&&n&&await $.switchActiveNetwork(n)},async switchActiveNetwork(r){const e=$.state.activeChain;if(!e)throw new Error("ChainController:switchActiveNetwork - namespace is required");const n=!$.state.chains.get(e)?.caipNetworks?.some(s=>s.id===fe.activeCaipNetwork?.id),i=$.getNetworkControllerClient(r.chainNamespace);if(i){try{await i.switchCaipNetwork(r),n&&He.close()}catch{Te.goBack()}Qe.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:r.caipNetworkId}})}},getNetworkControllerClient(r){const e=r||fe.activeChain;if(!e)throw new Error("ChainController:getNetworkControllerClient - chain is required");const t=fe.chains.get(e);if(!t)throw new Error("Chain adapter not found");if(!t.networkControllerClient)throw new Error("NetworkController client not set");return t.networkControllerClient},getConnectionControllerClient(r){const e=r||fe.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const t=fe.chains.get(e);if(!t?.connectionControllerClient)throw new Error("ConnectionController client not set");return t.connectionControllerClient},getNetworkProp(r,e){const t=fe.chains.get(e)?.networkState;if(t)return t[r]},getRequestedCaipNetworks(r){const e=fe.chains.get(r),{approvedCaipNetworkIds:t=[],requestedCaipNetworks:n=[]}=e?.networkState||{};return be.sortRequestedNetworks(t,n).filter(o=>o?.id)},getAllRequestedCaipNetworks(){const r=[];return fe.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const t=$.getRequestedCaipNetworks(e.namespace);r.push(...t)}),r},setRequestedCaipNetworks(r,e){$.setAdapterNetworkState(e,{requestedCaipNetworks:r});const n=$.getAllRequestedCaipNetworks().map(s=>s.chainNamespace),i=Array.from(new Set(n));ae.filterByNamespaces(i)},getAllApprovedCaipNetworkIds(){const r=[];return fe.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const t=$.getApprovedCaipNetworkIds(e.namespace);r.push(...t)}),r},getActiveCaipNetwork(r){return r?fe.chains.get(r)?.networkState?.caipNetwork:fe.activeCaipNetwork},getActiveCaipAddress(){return fe.activeCaipAddress},getApprovedCaipNetworkIds(r){return fe.chains.get(r)?.networkState?.approvedCaipNetworkIds||[]},async setApprovedCaipNetworksData(r){const t=await $.getNetworkControllerClient()?.getApprovedCaipNetworksData();$.setAdapterNetworkState(r,{approvedCaipNetworkIds:t?.approvedCaipNetworkIds,supportsAllNetworks:t?.supportsAllNetworks})},checkIfSupportedNetwork(r,e){const t=e||fe.activeCaipNetwork?.caipNetworkId,n=$.getRequestedCaipNetworks(r);return n.length?n?.some(i=>i.caipNetworkId===t):!0},checkIfSupportedChainId(r){return fe.activeChain?$.getRequestedCaipNetworks(fe.activeChain)?.some(t=>t.id===r):!0},setSmartAccountEnabledNetworks(r,e){$.setAdapterNetworkState(e,{smartAccountEnabledNetworks:r})},checkIfSmartAccountEnabled(){const r=Nv.caipNetworkIdToNumber(fe.activeCaipNetwork?.caipNetworkId),e=fe.activeChain;return!e||!r?!1:!!$.getNetworkProp("smartAccountEnabledNetworks",e)?.includes(Number(r))},showUnsupportedChainUI(){He.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const r=fe.activeCaipNetwork;return!!(r?.chainNamespace&&Ge.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(r.chainNamespace))},resetNetwork(r){$.setAdapterNetworkState(r,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(r){const e=r;if(!e)throw new Error("Chain is required to set account prop");const t=$.state.chains.get(e)?.accountState?.preferredAccountType,n=Z.state.defaultAccountTypes[e];fe.activeCaipAddress=void 0,$.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:n||t,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),ae.removeConnectorId(e)},setIsSwitchingNamespace(r){fe.isSwitchingNamespace=r},getFirstCaipNetworkSupportsAuthConnector(){const r=[];let e;if(fe.chains.forEach(t=>{Y.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(n=>n===t.namespace)&&t.namespace&&r.push(t.namespace)}),r.length>0){const t=r[0];return e=t?fe.chains.get(t)?.caipNetworks?.[0]:void 0,e}},getAccountData(r){const e=r||fe.activeChain;if(e)return $.state.chains.get(e)?.accountState},getNetworkData(r){const e=r||fe.activeChain;if(e)return $.state.chains.get(e)?.networkState},getCaipNetworkByNamespace(r,e){if(!r)return;const t=$.state.chains.get(r),n=t?.caipNetworks?.find(i=>i.id===e);return n||t?.networkState?.caipNetwork||t?.caipNetworks?.[0]},getRequestedCaipNetworkIds(){const r=ae.state.filterByNamespace;return(r?[fe.chains.get(r)]:Array.from(fe.chains.values())).flatMap(t=>t?.caipNetworks||[]).map(t=>t.caipNetworkId)},getCaipNetworks(r){return r?$.getRequestedCaipNetworks(r):$.getAllRequestedCaipNetworks()},setLastConnectedSIWECaipNetwork(r){fe.lastConnectedSIWECaipNetwork=r},getLastConnectedSIWECaipNetwork(){return fe.lastConnectedSIWECaipNetwork}},$=Wn(w3),x3={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},Mv=be.getBlockchainApiUrl(),hn=It({clientId:null,api:new Xu({baseUrl:Mv,clientId:null}),supportedChains:{http:[],ws:[]}}),Ie={state:hn,async get(r){const{st:e,sv:t}=Ie.getSdkProperties(),n=Z.state.projectId,i={...r.params||{},st:e,sv:t,projectId:n};return hn.api.get({...r,params:i})},getSdkProperties(){const{sdkType:r,sdkVersion:e}=Z.state;return{st:r||"unknown",sv:e||"unknown"}},async isNetworkSupported(r){if(!r)return!1;try{hn.supportedChains.http.length||await Ie.getSupportedNetworks()}catch{return!1}return hn.supportedChains.http.includes(r)},async getSupportedNetworks(){try{const r=await Ie.get({path:"v1/supported-chains"});return hn.supportedChains=r,r}catch{return hn.supportedChains}},async fetchIdentity({address:r}){const e=Q.getIdentityFromCacheForAddress(r);if(e)return e;const t=await Ie.get({path:`/v1/identity/${r}`,params:{sender:$.state.activeCaipAddress?be.getPlainAddress($.state.activeCaipAddress):void 0}});return Q.updateIdentityCache({address:r,identity:t,timestamp:Date.now()}),t},async fetchTransactions({account:r,cursor:e,signal:t,cache:n,chainId:i}){if(!await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId))return{data:[],next:void 0};const o=Q.getTransactionsCacheForAddress({address:r,chainId:i});if(o)return o;const a=await Ie.get({path:`/v1/account/${r}/history`,params:{cursor:e,chainId:i},signal:t,cache:n});return Q.updateTransactionsCache({address:r,chainId:i,timestamp:Date.now(),transactions:a}),a},async fetchSwapQuote({amount:r,userAddress:e,from:t,to:n,gasPrice:i}){return await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId)?Ie.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:r,userAddress:e,from:t,to:n,gasPrice:i}}):{quotes:[]}},async fetchSwapTokens({chainId:r}){return await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId)?Ie.get({path:"/v1/convert/tokens",params:{chainId:r}}):{tokens:[]}},async fetchTokenPrice({addresses:r}){if(!await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId))return{fungibles:[]};const t=Q.getTokenPriceCacheForAddresses(r);if(t)return t;const n=await hn.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:r,projectId:Z.state.projectId},headers:{"Content-Type":"application/json"}});return Q.updateTokenPriceCache({addresses:r,timestamp:Date.now(),tokenPrice:n}),n},async fetchSwapAllowance({tokenAddress:r,userAddress:e}){return await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId)?Ie.get({path:"/v1/convert/allowance",params:{tokenAddress:r,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:r}){const{st:e,sv:t}=Ie.getSdkProperties();if(!await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Gas Price");return Ie.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:r,st:e,sv:t}})},async generateSwapCalldata({amount:r,from:e,to:t,userAddress:n,disableEstimate:i}){if(!await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return hn.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:r,eip155:{slippage:Ge.CONVERT_SLIPPAGE_TOLERANCE},projectId:Z.state.projectId,from:e,to:t,userAddress:n,disableEstimate:i}})},async generateApproveCalldata({from:r,to:e,userAddress:t}){const{st:n,sv:i}=Ie.getSdkProperties();if(!await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return Ie.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:t,from:r,to:e,st:n,sv:i}})},async getBalance(r,e,t){const{st:n,sv:i}=Ie.getSdkProperties();if(!await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId))return Xi.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${r}`,a=Q.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await Ie.get({path:`/v1/account/${r}/balance`,params:{currency:"usd",chainId:e,forceUpdate:t,st:n,sv:i}});return Q.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(r){return await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId)?Ie.get({path:`/v1/profile/account/${r}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:r}){return await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId)?Ie.get({path:`/v1/profile/reverse/${r}`,params:{sender:ye.state.address,apiVersion:"2"}}):[]},async getEnsNameSuggestions(r){return await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId)?Ie.get({path:`/v1/profile/suggestions/${r}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:r,address:e,message:t,signature:n}){return await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId)?hn.api.post({path:"/v1/profile/account",body:{coin_type:r,address:e,message:t,signature:n},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:r,partnerUserId:e,defaultNetwork:t,purchaseAmount:n,paymentAmount:i}){return await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId)?(await hn.api.post({path:"/v1/generators/onrampurl",params:{projectId:Z.state.projectId},body:{destinationWallets:r,defaultNetwork:t,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:n,presetFiatAmount:i}})).url:""},async getOnrampOptions(){if(!await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await Ie.get({path:"/v1/onramp/options"})}catch{return x3}},async getOnrampQuote({purchaseCurrency:r,paymentCurrency:e,amount:t,network:n}){try{return await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId)?await hn.api.post({path:"/v1/onramp/quote",params:{projectId:Z.state.projectId},body:{purchaseCurrency:r,paymentCurrency:e,amount:t,network:n}}):null}catch{return{networkFee:{amount:t,currency:e.id},paymentSubtotal:{amount:t,currency:e.id},paymentTotal:{amount:t,currency:e.id},purchaseAmount:{amount:t,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(r){return await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId)?Ie.get({path:`/v1/sessions/${r}`}):[]},async revokeSmartSession(r,e,t){return await Ie.isNetworkSupported($.state.activeCaipNetwork?.caipNetworkId)?hn.api.post({path:`/v1/sessions/${r}/revoke`,params:{projectId:Z.state.projectId},body:{pci:e,signature:t}}):{success:!1}},setClientId(r){hn.clientId=r,hn.api=new Xu({baseUrl:Mv,clientId:r})}};function v3(r,{strict:e=!0}={}){return!r||typeof r!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(r):r.startsWith("0x")}function Ab(r){return v3(r,{strict:!1})?Math.ceil((r.length-2)/2):r.length}const Uv="2.36.0";let o0={getDocsUrl:({docsBaseUrl:r,docsPath:e="",docsSlug:t})=>e?`${r??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${Uv}`},Mi=class Bp extends Error{constructor(e,t={}){const n=t.cause instanceof Bp?t.cause.details:t.cause?.message?t.cause.message:t.details,i=t.cause instanceof Bp&&t.cause.docsPath||t.docsPath,s=o0.getDocsUrl?.({...t,docsPath:i}),o=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...s?[`Docs: ${s}`]:[],...n?[`Details: ${n}`]:[],...o0.version?[`Version: ${o0.version}`]:[]].join(`
`);super(o,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=i,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=Uv}walk(e){return Bv(this,e)}};function Bv(r,e){return e?.(r)?r:r&&typeof r=="object"&&"cause"in r&&r.cause!==void 0?Bv(r.cause,e):e?null:r}class NK extends Mi{constructor({offset:e,position:t,size:n}){super(`Slice ${t==="start"?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${n}).`,{name:"SliceOffsetOutOfBoundsError"})}}let $v=class extends Mi{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}};function Qg(r,{dir:e,size:t=32}={}){return typeof r=="string"?E3(r,{dir:e,size:t}):A3(r,{dir:e,size:t})}function E3(r,{dir:e,size:t=32}={}){if(t===null)return r;const n=r.replace("0x","");if(n.length>t*2)throw new $v({size:Math.ceil(n.length/2),targetSize:t,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function A3(r,{dir:e,size:t=32}={}){if(t===null)return r;if(r.length>t)throw new $v({size:r.length,targetSize:t,type:"bytes"});const n=new Uint8Array(t);for(let i=0;i<t;i++){const s=e==="right";n[s?i:t-i-1]=r[s?i:r.length-i-1]}return n}let _3=class extends Mi{constructor({max:e,min:t,signed:n,size:i,value:s}){super(`Number "${s}" is not in safe ${i?`${i*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}},C3=class extends Mi{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function Lv(r,{size:e}){if(Ab(r)>e)throw new C3({givenSize:Ab(r),maxSize:e})}const S3=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function _b(r,e={}){return typeof r=="number"||typeof r=="bigint"?I3(r,e):typeof r=="string"?jv(r,e):typeof r=="boolean"?N3(r,e):Fv(r,e)}function N3(r,e={}){const t=`0x${Number(r)}`;return typeof e.size=="number"?(Lv(t,{size:e.size}),Qg(t,{size:e.size})):t}function Fv(r,e={}){let t="";for(let i=0;i<r.length;i++)t+=S3[r[i]];const n=`0x${t}`;return typeof e.size=="number"?(Lv(n,{size:e.size}),Qg(n,{dir:"right",size:e.size})):n}function I3(r,e={}){const{signed:t,size:n}=e,i=BigInt(r);let s;n?t?s=(1n<<BigInt(n)*8n-1n)-1n:s=2n**(BigInt(n)*8n)-1n:typeof r=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof s=="bigint"&&t?-s-1n:0;if(s&&i>s||i<o){const c=typeof r=="bigint"?"n":"";throw new _3({max:s?`${s}${c}`:void 0,min:`${o}${c}`,signed:t,size:n,value:`${r}${c}`})}const a=`0x${(t&&i<0?(1n<<BigInt(n*8))+BigInt(i):i).toString(16)}`;return n?Qg(a,{size:n}):a}const T3=new TextEncoder;function jv(r,e={}){const t=T3.encode(r);return Fv(t,e)}const vd=BigInt(2**32-1),Cb=BigInt(32);function P3(r,e=!1){return e?{h:Number(r&vd),l:Number(r>>Cb&vd)}:{h:Number(r>>Cb&vd)|0,l:Number(r&vd)|0}}function R3(r,e=!1){const t=r.length;let n=new Uint32Array(t),i=new Uint32Array(t);for(let s=0;s<t;s++){const{h:o,l:a}=P3(r[s],e);[n[s],i[s]]=[o,a]}return[n,i]}const O3=(r,e,t)=>r<<t|e>>>32-t,k3=(r,e,t)=>e<<t|r>>>32-t,D3=(r,e,t)=>e<<t-32|r>>>64-t,M3=(r,e,t)=>r<<t-32|e>>>64-t,qa=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function U3(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Af(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function kc(r,...e){if(!U3(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function RK(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Af(r.outputLen),Af(r.blockLen)}function Sb(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function B3(r,e){kc(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function $3(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function qv(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function OK(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function kK(r,e){return r<<32-e|r>>>e}const L3=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function F3(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}function j3(r){for(let e=0;e<r.length;e++)r[e]=F3(r[e]);return r}const Nb=L3?r=>r:j3,q3=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",H3=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function DK(r){if(kc(r),q3)return r.toHex();let e="";for(let t=0;t<r.length;t++)e+=H3[r[t]];return e}function W3(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function Hv(r){return typeof r=="string"&&(r=W3(r)),kc(r),r}function MK(...r){let e=0;for(let n=0;n<r.length;n++){const i=r[n];kc(i),e+=i.length}const t=new Uint8Array(e);for(let n=0,i=0;n<r.length;n++){const s=r[n];t.set(s,i),i+=s.length}return t}class z3{}function K3(r){const e=n=>r().update(Hv(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function UK(r=32){if(qa&&typeof qa.getRandomValues=="function")return qa.getRandomValues(new Uint8Array(r));if(qa&&typeof qa.randomBytes=="function")return Uint8Array.from(qa.randomBytes(r));throw new Error("crypto.getRandomValues must be defined")}const V3=BigInt(0),ol=BigInt(1),G3=BigInt(2),Y3=BigInt(7),J3=BigInt(256),Z3=BigInt(113),Wv=[],zv=[],Kv=[];for(let r=0,e=ol,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],Wv.push(2*(5*n+t)),zv.push((r+1)*(r+2)/2%64);let i=V3;for(let s=0;s<7;s++)e=(e<<ol^(e>>Y3)*Z3)%J3,e&G3&&(i^=ol<<(ol<<BigInt(s))-ol);Kv.push(i)}const Vv=R3(Kv,!0),X3=Vv[0],Q3=Vv[1],Ib=(r,e,t)=>t>32?D3(r,e,t):O3(r,e,t),Tb=(r,e,t)=>t>32?M3(r,e,t):k3(r,e,t);function e6(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],d=Ib(l,u,1)^t[a],p=Tb(l,u,1)^t[a+1];for(let x=0;x<50;x+=10)r[o+x]^=d,r[o+x+1]^=p}let i=r[2],s=r[3];for(let o=0;o<24;o++){const a=zv[o],c=Ib(i,s,a),l=Tb(i,s,a),u=Wv[o];i=r[u],s=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=X3[n],r[1]^=Q3[n]}qv(t)}class em extends z3{constructor(e,t,n,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=i,this.rounds=s,Af(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=$3(this.state)}clone(){return this._cloneInto()}keccak(){Nb(this.state32),e6(this.state32,this.rounds),Nb(this.state32),this.posOut=0,this.pos=0}update(e){Sb(this),e=Hv(e),kc(e);const{blockLen:t,state:n}=this,i=e.length;for(let s=0;s<i;){const o=Math.min(t-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:i}=this;e[n]^=t,(t&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){Sb(this,!1),kc(e),this.finish();const t=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Af(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(B3(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,qv(this.state)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new em(t,n,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}const t6=(r,e,t)=>K3(()=>new em(e,r,t)),r6=t6(1,136,256/8);let n6=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}};const ua=(r,e,t)=>JSON.stringify(r,(n,i)=>typeof i=="bigint"?i.toString():i,t);function i6(r,e){let t=r.toString();const n=t.startsWith("-");n&&(t=t.slice(1)),t=t.padStart(e,"0");let[i,s]=[t.slice(0,t.length-e),t.slice(t.length-e)];return s=s.replace(/(0+)$/,""),`${n?"-":""}${i||"0"}${s?`.${s}`:""}`}const tm=r=>r;class Rl extends Mi{constructor({body:e,cause:t,details:n,headers:i,status:s,url:o}){super("HTTP request failed.",{cause:t,details:n,metaMessages:[s&&`Status: ${s}`,`URL: ${tm(o)}`,e&&`Request body: ${ua(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=i,this.status=s,this.url=o}}class Gv extends Mi{constructor({body:e,error:t,url:n}){super("RPC Request failed.",{cause:t,details:t.message,metaMessages:[`URL: ${tm(n)}`,`Request body: ${ua(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=t.code,this.data=t.data}}class Pb extends Mi{constructor({body:e,url:t}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${tm(t)}`,`Request body: ${ua(e)}`],name:"TimeoutError"})}}const s6=-1;class Tn extends Mi{constructor(e,{code:t,docsPath:n,metaMessages:i,name:s,shortMessage:o}){super(o,{cause:e,docsPath:n,metaMessages:i||e?.metaMessages,name:s||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=s||e.name,this.code=e instanceof Gv?e.code:t??s6}}class zn extends Tn{constructor(e,t){super(e,t),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t.data}}class eu extends Tn{constructor(e){super(e,{code:eu.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(eu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class tu extends Tn{constructor(e){super(e,{code:tu.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(tu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class ru extends Tn{constructor(e,{method:t}={}){super(e,{code:ru.code,name:"MethodNotFoundRpcError",shortMessage:`The method${t?` "${t}"`:""} does not exist / is not available.`})}}Object.defineProperty(ru,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class nu extends Tn{constructor(e){super(e,{code:nu.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(nu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class Dc extends Tn{constructor(e){super(e,{code:Dc.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(Dc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class iu extends Tn{constructor(e){super(e,{code:iu.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(iu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class su extends Tn{constructor(e){super(e,{code:su.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(su,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class ou extends Tn{constructor(e){super(e,{code:ou.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(ou,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class Mc extends Tn{constructor(e){super(e,{code:Mc.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(Mc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class na extends Tn{constructor(e,{method:t}={}){super(e,{code:na.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${t?` "${t}"`:""} is not supported.`})}}Object.defineProperty(na,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class Uc extends Tn{constructor(e){super(e,{code:Uc.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(Uc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class au extends Tn{constructor(e){super(e,{code:au.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(au,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class da extends zn{constructor(e){super(e,{code:da.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(da,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class cu extends zn{constructor(e){super(e,{code:cu.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(cu,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class lu extends zn{constructor(e,{method:t}={}){super(e,{code:lu.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${t?` " ${t}"`:""}.`})}}Object.defineProperty(lu,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class uu extends zn{constructor(e){super(e,{code:uu.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(uu,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class du extends zn{constructor(e){super(e,{code:du.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(du,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class fu extends zn{constructor(e){super(e,{code:fu.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(fu,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class hu extends zn{constructor(e){super(e,{code:hu.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(hu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class pu extends zn{constructor(e){super(e,{code:pu.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(pu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class gu extends zn{constructor(e){super(e,{code:gu.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(gu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class mu extends zn{constructor(e){super(e,{code:mu.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(mu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class bu extends zn{constructor(e){super(e,{code:bu.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(bu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class yu extends zn{constructor(e){super(e,{code:yu.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(yu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class wu extends zn{constructor(e){super(e,{code:wu.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(wu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class o6 extends Tn{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}const a6="modulepreload",c6=function(r){return"/build/"+r},Rb={},Nr=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){let c=function(l){return Promise.all(l.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");i=c(t.map(l=>{if(l=c6(l),l in Rb)return;Rb[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":a6,u||(p.as="script"),p.crossOrigin="",p.href=l,a&&p.setAttribute("nonce",a),document.head.appendChild(p),u)return new Promise((x,w)=>{p.addEventListener("load",x),p.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};class rm extends Mi{constructor({cause:e,message:t}={}){const n=t?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${n?`with reason: ${n}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(rm,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(rm,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});function l6(){let r=()=>{},e=()=>{};return{promise:new Promise((n,i)=>{r=n,e=i}),resolve:r,reject:e}}const a0=new Map;function u6({fn:r,id:e,shouldSplitBatch:t,wait:n=0,sort:i}){const s=async()=>{const u=c();o();const d=u.map(({args:p})=>p);d.length!==0&&r(d).then(p=>{i&&Array.isArray(p)&&p.sort(i);for(let x=0;x<u.length;x++){const{resolve:w}=u[x];w?.([p[x],p])}}).catch(p=>{for(let x=0;x<u.length;x++){const{reject:w}=u[x];w?.(p)}})},o=()=>a0.delete(e),a=()=>c().map(({args:u})=>u),c=()=>a0.get(e)||[],l=u=>a0.set(e,[...c(),u]);return{flush:o,async schedule(u){const{promise:d,resolve:p,reject:x}=l6();return t?.([...a(),u])&&s(),c().length>0?(l({args:u,resolve:p,reject:x}),d):(l({args:u,resolve:p,reject:x}),setTimeout(s,n),d)}}}async function Yv(r){return new Promise(e=>setTimeout(e,r))}function d6(r,{delay:e=100,retryCount:t=2,shouldRetry:n=()=>!0}={}){return new Promise((i,s)=>{const o=async({count:a=0}={})=>{const c=async({error:l})=>{const u=typeof e=="function"?e({count:a,error:l}):e;u&&await Yv(u),o({count:a+1})};try{const l=await r();i(l)}catch(l){if(a<t&&await n({count:a,error:l}))return c({error:l});s(l)}};o()})}const $p=256;let Ed=$p,Ad;function f6(r=11){if(!Ad||Ed+r>$p*2){Ad="",Ed=0;for(let e=0;e<$p;e++)Ad+=(256+Math.random()*256|0).toString(16).substring(1)}return Ad.substring(Ed,Ed+++r)}const _d=new n6(8192);function h6(r,{enabled:e=!0,id:t}){if(!e||!t)return r();if(_d.get(t))return _d.get(t);const n=r().finally(()=>_d.delete(t));return _d.set(t,n),n}function p6(r,e={}){return async(t,n={})=>{const{dedupe:i=!1,methods:s,retryDelay:o=150,retryCount:a=3,uid:c}={...e,...n},{method:l}=t;if(s?.exclude?.includes(l))throw new na(new Error("method not supported"),{method:l});if(s?.include&&!s.include.includes(l))throw new na(new Error("method not supported"),{method:l});const u=i?jv(`${c}.${ua(t)}`):void 0;return h6(()=>d6(async()=>{try{return await r(t)}catch(d){const p=d;switch(p.code){case eu.code:throw new eu(p);case tu.code:throw new tu(p);case ru.code:throw new ru(p,{method:t.method});case nu.code:throw new nu(p);case Dc.code:throw new Dc(p);case iu.code:throw new iu(p);case su.code:throw new su(p);case ou.code:throw new ou(p);case Mc.code:throw new Mc(p);case na.code:throw new na(p,{method:t.method});case Uc.code:throw new Uc(p);case au.code:throw new au(p);case da.code:throw new da(p);case cu.code:throw new cu(p);case lu.code:throw new lu(p);case uu.code:throw new uu(p);case du.code:throw new du(p);case fu.code:throw new fu(p);case hu.code:throw new hu(p);case pu.code:throw new pu(p);case gu.code:throw new gu(p);case mu.code:throw new mu(p);case bu.code:throw new bu(p);case yu.code:throw new yu(p);case wu.code:throw new wu(p);case 5e3:throw new da(p);default:throw d instanceof Mi?d:new o6(p)}}},{delay:({count:d,error:p})=>{if(p&&p instanceof Rl){const x=p?.headers?.get("Retry-After");if(x?.match(/\d/))return Number.parseInt(x,10)*1e3}return~~(1<<d)*o},retryCount:a,shouldRetry:({error:d})=>g6(d)}),{enabled:i,id:u})}}function g6(r){return"code"in r&&typeof r.code=="number"?r.code===-1||r.code===Uc.code||r.code===Dc.code:r instanceof Rl&&r.status?r.status===403||r.status===408||r.status===413||r.status===429||r.status===500||r.status===502||r.status===503||r.status===504:!0}function nm(r){return{formatters:void 0,fees:void 0,serializers:void 0,...r}}function m6(r,{errorInstance:e=new Error("timed out"),timeout:t,signal:n}){return new Promise((i,s)=>{(async()=>{let o;try{const a=new AbortController;t>0&&(o=setTimeout(()=>{n&&a.abort()},t)),i(await r({signal:a?.signal||null}))}catch(a){a?.name==="AbortError"&&s(e),s(a)}finally{clearTimeout(o)}})()})}function b6(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const Ob=b6();function y6(r,e={}){return{async request(t){const{body:n,onRequest:i=e.onRequest,onResponse:s=e.onResponse,timeout:o=e.timeout??1e4}=t,a={...e.fetchOptions??{},...t.fetchOptions??{}},{headers:c,method:l,signal:u}=a;try{const d=await m6(async({signal:x})=>{const w={...a,body:Array.isArray(n)?ua(n.map(T=>({jsonrpc:"2.0",id:T.id??Ob.take(),...T}))):ua({jsonrpc:"2.0",id:n.id??Ob.take(),...n}),headers:{"Content-Type":"application/json",...c},method:l||"POST",signal:u||(o>0?x:null)},b=new Request(r,w),y=await i?.(b,w)??{...w,url:r};return await fetch(y.url??r,y)},{errorInstance:new Pb({body:n,url:r}),timeout:o,signal:!0});s&&await s(d);let p;if(d.headers.get("Content-Type")?.startsWith("application/json"))p=await d.json();else{p=await d.text();try{p=JSON.parse(p||"{}")}catch(x){if(d.ok)throw x;p={error:p}}}if(!d.ok)throw new Rl({body:n,details:ua(p.error)||d.statusText,headers:d.headers,status:d.status,url:r});return p}catch(d){throw d instanceof Rl||d instanceof Pb?d:new Rl({body:n,cause:d,url:r})}}}}function Jv({key:r,methods:e,name:t,request:n,retryCount:i=3,retryDelay:s=150,timeout:o,type:a},c){const l=f6();return{config:{key:r,methods:e,name:t,request:n,retryCount:i,retryDelay:s,timeout:o,type:a},request:p6(n,{methods:e,retryCount:i,retryDelay:s,uid:l}),value:c}}function kb(r,e={}){const{key:t="fallback",name:n="Fallback",rank:i=!1,shouldThrow:s=w6,retryCount:o,retryDelay:a}=e;return(({chain:c,pollingInterval:l=4e3,timeout:u,...d})=>{let p=r,x=()=>{};const w=Jv({key:t,name:n,async request({method:b,params:y}){let C;const T=async(I=0)=>{const k=p[I]({...d,chain:c,retryCount:0,timeout:u});try{const P=await k.request({method:b,params:y});return x({method:b,params:y,response:P,transport:k,status:"success"}),P}catch(P){if(x({error:P,method:b,params:y,transport:k,status:"error"}),s(P)||I===p.length-1||(C??=p.slice(I+1).some(O=>{const{include:q,exclude:F}=O({chain:c}).config.methods||{};return q?q.includes(b):F?!F.includes(b):!0}),!C))throw P;return T(I+1)}};return T()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:b=>x=b,transports:p.map(b=>b({chain:c,retryCount:0}))});if(i){const b=typeof i=="object"?i:{};x6({chain:c,interval:b.interval??l,onTransports:y=>p=y,ping:b.ping,sampleCount:b.sampleCount,timeout:b.timeout,transports:p,weights:b.weights})}return w})}function w6(r){return!!("code"in r&&typeof r.code=="number"&&(r.code===Mc.code||r.code===da.code||rm.nodeMessage.test(r.message)||r.code===5e3))}function x6({chain:r,interval:e=4e3,onTransports:t,ping:n,sampleCount:i=10,timeout:s=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:l=.3}=a,u=[],d=async()=>{const p=await Promise.all(o.map(async b=>{const y=b({chain:r,retryCount:0,timeout:s}),C=Date.now();let T,I;try{await(n?n({transport:y}):y.request({method:"net_listening"})),I=1}catch{I=0}finally{T=Date.now()}return{latency:T-C,success:I}}));u.push(p),u.length>i&&u.shift();const x=Math.max(...u.map(b=>Math.max(...b.map(({latency:y})=>y)))),w=o.map((b,y)=>{const C=u.map(O=>O[y].latency),I=1-C.reduce((O,q)=>O+q,0)/C.length/x,k=u.map(O=>O[y].success),P=k.reduce((O,q)=>O+q,0)/k.length;return P===0?[0,y]:[l*I+c*P,y]}).sort((b,y)=>y[0]-b[0]);t(w.map(([,b])=>o[b])),await Yv(e),d()};d()}class v6 extends Mi{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function Cd(r,e={}){const{batch:t,fetchOptions:n,key:i="http",methods:s,name:o="HTTP JSON-RPC",onFetchRequest:a,onFetchResponse:c,retryDelay:l,raw:u}=e;return({chain:d,retryCount:p,timeout:x})=>{const{batchSize:w=1e3,wait:b=0}=typeof t=="object"?t:{},y=e.retryCount??p,C=x??e.timeout??1e4,T=r||d?.rpcUrls.default.http[0];if(!T)throw new v6;const I=y6(T,{fetchOptions:n,onRequest:a,onResponse:c,timeout:C});return Jv({key:i,methods:s,name:o,async request({method:k,params:P}){const O={method:k,params:P},{schedule:q}=u6({id:T,wait:b,shouldSplitBatch(j){return j.length>w},fn:j=>I.request({body:j}),sort:(j,U)=>j.id-U.id}),F=async j=>t?q(j):[await I.request({body:j})],[{error:B,result:W}]=await F(O);if(u)return{error:B,result:W};if(B)throw new Gv({body:O,error:B,url:T});return W},retryCount:y,retryDelay:l,timeout:C,type:"http"},{fetchOptions:n,url:T})}}const c0={createBalance(r,e){const t={name:r.metadata.name||"",symbol:r.metadata.symbol||"",decimals:r.metadata.decimals||0,value:r.metadata.value||0,price:r.metadata.price||0,iconUrl:r.metadata.iconUrl||""};return{name:t.name,symbol:t.symbol,chainId:e,address:r.address==="native"?void 0:this.convertAddressToCAIP10Address(r.address,e),value:t.value,price:t.price,quantity:{decimals:t.decimals.toString(),numeric:this.convertHexToBalance({hex:r.balance,decimals:t.decimals})},iconUrl:t.iconUrl}},convertHexToBalance({hex:r,decimals:e}){return i6(BigInt(r),e)},convertAddressToCAIP10Address(r,e){return`${e}:${r}`},createCAIP2ChainId(r,e){return`${e}:${parseInt(r,16)}`},getChainIdHexFromCAIP2ChainId(r){const e=r.split(":");if(e.length<2||!e[1])return"0x0";const t=e[1],n=parseInt(t,10);return isNaN(n)?"0x0":`0x${n.toString(16)}`},isWalletGetAssetsResponse(r){return typeof r!="object"||r===null?!1:Object.values(r).every(e=>Array.isArray(e)&&e.every(t=>this.isValidAsset(t)))},isValidAsset(r){return typeof r=="object"&&r!==null&&typeof r.address=="string"&&typeof r.balance=="string"&&(r.type==="ERC20"||r.type==="NATIVE")&&typeof r.metadata=="object"&&r.metadata!==null&&typeof r.metadata.name=="string"&&typeof r.metadata.symbol=="string"&&typeof r.metadata.decimals=="number"&&typeof r.metadata.price=="number"&&typeof r.metadata.iconUrl=="string"}},im={async getMyTokensWithBalance(r){const e=ye.state.address,t=$.state.activeCaipNetwork,n=ae.getConnectorId("eip155")===Y.CONNECTOR_ID.AUTH;if(!e||!t)return[];const i=`${t.caipNetworkId}:${e}`,s=Q.getBalanceCacheForCaipAddress(i);if(s)return s.balances;if(t.chainNamespace===Y.CHAIN.EVM&&n){const a=await this.getEIP155Balances(e,t);if(a)return this.filterLowQualityTokens(a)}const o=await Ie.getBalance(e,t.caipNetworkId,r);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(r,e){try{const t=c0.getChainIdHexFromCAIP2ChainId(e.caipNetworkId);if(!(await de.getCapabilities(r))?.[t]?.assetDiscovery?.supported)return null;const i=await de.walletGetAssets({account:r,chainFilter:[t]});if(!c0.isWalletGetAssetsResponse(i))return null;const o=(i[t]||[]).map(a=>c0.createBalance(a,e.caipNetworkId));return Q.updateBalanceCache({caipAddress:`${e.caipNetworkId}:${r}`,balance:{balances:o},timestamp:Date.now()}),o}catch{return null}},filterLowQualityTokens(r){return r.filter(e=>e.quantity.decimals!=="0")}},Bi=It({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map}),E6={state:Bi,replaceState(r){r&&Object.assign(Bi,ma(r))},subscribe(r){return $.subscribeChainProp("accountState",e=>{if(e)return r(e)})},subscribeKey(r,e,t){let n;return $.subscribeChainProp("accountState",i=>{if(i){const s=i[r];n!==s&&(n=s,e(s))}},t)},setStatus(r,e){$.setAccountProp("status",r,e)},getCaipAddress(r){if(r)return $.state.chains.get(r)?.accountState?.caipAddress},setCaipAddress(r,e){const t=r?be.getPlainAddress(r):void 0;e===$.state.activeChain&&($.state.activeCaipAddress=r),$.setAccountProp("caipAddress",r,e),$.setAccountProp("address",t,e)},setBalance(r,e,t){$.setAccountProp("balance",r,t),$.setAccountProp("balanceSymbol",e,t)},setProfileName(r,e){$.setAccountProp("profileName",r,e)},setProfileImage(r,e){$.setAccountProp("profileImage",r,e)},setUser(r,e){$.setAccountProp("user",r,e)},setAddressExplorerUrl(r,e){$.setAccountProp("addressExplorerUrl",r,e)},setSmartAccountDeployed(r,e){$.setAccountProp("smartAccountDeployed",r,e)},setCurrentTab(r){$.setAccountProp("currentTab",r,$.state.activeChain)},setTokenBalance(r,e){r&&$.setAccountProp("tokenBalance",r,e)},setShouldUpdateToAddress(r,e){$.setAccountProp("shouldUpdateToAddress",r,e)},addAddressLabel(r,e,t){if(!t)return;const n=$.state.chains.get(t)?.accountState?.addressLabels||new Map;n.set(r,e),$.setAccountProp("addressLabels",n,t)},removeAddressLabel(r,e){if(!e)return;const t=$.state.chains.get(e)?.accountState?.addressLabels||new Map;t.delete(r),$.setAccountProp("addressLabels",t,e)},setConnectedWalletInfo(r,e){$.setAccountProp("connectedWalletInfo",r,e,!1)},setPreferredAccountType(r,e){$.setAccountProp("preferredAccountType",r,e)},setSocialProvider(r,e){r&&$.setAccountProp("socialProvider",r,e)},setSocialWindow(r,e){$.setAccountProp("socialWindow",r?ma(r):void 0,e)},setFarcasterUrl(r,e){$.setAccountProp("farcasterUrl",r,e)},async fetchTokenBalance(r){Bi.balanceLoading=!0;const e=$.state.activeCaipNetwork?.caipNetworkId,t=$.state.activeCaipNetwork?.chainNamespace,n=$.state.activeCaipAddress,i=n?be.getPlainAddress(n):void 0;if(Bi.lastRetry&&!be.isAllowedRetry(Bi.lastRetry,30*Ge.ONE_SEC_MS))return Bi.balanceLoading=!1,[];try{if(i&&e&&t){const s=await im.getMyTokensWithBalance();return ye.setTokenBalance(s,t),Bi.lastRetry=void 0,Bi.balanceLoading=!1,s}}catch(s){Bi.lastRetry=Date.now(),r?.(s),Xi.showError("Token Balance Unavailable")}finally{Bi.balanceLoading=!1}return[]},resetAccount(r){$.resetAccount(r)}},ye=Wn(E6),A6={onSwitchNetwork({network:r,ignoreSwitchConfirmation:e=!1}){const t=$.state.activeCaipNetwork,n=Te.state.data;if(r.id===t?.id)return;const s=ye.getCaipAddress($.state.activeChain),o=r.chainNamespace!==$.state.activeChain,a=ye.getCaipAddress(r.chainNamespace),l=ae.getConnectorId($.state.activeChain)===Y.CONNECTOR_ID.AUTH,u=Y.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(d=>d===r.chainNamespace);e||l&&u?Te.push("SwitchNetwork",{...n,network:r}):s&&o&&!a?Te.push("SwitchActiveChain",{switchToChain:r.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:r}):Te.push("SwitchNetwork",{...n,network:r})}},pn=It({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),_6={state:pn,subscribe(r){return Lr(pn,()=>r(pn))},subscribeKey(r,e){return en(pn,r,e)},async open(r){const e=r?.namespace,t=$.state.activeChain,n=e&&e!==t,i=$.getAccountData(r?.namespace)?.caipAddress,s=$.state.noAdapters;if(de.state.wcBasic?_e.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await _e.prefetch(),ae.setFilterByNamespace(r?.namespace),He.setLoading(!0,e),e&&n){const o=$.getNetworkData(e)?.caipNetwork||$.getRequestedCaipNetworks(e)[0];o&&(s?(await $.switchActiveNetwork(o),Te.push("ConnectingWalletConnectBasic")):A6.onSwitchNetwork({network:o,ignoreSwitchConfirmation:!0}))}else Z.state.manualWCControl||s&&!i?be.isMobile()?Te.reset("AllWallets"):Te.reset("ConnectingWalletConnectBasic"):r?.view?Te.reset(r.view,r.data):i?Te.reset("Account"):Te.reset("Connect");pn.open=!0,Ni.set({open:!0}),Qe.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!i}})},close(){const r=Z.state.enableEmbedded,e=!!$.state.activeCaipAddress;pn.open&&Qe.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:e}}),pn.open=!1,Te.reset("Connect"),He.clearLoading(),r?e?Te.replace("Account"):Te.push("Connect"):Ni.set({open:!1}),de.resetUri()},setLoading(r,e){e&&pn.loadingNamespaceMap.set(e,r),pn.loading=r,Ni.set({loading:r})},clearLoading(){pn.loadingNamespaceMap.clear(),pn.loading=!1,Ni.set({loading:!1})},shake(){pn.shake||(pn.shake=!0,setTimeout(()=>{pn.shake=!1},500))}},He=Wn(_6),Ol={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},Lp={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},C6={providers:Rv,selectedProvider:null,error:null,purchaseCurrency:Ol,paymentCurrency:Lp,purchaseCurrencies:[Ol],paymentCurrencies:[],quotesLoading:!1},Xe=It(C6),S6={state:Xe,subscribe(r){return Lr(Xe,()=>r(Xe))},subscribeKey(r,e){return en(Xe,r,e)},setSelectedProvider(r){if(r&&r.name==="meld"){const e=$.state.activeChain,t=e===Y.CHAIN.SOLANA?"SOL":"USDC",n=e?$.state.chains.get(e)?.accountState?.address??"":"",i=new URL(r.url);i.searchParams.append("publicKey",HC),i.searchParams.append("destinationCurrencyCode",t),i.searchParams.append("walletAddress",n),i.searchParams.append("externalCustomerId",Z.state.projectId),Xe.selectedProvider={...r,url:i.toString()}}else Xe.selectedProvider=r},setOnrampProviders(r){if(Array.isArray(r)&&r.every(e=>typeof e=="string")){const e=r,t=Rv.filter(n=>e.includes(n.name));Xe.providers=t}else Xe.providers=[]},setPurchaseCurrency(r){Xe.purchaseCurrency=r},setPaymentCurrency(r){Xe.paymentCurrency=r},setPurchaseAmount(r){Fp.state.purchaseAmount=r},setPaymentAmount(r){Fp.state.paymentAmount=r},async getAvailableCurrencies(){const r=await Ie.getOnrampOptions();Xe.purchaseCurrencies=r.purchaseCurrencies,Xe.paymentCurrencies=r.paymentCurrencies,Xe.paymentCurrency=r.paymentCurrencies[0]||Lp,Xe.purchaseCurrency=r.purchaseCurrencies[0]||Ol,await _e.fetchCurrencyImages(r.paymentCurrencies.map(e=>e.id)),await _e.fetchTokenImages(r.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){Xe.quotesLoading=!0;try{const r=await Ie.getOnrampQuote({purchaseCurrency:Xe.purchaseCurrency,paymentCurrency:Xe.paymentCurrency,amount:Xe.paymentAmount?.toString()||"0",network:Xe.purchaseCurrency?.symbol});return Xe.quotesLoading=!1,Xe.purchaseAmount=Number(r?.purchaseAmount.amount),r}catch(r){return Xe.error=r.message,Xe.quotesLoading=!1,null}finally{Xe.quotesLoading=!1}},resetState(){Xe.selectedProvider=null,Xe.error=null,Xe.purchaseCurrency=Ol,Xe.paymentCurrency=Lp,Xe.purchaseCurrencies=[Ol],Xe.paymentCurrencies=[],Xe.paymentAmount=void 0,Xe.purchaseAmount=void 0,Xe.quotesLoading=!1}},Fp=Wn(S6),Db=2147483648,N6={convertEVMChainIdToCoinType(r){if(r>=Db)throw new Error("Invalid chainId");return(Db|r)>>>0}},Vn=It({suggestions:[],loading:!1}),I6={state:Vn,subscribe(r){return Lr(Vn,()=>r(Vn))},subscribeKey(r,e){return en(Vn,r,e)},async resolveName(r){try{return await Ie.lookupEnsName(r)}catch(e){const t=e;throw new Error(t?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(r){try{return await Ie.lookupEnsName(r),!0}catch{return!1}},async getSuggestions(r){try{Vn.loading=!0,Vn.suggestions=[];const e=await Ie.getEnsNameSuggestions(r);return Vn.suggestions=e.suggestions||[],Vn.suggestions}catch(e){const t=kl.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(t)}finally{Vn.loading=!1}},async getNamesForAddress(r){try{if(!$.state.activeCaipNetwork)return[];const t=Q.getEnsFromCacheForAddress(r);if(t)return t;const n=await Ie.reverseLookupEnsName({address:r});return Q.updateEnsCache({address:r,ens:n,timestamp:Date.now()}),n}catch(e){const t=kl.parseEnsApiError(e,"Error fetching names for address");throw new Error(t)}},async registerName(r){const e=$.state.activeCaipNetwork,t=ye.state.address,n=ae.getAuthConnector();if(!e)throw new Error("Network not found");if(!t||!n)throw new Error("Address or auth connector not found");Vn.loading=!0;try{const i=JSON.stringify({name:r,attributes:{},timestamp:Math.floor(Date.now()/1e3)});Te.pushTransactionStack({onCancel(){Te.replace("RegisterAccountName")}});const s=await de.signMessage(i);Vn.loading=!1;const o=e.id;if(!o)throw new Error("Network not found");const a=N6.convertEVMChainIdToCoinType(Number(o));await Ie.registerEnsName({coinType:a,address:t,signature:s,message:i}),ye.setProfileName(r,e.chainNamespace),Q.updateEnsCache({address:t,ens:[{name:r,registered_at:new Date().toISOString(),updated_at:void 0,addresses:{},attributes:[]}],timestamp:Date.now()}),Te.replace("RegisterAccountNameSuccess")}catch(i){const s=kl.parseEnsApiError(i,`Error registering name ${r}`);throw Te.replace("RegisterAccountName"),new Error(s)}finally{Vn.loading=!1}},validateName(r){return/^[a-zA-Z0-9-]{4,}$/u.test(r)},parseEnsApiError(r,e){return r?.reasons?.[0]?.description||e}},kl=Wn(I6);var Sd={exports:{}},Mb;function T6(){if(Mb)return Sd.exports;Mb=1;var r=typeof Reflect=="object"?Reflect:null,e=r&&typeof r.apply=="function"?r.apply:function(P,O,q){return Function.prototype.apply.call(P,O,q)},t;r&&typeof r.ownKeys=="function"?t=r.ownKeys:Object.getOwnPropertySymbols?t=function(P){return Object.getOwnPropertyNames(P).concat(Object.getOwnPropertySymbols(P))}:t=function(P){return Object.getOwnPropertyNames(P)};function n(k){console&&console.warn&&console.warn(k)}var i=Number.isNaN||function(P){return P!==P};function s(){s.init.call(this)}Sd.exports=s,Sd.exports.once=C,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(k){if(typeof k!="number"||k<0||i(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");o=k}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(P){if(typeof P!="number"||P<0||i(P))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+P+".");return this._maxListeners=P,this};function c(k){return k._maxListeners===void 0?s.defaultMaxListeners:k._maxListeners}s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(P){for(var O=[],q=1;q<arguments.length;q++)O.push(arguments[q]);var F=P==="error",B=this._events;if(B!==void 0)F=F&&B.error===void 0;else if(!F)return!1;if(F){var W;if(O.length>0&&(W=O[0]),W instanceof Error)throw W;var j=new Error("Unhandled error."+(W?" ("+W.message+")":""));throw j.context=W,j}var U=B[P];if(U===void 0)return!1;if(typeof U=="function")e(U,this,O);else for(var _=U.length,f=w(U,_),q=0;q<_;++q)e(f[q],this,O);return!0};function l(k,P,O,q){var F,B,W;if(a(O),B=k._events,B===void 0?(B=k._events=Object.create(null),k._eventsCount=0):(B.newListener!==void 0&&(k.emit("newListener",P,O.listener?O.listener:O),B=k._events),W=B[P]),W===void 0)W=B[P]=O,++k._eventsCount;else if(typeof W=="function"?W=B[P]=q?[O,W]:[W,O]:q?W.unshift(O):W.push(O),F=c(k),F>0&&W.length>F&&!W.warned){W.warned=!0;var j=new Error("Possible EventEmitter memory leak detected. "+W.length+" "+String(P)+" listeners added. Use emitter.setMaxListeners() to increase limit");j.name="MaxListenersExceededWarning",j.emitter=k,j.type=P,j.count=W.length,n(j)}return k}s.prototype.addListener=function(P,O){return l(this,P,O,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(P,O){return l(this,P,O,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(k,P,O){var q={fired:!1,wrapFn:void 0,target:k,type:P,listener:O},F=u.bind(q);return F.listener=O,q.wrapFn=F,F}s.prototype.once=function(P,O){return a(O),this.on(P,d(this,P,O)),this},s.prototype.prependOnceListener=function(P,O){return a(O),this.prependListener(P,d(this,P,O)),this},s.prototype.removeListener=function(P,O){var q,F,B,W,j;if(a(O),F=this._events,F===void 0)return this;if(q=F[P],q===void 0)return this;if(q===O||q.listener===O)--this._eventsCount===0?this._events=Object.create(null):(delete F[P],F.removeListener&&this.emit("removeListener",P,q.listener||O));else if(typeof q!="function"){for(B=-1,W=q.length-1;W>=0;W--)if(q[W]===O||q[W].listener===O){j=q[W].listener,B=W;break}if(B<0)return this;B===0?q.shift():b(q,B),q.length===1&&(F[P]=q[0]),F.removeListener!==void 0&&this.emit("removeListener",P,j||O)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(P){var O,q,F;if(q=this._events,q===void 0)return this;if(q.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):q[P]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete q[P]),this;if(arguments.length===0){var B=Object.keys(q),W;for(F=0;F<B.length;++F)W=B[F],W!=="removeListener"&&this.removeAllListeners(W);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(O=q[P],typeof O=="function")this.removeListener(P,O);else if(O!==void 0)for(F=O.length-1;F>=0;F--)this.removeListener(P,O[F]);return this};function p(k,P,O){var q=k._events;if(q===void 0)return[];var F=q[P];return F===void 0?[]:typeof F=="function"?O?[F.listener||F]:[F]:O?y(F):w(F,F.length)}s.prototype.listeners=function(P){return p(this,P,!0)},s.prototype.rawListeners=function(P){return p(this,P,!1)},s.listenerCount=function(k,P){return typeof k.listenerCount=="function"?k.listenerCount(P):x.call(k,P)},s.prototype.listenerCount=x;function x(k){var P=this._events;if(P!==void 0){var O=P[k];if(typeof O=="function")return 1;if(O!==void 0)return O.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function w(k,P){for(var O=new Array(P),q=0;q<P;++q)O[q]=k[q];return O}function b(k,P){for(;P+1<k.length;P++)k[P]=k[P+1];k.pop()}function y(k){for(var P=new Array(k.length),O=0;O<P.length;++O)P[O]=k[O].listener||k[O];return P}function C(k,P){return new Promise(function(O,q){function F(W){k.removeListener(P,B),q(W)}function B(){typeof k.removeListener=="function"&&k.removeListener("error",F),O([].slice.call(arguments))}I(k,P,B,{once:!0}),P!=="error"&&T(k,F,{once:!0})})}function T(k,P,O){typeof k.on=="function"&&I(k,"error",P,O)}function I(k,P,O,q){if(typeof k.on=="function")q.once?k.once(P,O):k.on(P,O);else if(typeof k.addEventListener=="function")k.addEventListener(P,function F(B){q.once&&k.removeEventListener(P,F),O(B)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k)}return Sd.exports}var ci=T6();const sm=qs(ci);var l0={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var jp=function(r,e){return jp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])},jp(r,e)};function P6(r,e){jp(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var qp=function(){return qp=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},qp.apply(this,arguments)};function R6(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function O6(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}function k6(r,e){return function(t,n){e(t,n,r)}}function D6(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function M6(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}function U6(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(s=l[0]&2?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){t.label=l[1];break}if(l[0]===6&&t.label<s[1]){t.label=s[1],s=l;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(l);break}s[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(u){l=[6,u],i=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function B6(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function $6(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function Hp(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Zv(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return s}function L6(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Zv(arguments[e]));return r}function F6(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function xu(r){return this instanceof xu?(this.v=r,this):new xu(r)}function j6(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(p){n[p]&&(i[p]=function(x){return new Promise(function(w,b){s.push([p,x,w,b])>1||a(p,x)})})}function a(p,x){try{c(n[p](x))}catch(w){d(s[0][3],w)}}function c(p){p.value instanceof xu?Promise.resolve(p.value.v).then(l,u):d(s[0][2],p)}function l(p){a("next",p)}function u(p){a("throw",p)}function d(p,x){p(x),s.shift(),s.length&&a(s[0][0],s[0][1])}}function q6(r){var e,t;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=r[i]?function(o){return(t=!t)?{value:xu(r[i](o)),done:i==="return"}:s?s(o):o}:s}}function H6(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Hp=="function"?Hp(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=r[s]&&function(o){return new Promise(function(a,c){o=r[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}function W6(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function z6(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function K6(r){return r&&r.__esModule?r:{default:r}}function V6(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function G6(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const Y6=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return qp},__asyncDelegator:q6,__asyncGenerator:j6,__asyncValues:H6,__await:xu,__awaiter:M6,__classPrivateFieldGet:V6,__classPrivateFieldSet:G6,__createBinding:B6,__decorate:O6,__exportStar:$6,__extends:P6,__generator:U6,__importDefault:K6,__importStar:z6,__makeTemplateObject:W6,__metadata:D6,__param:k6,__read:Zv,__rest:R6,__spread:L6,__spreadArrays:F6,__values:Hp},Symbol.toStringTag,{value:"Module"})),Qu=nr(Y6);var u0={},al={},Ub;function J6(){if(Ub)return al;Ub=1,Object.defineProperty(al,"__esModule",{value:!0}),al.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return al.delay=r,al}var Ho={},d0={},Wo={},Bb;function Z6(){return Bb||(Bb=1,Object.defineProperty(Wo,"__esModule",{value:!0}),Wo.ONE_THOUSAND=Wo.ONE_HUNDRED=void 0,Wo.ONE_HUNDRED=100,Wo.ONE_THOUSAND=1e3),Wo}var f0={},$b;function X6(){return $b||($b=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365})(f0)),f0}var Lb;function Xv(){return Lb||(Lb=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Qu;e.__exportStar(Z6(),r),e.__exportStar(X6(),r)})(d0)),d0}var Fb;function Q6(){if(Fb)return Ho;Fb=1,Object.defineProperty(Ho,"__esModule",{value:!0}),Ho.fromMiliseconds=Ho.toMiliseconds=void 0;const r=Xv();function e(n){return n*r.ONE_THOUSAND}Ho.toMiliseconds=e;function t(n){return Math.floor(n/r.ONE_THOUSAND)}return Ho.fromMiliseconds=t,Ho}var jb;function eS(){return jb||(jb=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Qu;e.__exportStar(J6(),r),e.__exportStar(Q6(),r)})(u0)),u0}var Ha={},qb;function tS(){if(qb)return Ha;qb=1,Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const n=this.get(t);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const i=Date.now()-n.started;this.timestamps.set(t,{started:n.started,elapsed:i})}get(t){const n=this.timestamps.get(t);if(typeof n>"u")throw new Error(`No timestamp found for label: ${t}`);return n}elapsed(t){const n=this.get(t);return n.elapsed||Date.now()-n.started}}return Ha.Watch=r,Ha.default=r,Ha}var h0={},cl={},Hb;function rS(){if(Hb)return cl;Hb=1,Object.defineProperty(cl,"__esModule",{value:!0}),cl.IWatch=void 0;class r{}return cl.IWatch=r,cl}var Wb;function nS(){return Wb||(Wb=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),Qu.__exportStar(rS(),r)})(h0)),h0}var zb;function iS(){return zb||(zb=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Qu;e.__exportStar(eS(),r),e.__exportStar(tS(),r),e.__exportStar(nS(),r),e.__exportStar(Xv(),r)})(l0)),l0}var le=iS();class Oa{}let sS=class extends Oa{constructor(e){super()}};const Kb=le.FIVE_SECONDS,ka={pulse:"heartbeat_pulse"};let oS=class Qv extends sS{constructor(e){super(e),this.events=new ci.EventEmitter,this.interval=Kb,this.interval=e?.interval||Kb}static async init(e){const t=new Qv(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),le.toMiliseconds(this.interval))}pulse(){this.events.emit(ka.pulse)}};const aS=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,cS=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,lS=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function uS(r,e){if(r==="__proto__"||r==="constructor"&&e&&typeof e=="object"&&"prototype"in e){dS(r);return}return e}function dS(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function Nd(r,e={}){if(typeof r!="string")return r;if(r[0]==='"'&&r[r.length-1]==='"'&&r.indexOf("\\")===-1)return r.slice(1,-1);const t=r.trim();if(t.length<=9)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!lS.test(r)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(aS.test(r)||cS.test(r)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,uS)}return JSON.parse(r)}catch(n){if(e.strict)throw n;return r}}function fS(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function Sr(r,...e){try{return fS(r(...e))}catch(t){return Promise.reject(t)}}function hS(r){const e=typeof r;return r===null||e!=="object"&&e!=="function"}function pS(r){const e=Object.getPrototypeOf(r);return!e||e.isPrototypeOf(Object)}function Qd(r){if(hS(r))return String(r);if(pS(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return Qd(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Wp="base64:";function gS(r){return typeof r=="string"?r:Wp+yS(r)}function mS(r){return typeof r!="string"||!r.startsWith(Wp)?r:bS(r.slice(Wp.length))}function bS(r){return globalThis.Buffer?Buffer.from(r,"base64"):Uint8Array.from(globalThis.atob(r),e=>e.codePointAt(0))}function yS(r){return globalThis.Buffer?Buffer.from(r).toString("base64"):globalThis.btoa(String.fromCodePoint(...r))}function wn(r){return r&&r.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function wS(...r){return wn(r.join(":"))}function Id(r){return r=wn(r),r?r+":":""}function xS(r,e){if(e===void 0)return!0;let t=0,n=r.indexOf(":");for(;n>-1;)t++,n=r.indexOf(":",n+1);return t<=e}function vS(r,e){return e?r.startsWith(e)&&r[r.length-1]!=="$":r[r.length-1]!=="$"}const ES="memory",AS=()=>{const r=new Map;return{name:ES,getInstance:()=>r,hasItem(e){return r.has(e)},getItem(e){return r.get(e)??null},getItemRaw(e){return r.get(e)??null},setItem(e,t){r.set(e,t)},setItemRaw(e,t){r.set(e,t)},removeItem(e){r.delete(e)},getKeys(){return[...r.keys()]},clear(){r.clear()},dispose(){r.clear()}}};function _S(r={}){const e={mounts:{"":r.driver||AS()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},n=(l,u)=>e.mountpoints.filter(d=>d.startsWith(l)||u&&l.startsWith(d)).map(d=>({relativeBase:l.length>d.length?l.slice(d.length):void 0,mountpoint:d,driver:e.mounts[d]})),i=(l,u)=>{if(e.watching){u=wn(u);for(const d of e.watchListeners)d(l,u)}},s=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await Vb(e.mounts[l],i,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,d)=>{const p=new Map,x=w=>{let b=p.get(w.base);return b||(b={driver:w.driver,base:w.base,items:[]},p.set(w.base,b)),b};for(const w of l){const b=typeof w=="string",y=wn(b?w:w.key),C=b?void 0:w.value,T=b||!w.options?u:{...u,...w.options},I=t(y);x(I).items.push({key:y,value:C,relativeKey:I.relativeKey,options:T})}return Promise.all([...p.values()].map(w=>d(w))).then(w=>w.flat())},c={hasItem(l,u={}){l=wn(l);const{relativeKey:d,driver:p}=t(l);return Sr(p.hasItem,d,u)},getItem(l,u={}){l=wn(l);const{relativeKey:d,driver:p}=t(l);return Sr(p.getItem,d,u).then(x=>Nd(x))},getItems(l,u={}){return a(l,u,d=>d.driver.getItems?Sr(d.driver.getItems,d.items.map(p=>({key:p.relativeKey,options:p.options})),u).then(p=>p.map(x=>({key:wS(d.base,x.key),value:Nd(x.value)}))):Promise.all(d.items.map(p=>Sr(d.driver.getItem,p.relativeKey,p.options).then(x=>({key:p.key,value:Nd(x)})))))},getItemRaw(l,u={}){l=wn(l);const{relativeKey:d,driver:p}=t(l);return p.getItemRaw?Sr(p.getItemRaw,d,u):Sr(p.getItem,d,u).then(x=>mS(x))},async setItem(l,u,d={}){if(u===void 0)return c.removeItem(l);l=wn(l);const{relativeKey:p,driver:x}=t(l);x.setItem&&(await Sr(x.setItem,p,Qd(u),d),x.watch||i("update",l))},async setItems(l,u){await a(l,u,async d=>{if(d.driver.setItems)return Sr(d.driver.setItems,d.items.map(p=>({key:p.relativeKey,value:Qd(p.value),options:p.options})),u);d.driver.setItem&&await Promise.all(d.items.map(p=>Sr(d.driver.setItem,p.relativeKey,Qd(p.value),p.options)))})},async setItemRaw(l,u,d={}){if(u===void 0)return c.removeItem(l,d);l=wn(l);const{relativeKey:p,driver:x}=t(l);if(x.setItemRaw)await Sr(x.setItemRaw,p,u,d);else if(x.setItem)await Sr(x.setItem,p,gS(u),d);else return;x.watch||i("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=wn(l);const{relativeKey:d,driver:p}=t(l);p.removeItem&&(await Sr(p.removeItem,d,u),(u.removeMeta||u.removeMata)&&await Sr(p.removeItem,d+"$",u),p.watch||i("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=wn(l);const{relativeKey:d,driver:p}=t(l),x=Object.create(null);if(p.getMeta&&Object.assign(x,await Sr(p.getMeta,d,u)),!u.nativeOnly){const w=await Sr(p.getItem,d+"$",u).then(b=>Nd(b));w&&typeof w=="object"&&(typeof w.atime=="string"&&(w.atime=new Date(w.atime)),typeof w.mtime=="string"&&(w.mtime=new Date(w.mtime)),Object.assign(x,w))}return x},setMeta(l,u,d={}){return this.setItem(l+"$",u,d)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){l=Id(l);const d=n(l,!0);let p=[];const x=[];let w=!0;for(const y of d){y.driver.flags?.maxDepth||(w=!1);const C=await Sr(y.driver.getKeys,y.relativeBase,u);for(const T of C){const I=y.mountpoint+wn(T);p.some(k=>I.startsWith(k))||x.push(I)}p=[y.mountpoint,...p.filter(T=>!T.startsWith(y.mountpoint))]}const b=u.maxDepth!==void 0&&!w;return x.filter(y=>(!b||xS(y,u.maxDepth))&&vS(y,l))},async clear(l,u={}){l=Id(l),await Promise.all(n(l,!1).map(async d=>{if(d.driver.clear)return Sr(d.driver.clear,d.relativeBase,u);if(d.driver.removeItem){const p=await d.driver.getKeys(d.relativeBase||"",u);return Promise.all(p.map(x=>d.driver.removeItem(x,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>Gb(l)))},async watch(l){return await s(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=Id(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((d,p)=>p.length-d.length)),e.mounts[l]=u,e.watching&&Promise.resolve(Vb(u,i,l)).then(d=>{e.unwatch[l]=d}).catch(console.error),c},async unmount(l,u=!0){l=Id(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&(e.unwatch[l]?.(),delete e.unwatch[l]),u&&await Gb(e.mounts[l]),e.mountpoints=e.mountpoints.filter(d=>d!==l),delete e.mounts[l])},getMount(l=""){l=wn(l)+":";const u=t(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=wn(l),n(l,u.parents).map(p=>({driver:p.driver,base:p.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,d={})=>c.setItem(l,u,d),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function Vb(r,e,t){return r.watch?r.watch((n,i)=>e(n,t+i)):()=>{}}async function Gb(r){typeof r.dispose=="function"&&await Sr(r.dispose)}function Da(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function eE(r,e){let t;const n=()=>{if(t)return t;const i=indexedDB.open(r);return i.onupgradeneeded=()=>i.result.createObjectStore(e),t=Da(i),t.then(s=>{s.onclose=()=>t=void 0},()=>{}),t};return(i,s)=>n().then(o=>s(o.transaction(e,i).objectStore(e)))}let p0;function ed(){return p0||(p0=eE("keyval-store","keyval")),p0}function Yb(r,e=ed()){return e("readonly",t=>Da(t.get(r)))}function CS(r,e,t=ed()){return t("readwrite",n=>(n.put(e,r),Da(n.transaction)))}function SS(r,e=ed()){return e("readwrite",t=>(t.delete(r),Da(t.transaction)))}function NS(r=ed()){return r("readwrite",e=>(e.clear(),Da(e.transaction)))}function IS(r,e){return r.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Da(r.transaction)}function TS(r=ed()){return r("readonly",e=>{if(e.getAllKeys)return Da(e.getAllKeys());const t=[];return IS(e,n=>t.push(n.key)).then(()=>t)})}const PS=r=>JSON.stringify(r,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),RS=r=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=r.replace(e,'$1"$2n"$3');return JSON.parse(t,(n,i)=>typeof i=="string"&&i.match(/^\d+n$/)?BigInt(i.substring(0,i.length-1)):i)};function ya(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return RS(r)}catch{return r}}function Bs(r){return typeof r=="string"?r:PS(r)||""}const OS="idb-keyval";var kS=(r={})=>{const e=r.base&&r.base.length>0?`${r.base}:`:"",t=i=>e+i;let n;return r.dbName&&r.storeName&&(n=eE(r.dbName,r.storeName)),{name:OS,options:r,async hasItem(i){return!(typeof await Yb(t(i),n)>"u")},async getItem(i){return await Yb(t(i),n)??null},setItem(i,s){return CS(t(i),s,n)},removeItem(i){return SS(t(i),n)},getKeys(){return TS(n)},clear(){return NS(n)}}};const DS="WALLET_CONNECT_V2_INDEXED_DB",MS="keyvaluestorage";let US=class{constructor(){this.indexedDb=_S({driver:kS({dbName:DS,storeName:MS})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,Bs(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var g0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ef={exports:{}};(function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,n){this[t]=String(n)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof g0<"u"&&g0.localStorage?ef.exports=g0.localStorage:typeof window<"u"&&window.localStorage?ef.exports=window.localStorage:ef.exports=new e})();function BS(r){var e;return[r[0],ya((e=r[1])!=null?e:"")]}let $S=class{constructor(){this.localStorage=ef.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(BS)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return ya(t)}async setItem(e,t){this.localStorage.setItem(e,Bs(t))}async removeItem(e){this.localStorage.removeItem(e)}};const LS="wc_storage_version",Jb=1,FS=async(r,e,t)=>{const n=LS,i=await e.getItem(n);if(i&&i>=Jb){t(e);return}const s=await r.getKeys();if(!s.length){t(e);return}const o=[];for(;s.length;){const a=s.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await r.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(n,Jb),t(e),jS(r,o)},jS=async(r,e)=>{e.length&&e.forEach(async t=>{await r.removeItem(t)})};let qS=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new $S;this.storage=e;try{const t=new US;FS(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var m0,Zb;function HS(){if(Zb)return m0;Zb=1;function r(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}m0=e;function e(t,n,i){var s=i&&i.stringify||r,o=1;if(typeof t=="object"&&t!==null){var a=n.length+o;if(a===1)return t;var c=new Array(a);c[0]=s(t);for(var l=1;l<a;l++)c[l]=s(n[l]);return c.join(" ")}if(typeof t!="string")return t;var u=n.length;if(u===0)return t;for(var d="",p=1-o,x=-1,w=t&&t.length||0,b=0;b<w;){if(t.charCodeAt(b)===37&&b+1<w){switch(x=x>-1?x:0,t.charCodeAt(b+1)){case 100:case 102:if(p>=u||n[p]==null)break;x<b&&(d+=t.slice(x,b)),d+=Number(n[p]),x=b+2,b++;break;case 105:if(p>=u||n[p]==null)break;x<b&&(d+=t.slice(x,b)),d+=Math.floor(Number(n[p])),x=b+2,b++;break;case 79:case 111:case 106:if(p>=u||n[p]===void 0)break;x<b&&(d+=t.slice(x,b));var y=typeof n[p];if(y==="string"){d+="'"+n[p]+"'",x=b+2,b++;break}if(y==="function"){d+=n[p].name||"<anonymous>",x=b+2,b++;break}d+=s(n[p]),x=b+2,b++;break;case 115:if(p>=u)break;x<b&&(d+=t.slice(x,b)),d+=String(n[p]),x=b+2,b++;break;case 37:x<b&&(d+=t.slice(x,b)),d+="%",x=b+2,b++,p--;break}++p}++b}return x===-1?t:(x<w&&(d+=t.slice(x)),d)}return m0}var b0,Xb;function WS(){if(Xb)return b0;Xb=1;const r=HS();b0=i;const e=P().console||{},t={mapHttpRequest:w,mapHttpResponse:w,wrapRequestSerializer:b,wrapResponseSerializer:b,wrapErrorSerializer:b,req:w,res:w,err:p};function n(O,q){return Array.isArray(O)?O.filter(function(B){return B!=="!stdSerializers.err"}):O===!0?Object.keys(q):!1}function i(O){O=O||{},O.browser=O.browser||{};const q=O.browser.transmit;if(q&&typeof q.send!="function")throw Error("pino: transmit option must have a send function");const F=O.browser.write||e;O.browser.write&&(O.browser.asObject=!0);const B=O.serializers||{},W=n(O.browser.serialize,B);let j=O.browser.serialize;Array.isArray(O.browser.serialize)&&O.browser.serialize.indexOf("!stdSerializers.err")>-1&&(j=!1);const U=["error","fatal","warn","info","debug","trace"];typeof F=="function"&&(F.error=F.fatal=F.warn=F.info=F.debug=F.trace=F),O.enabled===!1&&(O.level="silent");const _=O.level||"info",f=Object.create(F);f.log||(f.log=y),Object.defineProperty(f,"levelVal",{get:m}),Object.defineProperty(f,"level",{get:A,set:S});const h={transmit:q,serialize:W,asObject:O.browser.asObject,levels:U,timestamp:x(O)};f.levels=i.levels,f.level=_,f.setMaxListeners=f.getMaxListeners=f.emit=f.addListener=f.on=f.prependListener=f.once=f.prependOnceListener=f.removeListener=f.removeAllListeners=f.listeners=f.listenerCount=f.eventNames=f.write=f.flush=y,f.serializers=B,f._serialize=W,f._stdErrSerialize=j,f.child=R,q&&(f._logEvent=d());function m(){return this.level==="silent"?1/0:this.levels.values[this.level]}function A(){return this._level}function S(M){if(M!=="silent"&&!this.levels.values[M])throw Error("unknown level "+M);this._level=M,s(h,f,"error","log"),s(h,f,"fatal","error"),s(h,f,"warn","error"),s(h,f,"info","log"),s(h,f,"debug","log"),s(h,f,"trace","log")}function R(M,E){if(!M)throw new Error("missing bindings for child Pino");E=E||{},W&&M.serializers&&(E.serializers=M.serializers);const g=E.serializers;if(W&&g){var N=Object.assign({},B,g),L=O.browser.serialize===!0?Object.keys(N):W;delete M.serializers,c([M],L,N,this._stdErrSerialize)}function v(H){this._childLevel=(H._childLevel|0)+1,this.error=l(H,M,"error"),this.fatal=l(H,M,"fatal"),this.warn=l(H,M,"warn"),this.info=l(H,M,"info"),this.debug=l(H,M,"debug"),this.trace=l(H,M,"trace"),N&&(this.serializers=N,this._serialize=L),q&&(this._logEvent=d([].concat(H._logEvent.bindings,M)))}return v.prototype=this,new v(this)}return f}i.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},i.stdSerializers=t,i.stdTimeFunctions=Object.assign({},{nullTime:C,epochTime:T,unixTime:I,isoTime:k});function s(O,q,F,B){const W=Object.getPrototypeOf(q);q[F]=q.levelVal>q.levels.values[F]?y:W[F]?W[F]:e[F]||e[B]||y,o(O,q,F)}function o(O,q,F){!O.transmit&&q[F]===y||(q[F]=(function(B){return function(){const j=O.timestamp(),U=new Array(arguments.length),_=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var f=0;f<U.length;f++)U[f]=arguments[f];if(O.serialize&&!O.asObject&&c(U,this._serialize,this.serializers,this._stdErrSerialize),O.asObject?B.call(_,a(this,F,U,j)):B.apply(_,U),O.transmit){const h=O.transmit.level||q.level,m=i.levels.values[h],A=i.levels.values[F];if(A<m)return;u(this,{ts:j,methodLevel:F,methodValue:A,transmitValue:i.levels.values[O.transmit.level||q.level],send:O.transmit.send,val:q.levelVal},U)}}})(q[F]))}function a(O,q,F,B){O._serialize&&c(F,O._serialize,O.serializers,O._stdErrSerialize);const W=F.slice();let j=W[0];const U={};B&&(U.time=B),U.level=i.levels.values[q];let _=(O._childLevel|0)+1;if(_<1&&(_=1),j!==null&&typeof j=="object"){for(;_--&&typeof W[0]=="object";)Object.assign(U,W.shift());j=W.length?r(W.shift(),W):void 0}else typeof j=="string"&&(j=r(W.shift(),W));return j!==void 0&&(U.msg=j),U}function c(O,q,F,B){for(const W in O)if(B&&O[W]instanceof Error)O[W]=i.stdSerializers.err(O[W]);else if(typeof O[W]=="object"&&!Array.isArray(O[W]))for(const j in O[W])q&&q.indexOf(j)>-1&&j in F&&(O[W][j]=F[j](O[W][j]))}function l(O,q,F){return function(){const B=new Array(1+arguments.length);B[0]=q;for(var W=1;W<B.length;W++)B[W]=arguments[W-1];return O[F].apply(this,B)}}function u(O,q,F){const B=q.send,W=q.ts,j=q.methodLevel,U=q.methodValue,_=q.val,f=O._logEvent.bindings;c(F,O._serialize||Object.keys(O.serializers),O.serializers,O._stdErrSerialize===void 0?!0:O._stdErrSerialize),O._logEvent.ts=W,O._logEvent.messages=F.filter(function(h){return f.indexOf(h)===-1}),O._logEvent.level.label=j,O._logEvent.level.value=U,B(j,O._logEvent,_),O._logEvent=d(f)}function d(O){return{ts:0,messages:[],bindings:O||[],level:{label:"",value:0}}}function p(O){const q={type:O.constructor.name,msg:O.message,stack:O.stack};for(const F in O)q[F]===void 0&&(q[F]=O[F]);return q}function x(O){return typeof O.timestamp=="function"?O.timestamp:O.timestamp===!1?C:T}function w(){return{}}function b(O){return O}function y(){}function C(){return!1}function T(){return Date.now()}function I(){return Math.round(Date.now()/1e3)}function k(){return new Date(Date.now()).toISOString()}function P(){function O(q){return typeof q<"u"&&q}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return O(self)||O(window)||O(this)||{}}}return b0}var fc=WS();const td=qs(fc),zS={level:"info"},rd="custom_context",om=1e3*1024;let KS=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Qb=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new KS(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}},tE=class{constructor(e,t=om){this.level=e??"error",this.levelValue=fc.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new Qb(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===fc.levels.values.error?console.error(e):t===fc.levels.values.warn?console.warn(e):t===fc.levels.values.debug?console.debug(e):t===fc.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Bs({timestamp:new Date().toISOString(),log:e}));const t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new Qb(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(Bs({extraMetadata:e})),new Blob(t,{type:"application/json"})}},VS=class{constructor(e,t=om){this.baseChunkLogger=new tE(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=t,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}},GS=class{constructor(e,t=om){this.baseChunkLogger=new tE(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var YS=Object.defineProperty,JS=Object.defineProperties,ZS=Object.getOwnPropertyDescriptors,ey=Object.getOwnPropertySymbols,XS=Object.prototype.hasOwnProperty,QS=Object.prototype.propertyIsEnumerable,ty=(r,e,t)=>e in r?YS(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,_f=(r,e)=>{for(var t in e||(e={}))XS.call(e,t)&&ty(r,t,e[t]);if(ey)for(var t of ey(e))QS.call(e,t)&&ty(r,t,e[t]);return r},Cf=(r,e)=>JS(r,ZS(e));function Kc(r){return Cf(_f({},r),{level:r?.level||zS.level})}function e8(r,e=rd){return r[e]||""}function t8(r,e,t=rd){return r[t]=e,r}function Pn(r,e=rd){let t="";return typeof r.bindings>"u"?t=e8(r,e):t=r.bindings().context||"",t}function r8(r,e,t=rd){const n=Pn(r,t);return n.trim()?`${n}/${e}`:e}function tn(r,e,t=rd){const n=r8(r,e,t),i=r.child({context:n});return t8(i,n,t)}function n8(r){var e,t;const n=new VS((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:td(Cf(_f({},r.opts),{level:"trace",browser:Cf(_f({},(t=r.opts)==null?void 0:t.browser),{write:i=>n.write(i)})})),chunkLoggerController:n}}function i8(r){var e;const t=new GS((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:td(Cf(_f({},r.opts),{level:"trace"}),t),chunkLoggerController:t}}function am(r){return typeof r.loggerOverride<"u"&&typeof r.loggerOverride!="string"?{logger:r.loggerOverride,chunkLoggerController:null}:typeof window<"u"?n8(r):i8(r)}var s8=Object.defineProperty,o8=(r,e,t)=>e in r?s8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ry=(r,e,t)=>o8(r,typeof e!="symbol"?e+"":e,t);let a8=class extends Oa{constructor(e){super(),this.opts=e,ry(this,"protocol","wc"),ry(this,"version",2)}};var c8=Object.defineProperty,l8=(r,e,t)=>e in r?c8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,u8=(r,e,t)=>l8(r,e+"",t);let d8=class extends Oa{constructor(e,t){super(),this.core=e,this.logger=t,u8(this,"records",new Map)}},f8=class{constructor(e,t){this.logger=e,this.core=t}},h8=class extends Oa{constructor(e,t){super(),this.relayer=e,this.logger=t}},p8=class extends Oa{constructor(e){super()}},g8=class{constructor(e,t,n,i){this.core=e,this.logger=t,this.name=n}},m8=class extends Oa{constructor(e,t){super(),this.relayer=e,this.logger=t}},b8=class extends Oa{constructor(e,t){super(),this.core=e,this.logger=t}},y8=class{constructor(e,t,n){this.core=e,this.logger=t,this.store=n}},w8=class{constructor(e,t){this.projectId=e,this.logger=t}},x8=class{constructor(e,t,n){this.core=e,this.logger=t,this.telemetryEnabled=n}};var v8=Object.defineProperty,E8=(r,e,t)=>e in r?v8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ny=(r,e,t)=>E8(r,typeof e!="symbol"?e+"":e,t);let A8=class{constructor(e){this.opts=e,ny(this,"protocol","wc"),ny(this,"version",2)}},_8=class{constructor(e){this.client=e}};function C8(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function rE(r,...e){if(!C8(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function iy(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function S8(r,e){rE(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Wa=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const y0=r=>new DataView(r.buffer,r.byteOffset,r.byteLength);function N8(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function nE(r){return typeof r=="string"&&(r=N8(r)),rE(r),r}let I8=class{clone(){return this._cloneInto()}};function T8(r){const e=n=>r().update(nE(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function iE(r=32){if(Wa&&typeof Wa.getRandomValues=="function")return Wa.getRandomValues(new Uint8Array(r));if(Wa&&typeof Wa.randomBytes=="function")return Wa.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}function P8(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(t>>i&s),a=Number(t&s),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}let R8=class extends I8{constructor(e,t,n,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=y0(this.buffer)}update(e){iy(this);const{view:t,buffer:n,blockLen:i}=this;e=nE(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=y0(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){iy(this),S8(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let d=o;d<i;d++)t[d]=0;P8(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=y0(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],s)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%t&&e.buffer.set(n),e}};const Td=BigInt(2**32-1),zp=BigInt(32);function sE(r,e=!1){return e?{h:Number(r&Td),l:Number(r>>zp&Td)}:{h:Number(r>>zp&Td)|0,l:Number(r&Td)|0}}function O8(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let i=0;i<r.length;i++){const{h:s,l:o}=sE(r[i],e);[t[i],n[i]]=[s,o]}return[t,n]}const k8=(r,e)=>BigInt(r>>>0)<<zp|BigInt(e>>>0),D8=(r,e,t)=>r>>>t,M8=(r,e,t)=>r<<32-t|e>>>t,U8=(r,e,t)=>r>>>t|e<<32-t,B8=(r,e,t)=>r<<32-t|e>>>t,$8=(r,e,t)=>r<<64-t|e>>>t-32,L8=(r,e,t)=>r>>>t-32|e<<64-t,F8=(r,e)=>e,j8=(r,e)=>r,q8=(r,e,t)=>r<<t|e>>>32-t,H8=(r,e,t)=>e<<t|r>>>32-t,W8=(r,e,t)=>e<<t-32|r>>>64-t,z8=(r,e,t)=>r<<t-32|e>>>64-t;function K8(r,e,t,n){const i=(e>>>0)+(n>>>0);return{h:r+t+(i/2**32|0)|0,l:i|0}}const V8=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),G8=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,Y8=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),J8=(r,e,t,n,i)=>e+t+n+i+(r/2**32|0)|0,Z8=(r,e,t,n,i)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0),X8=(r,e,t,n,i,s)=>e+t+n+i+s+(r/2**32|0)|0,Ue={fromBig:sE,split:O8,toBig:k8,shrSH:D8,shrSL:M8,rotrSH:U8,rotrSL:B8,rotrBH:$8,rotrBL:L8,rotr32H:F8,rotr32L:j8,rotlSH:q8,rotlSL:H8,rotlBH:W8,rotlBL:z8,add:K8,add3L:V8,add3H:G8,add4L:Y8,add4H:J8,add5H:X8,add5L:Z8},[Q8,e4]=Ue.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Zs=new Uint32Array(80),Xs=new Uint32Array(80);let t4=class extends R8{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:p,Gh:x,Gl:w,Hh:b,Hl:y}=this;return[e,t,n,i,s,o,a,c,l,u,d,p,x,w,b,y]}set(e,t,n,i,s,o,a,c,l,u,d,p,x,w,b,y){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=p|0,this.Gh=x|0,this.Gl=w|0,this.Hh=b|0,this.Hl=y|0}process(e,t){for(let I=0;I<16;I++,t+=4)Zs[I]=e.getUint32(t),Xs[I]=e.getUint32(t+=4);for(let I=16;I<80;I++){const k=Zs[I-15]|0,P=Xs[I-15]|0,O=Ue.rotrSH(k,P,1)^Ue.rotrSH(k,P,8)^Ue.shrSH(k,P,7),q=Ue.rotrSL(k,P,1)^Ue.rotrSL(k,P,8)^Ue.shrSL(k,P,7),F=Zs[I-2]|0,B=Xs[I-2]|0,W=Ue.rotrSH(F,B,19)^Ue.rotrBH(F,B,61)^Ue.shrSH(F,B,6),j=Ue.rotrSL(F,B,19)^Ue.rotrBL(F,B,61)^Ue.shrSL(F,B,6),U=Ue.add4L(q,j,Xs[I-7],Xs[I-16]),_=Ue.add4H(U,O,W,Zs[I-7],Zs[I-16]);Zs[I]=_|0,Xs[I]=U|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:p,Fh:x,Fl:w,Gh:b,Gl:y,Hh:C,Hl:T}=this;for(let I=0;I<80;I++){const k=Ue.rotrSH(d,p,14)^Ue.rotrSH(d,p,18)^Ue.rotrBH(d,p,41),P=Ue.rotrSL(d,p,14)^Ue.rotrSL(d,p,18)^Ue.rotrBL(d,p,41),O=d&x^~d&b,q=p&w^~p&y,F=Ue.add5L(T,P,q,e4[I],Xs[I]),B=Ue.add5H(F,C,k,O,Q8[I],Zs[I]),W=F|0,j=Ue.rotrSH(n,i,28)^Ue.rotrBH(n,i,34)^Ue.rotrBH(n,i,39),U=Ue.rotrSL(n,i,28)^Ue.rotrBL(n,i,34)^Ue.rotrBL(n,i,39),_=n&s^n&a^s&a,f=i&o^i&c^o&c;C=b|0,T=y|0,b=x|0,y=w|0,x=d|0,w=p|0,{h:d,l:p}=Ue.add(l|0,u|0,B|0,W|0),l=a|0,u=c|0,a=s|0,c=o|0,s=n|0,o=i|0;const h=Ue.add3L(W,U,f);n=Ue.add3H(h,B,j,_),i=h|0}({h:n,l:i}=Ue.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=Ue.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=Ue.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Ue.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:p}=Ue.add(this.Eh|0,this.El|0,d|0,p|0),{h:x,l:w}=Ue.add(this.Fh|0,this.Fl|0,x|0,w|0),{h:b,l:y}=Ue.add(this.Gh|0,this.Gl|0,b|0,y|0),{h:C,l:T}=Ue.add(this.Hh|0,this.Hl|0,C|0,T|0),this.set(n,i,s,o,a,c,l,u,d,p,x,w,b,y,C,T)}roundClean(){Zs.fill(0),Xs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const r4=T8(()=>new t4);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const cm=BigInt(0),oE=BigInt(1),n4=BigInt(2);function lm(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function um(r){if(!lm(r))throw new Error("Uint8Array expected")}function w0(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const i4=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function dm(r){um(r);let e="";for(let t=0;t<r.length;t++)e+=i4[r[t]];return e}function aE(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?cm:BigInt("0x"+r)}const bs={_0:48,_9:57,A:65,F:70,a:97,f:102};function sy(r){if(r>=bs._0&&r<=bs._9)return r-bs._0;if(r>=bs.A&&r<=bs.F)return r-(bs.A-10);if(r>=bs.a&&r<=bs.f)return r-(bs.a-10)}function cE(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let i=0,s=0;i<t;i++,s+=2){const o=sy(r.charCodeAt(s)),a=sy(r.charCodeAt(s+1));if(o===void 0||a===void 0){const c=r[s]+r[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}function s4(r){return aE(dm(r))}function tf(r){return um(r),aE(dm(Uint8Array.from(r).reverse()))}function lE(r,e){return cE(r.toString(16).padStart(e*2,"0"))}function Kp(r,e){return lE(r,e).reverse()}function ys(r,e,t){let n;if(typeof e=="string")try{n=cE(e)}catch(s){throw new Error(r+" must be hex string or Uint8Array, cause: "+s)}else if(lm(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const i=n.length;if(typeof t=="number"&&i!==t)throw new Error(r+" of length "+t+" expected, got "+i);return n}function oy(...r){let e=0;for(let n=0;n<r.length;n++){const i=r[n];um(i),e+=i.length}const t=new Uint8Array(e);for(let n=0,i=0;n<r.length;n++){const s=r[n];t.set(s,i),i+=s.length}return t}const x0=r=>typeof r=="bigint"&&cm<=r;function o4(r,e,t){return x0(r)&&x0(e)&&x0(t)&&e<=r&&r<t}function ll(r,e,t,n){if(!o4(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function a4(r){let e;for(e=0;r>cm;r>>=oE,e+=1);return e}const c4=r=>(n4<<BigInt(r-1))-oE,l4={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||lm(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function fm(r,e,t={}){const n=(i,s,o)=>{const a=l4[s];if(typeof a!="function")throw new Error("invalid validator function");const c=r[i];if(!(o&&c===void 0)&&!a(c,r))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+c)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(t))n(i,s,!0);return r}function ay(r){const e=new WeakMap;return(t,...n)=>{const i=e.get(t);if(i!==void 0)return i;const s=r(t,...n);return e.set(t,s),s}}const Tr=BigInt(0),fr=BigInt(1),Zo=BigInt(2),u4=BigInt(3),Vp=BigInt(4),cy=BigInt(5),ly=BigInt(8);function xr(r,e){const t=r%e;return t>=Tr?t:e+t}function d4(r,e,t){if(e<Tr)throw new Error("invalid exponent, negatives unsupported");if(t<=Tr)throw new Error("invalid modulus");if(t===fr)return Tr;let n=fr;for(;e>Tr;)e&fr&&(n=n*r%t),r=r*r%t,e>>=fr;return n}function $i(r,e,t){let n=r;for(;e-- >Tr;)n*=n,n%=t;return n}function uy(r,e){if(r===Tr)throw new Error("invert: expected non-zero number");if(e<=Tr)throw new Error("invert: expected positive modulus, got "+e);let t=xr(r,e),n=e,i=Tr,s=fr;for(;t!==Tr;){const o=n/t,a=n%t,c=i-s*o;n=t,t=a,i=s,s=c}if(n!==fr)throw new Error("invert: does not exist");return xr(i,e)}function f4(r){const e=(r-fr)/Zo;let t,n,i;for(t=r-fr,n=0;t%Zo===Tr;t/=Zo,n++);for(i=Zo;i<r&&d4(i,e,r)!==r-fr;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(r+fr)/Vp;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const s=(t+fr)/Zo;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,l=o.pow(o.mul(o.ONE,i),t),u=o.pow(a,s),d=o.pow(a,t);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let p=1;for(let w=o.sqr(d);p<c&&!o.eql(w,o.ONE);p++)w=o.sqr(w);const x=o.pow(l,fr<<BigInt(c-p-1));l=o.sqr(x),u=o.mul(u,x),d=o.mul(d,l),c=p}return u}}function h4(r){if(r%Vp===u4){const e=(r+fr)/Vp;return function(t,n){const i=t.pow(n,e);if(!t.eql(t.sqr(i),n))throw new Error("Cannot find square root");return i}}if(r%ly===cy){const e=(r-cy)/ly;return function(t,n){const i=t.mul(n,Zo),s=t.pow(i,e),o=t.mul(n,s),a=t.mul(t.mul(o,Zo),s),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return f4(r)}const p4=(r,e)=>(xr(r,e)&fr)===fr,g4=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function m4(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=g4.reduce((n,i)=>(n[i]="function",n),e);return fm(r,t)}function b4(r,e,t){if(t<Tr)throw new Error("invalid exponent, negatives unsupported");if(t===Tr)return r.ONE;if(t===fr)return e;let n=r.ONE,i=e;for(;t>Tr;)t&fr&&(n=r.mul(n,i)),i=r.sqr(i),t>>=fr;return n}function y4(r,e){const t=new Array(e.length),n=e.reduce((s,o,a)=>r.is0(o)?s:(t[a]=s,r.mul(s,o)),r.ONE),i=r.inv(n);return e.reduceRight((s,o,a)=>r.is0(o)?s:(t[a]=r.mul(s,t[a]),r.mul(s,o)),i),t}function uE(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function dE(r,e,t=!1,n={}){if(r<=Tr)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:i,nByteLength:s}=uE(r,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:r,isLE:t,BITS:i,BYTES:s,MASK:c4(i),ZERO:Tr,ONE:fr,create:c=>xr(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Tr<=c&&c<r},is0:c=>c===Tr,isOdd:c=>(c&fr)===fr,neg:c=>xr(-c,r),eql:(c,l)=>c===l,sqr:c=>xr(c*c,r),add:(c,l)=>xr(c+l,r),sub:(c,l)=>xr(c-l,r),mul:(c,l)=>xr(c*l,r),pow:(c,l)=>b4(a,c,l),div:(c,l)=>xr(c*uy(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>uy(c,r),sqrt:n.sqrt||(c=>(o||(o=h4(r)),o(a,c))),invertBatch:c=>y4(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?Kp(c,s):lE(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return t?tf(c):s4(c)}});return Object.freeze(a)}const dy=BigInt(0),Pd=BigInt(1);function v0(r,e){const t=e.negate();return r?t:e}function fE(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function E0(r,e){fE(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1);return{windows:t,windowSize:n}}function w4(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function x4(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const A0=new WeakMap,hE=new WeakMap;function _0(r){return hE.get(r)||1}function v4(r,e){return{constTimeNegate:v0,hasPrecomputes(t){return _0(t)!==1},unsafeLadder(t,n,i=r.ZERO){let s=t;for(;n>dy;)n&Pd&&(i=i.add(s)),s=s.double(),n>>=Pd;return i},precomputeWindow(t,n){const{windows:i,windowSize:s}=E0(n,e),o=[];let a=t,c=a;for(let l=0;l<i;l++){c=a,o.push(c);for(let u=1;u<s;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,i){const{windows:s,windowSize:o}=E0(t,e);let a=r.ZERO,c=r.BASE;const l=BigInt(2**t-1),u=2**t,d=BigInt(t);for(let p=0;p<s;p++){const x=p*o;let w=Number(i&l);i>>=d,w>o&&(w-=u,i+=Pd);const b=x,y=x+Math.abs(w)-1,C=p%2!==0,T=w<0;w===0?c=c.add(v0(C,n[b])):a=a.add(v0(T,n[y]))}return{p:a,f:c}},wNAFUnsafe(t,n,i,s=r.ZERO){const{windows:o,windowSize:a}=E0(t,e),c=BigInt(2**t-1),l=2**t,u=BigInt(t);for(let d=0;d<o;d++){const p=d*a;if(i===dy)break;let x=Number(i&c);if(i>>=u,x>a&&(x-=l,i+=Pd),x===0)continue;let w=n[p+Math.abs(x)-1];x<0&&(w=w.negate()),s=s.add(w)}return s},getPrecomputes(t,n,i){let s=A0.get(n);return s||(s=this.precomputeWindow(n,t),t!==1&&A0.set(n,i(s))),s},wNAFCached(t,n,i){const s=_0(t);return this.wNAF(s,this.getPrecomputes(s,t,i),n)},wNAFCachedUnsafe(t,n,i,s){const o=_0(t);return o===1?this.unsafeLadder(t,n,s):this.wNAFUnsafe(o,this.getPrecomputes(o,t,i),n,s)},setWindowSize(t,n){fE(n,e),hE.set(t,n),A0.delete(t)}}}function E4(r,e,t,n){if(w4(t,r),x4(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=r.ZERO,s=a4(BigInt(t.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(i),l=Math.floor((e.BITS-1)/o)*o;let u=i;for(let d=l;d>=0;d-=o){c.fill(i);for(let x=0;x<n.length;x++){const w=n[x],b=Number(w>>BigInt(d)&BigInt(a));c[b]=c[b].add(t[x])}let p=i;for(let x=c.length-1,w=i;x>0;x--)w=w.add(c[x]),p=p.add(w);if(u=u.add(p),d!==0)for(let x=0;x<o;x++)u=u.double()}return u}function A4(r){return m4(r.Fp),fm(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...uE(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}const pi=BigInt(0),gn=BigInt(1),Rd=BigInt(2),_4=BigInt(8),C4={zip215:!0};function S4(r){const e=A4(r);return fm(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function N4(r){const e=S4(r),{Fp:t,n,prehash:i,hash:s,randomBytes:o,nByteLength:a,h:c}=e,l=Rd<<BigInt(a*8)-gn,u=t.create,d=dE(e.n,e.nBitLength),p=e.uvRatio||((h,m)=>{try{return{isValid:!0,value:t.sqrt(h*t.inv(m))}}catch{return{isValid:!1,value:pi}}}),x=e.adjustScalarBytes||(h=>h),w=e.domain||((h,m,A)=>{if(w0("phflag",A),m.length||A)throw new Error("Contexts/pre-hash are not supported");return h});function b(h,m){ll("coordinate "+h,m,pi,l)}function y(h){if(!(h instanceof I))throw new Error("ExtendedPoint expected")}const C=ay((h,m)=>{const{ex:A,ey:S,ez:R}=h,M=h.is0();m==null&&(m=M?_4:t.inv(R));const E=u(A*m),g=u(S*m),N=u(R*m);if(M)return{x:pi,y:gn};if(N!==gn)throw new Error("invZ was invalid");return{x:E,y:g}}),T=ay(h=>{const{a:m,d:A}=e;if(h.is0())throw new Error("bad point: ZERO");const{ex:S,ey:R,ez:M,et:E}=h,g=u(S*S),N=u(R*R),L=u(M*M),v=u(L*L),H=u(g*m),V=u(L*u(H+N)),z=u(v+u(A*u(g*N)));if(V!==z)throw new Error("bad point: equation left != right (1)");const G=u(S*R),re=u(M*E);if(G!==re)throw new Error("bad point: equation left != right (2)");return!0});class I{constructor(m,A,S,R){this.ex=m,this.ey=A,this.ez=S,this.et=R,b("x",m),b("y",A),b("z",S),b("t",R),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(m){if(m instanceof I)throw new Error("extended point not allowed");const{x:A,y:S}=m||{};return b("x",A),b("y",S),new I(A,S,gn,u(A*S))}static normalizeZ(m){const A=t.invertBatch(m.map(S=>S.ez));return m.map((S,R)=>S.toAffine(A[R])).map(I.fromAffine)}static msm(m,A){return E4(I,d,m,A)}_setWindowSize(m){O.setWindowSize(this,m)}assertValidity(){T(this)}equals(m){y(m);const{ex:A,ey:S,ez:R}=this,{ex:M,ey:E,ez:g}=m,N=u(A*g),L=u(M*R),v=u(S*g),H=u(E*R);return N===L&&v===H}is0(){return this.equals(I.ZERO)}negate(){return new I(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:m}=e,{ex:A,ey:S,ez:R}=this,M=u(A*A),E=u(S*S),g=u(Rd*u(R*R)),N=u(m*M),L=A+S,v=u(u(L*L)-M-E),H=N+E,V=H-g,z=N-E,G=u(v*V),re=u(H*z),X=u(v*z),ne=u(V*H);return new I(G,re,ne,X)}add(m){y(m);const{a:A,d:S}=e,{ex:R,ey:M,ez:E,et:g}=this,{ex:N,ey:L,ez:v,et:H}=m;if(A===BigInt(-1)){const Rn=u((M-R)*(L+N)),ct=u((M+R)*(L-N)),tt=u(ct-Rn);if(tt===pi)return this.double();const On=u(E*Rd*H),lt=u(g*Rd*v),Ze=lt+On,nn=ct+Rn,ut=lt-On,ft=u(Ze*tt),ps=u(nn*ut),vt=u(Ze*ut),Et=u(tt*nn);return new I(ft,ps,Et,vt)}const V=u(R*N),z=u(M*L),G=u(g*S*H),re=u(E*v),X=u((R+M)*(N+L)-V-z),ne=re-G,Fe=re+G,ue=u(z-A*V),Ce=u(X*ne),rn=u(Fe*ue),Je=u(X*ue),dt=u(ne*Fe);return new I(Ce,rn,dt,Je)}subtract(m){return this.add(m.negate())}wNAF(m){return O.wNAFCached(this,m,I.normalizeZ)}multiply(m){const A=m;ll("scalar",A,gn,n);const{p:S,f:R}=this.wNAF(A);return I.normalizeZ([S,R])[0]}multiplyUnsafe(m,A=I.ZERO){const S=m;return ll("scalar",S,pi,n),S===pi?P:this.is0()||S===gn?this:O.wNAFCachedUnsafe(this,S,I.normalizeZ,A)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return O.unsafeLadder(this,n).is0()}toAffine(m){return C(this,m)}clearCofactor(){const{h:m}=e;return m===gn?this:this.multiplyUnsafe(m)}static fromHex(m,A=!1){const{d:S,a:R}=e,M=t.BYTES;m=ys("pointHex",m,M),w0("zip215",A);const E=m.slice(),g=m[M-1];E[M-1]=g&-129;const N=tf(E),L=A?l:t.ORDER;ll("pointHex.y",N,pi,L);const v=u(N*N),H=u(v-gn),V=u(S*v-R);let{isValid:z,value:G}=p(H,V);if(!z)throw new Error("Point.fromHex: invalid y coordinate");const re=(G&gn)===gn,X=(g&128)!==0;if(!A&&G===pi&&X)throw new Error("Point.fromHex: x=0 and x_0=1");return X!==re&&(G=u(-G)),I.fromAffine({x:G,y:N})}static fromPrivateKey(m){return B(m).point}toRawBytes(){const{x:m,y:A}=this.toAffine(),S=Kp(A,t.BYTES);return S[S.length-1]|=m&gn?128:0,S}toHex(){return dm(this.toRawBytes())}}I.BASE=new I(e.Gx,e.Gy,gn,u(e.Gx*e.Gy)),I.ZERO=new I(pi,gn,gn,pi);const{BASE:k,ZERO:P}=I,O=v4(I,a*8);function q(h){return xr(h,n)}function F(h){return q(tf(h))}function B(h){const m=t.BYTES;h=ys("private key",h,m);const A=ys("hashed private key",s(h),2*m),S=x(A.slice(0,m)),R=A.slice(m,2*m),M=F(S),E=k.multiply(M),g=E.toRawBytes();return{head:S,prefix:R,scalar:M,point:E,pointBytes:g}}function W(h){return B(h).pointBytes}function j(h=new Uint8Array,...m){const A=oy(...m);return F(s(w(A,ys("context",h),!!i)))}function U(h,m,A={}){h=ys("message",h),i&&(h=i(h));const{prefix:S,scalar:R,pointBytes:M}=B(m),E=j(A.context,S,h),g=k.multiply(E).toRawBytes(),N=j(A.context,g,M,h),L=q(E+N*R);ll("signature.s",L,pi,n);const v=oy(g,Kp(L,t.BYTES));return ys("result",v,t.BYTES*2)}const _=C4;function f(h,m,A,S=_){const{context:R,zip215:M}=S,E=t.BYTES;h=ys("signature",h,2*E),m=ys("message",m),A=ys("publicKey",A,E),M!==void 0&&w0("zip215",M),i&&(m=i(m));const g=tf(h.slice(E,2*E));let N,L,v;try{N=I.fromHex(A,M),L=I.fromHex(h.slice(0,E),M),v=k.multiplyUnsafe(g)}catch{return!1}if(!M&&N.isSmallOrder())return!1;const H=j(R,L.toRawBytes(),N.toRawBytes(),m);return L.add(N.multiplyUnsafe(H)).subtract(v).clearCofactor().equals(I.ZERO)}return k._setWindowSize(8),{CURVE:e,getPublicKey:W,sign:U,verify:f,ExtendedPoint:I,utils:{getExtendedPublicKey:B,randomPrivateKey:()=>o(t.BYTES),precompute(h=8,m=I.BASE){return m._setWindowSize(h),m.multiply(BigInt(3)),m}}}}BigInt(0),BigInt(1);const hm=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),fy=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const I4=BigInt(1),hy=BigInt(2);BigInt(3);const T4=BigInt(5),P4=BigInt(8);function R4(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),i=BigInt(80),s=hm,o=r*r%s*r%s,a=$i(o,hy,s)*o%s,c=$i(a,I4,s)*r%s,l=$i(c,T4,s)*c%s,u=$i(l,e,s)*l%s,d=$i(u,t,s)*u%s,p=$i(d,n,s)*d%s,x=$i(p,i,s)*p%s,w=$i(x,i,s)*p%s,b=$i(w,e,s)*l%s;return{pow_p_5_8:$i(b,hy,s)*r%s,b2:o}}function O4(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function k4(r,e){const t=hm,n=xr(e*e*e,t),i=xr(n*n*e,t),s=R4(r*i).pow_p_5_8;let o=xr(r*n*s,t);const a=xr(e*o*o,t),c=o,l=xr(o*fy,t),u=a===r,d=a===xr(-r,t),p=a===xr(-r*fy,t);return u&&(o=c),(d||p)&&(o=l),p4(o,t)&&(o=xr(-o,t)),{isValid:u||d,value:o}}const D4=dE(hm,void 0,!0),M4={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:D4,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:P4,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:r4,randomBytes:iE,adjustScalarBytes:O4,uvRatio:k4},pE=N4(M4),U4="EdDSA",B4="JWT",Sf=".",lh="base64url",gE="utf8",mE="utf8",$4=":",L4="did",F4="key",py="base58btc",j4="z",q4="K36",H4=32;function pm(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function bE(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?pm(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function yE(r,e){e||(e=r.reduce((i,s)=>i+s.length,0));const t=bE(e);let n=0;for(const i of r)t.set(i,n),n+=i.length;return pm(t)}function W4(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<r.length;i++){var s=r.charAt(i),o=s.charCodeAt(0);if(t[o]!==255)throw new TypeError(s+" is ambiguous");t[o]=i}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var b=0,y=0,C=0,T=w.length;C!==T&&w[C]===0;)C++,b++;for(var I=(T-C)*u+1>>>0,k=new Uint8Array(I);C!==T;){for(var P=w[C],O=0,q=I-1;(P!==0||O<y)&&q!==-1;q--,O++)P+=256*k[q]>>>0,k[q]=P%a>>>0,P=P/a>>>0;if(P!==0)throw new Error("Non-zero carry");y=O,C++}for(var F=I-y;F!==I&&k[F]===0;)F++;for(var B=c.repeat(b);F<I;++F)B+=r.charAt(k[F]);return B}function p(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var b=0;if(w[b]!==" "){for(var y=0,C=0;w[b]===c;)y++,b++;for(var T=(w.length-b)*l+1>>>0,I=new Uint8Array(T);w[b];){var k=t[w.charCodeAt(b)];if(k===255)return;for(var P=0,O=T-1;(k!==0||P<C)&&O!==-1;O--,P++)k+=a*I[O]>>>0,I[O]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");C=P,b++}if(w[b]!==" "){for(var q=T-C;q!==T&&I[q]===0;)q++;for(var F=new Uint8Array(y+(T-q)),B=y;q!==T;)F[B++]=I[q++];return F}}}function x(w){var b=p(w);if(b)return b;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:p,decode:x}}var z4=W4,K4=z4;const wE=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},V4=r=>new TextEncoder().encode(r),G4=r=>new TextDecoder().decode(r);let Y4=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},J4=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return xE(this,e)}},Z4=class{constructor(e){this.decoders=e}or(e){return xE(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const xE=(r,e)=>new Z4({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});let X4=class{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new Y4(e,t,n),this.decoder=new J4(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const uh=({name:r,prefix:e,encode:t,decode:n})=>new X4(r,e,t,n),nd=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:i}=K4(t,e);return uh({prefix:r,name:e,encode:n,decode:s=>wE(i(s))})},Q4=(r,e,t,n)=>{const i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let s=r.length;for(;r[s-1]==="=";)--s;const o=new Uint8Array(s*t/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const d=i[r[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|d,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},e5=(r,e,t)=>{const n=e[e.length-1]==="=",i=(1<<t)-1;let s="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,s+=e[i&a>>o];if(o&&(s+=e[i&a<<t-o]),n)for(;s.length*t&7;)s+="=";return s},Fr=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>uh({prefix:e,name:r,encode(i){return e5(i,n,t)},decode(i){return Q4(i,n,t,r)}}),t5=uh({prefix:"\0",name:"identity",encode:r=>G4(r),decode:r=>V4(r)});var r5=Object.freeze({__proto__:null,identity:t5});const n5=Fr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var i5=Object.freeze({__proto__:null,base2:n5});const s5=Fr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var o5=Object.freeze({__proto__:null,base8:s5});const a5=nd({prefix:"9",name:"base10",alphabet:"0123456789"});var c5=Object.freeze({__proto__:null,base10:a5});const l5=Fr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),u5=Fr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var d5=Object.freeze({__proto__:null,base16:l5,base16upper:u5});const f5=Fr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),h5=Fr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),p5=Fr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),g5=Fr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),m5=Fr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),b5=Fr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),y5=Fr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),w5=Fr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),x5=Fr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var v5=Object.freeze({__proto__:null,base32:f5,base32upper:h5,base32pad:p5,base32padupper:g5,base32hex:m5,base32hexupper:b5,base32hexpad:y5,base32hexpadupper:w5,base32z:x5});const E5=nd({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),A5=nd({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var _5=Object.freeze({__proto__:null,base36:E5,base36upper:A5});const C5=nd({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),S5=nd({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var N5=Object.freeze({__proto__:null,base58btc:C5,base58flickr:S5});const I5=Fr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),T5=Fr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),P5=Fr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),R5=Fr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var O5=Object.freeze({__proto__:null,base64:I5,base64pad:T5,base64url:P5,base64urlpad:R5});const vE=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),k5=vE.reduce((r,e,t)=>(r[t]=e,r),[]),D5=vE.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function M5(r){return r.reduce((e,t)=>(e+=k5[t],e),"")}function U5(r){const e=[];for(const t of r){const n=D5[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const B5=uh({prefix:"🚀",name:"base256emoji",encode:M5,decode:U5});var $5=Object.freeze({__proto__:null,base256emoji:B5}),L5=EE,gy=128,F5=-128,j5=Math.pow(2,31);function EE(r,e,t){e=e||[],t=t||0;for(var n=t;r>=j5;)e[t++]=r&255|gy,r/=128;for(;r&F5;)e[t++]=r&255|gy,r>>>=7;return e[t]=r|0,EE.bytes=t-n+1,e}var q5=Gp,H5=128,my=127;function Gp(r,n){var t=0,n=n||0,i=0,s=n,o,a=r.length;do{if(s>=a)throw Gp.bytes=0,new RangeError("Could not decode varint");o=r[s++],t+=i<28?(o&my)<<i:(o&my)*Math.pow(2,i),i+=7}while(o>=H5);return Gp.bytes=s-n,t}var W5=Math.pow(2,7),z5=Math.pow(2,14),K5=Math.pow(2,21),V5=Math.pow(2,28),G5=Math.pow(2,35),Y5=Math.pow(2,42),J5=Math.pow(2,49),Z5=Math.pow(2,56),X5=Math.pow(2,63),Q5=function(r){return r<W5?1:r<z5?2:r<K5?3:r<V5?4:r<G5?5:r<Y5?6:r<J5?7:r<Z5?8:r<X5?9:10},eN={encode:L5,decode:q5,encodingLength:Q5},AE=eN;const by=(r,e,t=0)=>(AE.encode(r,e,t),e),yy=r=>AE.encodingLength(r),Yp=(r,e)=>{const t=e.byteLength,n=yy(r),i=n+yy(t),s=new Uint8Array(i+t);return by(r,s,0),by(t,s,n),s.set(e,i),new tN(r,t,e,s)};let tN=class{constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}};const _E=({name:r,code:e,encode:t})=>new rN(r,e,t);let rN=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Yp(this.code,t):t.then(n=>Yp(this.code,n))}else throw Error("Unknown type, must be binary type")}};const CE=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),nN=_E({name:"sha2-256",code:18,encode:CE("SHA-256")}),iN=_E({name:"sha2-512",code:19,encode:CE("SHA-512")});var sN=Object.freeze({__proto__:null,sha256:nN,sha512:iN});const SE=0,oN="identity",NE=wE,aN=r=>Yp(SE,NE(r)),cN={code:SE,name:oN,encode:NE,digest:aN};var lN=Object.freeze({__proto__:null,identity:cN});new TextEncoder,new TextDecoder;const wy={...r5,...i5,...o5,...c5,...d5,...v5,..._5,...N5,...O5,...$5};({...sN,...lN});function IE(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const xy=IE("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),C0=IE("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=bE(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),TE={utf8:xy,"utf-8":xy,hex:wy.base16,latin1:C0,ascii:C0,binary:C0,...wy};function dh(r,e="utf8"){const t=TE[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function Vc(r,e="utf8"){const t=TE[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?pm(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function vy(r){return ya(dh(Vc(r,lh),gE))}function Nf(r){return dh(Vc(Bs(r),gE),lh)}function PE(r){const e=Vc(q4,py),t=j4+dh(yE([e,r]),py);return[L4,F4,t].join($4)}function uN(r){return dh(r,lh)}function dN(r){return Vc(r,lh)}function fN(r){return Vc([Nf(r.header),Nf(r.payload)].join(Sf),mE)}function hN(r){return[Nf(r.header),Nf(r.payload),uN(r.signature)].join(Sf)}function Jp(r){const e=r.split(Sf),t=vy(e[0]),n=vy(e[1]),i=dN(e[2]),s=Vc(e.slice(0,2).join(Sf),mE);return{header:t,payload:n,signature:i,data:s}}function Ey(r=iE(H4)){const e=pE.getPublicKey(r);return{secretKey:yE([r,e]),publicKey:e}}async function pN(r,e,t,n,i=le.fromMiliseconds(Date.now())){const s={alg:U4,typ:B4},o=PE(n.publicKey),a=i+t,c={iss:o,sub:r,aud:e,iat:i,exp:a},l=fN({header:s,payload:c}),u=pE.sign(l,n.secretKey.slice(0,32));return hN({header:s,payload:c,signature:u})}var Ay=function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return r.concat(s||Array.prototype.slice.call(e))},gN=(function(){function r(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"}return r})(),mN=(function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r})(),bN=(function(){function r(e,t,n,i){this.name=e,this.version=t,this.os=n,this.bot=i,this.type="bot-device"}return r})(),yN=(function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r})(),wN=(function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r})(),xN=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,vN=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,_y=3,EN=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",xN]],Cy=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function AN(r){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new wN:typeof navigator<"u"?CN(navigator.userAgent):NN()}function _N(r){return r!==""&&EN.reduce(function(e,t){var n=t[0],i=t[1];if(e)return e;var s=i.exec(r);return!!s&&[n,s]},!1)}function CN(r){var e=_N(r);if(!e)return null;var t=e[0],n=e[1];if(t==="searchbot")return new yN;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<_y&&(i=Ay(Ay([],i,!0),IN(_y-i.length),!0)):i=[];var s=i.join("."),o=SN(r),a=vN.exec(r);return a&&a[1]?new bN(t,s,o,a[1]):new gN(t,s,o)}function SN(r){for(var e=0,t=Cy.length;e<t;e++){var n=Cy[e],i=n[0],s=n[1],o=s.exec(r);if(o)return i}return null}function NN(){var r=typeof process<"u"&&process.version;return r?new mN(process.version.slice(1)):null}function IN(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var At={},Sy;function RE(){if(Sy)return At;Sy=1,Object.defineProperty(At,"__esModule",{value:!0}),At.getLocalStorage=At.getLocalStorageOrThrow=At.getCrypto=At.getCryptoOrThrow=At.getLocation=At.getLocationOrThrow=At.getNavigator=At.getNavigatorOrThrow=At.getDocument=At.getDocumentOrThrow=At.getFromWindowOrThrow=At.getFromWindow=void 0;function r(p){let x;return typeof window<"u"&&typeof window[p]<"u"&&(x=window[p]),x}At.getFromWindow=r;function e(p){const x=r(p);if(!x)throw new Error(`${p} is not defined in Window`);return x}At.getFromWindowOrThrow=e;function t(){return e("document")}At.getDocumentOrThrow=t;function n(){return r("document")}At.getDocument=n;function i(){return e("navigator")}At.getNavigatorOrThrow=i;function s(){return r("navigator")}At.getNavigator=s;function o(){return e("location")}At.getLocationOrThrow=o;function a(){return r("location")}At.getLocation=a;function c(){return e("crypto")}At.getCryptoOrThrow=c;function l(){return r("crypto")}At.getCrypto=l;function u(){return e("localStorage")}At.getLocalStorageOrThrow=u;function d(){return r("localStorage")}return At.getLocalStorage=d,At}var $s=RE(),ul={},Ny;function TN(){if(Ny)return ul;Ny=1,Object.defineProperty(ul,"__esModule",{value:!0}),ul.getWindowMetadata=void 0;const r=RE();function e(){let t,n;try{t=r.getDocumentOrThrow(),n=r.getLocationOrThrow()}catch{return null}function i(){const x=t.getElementsByTagName("link"),w=[];for(let b=0;b<x.length;b++){const y=x[b],C=y.getAttribute("rel");if(C&&C.toLowerCase().indexOf("icon")>-1){const T=y.getAttribute("href");if(T)if(T.toLowerCase().indexOf("https:")===-1&&T.toLowerCase().indexOf("http:")===-1&&T.indexOf("//")!==0){let I=n.protocol+"//"+n.host;if(T.indexOf("/")===0)I+=T;else{const k=n.pathname.split("/");k.pop();const P=k.join("/");I+=P+"/"+T}w.push(I)}else if(T.indexOf("//")===0){const I=n.protocol+T;w.push(I)}else w.push(T)}}return w}function s(...x){const w=t.getElementsByTagName("meta");for(let b=0;b<w.length;b++){const y=w[b],C=["itemprop","property","name"].map(T=>y.getAttribute(T)).filter(T=>T?x.includes(T):!1);if(C.length&&C){const T=y.getAttribute("content");if(T)return T}}return""}function o(){let x=s("name","og:site_name","og:title","twitter:title");return x||(x=t.title),x}function a(){return s("description","og:description","twitter:description","keywords")}const c=o(),l=a(),u=n.origin,d=i();return{description:l,url:u,icons:d,name:c}}return ul.getWindowMetadata=e,ul}var PN=TN();function vu(r,{strict:e=!0}={}){return!r||typeof r!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(r):r.startsWith("0x")}function Zp(r){return vu(r,{strict:!1})?Math.ceil((r.length-2)/2):r.length}const OE="2.31.0";let S0={getDocsUrl:({docsBaseUrl:r,docsPath:e="",docsSlug:t})=>e?`${r??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${OE}`};class wa extends Error{constructor(e,t={}){const n=t.cause instanceof wa?t.cause.details:t.cause?.message?t.cause.message:t.details,i=t.cause instanceof wa&&t.cause.docsPath||t.docsPath,s=S0.getDocsUrl?.({...t,docsPath:i}),o=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...s?[`Docs: ${s}`]:[],...n?[`Details: ${n}`]:[],...S0.version?[`Version: ${S0.version}`]:[]].join(`
`);super(o,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=i,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=OE}walk(e){return kE(this,e)}}function kE(r,e){return e?.(r)?r:r&&typeof r=="object"&&"cause"in r&&r.cause!==void 0?kE(r.cause,e):e?null:r}class DE extends wa{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function Gc(r,{dir:e,size:t=32}={}){return typeof r=="string"?RN(r,{dir:e,size:t}):ON(r,{dir:e,size:t})}function RN(r,{dir:e,size:t=32}={}){if(t===null)return r;const n=r.replace("0x","");if(n.length>t*2)throw new DE({size:Math.ceil(n.length/2),targetSize:t,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function ON(r,{dir:e,size:t=32}={}){if(t===null)return r;if(r.length>t)throw new DE({size:r.length,targetSize:t,type:"bytes"});const n=new Uint8Array(t);for(let i=0;i<t;i++){const s=e==="right";n[s?i:t-i-1]=r[s?i:r.length-i-1]}return n}class kN extends wa{constructor({max:e,min:t,signed:n,size:i,value:s}){super(`Number "${s}" is not in safe ${i?`${i*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class DN extends wa{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function Yc(r,{size:e}){if(Zp(r)>e)throw new DN({givenSize:Zp(r),maxSize:e})}function Xp(r,e={}){const{signed:t}=e;e.size&&Yc(r,{size:e.size});const n=BigInt(r);if(!t)return n;const i=(r.length-2)/2,s=(1n<<BigInt(i)*8n-1n)-1n;return n<=s?n:n-BigInt(`0x${"f".padStart(i*2,"f")}`)-1n}function MN(r,e={}){return Number(Xp(r,e))}const UN=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Qp(r,e={}){return typeof r=="number"||typeof r=="bigint"?UE(r,e):typeof r=="string"?LN(r,e):typeof r=="boolean"?BN(r,e):ME(r,e)}function BN(r,e={}){const t=`0x${Number(r)}`;return typeof e.size=="number"?(Yc(t,{size:e.size}),Gc(t,{size:e.size})):t}function ME(r,e={}){let t="";for(let i=0;i<r.length;i++)t+=UN[r[i]];const n=`0x${t}`;return typeof e.size=="number"?(Yc(n,{size:e.size}),Gc(n,{dir:"right",size:e.size})):n}function UE(r,e={}){const{signed:t,size:n}=e,i=BigInt(r);let s;n?t?s=(1n<<BigInt(n)*8n-1n)-1n:s=2n**(BigInt(n)*8n)-1n:typeof r=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof s=="bigint"&&t?-s-1n:0;if(s&&i>s||i<o){const c=typeof r=="bigint"?"n":"";throw new kN({max:s?`${s}${c}`:void 0,min:`${o}${c}`,signed:t,size:n,value:`${r}${c}`})}const a=`0x${(t&&i<0?(1n<<BigInt(n*8))+BigInt(i):i).toString(16)}`;return n?Gc(a,{size:n}):a}const $N=new TextEncoder;function LN(r,e={}){const t=$N.encode(r);return ME(t,e)}const FN=new TextEncoder;function jN(r,e={}){return typeof r=="number"||typeof r=="bigint"?HN(r,e):typeof r=="boolean"?qN(r,e):vu(r)?BE(r,e):$E(r,e)}function qN(r,e={}){const t=new Uint8Array(1);return t[0]=Number(r),typeof e.size=="number"?(Yc(t,{size:e.size}),Gc(t,{size:e.size})):t}const ws={zero:48,nine:57,A:65,F:70,a:97,f:102};function Iy(r){if(r>=ws.zero&&r<=ws.nine)return r-ws.zero;if(r>=ws.A&&r<=ws.F)return r-(ws.A-10);if(r>=ws.a&&r<=ws.f)return r-(ws.a-10)}function BE(r,e={}){let t=r;e.size&&(Yc(t,{size:e.size}),t=Gc(t,{dir:"right",size:e.size}));let n=t.slice(2);n.length%2&&(n=`0${n}`);const i=n.length/2,s=new Uint8Array(i);for(let o=0,a=0;o<i;o++){const c=Iy(n.charCodeAt(a++)),l=Iy(n.charCodeAt(a++));if(c===void 0||l===void 0)throw new wa(`Invalid byte sequence ("${n[a-2]}${n[a-1]}" in "${n}").`);s[o]=c*16+l}return s}function HN(r,e){const t=UE(r,e);return BE(t)}function $E(r,e={}){const t=FN.encode(r);return typeof e.size=="number"?(Yc(t,{size:e.size}),Gc(t,{dir:"right",size:e.size})):t}function LE(r,e){const t=e||"hex",n=r6(vu(r,{strict:!1})?jN(r):r);return t==="bytes"?n:Qp(n)}class WN extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const N0=new WN(8192);function zN(r,e){if(N0.has(`${r}.${e}`))return N0.get(`${r}.${e}`);const t=r.substring(2).toLowerCase(),n=LE($E(t),"bytes"),i=t.split("");for(let o=0;o<40;o+=2)n[o>>1]>>4>=8&&i[o]&&(i[o]=i[o].toUpperCase()),(n[o>>1]&15)>=8&&i[o+1]&&(i[o+1]=i[o+1].toUpperCase());const s=`0x${i.join("")}`;return N0.set(`${r}.${e}`,s),s}function KN(r){const e=LE(`0x${r.substring(4)}`).substring(26);return zN(`0x${e}`)}async function VN({hash:r,signature:e}){const t=vu(r)?r:Qp(r),{secp256k1:n}=await Nr(async()=>{const{secp256k1:o}=await import("./secp256k1--dMZLd6c.js");return{secp256k1:o}},__vite__mapDeps([0,1]));return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:d,yParity:p}=e,x=Number(p??d),w=Ty(x);return new n.Signature(Xp(l),Xp(u)).addRecoveryBit(w)}const o=vu(e)?e:Qp(e);if(Zp(o)!==65)throw new Error("invalid signature length");const a=MN(`0x${o.slice(130)}`),c=Ty(a);return n.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(t.substring(2)).toHex(!1)}`}function Ty(r){if(r===0||r===1)return r;if(r===27)return 0;if(r===28)return 1;throw new Error("Invalid yParityOrV value")}async function GN({hash:r,signature:e}){return KN(await VN({hash:r,signature:e}))}function YN(r){if(r.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<r.length;l++){const u=r.charAt(l),d=u.charCodeAt(0);if(e[d]!==255)throw new TypeError(u+" is ambiguous");e[d]=l}const t=r.length,n=r.charAt(0),i=Math.log(t)/Math.log(256),s=Math.log(256)/Math.log(t);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,p=0;const x=l.length;for(;p!==x&&l[p]===0;)p++,u++;const w=(x-p)*s+1>>>0,b=new Uint8Array(w);for(;p!==x;){let T=l[p],I=0;for(let k=w-1;(T!==0||I<d)&&k!==-1;k--,I++)T+=256*b[k]>>>0,b[k]=T%t>>>0,T=T/t>>>0;if(T!==0)throw new Error("Non-zero carry");d=I,p++}let y=w-d;for(;y!==w&&b[y]===0;)y++;let C=n.repeat(u);for(;y<w;++y)C+=r.charAt(b[y]);return C}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,p=0;for(;l[u]===n;)d++,u++;const x=(l.length-u)*i+1>>>0,w=new Uint8Array(x);for(;u<l.length;){const T=l.charCodeAt(u);if(T>255)return;let I=e[T];if(I===255)return;let k=0;for(let P=x-1;(I!==0||k<p)&&P!==-1;P--,k++)I+=t*w[P]>>>0,w[P]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");p=k,u++}let b=x-p;for(;b!==x&&w[b]===0;)b++;const y=new Uint8Array(d+(x-b));let C=d;for(;b!==x;)y[C++]=w[b++];return y}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+t+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var JN="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Jc=YN(JN);function ZN(r){const e=r.length;let t=0,n=0;for(;n<e;){let i=r.charCodeAt(n++);if((i&4294967168)===0){t++;continue}else if((i&4294965248)===0)t+=2;else{if(i>=55296&&i<=56319&&n<e){const s=r.charCodeAt(n);(s&64512)===56320&&(++n,i=((i&1023)<<10)+(s&1023)+65536)}(i&4294901760)===0?t+=3:t+=4}}return t}function XN(r,e,t){const n=r.length;let i=t,s=0;for(;s<n;){let o=r.charCodeAt(s++);if((o&4294967168)===0){e[i++]=o;continue}else if((o&4294965248)===0)e[i++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&s<n){const a=r.charCodeAt(s);(a&64512)===56320&&(++s,o=((o&1023)<<10)+(a&1023)+65536)}(o&4294901760)===0?(e[i++]=o>>12&15|224,e[i++]=o>>6&63|128):(e[i++]=o>>18&7|240,e[i++]=o>>12&63|128,e[i++]=o>>6&63|128)}e[i++]=o&63|128}}const QN=new TextEncoder,eI=50;function tI(r,e,t){QN.encodeInto(r,e.subarray(t))}function rI(r,e,t){r.length>eI?tI(r,e,t):XN(r,e,t)}const nI=4096;function FE(r,e,t){let n=e;const i=n+t,s=[];let o="";for(;n<i;){const a=r[n++];if((a&128)===0)s.push(a);else if((a&224)===192){const c=r[n++]&63;s.push((a&31)<<6|c)}else if((a&240)===224){const c=r[n++]&63,l=r[n++]&63;s.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=r[n++]&63,l=r[n++]&63,u=r[n++]&63;let d=(a&7)<<18|c<<12|l<<6|u;d>65535&&(d-=65536,s.push(d>>>10&1023|55296),d=56320|d&1023),s.push(d)}else s.push(a);s.length>=nI&&(o+=String.fromCharCode(...s),s.length=0)}return s.length>0&&(o+=String.fromCharCode(...s)),o}const iI=new TextDecoder,sI=200;function oI(r,e,t){const n=r.subarray(e,e+t);return iI.decode(n)}function aI(r,e,t){return t>sI?oI(r,e,t):FE(r,e,t)}class Od{constructor(e,t){this.type=e,this.data=t}}class Un extends Error{constructor(e){super(e);const t=Object.create(Un.prototype);Object.setPrototypeOf(this,t),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:Un.name})}}const dl=4294967295;function cI(r,e,t){const n=t/4294967296,i=t;r.setUint32(e,n),r.setUint32(e+4,i)}function jE(r,e,t){const n=Math.floor(t/4294967296),i=t;r.setUint32(e,n),r.setUint32(e+4,i)}function qE(r,e){const t=r.getInt32(e),n=r.getUint32(e+4);return t*4294967296+n}function lI(r,e){const t=r.getUint32(e),n=r.getUint32(e+4);return t*4294967296+n}const uI=-1,dI=4294967296-1,fI=17179869184-1;function hI({sec:r,nsec:e}){if(r>=0&&e>=0&&r<=fI)if(e===0&&r<=dI){const t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,r),t}else{const t=r/4294967296,n=r&4294967295,i=new Uint8Array(8),s=new DataView(i.buffer);return s.setUint32(0,e<<2|t&3),s.setUint32(4,n),i}else{const t=new Uint8Array(12),n=new DataView(t.buffer);return n.setUint32(0,e),jE(n,4,r),t}}function pI(r){const e=r.getTime(),t=Math.floor(e/1e3),n=(e-t*1e3)*1e6,i=Math.floor(n/1e9);return{sec:t+i,nsec:n-i*1e9}}function gI(r){if(r instanceof Date){const e=pI(r);return hI(e)}else return null}function mI(r){const e=new DataView(r.buffer,r.byteOffset,r.byteLength);switch(r.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const t=e.getUint32(0),n=e.getUint32(4),i=(t&3)*4294967296+n,s=t>>>2;return{sec:i,nsec:s}}case 12:{const t=qE(e,4),n=e.getUint32(0);return{sec:t,nsec:n}}default:throw new Un(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${r.length}`)}}function bI(r){const e=mI(r);return new Date(e.sec*1e3+e.nsec/1e6)}const yI={type:uI,encode:gI,decode:bI};class If{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(yI)}register({type:e,encode:t,decode:n}){if(e>=0)this.encoders[e]=t,this.decoders[e]=n;else{const i=-1-e;this.builtInEncoders[i]=t,this.builtInDecoders[i]=n}}tryToEncode(e,t){for(let n=0;n<this.builtInEncoders.length;n++){const i=this.builtInEncoders[n];if(i!=null){const s=i(e,t);if(s!=null){const o=-1-n;return new Od(o,s)}}}for(let n=0;n<this.encoders.length;n++){const i=this.encoders[n];if(i!=null){const s=i(e,t);if(s!=null){const o=n;return new Od(o,s)}}}return e instanceof Od?e:null}decode(e,t,n){const i=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return i?i(e,t,n):new Od(t,e)}}If.defaultCodec=new If;function wI(r){return r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer}function eg(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):wI(r)?new Uint8Array(r):Uint8Array.from(r)}const xI=100,vI=2048;let EI=class HE{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??If.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??xI,this.initialBufferSize=e?.initialBufferSize??vI,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new HE({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,t){if(t>this.maxDepth)throw new Error(`Too deep objects in depth ${t}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,t)}ensureBufferSizeToWrite(e){const t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(t*2)}resizeBuffer(e){const t=new ArrayBuffer(e),n=new Uint8Array(t),i=new DataView(t);n.set(this.bytes),this.view=i,this.bytes=n}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const n=ZN(e);this.ensureBufferSizeToWrite(5+n),this.writeStringHeader(n),rI(e,this.bytes,this.pos),this.pos+=n}encodeObject(e,t){const n=this.extensionCodec.tryToEncode(e,this.context);if(n!=null)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,t);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else if(t<4294967296)this.writeU8(198),this.writeU32(t);else throw new Error(`Too large binary: ${t}`);const n=eg(e);this.writeU8a(n)}encodeArray(e,t){const n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else if(n<4294967296)this.writeU8(221),this.writeU32(n);else throw new Error(`Too large array: ${n}`);for(const i of e)this.doEncode(i,t+1)}countWithoutUndefined(e,t){let n=0;for(const i of t)e[i]!==void 0&&n++;return n}encodeMap(e,t){const n=Object.keys(e);this.sortKeys&&n.sort();const i=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(i<16)this.writeU8(128+i);else if(i<65536)this.writeU8(222),this.writeU16(i);else if(i<4294967296)this.writeU8(223),this.writeU32(i);else throw new Error(`Too large map object: ${i}`);for(const s of n){const o=e[s];this.ignoreUndefined&&o===void 0||(this.encodeString(s),this.doEncode(o,t+1))}}encodeExtension(e){if(typeof e.data=="function"){const n=e.data(this.pos+6),i=n.length;if(i>=4294967296)throw new Error(`Too large extension object: ${i}`);this.writeU8(201),this.writeU32(i),this.writeI8(e.type),this.writeU8a(n);return}const t=e.data.length;if(t===1)this.writeU8(212);else if(t===2)this.writeU8(213);else if(t===4)this.writeU8(214);else if(t===8)this.writeU8(215);else if(t===16)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else if(t<4294967296)this.writeU8(201),this.writeU32(t);else throw new Error(`Too large extension object: ${t}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),cI(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),jE(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function AI(r,e){return new EI(e).encodeSharedRef(r)}function I0(r){return`${r<0?"-":""}0x${Math.abs(r).toString(16).padStart(2,"0")}`}const _I=16,CI=16;class SI{constructor(e=_I,t=CI){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=t,this.caches=[];for(let n=0;n<this.maxKeyLength;n++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,n){const i=this.caches[n-1];e:for(const s of i){const o=s.bytes;for(let a=0;a<n;a++)if(o[a]!==e[t+a])continue e;return s.str}return null}store(e,t){const n=this.caches[e.length-1],i={bytes:e,str:t};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=i:n.push(i)}decode(e,t,n){const i=this.find(e,t,n);if(i!=null)return this.hit++,i;this.miss++;const s=FE(e,t,n),o=Uint8Array.prototype.slice.call(e,t,t+n);return this.store(o,s),s}}const tg="array",Dl="map_key",WE="map_value",NI=r=>{if(typeof r=="string"||typeof r=="number")return r;throw new Un("The type of key must be string or number but "+typeof r)};class II{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const t=this.getUninitializedStateFromPool();t.type=tg,t.position=0,t.size=e,t.array=new Array(e)}pushMapState(e){const t=this.getUninitializedStateFromPool();t.type=Dl,t.readCount=0,t.size=e,t.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===tg){const n=e;n.size=0,n.array=void 0,n.position=0,n.type=void 0}if(e.type===Dl||e.type===WE){const n=e;n.size=0,n.map=void 0,n.readCount=0,n.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const fl=-1,gm=new DataView(new ArrayBuffer(0)),TI=new Uint8Array(gm.buffer);try{gm.getInt8(0)}catch(r){if(!(r instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const Py=new RangeError("Insufficient data"),PI=new SI;let RI=class zE{constructor(e){this.totalPos=0,this.pos=0,this.view=gm,this.bytes=TI,this.headByte=fl,this.stack=new II,this.entered=!1,this.extensionCodec=e?.extensionCodec??If.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??dl,this.maxBinLength=e?.maxBinLength??dl,this.maxArrayLength=e?.maxArrayLength??dl,this.maxMapLength=e?.maxMapLength??dl,this.maxExtLength=e?.maxExtLength??dl,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:PI,this.mapKeyConverter=e?.mapKeyConverter??NI}clone(){return new zE({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=fl,this.stack.reset()}setBuffer(e){const t=eg(e);this.bytes=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===fl&&!this.hasRemaining(1))this.setBuffer(e);else{const t=this.bytes.subarray(this.pos),n=eg(e),i=new Uint8Array(t.length+n.length);i.set(t),i.set(n,t.length),this.setBuffer(i)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:t,pos:n}=this;return new RangeError(`Extra ${t.byteLength-n} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let t=!1,n;for await(const a of e){if(t)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{n=this.doDecodeSync(),t=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(t){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return n}const{headByte:i,pos:s,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${I0(i)} at ${o} (${s} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,t){if(this.entered){yield*this.clone().decodeMultiAsync(e,t);return}try{this.entered=!0;let n=t,i=-1;for await(const s of e){if(t&&i===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(s),n&&(i=this.readArraySize(),n=!1,this.complete());try{for(;yield this.doDecodeSync(),--i!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let t;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){const i=e-128;if(i!==0){this.pushMapState(i),this.complete();continue e}else t={}}else if(e<160){const i=e-144;if(i!==0){this.pushArrayState(i),this.complete();continue e}else t=[]}else{const i=e-160;t=this.decodeString(i,0)}else if(e===192)t=null;else if(e===194)t=!1;else if(e===195)t=!0;else if(e===202)t=this.readF32();else if(e===203)t=this.readF64();else if(e===204)t=this.readU8();else if(e===205)t=this.readU16();else if(e===206)t=this.readU32();else if(e===207)this.useBigInt64?t=this.readU64AsBigInt():t=this.readU64();else if(e===208)t=this.readI8();else if(e===209)t=this.readI16();else if(e===210)t=this.readI32();else if(e===211)this.useBigInt64?t=this.readI64AsBigInt():t=this.readI64();else if(e===217){const i=this.lookU8();t=this.decodeString(i,1)}else if(e===218){const i=this.lookU16();t=this.decodeString(i,2)}else if(e===219){const i=this.lookU32();t=this.decodeString(i,4)}else if(e===220){const i=this.readU16();if(i!==0){this.pushArrayState(i),this.complete();continue e}else t=[]}else if(e===221){const i=this.readU32();if(i!==0){this.pushArrayState(i),this.complete();continue e}else t=[]}else if(e===222){const i=this.readU16();if(i!==0){this.pushMapState(i),this.complete();continue e}else t={}}else if(e===223){const i=this.readU32();if(i!==0){this.pushMapState(i),this.complete();continue e}else t={}}else if(e===196){const i=this.lookU8();t=this.decodeBinary(i,1)}else if(e===197){const i=this.lookU16();t=this.decodeBinary(i,2)}else if(e===198){const i=this.lookU32();t=this.decodeBinary(i,4)}else if(e===212)t=this.decodeExtension(1,0);else if(e===213)t=this.decodeExtension(2,0);else if(e===214)t=this.decodeExtension(4,0);else if(e===215)t=this.decodeExtension(8,0);else if(e===216)t=this.decodeExtension(16,0);else if(e===199){const i=this.lookU8();t=this.decodeExtension(i,1)}else if(e===200){const i=this.lookU16();t=this.decodeExtension(i,2)}else if(e===201){const i=this.lookU32();t=this.decodeExtension(i,4)}else throw new Un(`Unrecognized type byte: ${I0(e)}`);this.complete();const n=this.stack;for(;n.length>0;){const i=n.top();if(i.type===tg)if(i.array[i.position]=t,i.position++,i.position===i.size)t=i.array,n.release(i);else continue e;else if(i.type===Dl){if(t==="__proto__")throw new Un("The key __proto__ is not allowed");i.key=this.mapKeyConverter(t),i.type=WE;continue e}else if(i.map[i.key]=t,i.readCount++,i.readCount===i.size)t=i.map,n.release(i);else{i.key=null,i.type=Dl;continue e}}return t}}readHeadByte(){return this.headByte===fl&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=fl}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new Un(`Unrecognized array type byte: ${I0(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new Un(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new Un(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,t){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,t):this.decodeBinary(e,t)}decodeUtf8String(e,t){if(e>this.maxStrLength)throw new Un(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw Py;const n=this.pos+t;let i;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?i=this.keyDecoder.decode(this.bytes,n,e):i=aI(this.bytes,n,e),this.pos+=t+e,i}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===Dl:!1}decodeBinary(e,t){if(e>this.maxBinLength)throw new Un(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw Py;const n=this.pos+t,i=this.bytes.subarray(n,n+e);return this.pos+=t+e,i}decodeExtension(e,t){if(e>this.maxExtLength)throw new Un(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const n=this.view.getInt8(this.pos+t),i=this.decodeBinary(e,t+1);return this.extensionCodec.decode(i,n,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=lI(this.view,this.pos);return this.pos+=8,e}readI64(){const e=qE(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function OI(r,e){return new RI(e).decode(r)}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function kI(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function KE(r,e){return Array.isArray(e)?e.length===0?!0:r?e.every(t=>typeof t=="string"):e.every(t=>Number.isSafeInteger(t)):!1}function Tf(r,e){if(typeof e!="string")throw new Error(`${r}: string expected`);return!0}function mm(r){if(!Number.isSafeInteger(r))throw new Error(`invalid integer: ${r}`)}function rg(r){if(!Array.isArray(r))throw new Error("array expected")}function Pf(r,e){if(!KE(!0,e))throw new Error(`${r}: array of strings expected`)}function DI(r,e){if(!KE(!1,e))throw new Error(`${r}: array of numbers expected`)}function MI(...r){const e=s=>s,t=(s,o)=>a=>s(o(a)),n=r.map(s=>s.encode).reduceRight(t,e),i=r.map(s=>s.decode).reduce(t,e);return{encode:n,decode:i}}function UI(r){const e=typeof r=="string"?r.split(""):r,t=e.length;Pf("alphabet",e);const n=new Map(e.map((i,s)=>[i,s]));return{encode:i=>(rg(i),i.map(s=>{if(!Number.isSafeInteger(s)||s<0||s>=t)throw new Error(`alphabet.encode: digit index outside alphabet "${s}". Allowed: ${r}`);return e[s]})),decode:i=>(rg(i),i.map(s=>{Tf("alphabet.decode",s);const o=n.get(s);if(o===void 0)throw new Error(`Unknown letter: "${s}". Allowed: ${r}`);return o}))}}function BI(r=""){return Tf("join",r),{encode:e=>(Pf("join.decode",e),e.join(r)),decode:e=>(Tf("join.decode",e),e.split(r))}}function $I(r,e="="){return mm(r),Tf("padding",e),{encode(t){for(Pf("padding.encode",t);t.length*r%8;)t.push(e);return t},decode(t){Pf("padding.decode",t);let n=t.length;if(n*r%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;n>0&&t[n-1]===e;n--)if((n-1)*r%8===0)throw new Error("padding: invalid, string has too much padding");return t.slice(0,n)}}}const VE=(r,e)=>e===0?r:VE(e,r%e),Rf=(r,e)=>r+(e-VE(r,e)),T0=(()=>{let r=[];for(let e=0;e<40;e++)r.push(2**e);return r})();function Ry(r,e,t,n){if(rg(r),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(t<=0||t>32)throw new Error(`convertRadix2: wrong to=${t}`);if(Rf(e,t)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${t} carryBits=${Rf(e,t)}`);let i=0,s=0;const o=T0[e],a=T0[t]-1,c=[];for(const l of r){if(mm(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${e}`);if(i=i<<e|l,s+e>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${e}`);for(s+=e;s>=t;s-=t)c.push((i>>s-t&a)>>>0);const u=T0[s];if(u===void 0)throw new Error("invalid carry");i&=u-1}if(i=i<<t-s&a,!n&&s>=e)throw new Error("Excess padding");if(!n&&i>0)throw new Error(`Non-zero padding: ${i}`);return n&&s>0&&c.push(i>>>0),c}function LI(r,e=!1){if(mm(r),r<=0||r>32)throw new Error("radix2: bits should be in (0..32]");if(Rf(8,r)>32||Rf(r,8)>32)throw new Error("radix2: carry overflow");return{encode:t=>{if(!kI(t))throw new Error("radix2.encode input should be Uint8Array");return Ry(Array.from(t),8,r,!e)},decode:t=>(DI("radix2.decode",t),Uint8Array.from(Ry(t,r,8,e)))}}const FI=MI(LI(5),UI("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),$I(5),BI(""));function bm(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function GE(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?bm(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function Ml(r,e){e||(e=r.reduce((i,s)=>i+s.length,0));const t=GE(e);let n=0;for(const i of r)t.set(i,n),n+=i.length;return bm(t)}function jI(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<r.length;i++){var s=r.charAt(i),o=s.charCodeAt(0);if(t[o]!==255)throw new TypeError(s+" is ambiguous");t[o]=i}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var b=0,y=0,C=0,T=w.length;C!==T&&w[C]===0;)C++,b++;for(var I=(T-C)*u+1>>>0,k=new Uint8Array(I);C!==T;){for(var P=w[C],O=0,q=I-1;(P!==0||O<y)&&q!==-1;q--,O++)P+=256*k[q]>>>0,k[q]=P%a>>>0,P=P/a>>>0;if(P!==0)throw new Error("Non-zero carry");y=O,C++}for(var F=I-y;F!==I&&k[F]===0;)F++;for(var B=c.repeat(b);F<I;++F)B+=r.charAt(k[F]);return B}function p(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var b=0;if(w[b]!==" "){for(var y=0,C=0;w[b]===c;)y++,b++;for(var T=(w.length-b)*l+1>>>0,I=new Uint8Array(T);w[b];){var k=t[w.charCodeAt(b)];if(k===255)return;for(var P=0,O=T-1;(k!==0||P<C)&&O!==-1;O--,P++)k+=a*I[O]>>>0,I[O]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");C=P,b++}if(w[b]!==" "){for(var q=T-C;q!==T&&I[q]===0;)q++;for(var F=new Uint8Array(y+(T-q)),B=y;q!==T;)F[B++]=I[q++];return F}}}function x(w){var b=p(w);if(b)return b;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:p,decode:x}}var qI=jI,HI=qI;const WI=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},zI=r=>new TextEncoder().encode(r),KI=r=>new TextDecoder().decode(r);class VI{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class GI{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return YE(this,e)}}class YI{constructor(e){this.decoders=e}or(e){return YE(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const YE=(r,e)=>new YI({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class JI{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new VI(e,t,n),this.decoder=new GI(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const fh=({name:r,prefix:e,encode:t,decode:n})=>new JI(r,e,t,n),id=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:i}=HI(t,e);return fh({prefix:r,name:e,encode:n,decode:s=>WI(i(s))})},ZI=(r,e,t,n)=>{const i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let s=r.length;for(;r[s-1]==="=";)--s;const o=new Uint8Array(s*t/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const d=i[r[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|d,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},XI=(r,e,t)=>{const n=e[e.length-1]==="=",i=(1<<t)-1;let s="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,s+=e[i&a>>o];if(o&&(s+=e[i&a<<t-o]),n)for(;s.length*t&7;)s+="=";return s},jr=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>fh({prefix:e,name:r,encode(i){return XI(i,n,t)},decode(i){return ZI(i,n,t,r)}}),QI=fh({prefix:"\0",name:"identity",encode:r=>KI(r),decode:r=>zI(r)}),eT=Object.freeze(Object.defineProperty({__proto__:null,identity:QI},Symbol.toStringTag,{value:"Module"})),tT=jr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),rT=Object.freeze(Object.defineProperty({__proto__:null,base2:tT},Symbol.toStringTag,{value:"Module"})),nT=jr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),iT=Object.freeze(Object.defineProperty({__proto__:null,base8:nT},Symbol.toStringTag,{value:"Module"})),sT=id({prefix:"9",name:"base10",alphabet:"0123456789"}),oT=Object.freeze(Object.defineProperty({__proto__:null,base10:sT},Symbol.toStringTag,{value:"Module"})),aT=jr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),cT=jr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),lT=Object.freeze(Object.defineProperty({__proto__:null,base16:aT,base16upper:cT},Symbol.toStringTag,{value:"Module"})),uT=jr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),dT=jr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),fT=jr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),hT=jr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),pT=jr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),gT=jr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),mT=jr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),bT=jr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),yT=jr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),wT=Object.freeze(Object.defineProperty({__proto__:null,base32:uT,base32hex:pT,base32hexpad:mT,base32hexpadupper:bT,base32hexupper:gT,base32pad:fT,base32padupper:hT,base32upper:dT,base32z:yT},Symbol.toStringTag,{value:"Module"})),xT=id({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),vT=id({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),ET=Object.freeze(Object.defineProperty({__proto__:null,base36:xT,base36upper:vT},Symbol.toStringTag,{value:"Module"})),AT=id({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),_T=id({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),CT=Object.freeze(Object.defineProperty({__proto__:null,base58btc:AT,base58flickr:_T},Symbol.toStringTag,{value:"Module"})),ST=jr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),NT=jr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),IT=jr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),TT=jr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),PT=Object.freeze(Object.defineProperty({__proto__:null,base64:ST,base64pad:NT,base64url:IT,base64urlpad:TT},Symbol.toStringTag,{value:"Module"})),JE=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),RT=JE.reduce((r,e,t)=>(r[t]=e,r),[]),OT=JE.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function kT(r){return r.reduce((e,t)=>(e+=RT[t],e),"")}function DT(r){const e=[];for(const t of r){const n=OT[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const MT=fh({prefix:"🚀",name:"base256emoji",encode:kT,decode:DT}),UT=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:MT},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Oy={...eT,...rT,...iT,...oT,...lT,...wT,...ET,...CT,...PT,...UT};function ZE(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const ky=ZE("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),P0=ZE("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=GE(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),XE={utf8:ky,"utf-8":ky,hex:Oy.base16,latin1:P0,ascii:P0,binary:P0,...Oy};function ii(r,e="utf8"){const t=XE[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?bm(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function In(r,e="utf8"){const t=XE[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}const BT={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var R0,Dy;function QE(){if(Dy)return R0;Dy=1;const r="Input must be an string, Buffer or Uint8Array";function e(o){let a;if(o instanceof Uint8Array)a=o;else if(typeof o=="string")a=new TextEncoder().encode(o);else throw new Error(r);return a}function t(o){return Array.prototype.map.call(o,function(a){return(a<16?"0":"")+a.toString(16)}).join("")}function n(o){return(4294967296+o).toString(16).substring(1)}function i(o,a,c){let l=`
`+o+" = ";for(let u=0;u<a.length;u+=2){if(c===32)l+=n(a[u]).toUpperCase(),l+=" ",l+=n(a[u+1]).toUpperCase();else if(c===64)l+=n(a[u+1]).toUpperCase(),l+=n(a[u]).toUpperCase();else throw new Error("Invalid size "+c);u%6===4?l+=`
`+new Array(o.length+4).join(" "):u<a.length-2&&(l+=" ")}console.log(l)}function s(o,a,c){let l=new Date().getTime();const u=new Uint8Array(a);for(let p=0;p<a;p++)u[p]=p%256;const d=new Date().getTime();console.log("Generated random input in "+(d-l)+"ms"),l=d;for(let p=0;p<c;p++){const x=o(u),w=new Date().getTime(),b=w-l;l=w,console.log("Hashed in "+b+"ms: "+x.substring(0,20)+"..."),console.log(Math.round(a/(1<<20)/(b/1e3)*100)/100+" MB PER SECOND")}}return R0={normalizeInput:e,toHex:t,debugPrint:i,testSpeed:s},R0}var O0,My;function $T(){if(My)return O0;My=1;const r=QE();function e(C,T,I){const k=C[T]+C[I];let P=C[T+1]+C[I+1];k>=4294967296&&P++,C[T]=k,C[T+1]=P}function t(C,T,I,k){let P=C[T]+I;I<0&&(P+=4294967296);let O=C[T+1]+k;P>=4294967296&&O++,C[T]=P,C[T+1]=O}function n(C,T){return C[T]^C[T+1]<<8^C[T+2]<<16^C[T+3]<<24}function i(C,T,I,k,P,O){const q=l[P],F=l[P+1],B=l[O],W=l[O+1];e(c,C,T),t(c,C,q,F);let j=c[k]^c[C],U=c[k+1]^c[C+1];c[k]=U,c[k+1]=j,e(c,I,k),j=c[T]^c[I],U=c[T+1]^c[I+1],c[T]=j>>>24^U<<8,c[T+1]=U>>>24^j<<8,e(c,C,T),t(c,C,B,W),j=c[k]^c[C],U=c[k+1]^c[C+1],c[k]=j>>>16^U<<16,c[k+1]=U>>>16^j<<16,e(c,I,k),j=c[T]^c[I],U=c[T+1]^c[I+1],c[T]=U>>>31^j<<1,c[T+1]=j>>>31^U<<1}const s=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],a=new Uint8Array(o.map(function(C){return C*2})),c=new Uint32Array(32),l=new Uint32Array(32);function u(C,T){let I=0;for(I=0;I<16;I++)c[I]=C.h[I],c[I+16]=s[I];for(c[24]=c[24]^C.t,c[25]=c[25]^C.t/4294967296,T&&(c[28]=~c[28],c[29]=~c[29]),I=0;I<32;I++)l[I]=n(C.b,4*I);for(I=0;I<12;I++)i(0,8,16,24,a[I*16+0],a[I*16+1]),i(2,10,18,26,a[I*16+2],a[I*16+3]),i(4,12,20,28,a[I*16+4],a[I*16+5]),i(6,14,22,30,a[I*16+6],a[I*16+7]),i(0,10,20,30,a[I*16+8],a[I*16+9]),i(2,12,22,24,a[I*16+10],a[I*16+11]),i(4,14,16,26,a[I*16+12],a[I*16+13]),i(6,8,18,28,a[I*16+14],a[I*16+15]);for(I=0;I<16;I++)C.h[I]=C.h[I]^c[I]^c[I+16]}const d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function p(C,T,I,k){if(C===0||C>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(T&&T.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(I&&I.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(k&&k.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const P={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:C};d.fill(0),d[0]=C,T&&(d[1]=T.length),d[2]=1,d[3]=1,I&&d.set(I,32),k&&d.set(k,48);for(let O=0;O<16;O++)P.h[O]=s[O]^n(d,O*4);return T&&(x(P,T),P.c=128),P}function x(C,T){for(let I=0;I<T.length;I++)C.c===128&&(C.t+=C.c,u(C,!1),C.c=0),C.b[C.c++]=T[I]}function w(C){for(C.t+=C.c;C.c<128;)C.b[C.c++]=0;u(C,!0);const T=new Uint8Array(C.outlen);for(let I=0;I<C.outlen;I++)T[I]=C.h[I>>2]>>8*(I&3);return T}function b(C,T,I,k,P){I=I||64,C=r.normalizeInput(C),k&&(k=r.normalizeInput(k)),P&&(P=r.normalizeInput(P));const O=p(I,T,k,P);return x(O,C),w(O)}function y(C,T,I,k,P){const O=b(C,T,I,k,P);return r.toHex(O)}return O0={blake2b:b,blake2bHex:y,blake2bInit:p,blake2bUpdate:x,blake2bFinal:w},O0}var k0,Uy;function LT(){if(Uy)return k0;Uy=1;const r=QE();function e(w,b){return w[b]^w[b+1]<<8^w[b+2]<<16^w[b+3]<<24}function t(w,b,y,C,T,I){o[w]=o[w]+o[b]+T,o[C]=n(o[C]^o[w],16),o[y]=o[y]+o[C],o[b]=n(o[b]^o[y],12),o[w]=o[w]+o[b]+I,o[C]=n(o[C]^o[w],8),o[y]=o[y]+o[C],o[b]=n(o[b]^o[y],7)}function n(w,b){return w>>>b^w<<32-b}const i=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),s=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),o=new Uint32Array(16),a=new Uint32Array(16);function c(w,b){let y=0;for(y=0;y<8;y++)o[y]=w.h[y],o[y+8]=i[y];for(o[12]^=w.t,o[13]^=w.t/4294967296,b&&(o[14]=~o[14]),y=0;y<16;y++)a[y]=e(w.b,4*y);for(y=0;y<10;y++)t(0,4,8,12,a[s[y*16+0]],a[s[y*16+1]]),t(1,5,9,13,a[s[y*16+2]],a[s[y*16+3]]),t(2,6,10,14,a[s[y*16+4]],a[s[y*16+5]]),t(3,7,11,15,a[s[y*16+6]],a[s[y*16+7]]),t(0,5,10,15,a[s[y*16+8]],a[s[y*16+9]]),t(1,6,11,12,a[s[y*16+10]],a[s[y*16+11]]),t(2,7,8,13,a[s[y*16+12]],a[s[y*16+13]]),t(3,4,9,14,a[s[y*16+14]],a[s[y*16+15]]);for(y=0;y<8;y++)w.h[y]^=o[y]^o[y+8]}function l(w,b){if(!(w>0&&w<=32))throw new Error("Incorrect output length, should be in [1, 32]");const y=b?b.length:0;if(b&&!(y>0&&y<=32))throw new Error("Incorrect key length, should be in [1, 32]");const C={h:new Uint32Array(i),b:new Uint8Array(64),c:0,t:0,outlen:w};return C.h[0]^=16842752^y<<8^w,y>0&&(u(C,b),C.c=64),C}function u(w,b){for(let y=0;y<b.length;y++)w.c===64&&(w.t+=w.c,c(w,!1),w.c=0),w.b[w.c++]=b[y]}function d(w){for(w.t+=w.c;w.c<64;)w.b[w.c++]=0;c(w,!0);const b=new Uint8Array(w.outlen);for(let y=0;y<w.outlen;y++)b[y]=w.h[y>>2]>>8*(y&3)&255;return b}function p(w,b,y){y=y||32,w=r.normalizeInput(w);const C=l(y,b);return u(C,w),d(C)}function x(w,b,y){const C=p(w,b,y);return r.toHex(C)}return k0={blake2s:p,blake2sHex:x,blake2sInit:l,blake2sUpdate:u,blake2sFinal:d},k0}var D0,By;function FT(){if(By)return D0;By=1;const r=$T(),e=LT();return D0={blake2b:r.blake2b,blake2bHex:r.blake2bHex,blake2bInit:r.blake2bInit,blake2bUpdate:r.blake2bUpdate,blake2bFinal:r.blake2bFinal,blake2s:e.blake2s,blake2sHex:e.blake2sHex,blake2sInit:e.blake2sInit,blake2sUpdate:e.blake2sUpdate,blake2sFinal:e.blake2sFinal},D0}var jT=FT(),qT={};const HT=":";function fa(r){const[e,t]=r.split(HT);return{namespace:e,reference:t}}function e2(r,e){return r.includes(":")?[r]:e.chains||[]}var WT=Object.defineProperty,zT=Object.defineProperties,KT=Object.getOwnPropertyDescriptors,$y=Object.getOwnPropertySymbols,VT=Object.prototype.hasOwnProperty,GT=Object.prototype.propertyIsEnumerable,ng=(r,e,t)=>e in r?WT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ly=(r,e)=>{for(var t in e||(e={}))VT.call(e,t)&&ng(r,t,e[t]);if($y)for(var t of $y(e))GT.call(e,t)&&ng(r,t,e[t]);return r},YT=(r,e)=>zT(r,KT(e)),Fy=(r,e,t)=>ng(r,typeof e!="symbol"?e+"":e,t);const JT="ReactNative",jn={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},ZT="js";function Of(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function No(){return!$s.getDocument()&&!!$s.getNavigator()&&navigator.product===JT}function XT(){return No()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function QT(){return No()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Zc(){return!Of()&&!!$s.getNavigator()&&!!$s.getDocument()}function sd(){return No()?jn.reactNative:Of()?jn.node:Zc()?jn.browser:jn.unknown}function jy(){var r;try{return No()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(r=global.Application)==null?void 0:r.applicationId:void 0}catch{return}}function eP(r,e){const t=new URLSearchParams(r);for(const n of Object.keys(e).sort())if(e.hasOwnProperty(n)){const i=e[n];i!==void 0&&t.set(n,i)}return t.toString()}function tP(r){var e,t;const n=t2();try{return r!=null&&r.url&&n.url&&new URL(r.url).host!==new URL(n.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${r.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),r.url=n.url),(e=r?.icons)!=null&&e.length&&r.icons.length>0&&(r.icons=r.icons.filter(i=>i!=="")),YT(Ly(Ly({},n),r),{url:r?.url||n.url,name:r?.name||n.name,description:r?.description||n.description,icons:(t=r?.icons)!=null&&t.length&&r.icons.length>0?r.icons:n.icons})}catch(i){return console.warn("Error populating app metadata",i),r||n}}function t2(){return PN.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function rP(){if(sd()===jn.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:n}=global.Platform;return[t,n].join("-")}const r=AN();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function nP(){var r;const e=sd();return e===jn.browser?[e,((r=$s.getLocation())==null?void 0:r.host)||"unknown"].join(":"):e}function r2(r,e,t){const n=rP(),i=nP();return[[r,e].join("-"),[ZT,t].join("-"),n,i].join("/")}function iP({protocol:r,version:e,relayUrl:t,sdkVersion:n,auth:i,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=t.split("?"),u=r2(r,e,n),d={auth:i,ua:u,projectId:s,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},p=eP(l[1]||"",d);return l[0]+"?"+p}function ia(r,e){return r.filter(t=>e.includes(t)).length===r.length}function ig(r){return Object.fromEntries(r.entries())}function sg(r){return new Map(Object.entries(r))}function Jo(r=le.FIVE_MINUTES,e){const t=le.toMiliseconds(r||le.FIVE_MINUTES);let n,i,s,o;return{resolve:a=>{s&&n&&(clearTimeout(s),n(a),o=Promise.resolve(a))},reject:a=>{s&&i&&(clearTimeout(s),i(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);s=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},t),n=a,i=c})}}function Qi(r,e,t){return new Promise(async(n,i)=>{const s=setTimeout(()=>i(new Error(t)),e);try{const o=await r;n(o)}catch(o){i(o)}clearTimeout(s)})}function n2(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function sP(r){return n2("topic",r)}function oP(r){return n2("id",r)}function i2(r){const[e,t]=r.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")n.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))n.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return n}function wr(r,e){return le.fromMiliseconds(Date.now()+le.toMiliseconds(r))}function ao(r){return Date.now()>=le.toMiliseconds(r)}function ht(r,e){return`${r}${e?`:${e}`:""}`}function is(r=[],e=[]){return[...new Set([...r,...e])]}async function aP({id:r,topic:e,wcDeepLink:t}){var n;try{if(!t)return;const i=typeof t=="string"?JSON.parse(t):t,s=i?.href;if(typeof s!="string")return;const o=cP(s,r,e),a=sd();if(a===jn.browser){if(!((n=$s.getDocument())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}lP(o)}else a===jn.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(i){console.error(i)}}function cP(r,e,t){const n=`requestId=${e}&sessionTopic=${t}`;r.endsWith("/")&&(r=r.slice(0,-1));let i=`${r}`;if(r.startsWith("https://t.me")){const s=r.includes("?")?"&startapp=":"?startapp=";i=`${i}${s}${hP(n,!0)}`}else i=`${i}/wc?${n}`;return i}function lP(r){let e="_self";fP()?e="_top":(dP()||r.startsWith("https://")||r.startsWith("http://"))&&(e="_blank"),window.open(r,e,"noreferrer noopener")}async function uP(r,e){let t="";try{if(Zc()&&(t=localStorage.getItem(e),t))return t;t=await r.getItem(e)}catch(n){console.error(n)}return t}function qy(r,e){if(!r.includes(e))return null;const t=r.split(/([&,?,=])/),n=t.indexOf(e);return t[n+2]}function Hy(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}function ym(){return typeof process<"u"&&qT.IS_VITEST==="true"}function dP(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function fP(){try{return window.self!==window.top}catch{return!1}}function hP(r,e=!1){const t=Buffer.from(r).toString("base64");return e?t.replace(/[=]/g,""):t}function s2(r){return Buffer.from(r,"base64").toString("utf-8")}function pP(r){return new Promise(e=>setTimeout(e,r))}let gP=class{constructor({limit:e}){Fy(this,"limit"),Fy(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const t=this.set.values().next().value;t&&this.set.delete(t)}this.set.add(e)}}has(e){return this.set.has(e)}};const kd=BigInt(2**32-1),Wy=BigInt(32);function o2(r,e=!1){return e?{h:Number(r&kd),l:Number(r>>Wy&kd)}:{h:Number(r>>Wy&kd)|0,l:Number(r&kd)|0}}function a2(r,e=!1){const t=r.length;let n=new Uint32Array(t),i=new Uint32Array(t);for(let s=0;s<t;s++){const{h:o,l:a}=o2(r[s],e);[n[s],i[s]]=[o,a]}return[n,i]}const zy=(r,e,t)=>r>>>t,Ky=(r,e,t)=>r<<32-t|e>>>t,co=(r,e,t)=>r>>>t|e<<32-t,lo=(r,e,t)=>r<<32-t|e>>>t,Il=(r,e,t)=>r<<64-t|e>>>t-32,Tl=(r,e,t)=>r>>>t-32|e<<64-t,mP=(r,e)=>e,bP=(r,e)=>r,yP=(r,e,t)=>r<<t|e>>>32-t,wP=(r,e,t)=>e<<t|r>>>32-t,xP=(r,e,t)=>e<<t-32|r>>>64-t,vP=(r,e,t)=>r<<t-32|e>>>64-t;function wi(r,e,t,n){const i=(e>>>0)+(n>>>0);return{h:r+t+(i/2**32|0)|0,l:i|0}}const wm=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),xm=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,EP=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),AP=(r,e,t,n,i)=>e+t+n+i+(r/2**32|0)|0,_P=(r,e,t,n,i)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0),CP=(r,e,t,n,i,s)=>e+t+n+i+s+(r/2**32|0)|0,za=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function vm(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Ls(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function si(r,...e){if(!vm(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function Em(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Ls(r.outputLen),Ls(r.blockLen)}function Eo(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function Am(r,e){si(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function Eu(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function oi(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function M0(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Li(r,e){return r<<32-e|r>>>e}const c2=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function l2(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}const _s=c2?r=>r:r=>l2(r);function SP(r){for(let e=0;e<r.length;e++)r[e]=l2(r[e]);return r}const uo=c2?r=>r:SP,u2=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",NP=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Au(r){if(si(r),u2)return r.toHex();let e="";for(let t=0;t<r.length;t++)e+=NP[r[t]];return e}const xs={_0:48,_9:57,A:65,F:70,a:97,f:102};function Vy(r){if(r>=xs._0&&r<=xs._9)return r-xs._0;if(r>=xs.A&&r<=xs.F)return r-(xs.A-10);if(r>=xs.a&&r<=xs.f)return r-(xs.a-10)}function _m(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);if(u2)return Uint8Array.fromHex(r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let i=0,s=0;i<t;i++,s+=2){const o=Vy(r.charCodeAt(s)),a=Vy(r.charCodeAt(s+1));if(o===void 0||a===void 0){const c=r[s]+r[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}function IP(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function Ri(r){return typeof r=="string"&&(r=IP(r)),si(r),r}function sa(...r){let e=0;for(let n=0;n<r.length;n++){const i=r[n];si(i),e+=i.length}const t=new Uint8Array(e);for(let n=0,i=0;n<r.length;n++){const s=r[n];t.set(s,i),i+=s.length}return t}let hh=class{};function od(r){const e=n=>r().update(Ri(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function TP(r){const e=(n,i)=>r(i).update(Ri(n)).digest(),t=r({});return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=n=>r(n),e}function Xc(r=32){if(za&&typeof za.getRandomValues=="function")return za.getRandomValues(new Uint8Array(r));if(za&&typeof za.randomBytes=="function")return Uint8Array.from(za.randomBytes(r));throw new Error("crypto.getRandomValues must be defined")}const PP=BigInt(0),hl=BigInt(1),RP=BigInt(2),OP=BigInt(7),kP=BigInt(256),DP=BigInt(113),d2=[],f2=[],h2=[];for(let r=0,e=hl,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],d2.push(2*(5*n+t)),f2.push((r+1)*(r+2)/2%64);let i=PP;for(let s=0;s<7;s++)e=(e<<hl^(e>>OP)*DP)%kP,e&RP&&(i^=hl<<(hl<<BigInt(s))-hl);h2.push(i)}const p2=a2(h2,!0),MP=p2[0],UP=p2[1],Gy=(r,e,t)=>t>32?xP(r,e,t):yP(r,e,t),Yy=(r,e,t)=>t>32?vP(r,e,t):wP(r,e,t);function BP(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],d=Gy(l,u,1)^t[a],p=Yy(l,u,1)^t[a+1];for(let x=0;x<50;x+=10)r[o+x]^=d,r[o+x+1]^=p}let i=r[2],s=r[3];for(let o=0;o<24;o++){const a=f2[o],c=Gy(i,s,a),l=Yy(i,s,a),u=d2[o];i=r[u],s=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=MP[n],r[1]^=UP[n]}oi(t)}let $P=class g2 extends hh{constructor(e,t,n,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=i,this.rounds=s,Ls(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Eu(this.state)}clone(){return this._cloneInto()}keccak(){uo(this.state32),BP(this.state32,this.rounds),uo(this.state32),this.posOut=0,this.pos=0}update(e){Eo(this),e=Ri(e),si(e);const{blockLen:t,state:n}=this,i=e.length;for(let s=0;s<i;){const o=Math.min(t-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:i}=this;e[n]^=t,(t&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){Eo(this,!1),si(e),this.finish();const t=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Ls(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Am(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,oi(this.state)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new g2(t,n,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}};const LP=(r,e,t)=>od(()=>new $P(e,r,t)),FP=LP(1,136,256/8);function jP(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(t>>i&s),a=Number(t&s),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}function qP(r,e,t){return r&e^~r&t}function HP(r,e,t){return r&e^r&t^e&t}let m2=class extends hh{constructor(e,t,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(e),this.view=M0(this.buffer)}update(e){Eo(this),e=Ri(e),si(e);const{view:t,buffer:n,blockLen:i}=this,s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=M0(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Eo(this),Am(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;t[o++]=128,oi(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(n,0),o=0);for(let d=o;d<i;d++)t[d]=0;jP(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=M0(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],s)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=s,e.length=i,e.pos=a,i%t&&e.buffer.set(n),e}clone(){return this._cloneInto()}};const Qs=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Wr=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),zr=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),WP=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),eo=new Uint32Array(64);let zP=class extends m2{constructor(e=32){super(64,e,8,!1),this.A=Qs[0]|0,this.B=Qs[1]|0,this.C=Qs[2]|0,this.D=Qs[3]|0,this.E=Qs[4]|0,this.F=Qs[5]|0,this.G=Qs[6]|0,this.H=Qs[7]|0}get(){const{A:e,B:t,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[e,t,n,i,s,o,a,c]}set(e,t,n,i,s,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let d=0;d<16;d++,t+=4)eo[d]=e.getUint32(t,!1);for(let d=16;d<64;d++){const p=eo[d-15],x=eo[d-2],w=Li(p,7)^Li(p,18)^p>>>3,b=Li(x,17)^Li(x,19)^x>>>10;eo[d]=b+eo[d-7]+w+eo[d-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const p=Li(a,6)^Li(a,11)^Li(a,25),x=u+p+qP(a,c,l)+WP[d]+eo[d]|0,w=(Li(n,2)^Li(n,13)^Li(n,22))+HP(n,i,s)|0;u=l,l=c,c=a,a=o+x|0,o=s,s=i,i=n,n=x+w|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,i,s,o,a,c,l,u)}roundClean(){oi(eo)}destroy(){this.set(0,0,0,0,0,0,0,0),oi(this.buffer)}};const b2=a2(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),KP=b2[0],VP=b2[1],to=new Uint32Array(80),ro=new Uint32Array(80);let Cm=class extends m2{constructor(e=64){super(128,e,16,!1),this.Ah=zr[0]|0,this.Al=zr[1]|0,this.Bh=zr[2]|0,this.Bl=zr[3]|0,this.Ch=zr[4]|0,this.Cl=zr[5]|0,this.Dh=zr[6]|0,this.Dl=zr[7]|0,this.Eh=zr[8]|0,this.El=zr[9]|0,this.Fh=zr[10]|0,this.Fl=zr[11]|0,this.Gh=zr[12]|0,this.Gl=zr[13]|0,this.Hh=zr[14]|0,this.Hl=zr[15]|0}get(){const{Ah:e,Al:t,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:p,Gh:x,Gl:w,Hh:b,Hl:y}=this;return[e,t,n,i,s,o,a,c,l,u,d,p,x,w,b,y]}set(e,t,n,i,s,o,a,c,l,u,d,p,x,w,b,y){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=p|0,this.Gh=x|0,this.Gl=w|0,this.Hh=b|0,this.Hl=y|0}process(e,t){for(let I=0;I<16;I++,t+=4)to[I]=e.getUint32(t),ro[I]=e.getUint32(t+=4);for(let I=16;I<80;I++){const k=to[I-15]|0,P=ro[I-15]|0,O=co(k,P,1)^co(k,P,8)^zy(k,P,7),q=lo(k,P,1)^lo(k,P,8)^Ky(k,P,7),F=to[I-2]|0,B=ro[I-2]|0,W=co(F,B,19)^Il(F,B,61)^zy(F,B,6),j=lo(F,B,19)^Tl(F,B,61)^Ky(F,B,6),U=EP(q,j,ro[I-7],ro[I-16]),_=AP(U,O,W,to[I-7],to[I-16]);to[I]=_|0,ro[I]=U|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:p,Fh:x,Fl:w,Gh:b,Gl:y,Hh:C,Hl:T}=this;for(let I=0;I<80;I++){const k=co(d,p,14)^co(d,p,18)^Il(d,p,41),P=lo(d,p,14)^lo(d,p,18)^Tl(d,p,41),O=d&x^~d&b,q=p&w^~p&y,F=_P(T,P,q,VP[I],ro[I]),B=CP(F,C,k,O,KP[I],to[I]),W=F|0,j=co(n,i,28)^Il(n,i,34)^Il(n,i,39),U=lo(n,i,28)^Tl(n,i,34)^Tl(n,i,39),_=n&s^n&a^s&a,f=i&o^i&c^o&c;C=b|0,T=y|0,b=x|0,y=w|0,x=d|0,w=p|0,{h:d,l:p}=wi(l|0,u|0,B|0,W|0),l=a|0,u=c|0,a=s|0,c=o|0,s=n|0,o=i|0;const h=wm(W,U,f);n=xm(h,B,j,_),i=h|0}({h:n,l:i}=wi(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=wi(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=wi(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=wi(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:p}=wi(this.Eh|0,this.El|0,d|0,p|0),{h:x,l:w}=wi(this.Fh|0,this.Fl|0,x|0,w|0),{h:b,l:y}=wi(this.Gh|0,this.Gl|0,b|0,y|0),{h:C,l:T}=wi(this.Hh|0,this.Hl|0,C|0,T|0),this.set(n,i,s,o,a,c,l,u,d,p,x,w,b,y,C,T)}roundClean(){oi(to,ro)}destroy(){oi(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},GP=class extends Cm{constructor(){super(48),this.Ah=Wr[0]|0,this.Al=Wr[1]|0,this.Bh=Wr[2]|0,this.Bl=Wr[3]|0,this.Ch=Wr[4]|0,this.Cl=Wr[5]|0,this.Dh=Wr[6]|0,this.Dl=Wr[7]|0,this.Eh=Wr[8]|0,this.El=Wr[9]|0,this.Fh=Wr[10]|0,this.Fl=Wr[11]|0,this.Gh=Wr[12]|0,this.Gl=Wr[13]|0,this.Hh=Wr[14]|0,this.Hl=Wr[15]|0}};const Kr=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class YP extends Cm{constructor(){super(32),this.Ah=Kr[0]|0,this.Al=Kr[1]|0,this.Bh=Kr[2]|0,this.Bl=Kr[3]|0,this.Ch=Kr[4]|0,this.Cl=Kr[5]|0,this.Dh=Kr[6]|0,this.Dl=Kr[7]|0,this.Eh=Kr[8]|0,this.El=Kr[9]|0,this.Fh=Kr[10]|0,this.Fl=Kr[11]|0,this.Gh=Kr[12]|0,this.Gl=Kr[13]|0,this.Hh=Kr[14]|0,this.Hl=Kr[15]|0}}const ph=od(()=>new zP),JP=od(()=>new Cm),ZP=od(()=>new GP),XP=od(()=>new YP),QP=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),yr=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),he=new Uint32Array(32);function no(r,e,t,n,i,s){const o=i[s],a=i[s+1];let c=he[2*r],l=he[2*r+1],u=he[2*e],d=he[2*e+1],p=he[2*t],x=he[2*t+1],w=he[2*n],b=he[2*n+1],y=wm(c,u,o);l=xm(y,l,d,a),c=y|0,{Dh:b,Dl:w}={Dh:b^l,Dl:w^c},{Dh:b,Dl:w}={Dh:mP(b,w),Dl:bP(b)},{h:x,l:p}=wi(x,p,b,w),{Bh:d,Bl:u}={Bh:d^x,Bl:u^p},{Bh:d,Bl:u}={Bh:co(d,u,24),Bl:lo(d,u,24)},he[2*r]=c,he[2*r+1]=l,he[2*e]=u,he[2*e+1]=d,he[2*t]=p,he[2*t+1]=x,he[2*n]=w,he[2*n+1]=b}function io(r,e,t,n,i,s){const o=i[s],a=i[s+1];let c=he[2*r],l=he[2*r+1],u=he[2*e],d=he[2*e+1],p=he[2*t],x=he[2*t+1],w=he[2*n],b=he[2*n+1],y=wm(c,u,o);l=xm(y,l,d,a),c=y|0,{Dh:b,Dl:w}={Dh:b^l,Dl:w^c},{Dh:b,Dl:w}={Dh:co(b,w,16),Dl:lo(b,w,16)},{h:x,l:p}=wi(x,p,b,w),{Bh:d,Bl:u}={Bh:d^x,Bl:u^p},{Bh:d,Bl:u}={Bh:Il(d,u,63),Bl:Tl(d,u,63)},he[2*r]=c,he[2*r+1]=l,he[2*e]=u,he[2*e+1]=d,he[2*t]=p,he[2*t+1]=x,he[2*n]=w,he[2*n+1]=b}function eR(r,e={},t,n,i){if(Ls(t),r<0||r>t)throw new Error("outputLen bigger than keyLen");const{key:s,salt:o,personalization:a}=e;if(s!==void 0&&(s.length<1||s.length>t))throw new Error("key length must be undefined or 1.."+t);if(o!==void 0&&o.length!==n)throw new Error("salt must be undefined or "+n);if(a!==void 0&&a.length!==i)throw new Error("personalization must be undefined or "+i)}class tR extends hh{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Ls(e),Ls(t),this.blockLen=e,this.outputLen=t,this.buffer=new Uint8Array(e),this.buffer32=Eu(this.buffer)}update(e){Eo(this),e=Ri(e),si(e);const{blockLen:t,buffer:n,buffer32:i}=this,s=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<s;){this.pos===t&&(uo(i),this.compress(i,0,!1),uo(i),this.pos=0);const l=Math.min(t-this.pos,s-c),u=o+c;if(l===t&&!(u%4)&&c+l<s){const d=new Uint32Array(a,u,Math.floor((s-c)/4));uo(d);for(let p=0;c+t<s;p+=i.length,c+=t)this.length+=t,this.compress(d,p,!1);uo(d);continue}n.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){Eo(this),Am(e,this);const{pos:t,buffer32:n}=this;this.finished=!0,oi(this.buffer.subarray(t)),uo(n),this.compress(n,0,!0),uo(n);const i=Eu(e);this.get().forEach((s,o)=>i[o]=_s(s))}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){const{buffer:t,length:n,finished:i,destroyed:s,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(t),e.destroyed=s,e.finished=i,e.length=n,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class rR extends tR{constructor(e={}){const t=e.dkLen===void 0?64:e.dkLen;super(128,t),this.v0l=yr[0]|0,this.v0h=yr[1]|0,this.v1l=yr[2]|0,this.v1h=yr[3]|0,this.v2l=yr[4]|0,this.v2h=yr[5]|0,this.v3l=yr[6]|0,this.v3h=yr[7]|0,this.v4l=yr[8]|0,this.v4h=yr[9]|0,this.v5l=yr[10]|0,this.v5h=yr[11]|0,this.v6l=yr[12]|0,this.v6h=yr[13]|0,this.v7l=yr[14]|0,this.v7h=yr[15]|0,eR(t,e,64,16,16);let{key:n,personalization:i,salt:s}=e,o=0;if(n!==void 0&&(n=Ri(n),o=n.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,s!==void 0){s=Ri(s);const a=Eu(s);this.v4l^=_s(a[0]),this.v4h^=_s(a[1]),this.v5l^=_s(a[2]),this.v5h^=_s(a[3])}if(i!==void 0){i=Ri(i);const a=Eu(i);this.v6l^=_s(a[0]),this.v6h^=_s(a[1]),this.v7l^=_s(a[2]),this.v7h^=_s(a[3])}if(n!==void 0){const a=new Uint8Array(this.blockLen);a.set(n),this.update(a)}}get(){let{v0l:e,v0h:t,v1l:n,v1h:i,v2l:s,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:d,v5h:p,v6l:x,v6h:w,v7l:b,v7h:y}=this;return[e,t,n,i,s,o,a,c,l,u,d,p,x,w,b,y]}set(e,t,n,i,s,o,a,c,l,u,d,p,x,w,b,y){this.v0l=e|0,this.v0h=t|0,this.v1l=n|0,this.v1h=i|0,this.v2l=s|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=d|0,this.v5h=p|0,this.v6l=x|0,this.v6h=w|0,this.v7l=b|0,this.v7h=y|0}compress(e,t,n){this.get().forEach((c,l)=>he[l]=c),he.set(yr,16);let{h:i,l:s}=o2(BigInt(this.length));he[24]=yr[8]^s,he[25]=yr[9]^i,n&&(he[28]=~he[28],he[29]=~he[29]);let o=0;const a=QP;for(let c=0;c<12;c++)no(0,4,8,12,e,t+2*a[o++]),io(0,4,8,12,e,t+2*a[o++]),no(1,5,9,13,e,t+2*a[o++]),io(1,5,9,13,e,t+2*a[o++]),no(2,6,10,14,e,t+2*a[o++]),io(2,6,10,14,e,t+2*a[o++]),no(3,7,11,15,e,t+2*a[o++]),io(3,7,11,15,e,t+2*a[o++]),no(0,5,10,15,e,t+2*a[o++]),io(0,5,10,15,e,t+2*a[o++]),no(1,6,11,12,e,t+2*a[o++]),io(1,6,11,12,e,t+2*a[o++]),no(2,7,8,13,e,t+2*a[o++]),io(2,7,8,13,e,t+2*a[o++]),no(3,4,9,14,e,t+2*a[o++]),io(3,4,9,14,e,t+2*a[o++]);this.v0l^=he[0]^he[16],this.v0h^=he[1]^he[17],this.v1l^=he[2]^he[18],this.v1h^=he[3]^he[19],this.v2l^=he[4]^he[20],this.v2h^=he[5]^he[21],this.v3l^=he[6]^he[22],this.v3h^=he[7]^he[23],this.v4l^=he[8]^he[24],this.v4h^=he[9]^he[25],this.v5l^=he[10]^he[26],this.v5h^=he[11]^he[27],this.v6l^=he[12]^he[28],this.v6h^=he[13]^he[29],this.v7l^=he[14]^he[30],this.v7h^=he[15]^he[31],oi(he)}destroy(){this.destroyed=!0,oi(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const nR=TP(r=>new rR(r)),iR="https://rpc.walletconnect.org/v1";function y2(r){const e=`Ethereum Signed Message:
${r.length}`,t=new TextEncoder().encode(e+r);return"0x"+Buffer.from(FP(t)).toString("hex")}async function sR(r,e,t,n,i,s){switch(t.t){case"eip191":return await oR(r,e,t.s);case"eip1271":return await aR(r,e,t.s,n,i,s);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}async function oR(r,e,t){return(await GN({hash:y2(e),signature:t})).toLowerCase()===r.toLowerCase()}async function aR(r,e,t,n,i,s){const o=fa(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=t.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),d=(e.startsWith("0x")?e:y2(e)).substring(2),p=a+d+c+u+l,x=await fetch(`${s||iR}/?chainId=${n}&projectId=${i}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:cR(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:p},"latest"]})}),{result:w}=await x.json();return w?w.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function cR(){return Date.now()+Math.floor(Math.random()*1e3)}function lR(r){const e=atob(r),t=new Uint8Array(e.length);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);const n=t[0];if(n===0)throw new Error("No signatures found");const i=1+n*64;if(t.length<i)throw new Error("Transaction data too short for claimed signature count");if(t.length<100)throw new Error("Transaction too short");const s=Buffer.from(r,"base64").slice(1,65);return Jc.encode(s)}function uR(r){const e=new Uint8Array(Buffer.from(r,"base64")),t=Array.from("TransactionData::").map(s=>s.charCodeAt(0)),n=new Uint8Array(t.length+e.length);n.set(t),n.set(e,t.length);const i=nR(n,{dkLen:32});return Jc.encode(i)}function Jy(r){const e=new Uint8Array(ph(dR(r)));return Jc.encode(e)}function dR(r){if(r instanceof Uint8Array)return r;if(Array.isArray(r))return new Uint8Array(r);if(typeof r=="object"&&r!=null&&r.data)return new Uint8Array(Object.values(r.data));if(typeof r=="object"&&r)return new Uint8Array(Object.values(r));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function Zy(r){const e=Buffer.from(r,"base64"),t=OI(e).txn;if(!t)throw new Error("Invalid signed transaction: missing 'txn' field");const n=AI(t),i=Buffer.from("TX"),s=Buffer.concat([i,Buffer.from(n)]),o=XP(s);return FI.encode(o).replace(/=+$/,"")}function U0(r){const e=[];let t=BigInt(r);for(;t>=BigInt(128);)e.push(Number(t&BigInt(127)|BigInt(128))),t>>=BigInt(7);return e.push(Number(t)),Buffer.from(e)}function fR(r){const e=Buffer.from(r.signed.bodyBytes,"base64"),t=Buffer.from(r.signed.authInfoBytes,"base64"),n=Buffer.from(r.signature.signature,"base64"),i=[];i.push(Buffer.from([10])),i.push(U0(e.length)),i.push(e),i.push(Buffer.from([18])),i.push(U0(t.length)),i.push(t),i.push(Buffer.from([26])),i.push(U0(n.length)),i.push(n);const s=Buffer.concat(i),o=ph(s);return Buffer.from(o).toString("hex").toUpperCase()}var hR=Object.defineProperty,pR=Object.defineProperties,gR=Object.getOwnPropertyDescriptors,Xy=Object.getOwnPropertySymbols,mR=Object.prototype.hasOwnProperty,bR=Object.prototype.propertyIsEnumerable,Qy=(r,e,t)=>e in r?hR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,yR=(r,e)=>{for(var t in e||(e={}))mR.call(e,t)&&Qy(r,t,e[t]);if(Xy)for(var t of Xy(e))bR.call(e,t)&&Qy(r,t,e[t]);return r},wR=(r,e)=>pR(r,gR(e));const xR="did:pkh:",Sm=r=>r?.split(":"),vR=r=>{const e=r&&Sm(r);if(e)return r.includes(xR)?e[3]:e[1]},og=r=>{const e=r&&Sm(r);if(e)return e[2]+":"+e[3]},kf=r=>{const e=r&&Sm(r);if(e)return e.pop()};async function e1(r){const{cacao:e,projectId:t}=r,{s:n,p:i}=e,s=w2(i,i.iss),o=kf(i.iss);return await sR(o,s,n,og(i.iss),t)}const w2=(r,e)=>{const t=`${r.domain} wants you to sign in with your Ethereum account:`,n=kf(e);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=r.statement||void 0;const s=`URI: ${r.aud||r.uri}`,o=`Version: ${r.version}`,a=`Chain ID: ${vR(e)}`,c=`Nonce: ${r.nonce}`,l=`Issued At: ${r.iat}`,u=r.exp?`Expiration Time: ${r.exp}`:void 0,d=r.nbf?`Not Before: ${r.nbf}`:void 0,p=r.requestId?`Request ID: ${r.requestId}`:void 0,x=r.resources?`Resources:${r.resources.map(b=>`
- ${b}`).join("")}`:void 0,w=rf(r.resources);if(w){const b=_u(w);i=PR(i,b)}return[t,n,"",i,"",s,o,a,c,l,u,d,p,x].filter(b=>b!=null).join(`
`)};function ER(r){return Buffer.from(JSON.stringify(r)).toString("base64")}function AR(r){return JSON.parse(Buffer.from(r,"base64").toString("utf-8"))}function xa(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const e=Object.keys(r.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const n=r.att[t];if(Array.isArray(n))throw new Error(`Resource must be an object: ${t}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(n).forEach(i=>{const s=n[i];if(!Array.isArray(s))throw new Error(`Ability limits ${i} must be an array of objects, found: ${s}`);if(!s.length)throw new Error(`Value of ${i} is empty array, must be an array with objects`);s.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${i}) must be an array of objects, found: ${o}`)})})})}function _R(r,e,t,n={}){return t?.sort((i,s)=>i.localeCompare(s)),{att:{[r]:CR(e,t,n)}}}function CR(r,e,t={}){e=e?.sort((i,s)=>i.localeCompare(s));const n=e.map(i=>({[`${r}/${i}`]:[t]}));return Object.assign({},...n)}function x2(r){return xa(r),`urn:recap:${ER(r).replace(/=/g,"")}`}function _u(r){const e=AR(r.replace("urn:recap:",""));return xa(e),e}function SR(r,e,t){const n=_R(r,e,t);return x2(n)}function NR(r){return r&&r.includes("urn:recap:")}function IR(r,e){const t=_u(r),n=_u(e),i=TR(t,n);return x2(i)}function TR(r,e){xa(r),xa(e);const t=Object.keys(r.att).concat(Object.keys(e.att)).sort((i,s)=>i.localeCompare(s)),n={att:{}};return t.forEach(i=>{var s,o;Object.keys(((s=r.att)==null?void 0:s[i])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[i])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;n.att[i]=wR(yR({},n.att[i]),{[a]:((c=r.att[i])==null?void 0:c[a])||((l=e.att[i])==null?void 0:l[a])})})}),n}function PR(r="",e){xa(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(t))return r;const n=[];let i=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,p)=>d.action.localeCompare(p.action));const l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});const u=Object.keys(l).map(d=>(i++,`(${i}) '${d}': '${l[d].join("', '")}' for '${a}'.`));n.push(u.join(", ").replace(".,","."))});const s=n.join(" "),o=`${t}${s}`;return`${r?r+" ":""}${o}`}function t1(r){var e;const t=_u(r);xa(t);const n=(e=t.att)==null?void 0:e.eip155;return n?Object.keys(n).map(i=>i.split("/")[1]):[]}function r1(r){const e=_u(r);xa(e);const t=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(i=>{var s;(s=i?.[0])!=null&&s.chains&&t.push(i[0].chains)})}),[...new Set(t.flat())]}function rf(r){if(!r)return;const e=r?.[r.length-1];return NR(e)?e:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function v2(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function ag(r){if(typeof r!="boolean")throw new Error(`boolean expected, not ${r}`)}function B0(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function _n(r,...e){if(!v2(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function n1(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function RR(r,e){_n(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function wo(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function Bc(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function OR(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}const kR=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function DR(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function cg(r){if(typeof r=="string")r=DR(r);else if(v2(r))r=lg(r);else throw new Error("Uint8Array expected, got "+typeof r);return r}function MR(r,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(r,e)}function UR(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}const BR=(r,e)=>{function t(n,...i){if(_n(n),!kR)throw new Error("Non little-endian hardware is not yet supported");if(r.nonceLength!==void 0){const l=i[0];if(!l)throw new Error("nonce / iv required");r.varSizeNonce?_n(l):_n(l,r.nonceLength)}const s=r.tagLength;s&&i[1]!==void 0&&_n(i[1]);const o=e(n,...i),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");_n(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,_n(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(_n(l),s&&l.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(t,r),t};function i1(r,e,t=!0){if(e===void 0)return new Uint8Array(r);if(e.length!==r)throw new Error("invalid output length, expected "+r+", got: "+e.length);if(t&&!LR(e))throw new Error("invalid output, must be aligned");return e}function s1(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(t>>i&s),a=Number(t&s);r.setUint32(e+4,o,n),r.setUint32(e+0,a,n)}function $R(r,e,t){ag(t);const n=new Uint8Array(16),i=OR(n);return s1(i,0,BigInt(e),t),s1(i,8,BigInt(r),t),n}function LR(r){return r.byteOffset%4===0}function lg(r){return Uint8Array.from(r)}const E2=r=>Uint8Array.from(r.split("").map(e=>e.charCodeAt(0))),FR=E2("expand 16-byte k"),jR=E2("expand 32-byte k"),qR=wo(FR),HR=wo(jR);function it(r,e){return r<<e|r>>>32-e}function ug(r){return r.byteOffset%4===0}const Dd=64,WR=16,A2=2**32-1,o1=new Uint32Array;function zR(r,e,t,n,i,s,o,a){const c=i.length,l=new Uint8Array(Dd),u=wo(l),d=ug(i)&&ug(s),p=d?wo(i):o1,x=d?wo(s):o1;for(let w=0;w<c;o++){if(r(e,t,n,u,o,a),o>=A2)throw new Error("arx: counter overflow");const b=Math.min(Dd,c-w);if(d&&b===Dd){const y=w/4;if(w%4!==0)throw new Error("arx: invalid block position");for(let C=0,T;C<WR;C++)T=y+C,x[T]=p[T]^u[C];w+=Dd;continue}for(let y=0,C;y<b;y++)C=w+y,s[C]=i[C]^l[y];w+=b}}function KR(r,e){const{allowShortKeys:t,extendNonceFn:n,counterLength:i,counterRight:s,rounds:o}=MR({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof r!="function")throw new Error("core must be a function");return B0(i),B0(o),ag(s),ag(t),(a,c,l,u,d=0)=>{_n(a),_n(c),_n(l);const p=l.length;if(u===void 0&&(u=new Uint8Array(p)),_n(u),B0(d),d<0||d>=A2)throw new Error("arx: counter overflow");if(u.length<p)throw new Error(`arx: output (${u.length}) is shorter than data (${p})`);const x=[];let w=a.length,b,y;if(w===32)x.push(b=lg(a)),y=HR;else if(w===16&&t)b=new Uint8Array(32),b.set(a),b.set(a,16),y=qR,x.push(b);else throw new Error(`arx: invalid 32-byte key, got length=${w}`);ug(c)||x.push(c=lg(c));const C=wo(b);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(y,C,wo(c.subarray(0,16)),C),c=c.subarray(16)}const T=16-i;if(T!==c.length)throw new Error(`arx: nonce must be ${T} or 16 bytes`);if(T!==12){const k=new Uint8Array(12);k.set(c,s?0:12-c.length),c=k,x.push(c)}const I=wo(c);return zR(r,y,C,I,l,u,d,o),Bc(...x),u}}const Rr=(r,e)=>r[e++]&255|(r[e++]&255)<<8;class VR{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=cg(e),_n(e,32);const t=Rr(e,0),n=Rr(e,2),i=Rr(e,4),s=Rr(e,6),o=Rr(e,8),a=Rr(e,10),c=Rr(e,12),l=Rr(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|n<<3)&8191,this.r[2]=(n>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Rr(e,16+2*u)}process(e,t,n=!1){const i=n?0:2048,{h:s,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],p=o[5],x=o[6],w=o[7],b=o[8],y=o[9],C=Rr(e,t+0),T=Rr(e,t+2),I=Rr(e,t+4),k=Rr(e,t+6),P=Rr(e,t+8),O=Rr(e,t+10),q=Rr(e,t+12),F=Rr(e,t+14);let B=s[0]+(C&8191),W=s[1]+((C>>>13|T<<3)&8191),j=s[2]+((T>>>10|I<<6)&8191),U=s[3]+((I>>>7|k<<9)&8191),_=s[4]+((k>>>4|P<<12)&8191),f=s[5]+(P>>>1&8191),h=s[6]+((P>>>14|O<<2)&8191),m=s[7]+((O>>>11|q<<5)&8191),A=s[8]+((q>>>8|F<<8)&8191),S=s[9]+(F>>>5|i),R=0,M=R+B*a+W*(5*y)+j*(5*b)+U*(5*w)+_*(5*x);R=M>>>13,M&=8191,M+=f*(5*p)+h*(5*d)+m*(5*u)+A*(5*l)+S*(5*c),R+=M>>>13,M&=8191;let E=R+B*c+W*a+j*(5*y)+U*(5*b)+_*(5*w);R=E>>>13,E&=8191,E+=f*(5*x)+h*(5*p)+m*(5*d)+A*(5*u)+S*(5*l),R+=E>>>13,E&=8191;let g=R+B*l+W*c+j*a+U*(5*y)+_*(5*b);R=g>>>13,g&=8191,g+=f*(5*w)+h*(5*x)+m*(5*p)+A*(5*d)+S*(5*u),R+=g>>>13,g&=8191;let N=R+B*u+W*l+j*c+U*a+_*(5*y);R=N>>>13,N&=8191,N+=f*(5*b)+h*(5*w)+m*(5*x)+A*(5*p)+S*(5*d),R+=N>>>13,N&=8191;let L=R+B*d+W*u+j*l+U*c+_*a;R=L>>>13,L&=8191,L+=f*(5*y)+h*(5*b)+m*(5*w)+A*(5*x)+S*(5*p),R+=L>>>13,L&=8191;let v=R+B*p+W*d+j*u+U*l+_*c;R=v>>>13,v&=8191,v+=f*a+h*(5*y)+m*(5*b)+A*(5*w)+S*(5*x),R+=v>>>13,v&=8191;let H=R+B*x+W*p+j*d+U*u+_*l;R=H>>>13,H&=8191,H+=f*c+h*a+m*(5*y)+A*(5*b)+S*(5*w),R+=H>>>13,H&=8191;let V=R+B*w+W*x+j*p+U*d+_*u;R=V>>>13,V&=8191,V+=f*l+h*c+m*a+A*(5*y)+S*(5*b),R+=V>>>13,V&=8191;let z=R+B*b+W*w+j*x+U*p+_*d;R=z>>>13,z&=8191,z+=f*u+h*l+m*c+A*a+S*(5*y),R+=z>>>13,z&=8191;let G=R+B*y+W*b+j*w+U*x+_*p;R=G>>>13,G&=8191,G+=f*d+h*u+m*l+A*c+S*a,R+=G>>>13,G&=8191,R=(R<<2)+R|0,R=R+M|0,M=R&8191,R=R>>>13,E+=R,s[0]=M,s[1]=E,s[2]=g,s[3]=N,s[4]=L,s[5]=v,s[6]=H,s[7]=V,s[8]=z,s[9]=G}finalize(){const{h:e,pad:t}=this,n=new Uint16Array(10);let i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,n[0]=e[0]+5,i=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+i,i=n[a]>>>13,n[a]&=8191;n[9]-=8192;let s=(i^1)-1;for(let a=0;a<10;a++)n[a]&=s;s=~s;for(let a=0;a<10;a++)e[a]=e[a]&s|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+t[a]|0)+(o>>>16)|0,e[a]=o&65535;Bc(n)}update(e){n1(this),e=cg(e),_n(e);const{buffer:t,blockLen:n}=this,i=e.length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);if(o===n){for(;n<=i-s;s+=n)this.process(e,s);continue}t.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===n&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){Bc(this.h,this.r,this.buffer,this.pad)}digestInto(e){n1(this),RR(e,this),this.finished=!0;const{buffer:t,h:n}=this;let{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)e[s++]=n[o]>>>0,e[s++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}}function GR(r){const e=(n,i)=>r(i).update(cg(n)).digest(),t=r(new Uint8Array(32));return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=n=>r(n),e}const YR=GR(r=>new VR(r));function JR(r,e,t,n,i,s=20){let o=r[0],a=r[1],c=r[2],l=r[3],u=e[0],d=e[1],p=e[2],x=e[3],w=e[4],b=e[5],y=e[6],C=e[7],T=i,I=t[0],k=t[1],P=t[2],O=o,q=a,F=c,B=l,W=u,j=d,U=p,_=x,f=w,h=b,m=y,A=C,S=T,R=I,M=k,E=P;for(let N=0;N<s;N+=2)O=O+W|0,S=it(S^O,16),f=f+S|0,W=it(W^f,12),O=O+W|0,S=it(S^O,8),f=f+S|0,W=it(W^f,7),q=q+j|0,R=it(R^q,16),h=h+R|0,j=it(j^h,12),q=q+j|0,R=it(R^q,8),h=h+R|0,j=it(j^h,7),F=F+U|0,M=it(M^F,16),m=m+M|0,U=it(U^m,12),F=F+U|0,M=it(M^F,8),m=m+M|0,U=it(U^m,7),B=B+_|0,E=it(E^B,16),A=A+E|0,_=it(_^A,12),B=B+_|0,E=it(E^B,8),A=A+E|0,_=it(_^A,7),O=O+j|0,E=it(E^O,16),m=m+E|0,j=it(j^m,12),O=O+j|0,E=it(E^O,8),m=m+E|0,j=it(j^m,7),q=q+U|0,S=it(S^q,16),A=A+S|0,U=it(U^A,12),q=q+U|0,S=it(S^q,8),A=A+S|0,U=it(U^A,7),F=F+_|0,R=it(R^F,16),f=f+R|0,_=it(_^f,12),F=F+_|0,R=it(R^F,8),f=f+R|0,_=it(_^f,7),B=B+W|0,M=it(M^B,16),h=h+M|0,W=it(W^h,12),B=B+W|0,M=it(M^B,8),h=h+M|0,W=it(W^h,7);let g=0;n[g++]=o+O|0,n[g++]=a+q|0,n[g++]=c+F|0,n[g++]=l+B|0,n[g++]=u+W|0,n[g++]=d+j|0,n[g++]=p+U|0,n[g++]=x+_|0,n[g++]=w+f|0,n[g++]=b+h|0,n[g++]=y+m|0,n[g++]=C+A|0,n[g++]=T+S|0,n[g++]=I+R|0,n[g++]=k+M|0,n[g++]=P+E|0}const ZR=KR(JR,{counterRight:!1,counterLength:4,allowShortKeys:!1}),XR=new Uint8Array(16),a1=(r,e)=>{r.update(e);const t=e.length%16;t&&r.update(XR.subarray(t))},QR=new Uint8Array(32);function c1(r,e,t,n,i){const s=r(e,t,QR),o=YR.create(s);i&&a1(o,i),a1(o,n);const a=$R(n.length,i?i.length:0,!0);o.update(a);const c=o.digest();return Bc(s,a),c}const eO=r=>(e,t,n)=>({encrypt(i,s){const o=i.length;s=i1(o+16,s,!1),s.set(i);const a=s.subarray(0,-16);r(e,t,a,a,1);const c=c1(r,e,t,a,n);return s.set(c,o),Bc(c),s},decrypt(i,s){s=i1(i.length-16,s,!1);const o=i.subarray(0,-16),a=i.subarray(-16),c=c1(r,e,t,o,n);if(!UR(a,c))throw new Error("invalid tag");return s.set(i.subarray(0,-16)),r(e,t,s,s,1),Bc(c),s}}),_2=BR({blockSize:64,nonceLength:12,tagLength:16},eO(ZR));let C2=class extends hh{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Em(e);const n=Ri(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),oi(s)}update(e){return Eo(this),this.iHash.update(e),this}digestInto(e){Eo(this),si(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const gh=(r,e,t)=>new C2(r,e).update(t).digest();gh.create=(r,e)=>new C2(r,e);function tO(r,e,t){return Em(r),t===void 0&&(t=new Uint8Array(r.outputLen)),gh(r,Ri(t),Ri(e))}const $0=Uint8Array.from([0]),l1=Uint8Array.of();function rO(r,e,t,n=32){Em(r),Ls(n);const i=r.outputLen;if(n>255*i)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(n/i);t===void 0&&(t=l1);const o=new Uint8Array(s*i),a=gh.create(r,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<s;u++)$0[0]=u+1,c.update(u===0?l1:l).update(t).update($0).digestInto(l),o.set(l,i*u),a._cloneInto(c);return a.destroy(),c.destroy(),oi(l,$0),o.slice(0,n)}const nO=(r,e,t,n,i)=>rO(r,tO(r,e,t),n,i),mh=ph,Nm=BigInt(0),dg=BigInt(1);function Df(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}function Md(r){const e=r.toString(16);return e.length&1?"0"+e:e}function S2(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?Nm:BigInt("0x"+r)}function bh(r){return S2(Au(r))}function Mf(r){return si(r),S2(Au(Uint8Array.from(r).reverse()))}function Im(r,e){return _m(r.toString(16).padStart(e*2,"0"))}function Tm(r,e){return Im(r,e).reverse()}function En(r,e,t){let n;if(typeof e=="string")try{n=_m(e)}catch(s){throw new Error(r+" must be hex string or Uint8Array, cause: "+s)}else if(vm(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const i=n.length;if(typeof t=="number"&&i!==t)throw new Error(r+" of length "+t+" expected, got "+i);return n}const L0=r=>typeof r=="bigint"&&Nm<=r;function iO(r,e,t){return L0(r)&&L0(e)&&L0(t)&&e<=r&&r<t}function fg(r,e,t,n){if(!iO(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function sO(r){let e;for(e=0;r>Nm;r>>=dg,e+=1);return e}const yh=r=>(dg<<BigInt(r))-dg;function oO(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");const n=p=>new Uint8Array(p),i=p=>Uint8Array.of(p);let s=n(r),o=n(r),a=0;const c=()=>{s.fill(1),o.fill(0),a=0},l=(...p)=>t(o,s,...p),u=(p=n(0))=>{o=l(i(0),p),s=l(),p.length!==0&&(o=l(i(1),p),s=l())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let p=0;const x=[];for(;p<e;){s=l();const w=s.slice();x.push(w),p+=s.length}return sa(...x)};return(p,x)=>{c(),u(p);let w;for(;!(w=x(d()));)u();return c(),w}}function wh(r,e,t={}){if(!r||typeof r!="object")throw new Error("expected valid options object");function n(i,s,o){const a=r[i];if(o&&a===void 0)return;const c=typeof a;if(c!==s||a===null)throw new Error(`param "${i}" is invalid: expected ${s}, got ${c}`)}Object.entries(e).forEach(([i,s])=>n(i,s,!1)),Object.entries(t).forEach(([i,s])=>n(i,s,!0))}function u1(r){const e=new WeakMap;return(t,...n)=>{const i=e.get(t);if(i!==void 0)return i;const s=r(t,...n);return e.set(t,s),s}}const Nn=BigInt(0),ln=BigInt(1),oa=BigInt(2),aO=BigInt(3),N2=BigInt(4),I2=BigInt(5),T2=BigInt(8);function ni(r,e){const t=r%e;return t>=Nn?t:e+t}function bi(r,e,t){let n=r;for(;e-- >Nn;)n*=n,n%=t;return n}function d1(r,e){if(r===Nn)throw new Error("invert: expected non-zero number");if(e<=Nn)throw new Error("invert: expected positive modulus, got "+e);let t=ni(r,e),n=e,i=Nn,s=ln;for(;t!==Nn;){const o=n/t,a=n%t,c=i-s*o;n=t,t=a,i=s,s=c}if(n!==ln)throw new Error("invert: does not exist");return ni(i,e)}function P2(r,e){const t=(r.ORDER+ln)/N2,n=r.pow(e,t);if(!r.eql(r.sqr(n),e))throw new Error("Cannot find square root");return n}function cO(r,e){const t=(r.ORDER-I2)/T2,n=r.mul(e,oa),i=r.pow(n,t),s=r.mul(e,i),o=r.mul(r.mul(s,oa),i),a=r.mul(s,r.sub(o,r.ONE));if(!r.eql(r.sqr(a),e))throw new Error("Cannot find square root");return a}function lO(r){if(r<BigInt(3))throw new Error("sqrt is not defined for small field");let e=r-ln,t=0;for(;e%oa===Nn;)e/=oa,t++;let n=oa;const i=Qc(r);for(;f1(i,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(t===1)return P2;let s=i.pow(n,e);const o=(e+ln)/oa;return function(a,c){if(a.is0(c))return c;if(f1(a,c)!==1)throw new Error("Cannot find square root");let l=t,u=a.mul(a.ONE,s),d=a.pow(c,e),p=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let x=1,w=a.sqr(d);for(;!a.eql(w,a.ONE);)if(x++,w=a.sqr(w),x===l)throw new Error("Cannot find square root");const b=ln<<BigInt(l-x-1),y=a.pow(u,b);l=x,u=a.sqr(y),d=a.mul(d,u),p=a.mul(p,y)}return p}}function uO(r){return r%N2===aO?P2:r%T2===I2?cO:lO(r)}const dO=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function fO(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},t=dO.reduce((n,i)=>(n[i]="function",n),e);return wh(r,t),r}function hO(r,e,t){if(t<Nn)throw new Error("invalid exponent, negatives unsupported");if(t===Nn)return r.ONE;if(t===ln)return e;let n=r.ONE,i=e;for(;t>Nn;)t&ln&&(n=r.mul(n,i)),i=r.sqr(i),t>>=ln;return n}function R2(r,e,t=!1){const n=new Array(e.length).fill(t?r.ZERO:void 0),i=e.reduce((o,a,c)=>r.is0(a)?o:(n[c]=o,r.mul(o,a)),r.ONE),s=r.inv(i);return e.reduceRight((o,a,c)=>r.is0(a)?o:(n[c]=r.mul(o,n[c]),r.mul(o,a)),s),n}function f1(r,e){const t=(r.ORDER-ln)/oa,n=r.pow(e,t),i=r.eql(n,r.ONE),s=r.eql(n,r.ZERO),o=r.eql(n,r.neg(r.ONE));if(!i&&!s&&!o)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function pO(r,e){e!==void 0&&Ls(e);const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function Qc(r,e,t=!1,n={}){if(r<=Nn)throw new Error("invalid field: expected ORDER > 0, got "+r);let i,s;if(typeof e=="object"&&e!=null){if(n.sqrt||t)throw new Error("cannot specify opts in two arguments");const u=e;u.BITS&&(i=u.BITS),u.sqrt&&(s=u.sqrt),typeof u.isLE=="boolean"&&(t=u.isLE)}else typeof e=="number"&&(i=e),n.sqrt&&(s=n.sqrt);const{nBitLength:o,nByteLength:a}=pO(r,i);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const l=Object.freeze({ORDER:r,isLE:t,BITS:o,BYTES:a,MASK:yh(o),ZERO:Nn,ONE:ln,create:u=>ni(u,r),isValid:u=>{if(typeof u!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof u);return Nn<=u&&u<r},is0:u=>u===Nn,isValidNot0:u=>!l.is0(u)&&l.isValid(u),isOdd:u=>(u&ln)===ln,neg:u=>ni(-u,r),eql:(u,d)=>u===d,sqr:u=>ni(u*u,r),add:(u,d)=>ni(u+d,r),sub:(u,d)=>ni(u-d,r),mul:(u,d)=>ni(u*d,r),pow:(u,d)=>hO(l,u,d),div:(u,d)=>ni(u*d1(d,r),r),sqrN:u=>u*u,addN:(u,d)=>u+d,subN:(u,d)=>u-d,mulN:(u,d)=>u*d,inv:u=>d1(u,r),sqrt:s||(u=>(c||(c=uO(r)),c(l,u))),toBytes:u=>t?Tm(u,a):Im(u,a),fromBytes:u=>{if(u.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+u.length);return t?Mf(u):bh(u)},invertBatch:u=>R2(l,u),cmov:(u,d,p)=>p?d:u});return Object.freeze(l)}function O2(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function k2(r){const e=O2(r);return e+Math.ceil(e/2)}function gO(r,e,t=!1){const n=r.length,i=O2(e),s=k2(e);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);const o=t?Mf(r):bh(r),a=ni(o,e-ln)+ln;return t?Tm(a,i):Im(a,i)}const $c=BigInt(0),aa=BigInt(1);function Ul(r,e){const t=e.negate();return r?t:e}function mO(r,e,t){const n=s=>s.pz,i=R2(r.Fp,t.map(n));return t.map((s,o)=>s.toAffine(i[o])).map(r.fromAffine)}function D2(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function F0(r,e){D2(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1),i=2**r,s=yh(r),o=BigInt(r);return{windows:t,windowSize:n,mask:s,maxNumber:i,shiftBy:o}}function h1(r,e,t){const{windowSize:n,mask:i,maxNumber:s,shiftBy:o}=t;let a=Number(r&i),c=r>>o;a>n&&(a-=s,c+=aa);const l=e*n,u=l+Math.abs(a)-1,d=a===0,p=a<0,x=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:p,isNegF:x,offsetF:l}}function bO(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function yO(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const j0=new WeakMap,M2=new WeakMap;function q0(r){return M2.get(r)||1}function p1(r){if(r!==$c)throw new Error("invalid wNAF")}function wO(r,e){return{constTimeNegate:Ul,hasPrecomputes(t){return q0(t)!==1},unsafeLadder(t,n,i=r.ZERO){let s=t;for(;n>$c;)n&aa&&(i=i.add(s)),s=s.double(),n>>=aa;return i},precomputeWindow(t,n){const{windows:i,windowSize:s}=F0(n,e),o=[];let a=t,c=a;for(let l=0;l<i;l++){c=a,o.push(c);for(let u=1;u<s;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,i){let s=r.ZERO,o=r.BASE;const a=F0(t,e);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:d,isNeg:p,isNegF:x,offsetF:w}=h1(i,c,a);i=l,d?o=o.add(Ul(x,n[w])):s=s.add(Ul(p,n[u]))}return p1(i),{p:s,f:o}},wNAFUnsafe(t,n,i,s=r.ZERO){const o=F0(t,e);for(let a=0;a<o.windows&&i!==$c;a++){const{nextN:c,offset:l,isZero:u,isNeg:d}=h1(i,a,o);if(i=c,!u){const p=n[l];s=s.add(d?p.negate():p)}}return p1(i),s},getPrecomputes(t,n,i){let s=j0.get(n);return s||(s=this.precomputeWindow(n,t),t!==1&&(typeof i=="function"&&(s=i(s)),j0.set(n,s))),s},wNAFCached(t,n,i){const s=q0(t);return this.wNAF(s,this.getPrecomputes(s,t,i),n)},wNAFCachedUnsafe(t,n,i,s){const o=q0(t);return o===1?this.unsafeLadder(t,n,s):this.wNAFUnsafe(o,this.getPrecomputes(o,t,i),n,s)},setWindowSize(t,n){D2(n,e),M2.set(t,n),j0.delete(t)}}}function xO(r,e,t,n){let i=e,s=r.ZERO,o=r.ZERO;for(;t>$c||n>$c;)t&aa&&(s=s.add(i)),n&aa&&(o=o.add(i)),i=i.double(),t>>=aa,n>>=aa;return{p1:s,p2:o}}function vO(r,e,t,n){bO(t,r),yO(n,e);const i=t.length,s=n.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const o=r.ZERO,a=sO(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=yh(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let p=o;for(let x=d;x>=0;x-=c){u.fill(o);for(let b=0;b<s;b++){const y=n[b],C=Number(y>>BigInt(x)&l);u[C]=u[C].add(t[b])}let w=o;for(let b=u.length-1,y=o;b>0;b--)y=y.add(u[b]),w=w.add(y);if(p=p.add(w),x!==0)for(let b=0;b<c;b++)p=p.double()}return p}function g1(r,e){if(e){if(e.ORDER!==r)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return fO(e),e}else return Qc(r)}function EO(r,e,t={}){if(!e||typeof e!="object")throw new Error(`expected valid ${r} CURVE object`);for(const o of["p","n","h"]){const a=e[o];if(!(typeof a=="bigint"&&a>$c))throw new Error(`CURVE.${o} must be positive bigint`)}const n=g1(e.p,t.Fp),i=g1(e.n,t.Fn),s=["Gx","Gy","a","b"];for(const o of s)if(!n.isValid(e[o]))throw new Error(`CURVE.${o} must be valid field element of CURVE.Fp`);return{Fp:n,Fn:i}}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const pl=BigInt(0),Ka=BigInt(1),Ud=BigInt(2);function AO(r){return wh(r,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...r})}function _O(r){const e=AO(r),{P:t,type:n,adjustScalarBytes:i,powPminus2:s,randomBytes:o}=e,a=n==="x25519";if(!a&&n!=="x448")throw new Error("invalid type");const c=o||Xc,l=a?255:448,u=a?32:56,d=BigInt(a?9:5),p=BigInt(a?121665:39081),x=a?Ud**BigInt(254):Ud**BigInt(447),w=a?BigInt(8)*Ud**BigInt(251)-Ka:BigInt(4)*Ud**BigInt(445)-Ka,b=x+w+Ka,y=B=>ni(B,t),C=T(d);function T(B){return Tm(y(B),u)}function I(B){const W=En("u coordinate",B,u);return a&&(W[31]&=127),y(Mf(W))}function k(B){return Mf(i(En("scalar",B,u)))}function P(B,W){const j=F(I(W),k(B));if(j===pl)throw new Error("invalid private or public key received");return T(j)}function O(B){return P(B,C)}function q(B,W,j){const U=y(B*(W-j));return W=y(W-U),j=y(j+U),{x_2:W,x_3:j}}function F(B,W){fg("u",B,pl,t),fg("scalar",W,x,b);const j=W,U=B;let _=Ka,f=pl,h=B,m=Ka,A=pl;for(let R=BigInt(l-1);R>=pl;R--){const M=j>>R&Ka;A^=M,{x_2:_,x_3:h}=q(A,_,h),{x_2:f,x_3:m}=q(A,f,m),A=M;const E=_+f,g=y(E*E),N=_-f,L=y(N*N),v=g-L,H=h+m,V=h-m,z=y(V*E),G=y(H*N),re=z+G,X=z-G;h=y(re*re),m=y(U*y(X*X)),_=y(g*L),f=y(v*(g+y(p*v)))}({x_2:_,x_3:h}=q(A,_,h)),{x_2:f,x_3:m}=q(A,f,m);const S=s(f);return y(_*S)}return{scalarMult:P,scalarMultBase:O,getSharedSecret:(B,W)=>P(B,W),getPublicKey:B=>O(B),utils:{randomPrivateKey:()=>c(u)},GuBytes:C.slice()}}BigInt(0);const CO=BigInt(1),m1=BigInt(2),SO=BigInt(3),NO=BigInt(5);BigInt(8);const U2={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function IO(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),i=BigInt(80),s=U2.p,o=r*r%s*r%s,a=bi(o,m1,s)*o%s,c=bi(a,CO,s)*r%s,l=bi(c,NO,s)*c%s,u=bi(l,e,s)*l%s,d=bi(u,t,s)*u%s,p=bi(d,n,s)*d%s,x=bi(p,i,s)*p%s,w=bi(x,i,s)*p%s,b=bi(w,e,s)*l%s;return{pow_p_5_8:bi(b,m1,s)*r%s,b2:o}}function TO(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}const hg=(()=>{const r=U2.p;return _O({P:r,type:"x25519",powPminus2:e=>{const{pow_p_5_8:t,b2:n}=IO(e);return ni(bi(t,SO,r)*n,r)},adjustScalarBytes:TO})})();function b1(r){r.lowS!==void 0&&Df("lowS",r.lowS),r.prehash!==void 0&&Df("prehash",r.prehash)}class PO extends Error{constructor(e=""){super(e)}}const Ps={Err:PO,_tlv:{encode:(r,e)=>{const{Err:t}=Ps;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");const n=e.length/2,i=Md(n);if(i.length/2&128)throw new t("tlv.encode: long form length too big");const s=n>127?Md(i.length/2|128):"";return Md(r)+s+i+e},decode(r,e){const{Err:t}=Ps;let n=0;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[n++]!==r)throw new t("tlv.decode: wrong tlv");const i=e[n++],s=!!(i&128);let o=0;if(!s)o=i;else{const c=i&127;if(!c)throw new t("tlv.decode(long): indefinite length not supported");if(c>4)throw new t("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new t("tlv.decode: length bytes not complete");if(l[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new t("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new t("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(r){const{Err:e}=Ps;if(r<Bl)throw new e("integer: negative integers are not allowed");let t=Md(r);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(r){const{Err:e}=Ps;if(r[0]&128)throw new e("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return bh(r)}},toSig(r){const{Err:e,_int:t,_tlv:n}=Ps,i=En("signature",r),{v:s,l:o}=n.decode(48,i);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,s),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(a),s:t.decode(l)}},hexFromSig(r){const{_tlv:e,_int:t}=Ps,n=e.encode(2,t.encode(r.r)),i=e.encode(2,t.encode(r.s)),s=n+i;return e.encode(48,s)}},Bl=BigInt(0),$l=BigInt(1),RO=BigInt(2),Bd=BigInt(3),OO=BigInt(4);function kO(r,e,t){function n(i){const s=r.sqr(i),o=r.mul(s,i);return r.add(r.add(o,r.mul(i,e)),t)}return n}function B2(r,e,t){const{BYTES:n}=r;function i(s){let o;if(typeof s=="bigint")o=s;else{let a=En("private key",s);if(e){if(!e.includes(a.length*2))throw new Error("invalid private key");const c=new Uint8Array(n);c.set(a,c.length-a.length),a=c}try{o=r.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof s}`)}}if(t&&(o=r.create(o)),!r.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}return i}function DO(r,e={}){const{Fp:t,Fn:n}=EO("weierstrass",r,e),{h:i,n:s}=r;wh(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=e;if(o&&(!t.is0(r.a)||typeof o.beta!="bigint"||typeof o.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!t.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function c(F,B,W){const{x:j,y:U}=B.toAffine(),_=t.toBytes(j);if(Df("isCompressed",W),W){a();const f=!t.isOdd(U);return sa($2(f),_)}else return sa(Uint8Array.of(4),_,t.toBytes(U))}function l(F){si(F);const B=t.BYTES,W=B+1,j=2*B+1,U=F.length,_=F[0],f=F.subarray(1);if(U===W&&(_===2||_===3)){const h=t.fromBytes(f);if(!t.isValid(h))throw new Error("bad point: is not on curve, wrong x");const m=p(h);let A;try{A=t.sqrt(m)}catch(R){const M=R instanceof Error?": "+R.message:"";throw new Error("bad point: is not on curve, sqrt error"+M)}a();const S=t.isOdd(A);return(_&1)===1!==S&&(A=t.neg(A)),{x:h,y:A}}else if(U===j&&_===4){const h=t.fromBytes(f.subarray(B*0,B*1)),m=t.fromBytes(f.subarray(B*1,B*2));if(!x(h,m))throw new Error("bad point: is not on curve");return{x:h,y:m}}else throw new Error(`bad point: got length ${U}, expected compressed=${W} or uncompressed=${j}`)}const u=e.toBytes||c,d=e.fromBytes||l,p=kO(t,r.a,r.b);function x(F,B){const W=t.sqr(B),j=p(F);return t.eql(W,j)}if(!x(r.Gx,r.Gy))throw new Error("bad curve params: generator point");const w=t.mul(t.pow(r.a,Bd),OO),b=t.mul(t.sqr(r.b),BigInt(27));if(t.is0(t.add(w,b)))throw new Error("bad curve params: a or b");function y(F,B,W=!1){if(!t.isValid(B)||W&&t.is0(B))throw new Error(`bad point coordinate ${F}`);return B}function C(F){if(!(F instanceof P))throw new Error("ProjectivePoint expected")}const T=u1((F,B)=>{const{px:W,py:j,pz:U}=F;if(t.eql(U,t.ONE))return{x:W,y:j};const _=F.is0();B==null&&(B=_?t.ONE:t.inv(U));const f=t.mul(W,B),h=t.mul(j,B),m=t.mul(U,B);if(_)return{x:t.ZERO,y:t.ZERO};if(!t.eql(m,t.ONE))throw new Error("invZ was invalid");return{x:f,y:h}}),I=u1(F=>{if(F.is0()){if(e.allowInfinityPoint&&!t.is0(F.py))return;throw new Error("bad point: ZERO")}const{x:B,y:W}=F.toAffine();if(!t.isValid(B)||!t.isValid(W))throw new Error("bad point: x or y not field elements");if(!x(B,W))throw new Error("bad point: equation left != right");if(!F.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function k(F,B,W,j,U){return W=new P(t.mul(W.px,F),W.py,W.pz),B=Ul(j,B),W=Ul(U,W),B.add(W)}class P{constructor(B,W,j){this.px=y("x",B),this.py=y("y",W,!0),this.pz=y("z",j),Object.freeze(this)}static fromAffine(B){const{x:W,y:j}=B||{};if(!B||!t.isValid(W)||!t.isValid(j))throw new Error("invalid affine point");if(B instanceof P)throw new Error("projective point not allowed");return t.is0(W)&&t.is0(j)?P.ZERO:new P(W,j,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(B){return mO(P,"pz",B)}static fromBytes(B){return si(B),P.fromHex(B)}static fromHex(B){const W=P.fromAffine(d(En("pointHex",B)));return W.assertValidity(),W}static fromPrivateKey(B){const W=B2(n,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return P.BASE.multiply(W(B))}static msm(B,W){return vO(P,n,B,W)}precompute(B=8,W=!0){return q.setWindowSize(this,B),W||this.multiply(Bd),this}_setWindowSize(B){this.precompute(B)}assertValidity(){I(this)}hasEvenY(){const{y:B}=this.toAffine();if(!t.isOdd)throw new Error("Field doesn't support isOdd");return!t.isOdd(B)}equals(B){C(B);const{px:W,py:j,pz:U}=this,{px:_,py:f,pz:h}=B,m=t.eql(t.mul(W,h),t.mul(_,U)),A=t.eql(t.mul(j,h),t.mul(f,U));return m&&A}negate(){return new P(this.px,t.neg(this.py),this.pz)}double(){const{a:B,b:W}=r,j=t.mul(W,Bd),{px:U,py:_,pz:f}=this;let h=t.ZERO,m=t.ZERO,A=t.ZERO,S=t.mul(U,U),R=t.mul(_,_),M=t.mul(f,f),E=t.mul(U,_);return E=t.add(E,E),A=t.mul(U,f),A=t.add(A,A),h=t.mul(B,A),m=t.mul(j,M),m=t.add(h,m),h=t.sub(R,m),m=t.add(R,m),m=t.mul(h,m),h=t.mul(E,h),A=t.mul(j,A),M=t.mul(B,M),E=t.sub(S,M),E=t.mul(B,E),E=t.add(E,A),A=t.add(S,S),S=t.add(A,S),S=t.add(S,M),S=t.mul(S,E),m=t.add(m,S),M=t.mul(_,f),M=t.add(M,M),S=t.mul(M,E),h=t.sub(h,S),A=t.mul(M,R),A=t.add(A,A),A=t.add(A,A),new P(h,m,A)}add(B){C(B);const{px:W,py:j,pz:U}=this,{px:_,py:f,pz:h}=B;let m=t.ZERO,A=t.ZERO,S=t.ZERO;const R=r.a,M=t.mul(r.b,Bd);let E=t.mul(W,_),g=t.mul(j,f),N=t.mul(U,h),L=t.add(W,j),v=t.add(_,f);L=t.mul(L,v),v=t.add(E,g),L=t.sub(L,v),v=t.add(W,U);let H=t.add(_,h);return v=t.mul(v,H),H=t.add(E,N),v=t.sub(v,H),H=t.add(j,U),m=t.add(f,h),H=t.mul(H,m),m=t.add(g,N),H=t.sub(H,m),S=t.mul(R,v),m=t.mul(M,N),S=t.add(m,S),m=t.sub(g,S),S=t.add(g,S),A=t.mul(m,S),g=t.add(E,E),g=t.add(g,E),N=t.mul(R,N),v=t.mul(M,v),g=t.add(g,N),N=t.sub(E,N),N=t.mul(R,N),v=t.add(v,N),E=t.mul(g,v),A=t.add(A,E),E=t.mul(H,v),m=t.mul(L,m),m=t.sub(m,E),E=t.mul(L,g),S=t.mul(H,S),S=t.add(S,E),new P(m,A,S)}subtract(B){return this.add(B.negate())}is0(){return this.equals(P.ZERO)}multiply(B){const{endo:W}=e;if(!n.isValidNot0(B))throw new Error("invalid scalar: out of range");let j,U;const _=f=>q.wNAFCached(this,f,P.normalizeZ);if(W){const{k1neg:f,k1:h,k2neg:m,k2:A}=W.splitScalar(B),{p:S,f:R}=_(h),{p:M,f:E}=_(A);U=R.add(E),j=k(W.beta,S,M,f,m)}else{const{p:f,f:h}=_(B);j=f,U=h}return P.normalizeZ([j,U])[0]}multiplyUnsafe(B){const{endo:W}=e,j=this;if(!n.isValid(B))throw new Error("invalid scalar: out of range");if(B===Bl||j.is0())return P.ZERO;if(B===$l)return j;if(q.hasPrecomputes(this))return this.multiply(B);if(W){const{k1neg:U,k1:_,k2neg:f,k2:h}=W.splitScalar(B),{p1:m,p2:A}=xO(P,j,_,h);return k(W.beta,m,A,U,f)}else return q.wNAFCachedUnsafe(j,B)}multiplyAndAddUnsafe(B,W,j){const U=this.multiplyUnsafe(W).add(B.multiplyUnsafe(j));return U.is0()?void 0:U}toAffine(B){return T(this,B)}isTorsionFree(){const{isTorsionFree:B}=e;return i===$l?!0:B?B(P,this):q.wNAFCachedUnsafe(this,s).is0()}clearCofactor(){const{clearCofactor:B}=e;return i===$l?this:B?B(P,this):this.multiplyUnsafe(i)}toBytes(B=!0){return Df("isCompressed",B),this.assertValidity(),u(P,this,B)}toRawBytes(B=!0){return this.toBytes(B)}toHex(B=!0){return Au(this.toBytes(B))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}P.BASE=new P(r.Gx,r.Gy,t.ONE),P.ZERO=new P(t.ZERO,t.ONE,t.ZERO),P.Fp=t,P.Fn=n;const O=n.BITS,q=wO(P,e.endo?Math.ceil(O/2):O);return P}function $2(r){return Uint8Array.of(r?2:3)}function MO(r,e,t={}){wh(e,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=e.randomBytes||Xc,i=e.hmac||((j,...U)=>gh(e.hash,j,sa(...U))),{Fp:s,Fn:o}=r,{ORDER:a,BITS:c}=o;function l(j){const U=a>>$l;return j>U}function u(j){return l(j)?o.neg(j):j}function d(j,U){if(!o.isValidNot0(U))throw new Error(`invalid signature ${j}: out of range 1..CURVE.n`)}class p{constructor(U,_,f){d("r",U),d("s",_),this.r=U,this.s=_,f!=null&&(this.recovery=f),Object.freeze(this)}static fromCompact(U){const _=o.BYTES,f=En("compactSignature",U,_*2);return new p(o.fromBytes(f.subarray(0,_)),o.fromBytes(f.subarray(_,_*2)))}static fromDER(U){const{r:_,s:f}=Ps.toSig(En("DER",U));return new p(_,f)}assertValidity(){}addRecoveryBit(U){return new p(this.r,this.s,U)}recoverPublicKey(U){const _=s.ORDER,{r:f,s:h,recovery:m}=this;if(m==null||![0,1,2,3].includes(m))throw new Error("recovery id invalid");if(a*RO<_&&m>1)throw new Error("recovery id is ambiguous for h>1 curve");const A=m===2||m===3?f+a:f;if(!s.isValid(A))throw new Error("recovery id 2 or 3 invalid");const S=s.toBytes(A),R=r.fromHex(sa($2((m&1)===0),S)),M=o.inv(A),E=I(En("msgHash",U)),g=o.create(-E*M),N=o.create(h*M),L=r.BASE.multiplyUnsafe(g).add(R.multiplyUnsafe(N));if(L.is0())throw new Error("point at infinify");return L.assertValidity(),L}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new p(this.r,o.neg(this.s),this.recovery):this}toBytes(U){if(U==="compact")return sa(o.toBytes(this.r),o.toBytes(this.s));if(U==="der")return _m(Ps.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Au(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Au(this.toBytes("compact"))}}const x=B2(o,t.allowedPrivateKeyLengths,t.wrapPrivateKey),w={isValidPrivateKey(j){try{return x(j),!0}catch{return!1}},normPrivateKeyToScalar:x,randomPrivateKey:()=>{const j=a;return gO(n(k2(j)),j)},precompute(j=8,U=r.BASE){return U.precompute(j,!1)}};function b(j,U=!0){return r.fromPrivateKey(j).toBytes(U)}function y(j){if(typeof j=="bigint")return!1;if(j instanceof r)return!0;const U=En("key",j).length,_=s.BYTES,f=_+1,h=2*_+1;if(!(t.allowedPrivateKeyLengths||o.BYTES===f))return U===f||U===h}function C(j,U,_=!0){if(y(j)===!0)throw new Error("first arg must be private key");if(y(U)===!1)throw new Error("second arg must be public key");return r.fromHex(U).multiply(x(j)).toBytes(_)}const T=e.bits2int||function(j){if(j.length>8192)throw new Error("input is too large");const U=bh(j),_=j.length*8-c;return _>0?U>>BigInt(_):U},I=e.bits2int_modN||function(j){return o.create(T(j))},k=yh(c);function P(j){return fg("num < 2^"+c,j,Bl,k),o.toBytes(j)}function O(j,U,_=q){if(["recovered","canonical"].some(L=>L in _))throw new Error("sign() legacy options not supported");const{hash:f}=e;let{lowS:h,prehash:m,extraEntropy:A}=_;h==null&&(h=!0),j=En("msgHash",j),b1(_),m&&(j=En("prehashed msgHash",f(j)));const S=I(j),R=x(U),M=[P(R),P(S)];if(A!=null&&A!==!1){const L=A===!0?n(s.BYTES):A;M.push(En("extraEntropy",L))}const E=sa(...M),g=S;function N(L){const v=T(L);if(!o.isValidNot0(v))return;const H=o.inv(v),V=r.BASE.multiply(v).toAffine(),z=o.create(V.x);if(z===Bl)return;const G=o.create(H*o.create(g+z*R));if(G===Bl)return;let re=(V.x===z?0:2)|Number(V.y&$l),X=G;return h&&l(G)&&(X=u(G),re^=1),new p(z,X,re)}return{seed:E,k2sig:N}}const q={lowS:e.lowS,prehash:!1},F={lowS:e.lowS,prehash:!1};function B(j,U,_=q){const{seed:f,k2sig:h}=O(j,U,_);return oO(e.hash.outputLen,o.BYTES,i)(f,h)}r.BASE.precompute(8);function W(j,U,_,f=F){const h=j;U=En("msgHash",U),_=En("publicKey",_),b1(f);const{lowS:m,prehash:A,format:S}=f;if("strict"in f)throw new Error("options.strict was renamed to lowS");if(S!==void 0&&!["compact","der","js"].includes(S))throw new Error('format must be "compact", "der" or "js"');const R=typeof h=="string"||vm(h),M=!R&&!S&&typeof h=="object"&&h!==null&&typeof h.r=="bigint"&&typeof h.s=="bigint";if(!R&&!M)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let E,g;try{if(M)if(S===void 0||S==="js")E=new p(h.r,h.s);else throw new Error("invalid format");if(R){try{S!=="compact"&&(E=p.fromDER(h))}catch(re){if(!(re instanceof Ps.Err))throw re}!E&&S!=="der"&&(E=p.fromCompact(h))}g=r.fromHex(_)}catch{return!1}if(!E||m&&E.hasHighS())return!1;A&&(U=e.hash(U));const{r:N,s:L}=E,v=I(U),H=o.inv(L),V=o.create(v*H),z=o.create(N*H),G=r.BASE.multiplyUnsafe(V).add(g.multiplyUnsafe(z));return G.is0()?!1:o.create(G.x)===N}return Object.freeze({getPublicKey:b,getSharedSecret:C,sign:B,verify:W,utils:w,Point:r,Signature:p})}function UO(r){const e={a:r.a,b:r.b,p:r.Fp.ORDER,n:r.n,h:r.h,Gx:r.Gx,Gy:r.Gy},t=r.Fp,n=Qc(e.n,r.nBitLength),i={Fp:t,Fn:n,allowedPrivateKeyLengths:r.allowedPrivateKeyLengths,allowInfinityPoint:r.allowInfinityPoint,endo:r.endo,wrapPrivateKey:r.wrapPrivateKey,isTorsionFree:r.isTorsionFree,clearCofactor:r.clearCofactor,fromBytes:r.fromBytes,toBytes:r.toBytes};return{CURVE:e,curveOpts:i}}function BO(r){const{CURVE:e,curveOpts:t}=UO(r),n={hash:r.hash,hmac:r.hmac,randomBytes:r.randomBytes,lowS:r.lowS,bits2int:r.bits2int,bits2int_modN:r.bits2int_modN};return{CURVE:e,curveOpts:t,ecdsaOpts:n}}function $O(r,e){return Object.assign({},e,{ProjectivePoint:e.Point,CURVE:r})}function LO(r){const{CURVE:e,curveOpts:t,ecdsaOpts:n}=BO(r),i=DO(e,t),s=MO(i,n,t);return $O(r,s)}function pg(r,e){const t=n=>LO({...r,hash:n});return{...t(e),create:t}}const L2={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},F2={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},j2={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},FO=Qc(L2.p),jO=Qc(F2.p),qO=Qc(j2.p),HO=pg({...L2,Fp:FO,lowS:!1},ph);pg({...F2,Fp:jO,lowS:!1},ZP),pg({...j2,Fp:qO,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},JP);const WO=HO,q2="base10",un="base16",Cn="base64pad",fo="base64url",ad="utf8",H2=0,ks=1,cd=2,zO=0,y1=1,Ll=12,Pm=32;function KO(){const r=hg.utils.randomPrivateKey(),e=hg.getPublicKey(r);return{privateKey:In(r,un),publicKey:In(e,un)}}function gg(){const r=Xc(Pm);return In(r,un)}function VO(r,e){const t=hg.getSharedSecret(ii(r,un),ii(e,un)),n=nO(mh,t,void 0,void 0,Pm);return In(n,un)}function nf(r){const e=mh(ii(r,un));return In(e,un)}function ei(r){const e=mh(ii(r,ad));return In(e,un)}function W2(r){return ii(`${r}`,q2)}function va(r){return Number(In(r,q2))}function z2(r){return r.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function K2(r){const e=r.replace(/-/g,"+").replace(/_/g,"/"),t=(4-e.length%4)%4;return e+"=".repeat(t)}function GO(r){const e=W2(typeof r.type<"u"?r.type:H2);if(va(e)===ks&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?ii(r.senderPublicKey,un):void 0,n=typeof r.iv<"u"?ii(r.iv,un):Xc(Ll),i=ii(r.symKey,un),s=_2(i,n).encrypt(ii(r.message,ad)),o=V2({type:e,sealed:s,iv:n,senderPublicKey:t});return r.encoding===fo?z2(o):o}function YO(r){const e=ii(r.symKey,un),{sealed:t,iv:n}=Cu({encoded:r.encoded,encoding:r.encoding}),i=_2(e,n).decrypt(t);if(i===null)throw new Error("Failed to decrypt");return In(i,ad)}function JO(r,e){const t=W2(cd),n=Xc(Ll),i=ii(r,ad),s=V2({type:t,sealed:i,iv:n});return e===fo?z2(s):s}function ZO(r,e){const{sealed:t}=Cu({encoded:r,encoding:e});return In(t,ad)}function V2(r){if(va(r.type)===cd)return In(Ml([r.type,r.sealed]),Cn);if(va(r.type)===ks){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return In(Ml([r.type,r.senderPublicKey,r.iv,r.sealed]),Cn)}return In(Ml([r.type,r.iv,r.sealed]),Cn)}function Cu(r){const e=(r.encoding||Cn)===fo?K2(r.encoded):r.encoded,t=ii(e,Cn),n=t.slice(zO,y1),i=y1;if(va(n)===ks){const c=i+Pm,l=c+Ll,u=t.slice(i,c),d=t.slice(c,l),p=t.slice(l);return{type:n,sealed:p,iv:d,senderPublicKey:u}}if(va(n)===cd){const c=t.slice(i),l=Xc(Ll);return{type:n,sealed:c,iv:l}}const s=i+Ll,o=t.slice(i,s),a=t.slice(s);return{type:n,sealed:a,iv:o}}function XO(r,e){const t=Cu({encoded:r,encoding:e?.encoding});return G2({type:va(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?In(t.senderPublicKey,un):void 0,receiverPublicKey:e?.receiverPublicKey})}function G2(r){const e=r?.type||H2;if(e===ks){if(typeof r?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof r?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r?.senderPublicKey,receiverPublicKey:r?.receiverPublicKey}}function w1(r){return r.type===ks&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}function x1(r){return r.type===cd}function QO(r){const e=Buffer.from(r.x,"base64"),t=Buffer.from(r.y,"base64");return Ml([new Uint8Array([4]),e,t])}function e9(r,e){const[t,n,i]=r.split("."),s=Buffer.from(K2(i),"base64");if(s.length!==64)throw new Error("Invalid signature length");const o=s.slice(0,32),a=s.slice(32,64),c=`${t}.${n}`,l=mh(c),u=QO(e);if(!WO.verify(Ml([o,a]),l,u))throw new Error("Invalid signature");return Jp(r).payload}const t9="irn";function Uf(r){return r?.relay||{protocol:t9}}function xc(r){const e=BT[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}function r9(r,e="-"){const t={},n="relay"+e;return Object.keys(r).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),o=r[i];t[s]=o}}),t}function v1(r){if(!r.includes("wc:")){const l=s2(r);l!=null&&l.includes("wc:")&&(r=l)}r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,n=r.substring(0,e),i=r.substring(e+1,t).split("@"),s=typeof t<"u"?r.substring(t):"",o=new URLSearchParams(s),a={};o.forEach((l,u)=>{a[u]=l});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:n9(i[0]),version:parseInt(i[1],10),symKey:a.symKey,relay:r9(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function n9(r){return r.startsWith("//")?r.substring(2):r}function i9(r,e="-"){const t="relay",n={};return Object.keys(r).forEach(i=>{const s=i,o=t+e+s;r[s]&&(n[o]=r[s])}),n}function E1(r){const e=new URLSearchParams,t=i9(r.relay);Object.keys(t).sort().forEach(i=>{e.set(i,t[i])}),e.set("symKey",r.symKey),r.expiryTimestamp&&e.set("expiryTimestamp",r.expiryTimestamp.toString()),r.methods&&e.set("methods",r.methods.join(","));const n=e.toString();return`${r.protocol}:${r.topic}@${r.version}?${n}`}function $d(r,e,t){return`${r}?wc_ev=${t}&topic=${e}`}var s9=Object.defineProperty,o9=Object.defineProperties,a9=Object.getOwnPropertyDescriptors,A1=Object.getOwnPropertySymbols,c9=Object.prototype.hasOwnProperty,l9=Object.prototype.propertyIsEnumerable,_1=(r,e,t)=>e in r?s9(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,u9=(r,e)=>{for(var t in e||(e={}))c9.call(e,t)&&_1(r,t,e[t]);if(A1)for(var t of A1(e))l9.call(e,t)&&_1(r,t,e[t]);return r},d9=(r,e)=>o9(r,a9(e));function el(r){const e=[];return r.forEach(t=>{const[n,i]=t.split(":");e.push(`${n}:${i}`)}),e}function f9(r){const e=[];return Object.values(r).forEach(t=>{e.push(...el(t.accounts))}),e}function h9(r,e){const t=[];return Object.values(r).forEach(n=>{el(n.accounts).includes(e)&&t.push(...n.methods)}),t}function p9(r,e){const t=[];return Object.values(r).forEach(n=>{el(n.accounts).includes(e)&&t.push(...n.events)}),t}function xh(r){return r.includes(":")}function vc(r){return xh(r)?r.split(":")[0]:r}function C1(r){var e,t,n;const i={};if(!ss(r))return i;for(const[s,o]of Object.entries(r)){const a=xh(s)?[s]:o.chains,c=o.methods||[],l=o.events||[],u=vc(s);i[u]=d9(u9({},i[u]),{chains:is(a,(e=i[u])==null?void 0:e.chains),methods:is(c,(t=i[u])==null?void 0:t.methods),events:is(l,(n=i[u])==null?void 0:n.events)})}return i}function g9(r){const e={};return r?.forEach(t=>{var n;const[i,s]=t.split(":");e[i]||(e[i]={accounts:[],chains:[],events:[],methods:[]}),e[i].accounts.push(t),(n=e[i].chains)==null||n.push(`${i}:${s}`)}),e}function S1(r,e){e=e.map(n=>n.replace("did:pkh:",""));const t=g9(e);for(const[n,i]of Object.entries(t))i.methods?i.methods=is(i.methods,r):i.methods=r,i.events=["chainChanged","accountsChanged"];return t}function m9(r,e){var t,n,i,s,o,a;const c=C1(r),l=C1(e),u={},d=Object.keys(c).concat(Object.keys(l));for(const p of d)u[p]={chains:is((t=c[p])==null?void 0:t.chains,(n=l[p])==null?void 0:n.chains),methods:is((i=c[p])==null?void 0:i.methods,(s=l[p])==null?void 0:s.methods),events:is((o=c[p])==null?void 0:o.events,(a=l[p])==null?void 0:a.events)};return u}const b9={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},y9={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ce(r,e){const{message:t,code:n}=y9[r];return{message:e?`${t} ${e}`:t,code:n}}function Qt(r,e){const{message:t,code:n}=b9[r];return{message:e?`${t} ${e}`:t,code:n}}function Ds(r,e){return!!Array.isArray(r)}function ss(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function vr(r){return typeof r>"u"}function gr(r,e){return e&&vr(r)?!0:typeof r=="string"&&!!r.trim().length}function Rm(r,e){return e&&vr(r)?!0:typeof r=="number"&&!isNaN(r)}function w9(r,e){const{requiredNamespaces:t}=e,n=Object.keys(r.namespaces),i=Object.keys(t);let s=!0;return ia(i,n)?(n.forEach(o=>{const{accounts:a,methods:c,events:l}=r.namespaces[o],u=el(a),d=t[o];(!ia(e2(o,d),u)||!ia(d.methods,c)||!ia(d.events,l))&&(s=!1)}),s):!1}function Bf(r){return gr(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function x9(r){if(gr(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&Bf(t)}}return!1}function v9(r){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(gr(r,!1)){if(e(r))return!0;const t=s2(r);return e(t)}}catch{}return!1}function E9(r){var e;return(e=r?.proposer)==null?void 0:e.publicKey}function A9(r){return r?.topic}function _9(r,e){let t=null;return gr(r?.publicKey,!1)||(t=ce("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function N1(r){let e=!0;return Ds(r)?r.length&&(e=r.every(t=>gr(t,!1))):e=!1,e}function C9(r,e,t){let n=null;return Ds(e)&&e.length?e.forEach(i=>{n||Bf(i)||(n=Qt("UNSUPPORTED_CHAINS",`${t}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):Bf(r)||(n=Qt("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function S9(r,e,t){let n=null;return Object.entries(r).forEach(([i,s])=>{if(n)return;const o=C9(i,e2(i,s),`${e} ${t}`);o&&(n=o)}),n}function N9(r,e){let t=null;return Ds(r)?r.forEach(n=>{t||x9(n)||(t=Qt("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):t=Qt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function I9(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const i=N9(n?.accounts,`${e} namespace`);i&&(t=i)}),t}function T9(r,e){let t=null;return N1(r?.methods)?N1(r?.events)||(t=Qt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Qt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function Y2(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const i=T9(n,`${e}, namespace`);i&&(t=i)}),t}function P9(r,e,t){let n=null;if(r&&ss(r)){const i=Y2(r,e);i&&(n=i);const s=S9(r,e,t);s&&(n=s)}else n=ce("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return n}function H0(r,e){let t=null;if(r&&ss(r)){const n=Y2(r,e);n&&(t=n);const i=I9(r,e);i&&(t=i)}else t=ce("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function J2(r){return gr(r.protocol,!0)}function R9(r,e){let t=!1;return r?r&&Ds(r)&&r.length&&r.forEach(n=>{t=J2(n)}):t=!0,t}function O9(r){return typeof r=="number"}function xn(r){return typeof r<"u"&&typeof r!==null}function k9(r){return!(!r||typeof r!="object"||!r.code||!Rm(r.code,!1)||!r.message||!gr(r.message,!1))}function D9(r){return!(vr(r)||!gr(r.method,!1))}function M9(r){return!(vr(r)||vr(r.result)&&vr(r.error)||!Rm(r.id,!1)||!gr(r.jsonrpc,!1))}function U9(r){return!(vr(r)||!gr(r.name,!1))}function I1(r,e){return!(!Bf(e)||!f9(r).includes(e))}function B9(r,e,t){return gr(t,!1)?h9(r,e).includes(t):!1}function $9(r,e,t){return gr(t,!1)?p9(r,e).includes(t):!1}function T1(r,e,t){let n=null;const i=L9(r),s=F9(e),o=Object.keys(i),a=Object.keys(s),c=P1(Object.keys(r)),l=P1(Object.keys(e)),u=c.filter(d=>!l.includes(d));return u.length&&(n=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),ia(o,a)||(n=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||n)return;const p=el(e[d].accounts);p.includes(d)||(n=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${p.toString()}`))}),o.forEach(d=>{n||(ia(i[d].methods,s[d].methods)?ia(i[d].events,s[d].events)||(n=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${d}`)):n=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${d}`))}),n}function L9(r){const e={};return Object.keys(r).forEach(t=>{var n;t.includes(":")?e[t]=r[t]:(n=r[t].chains)==null||n.forEach(i=>{e[i]={methods:r[t].methods,events:r[t].events}})}),e}function P1(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function F9(r){const e={};return Object.keys(r).forEach(t=>{t.includes(":")?e[t]=r[t]:el(r[t].accounts)?.forEach(i=>{e[i]={accounts:r[t].accounts.filter(s=>s.includes(`${i}:`)),methods:r[t].methods,events:r[t].events}})}),e}function j9(r,e){return Rm(r,!1)&&r<=e.max&&r>=e.min}function R1(){const r=sd();return new Promise(e=>{switch(r){case jn.browser:e(q9());break;case jn.reactNative:e(H9());break;case jn.node:e(W9());break;default:e(!0)}})}function q9(){return Zc()&&navigator?.onLine}async function H9(){return No()&&typeof global<"u"&&global!=null&&global.NetInfo?(await(global==null?void 0:global.NetInfo.fetch()))?.isConnected:!0}function W9(){return!0}function z9(r){switch(sd()){case jn.browser:K9(r);break;case jn.reactNative:V9(r);break}}function K9(r){!No()&&Zc()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function V9(r){No()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>r(e?.isConnected))}function G9(){var r;return Zc()&&$s.getDocument()?((r=$s.getDocument())==null?void 0:r.visibilityState)==="visible":!0}const W0={};class gl{static get(e){return W0[e]}static set(e,t){W0[e]=t}static delete(e){delete W0[e]}}function Y9(r){const e=Jc.decode(r);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function J9({publicKey:r,signature:e,payload:t}){var n;const i=mg(t.method),s=128|parseInt(((n=t.version)==null?void 0:n.toString())||"4"),o=Q9(t.address),a=t.era==="00"?new Uint8Array([0]):mg(t.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(t.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${X9(t.tip)}`),d=t7(u),p=new Uint8Array([0,...r,o,...e,...a,...l,...d,...i]),x=e7(p.length+1);return new Uint8Array([...x,s,...p])}function Z9(r){const e=mg(r),t=jT.blake2b(e,void 0,32);return"0x"+Buffer.from(t).toString("hex")}function mg(r){return new Uint8Array(r.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function X9(r){return r.startsWith("0x")?r.slice(2):r}function Q9(r){const e=Jc.decode(r)[0];return e===42?0:e===60?2:1}function e7(r){if(r<64)return new Uint8Array([r<<2]);if(r<16384){const e=r<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(r<1<<30){const e=r<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function t7(r){if(r<BigInt(1)<<BigInt(6))return new Uint8Array([Number(r<<BigInt(2))]);if(r<BigInt(1)<<BigInt(14)){const e=r<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(r<BigInt(1)<<BigInt(30)){const e=r<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function r7(r){const e=Uint8Array.from(Buffer.from(r.signature,"hex")),t=Y9(r.transaction.address),n=J9({publicKey:t,signature:e,payload:r.transaction}),i=Buffer.from(n).toString("hex");return Z9(i)}const n7="PARSE_ERROR",i7="INVALID_REQUEST",s7="METHOD_NOT_FOUND",o7="INVALID_PARAMS",Z2="INTERNAL_ERROR",Om="SERVER_ERROR",a7=[-32700,-32600,-32601,-32602,-32603],Fl={[n7]:{code:-32700,message:"Parse error"},[i7]:{code:-32600,message:"Invalid Request"},[s7]:{code:-32601,message:"Method not found"},[o7]:{code:-32602,message:"Invalid params"},[Z2]:{code:-32603,message:"Internal error"},[Om]:{code:-32e3,message:"Server error"}},X2=Om;function c7(r){return a7.includes(r)}function O1(r){return Object.keys(Fl).includes(r)?Fl[r]:Fl[X2]}function l7(r){const e=Object.values(Fl).find(t=>t.code===r);return e||Fl[X2]}function Q2(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}var z0={},vs={},k1;function u7(){if(k1)return vs;k1=1,Object.defineProperty(vs,"__esModule",{value:!0}),vs.isBrowserCryptoAvailable=vs.getSubtleCrypto=vs.getBrowerCrypto=void 0;function r(){return Ei?.crypto||Ei?.msCrypto||{}}vs.getBrowerCrypto=r;function e(){const n=r();return n.subtle||n.webkitSubtle}vs.getSubtleCrypto=e;function t(){return!!r()&&!!e()}return vs.isBrowserCryptoAvailable=t,vs}var Es={},D1;function d7(){if(D1)return Es;D1=1,Object.defineProperty(Es,"__esModule",{value:!0}),Es.isBrowser=Es.isNode=Es.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Es.isReactNative=r;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Es.isNode=e;function t(){return!r()&&!e()}return Es.isBrowser=t,Es}var M1;function f7(){return M1||(M1=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Qu;e.__exportStar(u7(),r),e.__exportStar(d7(),r)})(z0)),z0}var h7=f7();function zi(r=3){const e=Date.now()*Math.pow(10,r),t=Math.floor(Math.random()*Math.pow(10,r));return e+t}function mo(r=6){return BigInt(zi(r))}function Gi(r,e,t){return{id:t||zi(),jsonrpc:"2.0",method:r,params:e}}function Su(r,e){return{id:r,jsonrpc:"2.0",result:e}}function vh(r,e,t){return{id:r,jsonrpc:"2.0",error:p7(e)}}function p7(r,e){return typeof r>"u"?O1(Z2):(typeof r=="string"&&(r=Object.assign(Object.assign({},O1(Om)),{message:r})),c7(r.code)&&(r=l7(r.code)),r)}let g7=class{},m7=class extends g7{constructor(){super()}},b7=class extends m7{constructor(e){super()}};const y7="^https?:",w7="^wss?:";function x7(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function eA(r,e){const t=x7(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function U1(r){return eA(r,y7)}function B1(r){return eA(r,w7)}function v7(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function tA(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function km(r){return tA(r)&&"method"in r}function Eh(r){return tA(r)&&(Ki(r)||ti(r))}function Ki(r){return"result"in r}function ti(r){return"error"in r}let li=class extends b7{constructor(e){super(e),this.events=new ci.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Gi(e.method,e.params||[],e.id||mo().toString()),t)}async requestStrict(e,t){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${e.id}`,s=>{ti(s)?i(s.error):n(s.result)});try{await this.connection.send(e,t)}catch(s){i(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Eh(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const E7=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),A7=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",$1=r=>r.split("?")[0],L1=10,_7=E7();let C7=class{constructor(e){if(this.url=e,this.events=new ci.EventEmitter,this.registering=!1,!B1(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Bs(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!B1(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,n)=>{const i=h7.isReactNative()?void 0:{rejectUnauthorized:!v7(e)},s=new _7(e,[],i);A7()?s.onerror=o=>{const a=o;n(this.emitError(a.error))}:s.on("error",o=>{n(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),t(s)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?ya(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),i=n.message||n.toString(),s=vh(e,i);this.events.emit("payload",s)}parseError(e,t=this.url){return Q2(e,$1(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>L1&&this.events.setMaxListeners(L1)}emitError(e){const t=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${$1(this.url)}`));return this.events.emit("register_error",t),t}};var S7={};const rA="wc",nA=2,bg="core",as=`${rA}@2:${bg}:`,N7={logger:"error"},I7={database:":memory:"},T7="crypto",F1="client_ed25519_seed",P7=le.ONE_DAY,R7="keychain",O7="0.3",k7="messages",D7="0.3",M7=le.SIX_HOURS,U7="publisher",iA="irn",B7="error",sA="wss://relay.walletconnect.org",$7="relayer",ur={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},L7="_subscription",Gn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},F7=.1,yg="2.21.7",Zt={link_mode:"link_mode",relay:"relay"},sf={inbound:"inbound",outbound:"outbound"},j7="0.3",q7="WALLETCONNECT_CLIENT_ID",j1="WALLETCONNECT_LINK_MODE_APPS",Mn={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},H7="subscription",W7="0.3",z7="pairing",K7="0.3",ml={wc_pairingDelete:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:le.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:le.ONE_DAY,prompt:!1,tag:0},res:{ttl:le.ONE_DAY,prompt:!1,tag:0}}},Xo={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},gi={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},V7="history",G7="0.3",Y7="expirer",Qn={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},J7="0.3",Z7="verify-api",X7="https://verify.walletconnect.com",oA="https://verify.walletconnect.org",jl=oA,Q7=`${jl}/v3`,ek=[X7,oA],tk="echo",rk="https://echo.walletconnect.com",Hi={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Cs={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},so={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},bl={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},zo={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},yl={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},nk=.1,ik="event-client",sk=86400,ok="https://pulse.walletconnect.org/batch";function ak(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<r.length;i++){var s=r.charAt(i),o=s.charCodeAt(0);if(t[o]!==255)throw new TypeError(s+" is ambiguous");t[o]=i}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var b=0,y=0,C=0,T=w.length;C!==T&&w[C]===0;)C++,b++;for(var I=(T-C)*u+1>>>0,k=new Uint8Array(I);C!==T;){for(var P=w[C],O=0,q=I-1;(P!==0||O<y)&&q!==-1;q--,O++)P+=256*k[q]>>>0,k[q]=P%a>>>0,P=P/a>>>0;if(P!==0)throw new Error("Non-zero carry");y=O,C++}for(var F=I-y;F!==I&&k[F]===0;)F++;for(var B=c.repeat(b);F<I;++F)B+=r.charAt(k[F]);return B}function p(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var b=0;if(w[b]!==" "){for(var y=0,C=0;w[b]===c;)y++,b++;for(var T=(w.length-b)*l+1>>>0,I=new Uint8Array(T);w[b];){var k=t[w.charCodeAt(b)];if(k===255)return;for(var P=0,O=T-1;(k!==0||P<C)&&O!==-1;O--,P++)k+=a*I[O]>>>0,I[O]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");C=P,b++}if(w[b]!==" "){for(var q=T-C;q!==T&&I[q]===0;)q++;for(var F=new Uint8Array(y+(T-q)),B=y;q!==T;)F[B++]=I[q++];return F}}}function x(w){var b=p(w);if(b)return b;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:p,decode:x}}var ck=ak,lk=ck;const aA=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},uk=r=>new TextEncoder().encode(r),dk=r=>new TextDecoder().decode(r);class fk{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class hk{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return cA(this,e)}}class pk{constructor(e){this.decoders=e}or(e){return cA(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const cA=(r,e)=>new pk({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class gk{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new fk(e,t,n),this.decoder=new hk(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ah=({name:r,prefix:e,encode:t,decode:n})=>new gk(r,e,t,n),ld=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:i}=lk(t,e);return Ah({prefix:r,name:e,encode:n,decode:s=>aA(i(s))})},mk=(r,e,t,n)=>{const i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let s=r.length;for(;r[s-1]==="=";)--s;const o=new Uint8Array(s*t/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const d=i[r[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|d,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},bk=(r,e,t)=>{const n=e[e.length-1]==="=",i=(1<<t)-1;let s="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,s+=e[i&a>>o];if(o&&(s+=e[i&a<<t-o]),n)for(;s.length*t&7;)s+="=";return s},qr=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Ah({prefix:e,name:r,encode(i){return bk(i,n,t)},decode(i){return mk(i,n,t,r)}}),yk=Ah({prefix:"\0",name:"identity",encode:r=>dk(r),decode:r=>uk(r)});var wk=Object.freeze({__proto__:null,identity:yk});const xk=qr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var vk=Object.freeze({__proto__:null,base2:xk});const Ek=qr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ak=Object.freeze({__proto__:null,base8:Ek});const _k=ld({prefix:"9",name:"base10",alphabet:"0123456789"});var Ck=Object.freeze({__proto__:null,base10:_k});const Sk=qr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Nk=qr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ik=Object.freeze({__proto__:null,base16:Sk,base16upper:Nk});const Tk=qr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Pk=qr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Rk=qr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ok=qr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),kk=qr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Dk=qr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Mk=qr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Uk=qr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Bk=qr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var $k=Object.freeze({__proto__:null,base32:Tk,base32upper:Pk,base32pad:Rk,base32padupper:Ok,base32hex:kk,base32hexupper:Dk,base32hexpad:Mk,base32hexpadupper:Uk,base32z:Bk});const Lk=ld({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Fk=ld({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var jk=Object.freeze({__proto__:null,base36:Lk,base36upper:Fk});const qk=ld({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Hk=ld({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Wk=Object.freeze({__proto__:null,base58btc:qk,base58flickr:Hk});const zk=qr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Kk=qr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Vk=qr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Gk=qr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Yk=Object.freeze({__proto__:null,base64:zk,base64pad:Kk,base64url:Vk,base64urlpad:Gk});const lA=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Jk=lA.reduce((r,e,t)=>(r[t]=e,r),[]),Zk=lA.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function Xk(r){return r.reduce((e,t)=>(e+=Jk[t],e),"")}function Qk(r){const e=[];for(const t of r){const n=Zk[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const eD=Ah({prefix:"🚀",name:"base256emoji",encode:Xk,decode:Qk});var tD=Object.freeze({__proto__:null,base256emoji:eD}),rD=uA,q1=128,nD=-128,iD=Math.pow(2,31);function uA(r,e,t){e=e||[],t=t||0;for(var n=t;r>=iD;)e[t++]=r&255|q1,r/=128;for(;r&nD;)e[t++]=r&255|q1,r>>>=7;return e[t]=r|0,uA.bytes=t-n+1,e}var sD=wg,oD=128,H1=127;function wg(r,n){var t=0,n=n||0,i=0,s=n,o,a=r.length;do{if(s>=a)throw wg.bytes=0,new RangeError("Could not decode varint");o=r[s++],t+=i<28?(o&H1)<<i:(o&H1)*Math.pow(2,i),i+=7}while(o>=oD);return wg.bytes=s-n,t}var aD=Math.pow(2,7),cD=Math.pow(2,14),lD=Math.pow(2,21),uD=Math.pow(2,28),dD=Math.pow(2,35),fD=Math.pow(2,42),hD=Math.pow(2,49),pD=Math.pow(2,56),gD=Math.pow(2,63),mD=function(r){return r<aD?1:r<cD?2:r<lD?3:r<uD?4:r<dD?5:r<fD?6:r<hD?7:r<pD?8:r<gD?9:10},bD={encode:rD,decode:sD,encodingLength:mD},dA=bD;const W1=(r,e,t=0)=>(dA.encode(r,e,t),e),z1=r=>dA.encodingLength(r),xg=(r,e)=>{const t=e.byteLength,n=z1(r),i=n+z1(t),s=new Uint8Array(i+t);return W1(r,s,0),W1(t,s,n),s.set(e,i),new yD(r,t,e,s)};class yD{constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}}const fA=({name:r,code:e,encode:t})=>new wD(r,e,t);class wD{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?xg(this.code,t):t.then(n=>xg(this.code,n))}else throw Error("Unknown type, must be binary type")}}const hA=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),xD=fA({name:"sha2-256",code:18,encode:hA("SHA-256")}),vD=fA({name:"sha2-512",code:19,encode:hA("SHA-512")});var ED=Object.freeze({__proto__:null,sha256:xD,sha512:vD});const pA=0,AD="identity",gA=aA,_D=r=>xg(pA,gA(r)),CD={code:pA,name:AD,encode:gA,digest:_D};var SD=Object.freeze({__proto__:null,identity:CD});new TextEncoder,new TextDecoder;const K1={...wk,...vk,...Ak,...Ck,...Ik,...$k,...jk,...Wk,...Yk,...tD};({...ED,...SD});function mA(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function ND(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?mA(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function bA(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const V1=bA("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),K0=bA("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=ND(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),ID={utf8:V1,"utf-8":V1,hex:K1.base16,latin1:K0,ascii:K0,binary:K0,...K1};function TD(r,e="utf8"){const t=ID[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?mA(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}var PD=Object.defineProperty,RD=(r,e,t)=>e in r?PD(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Fi=(r,e,t)=>RD(r,typeof e!="symbol"?e+"":e,t);class OD{constructor(e,t){this.core=e,this.logger=t,Fi(this,"keychain",new Map),Fi(this,"name",R7),Fi(this,"version",O7),Fi(this,"initialized",!1),Fi(this,"storagePrefix",as),Fi(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),Fi(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),Fi(this,"set",async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()}),Fi(this,"get",n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i}),Fi(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=tn(t,this.name)}get context(){return Pn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ig(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?sg(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}var kD=Object.defineProperty,DD=(r,e,t)=>e in r?kD(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Or=(r,e,t)=>DD(r,typeof e!="symbol"?e+"":e,t);class MD{constructor(e,t,n){this.core=e,this.logger=t,Or(this,"name",T7),Or(this,"keychain"),Or(this,"randomSessionIdentifier",gg()),Or(this,"initialized",!1),Or(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Or(this,"hasKeys",i=>(this.isInitialized(),this.keychain.has(i))),Or(this,"getClientId",async()=>{this.isInitialized();const i=await this.getClientSeed(),s=Ey(i);return PE(s.publicKey)}),Or(this,"generateKeyPair",()=>{this.isInitialized();const i=KO();return this.setPrivateKey(i.publicKey,i.privateKey)}),Or(this,"signJWT",async i=>{this.isInitialized();const s=await this.getClientSeed(),o=Ey(s),a=this.randomSessionIdentifier;return await pN(a,i,P7,o)}),Or(this,"generateSharedKey",(i,s,o)=>{this.isInitialized();const a=this.getPrivateKey(i),c=VO(a,s);return this.setSymKey(c,o)}),Or(this,"setSymKey",async(i,s)=>{this.isInitialized();const o=s||nf(i);return await this.keychain.set(o,i),o}),Or(this,"deleteKeyPair",async i=>{this.isInitialized(),await this.keychain.del(i)}),Or(this,"deleteSymKey",async i=>{this.isInitialized(),await this.keychain.del(i)}),Or(this,"encode",async(i,s,o)=>{this.isInitialized();const a=G2(o),c=Bs(s);if(x1(a))return JO(c,o?.encoding);if(w1(a)){const p=a.senderPublicKey,x=a.receiverPublicKey;i=await this.generateSharedKey(p,x)}const l=this.getSymKey(i),{type:u,senderPublicKey:d}=a;return GO({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o?.encoding})}),Or(this,"decode",async(i,s,o)=>{this.isInitialized();const a=XO(s,o);if(x1(a)){const c=ZO(s,o?.encoding);return ya(c)}if(w1(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;i=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(i),l=YO({symKey:c,encoded:s,encoding:o?.encoding});return ya(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Or(this,"getPayloadType",(i,s=Cn)=>{const o=Cu({encoded:i,encoding:s});return va(o.type)}),Or(this,"getPayloadSenderPublicKey",(i,s=Cn)=>{const o=Cu({encoded:i,encoding:s});return o.senderPublicKey?In(o.senderPublicKey,un):void 0}),this.core=e,this.logger=tn(t,this.name),this.keychain=n||new OD(this.core,this.logger)}get context(){return Pn(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(F1)}catch{e=gg(),await this.keychain.set(F1,e)}return TD(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}var UD=Object.defineProperty,BD=Object.defineProperties,$D=Object.getOwnPropertyDescriptors,G1=Object.getOwnPropertySymbols,LD=Object.prototype.hasOwnProperty,FD=Object.prototype.propertyIsEnumerable,vg=(r,e,t)=>e in r?UD(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,jD=(r,e)=>{for(var t in e||(e={}))LD.call(e,t)&&vg(r,t,e[t]);if(G1)for(var t of G1(e))FD.call(e,t)&&vg(r,t,e[t]);return r},qD=(r,e)=>BD(r,$D(e)),Dn=(r,e,t)=>vg(r,typeof e!="symbol"?e+"":e,t);class HD extends f8{constructor(e,t){super(e,t),this.logger=e,this.core=t,Dn(this,"messages",new Map),Dn(this,"messagesWithoutClientAck",new Map),Dn(this,"name",k7),Dn(this,"version",D7),Dn(this,"initialized",!1),Dn(this,"storagePrefix",as),Dn(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const i=await this.getRelayerMessagesWithoutClientAck();typeof i<"u"&&(this.messagesWithoutClientAck=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),Dn(this,"set",async(n,i,s)=>{this.isInitialized();const o=ei(i);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=i,this.messages.set(n,a),s===sf.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,qD(jD({},c),{[o]:i}))}return await this.persist(),o}),Dn(this,"get",n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i}),Dn(this,"getWithoutAck",n=>{this.isInitialized();const i={};for(const s of n){const o=this.messagesWithoutClientAck.get(s)||{};i[s]=Object.values(o)}return i}),Dn(this,"has",(n,i)=>{this.isInitialized();const s=this.get(n),o=ei(i);return typeof s[o]<"u"}),Dn(this,"ack",async(n,i)=>{this.isInitialized();const s=this.messagesWithoutClientAck.get(n);if(typeof s>"u")return;const o=ei(i);delete s[o],Object.keys(s).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,s),await this.persist()}),Dn(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=tn(e,this.name),this.core=t}get context(){return Pn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ig(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,ig(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?sg(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?sg(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}var WD=Object.defineProperty,zD=Object.defineProperties,KD=Object.getOwnPropertyDescriptors,Y1=Object.getOwnPropertySymbols,VD=Object.prototype.hasOwnProperty,GD=Object.prototype.propertyIsEnumerable,Eg=(r,e,t)=>e in r?WD(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Va=(r,e)=>{for(var t in e||(e={}))VD.call(e,t)&&Eg(r,t,e[t]);if(Y1)for(var t of Y1(e))GD.call(e,t)&&Eg(r,t,e[t]);return r},J1=(r,e)=>zD(r,KD(e)),Yn=(r,e,t)=>Eg(r,typeof e!="symbol"?e+"":e,t);class YD extends h8{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Yn(this,"events",new ci.EventEmitter),Yn(this,"name",U7),Yn(this,"queue",new Map),Yn(this,"publishTimeout",le.toMiliseconds(le.ONE_MINUTE)),Yn(this,"initialPublishTimeout",le.toMiliseconds(le.ONE_SECOND*15)),Yn(this,"needsTransportRestart",!1),Yn(this,"publish",async(n,i,s)=>{var o,a,c,l,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});const d=s?.ttl||M7,p=s?.prompt||!1,x=s?.tag||0,w=s?.id||mo().toString(),b=xc(Uf().protocol),y={id:w,method:s?.publishMethod||b.publish,params:Va({topic:n,message:i,ttl:d,prompt:p,tag:x,attestation:s?.attestation},s?.tvf&&{tvf:s.tvf})},C=`Failed to publish payload, please try again. id:${w} tag:${x}`;try{vr((o=y.params)==null?void 0:o.prompt)&&((a=y.params)==null||delete a.prompt),vr((c=y.params)==null?void 0:c.tag)&&((l=y.params)==null||delete l.tag);const T=new Promise(async I=>{const k=({id:O})=>{var q;((q=y.id)==null?void 0:q.toString())===O.toString()&&(this.removeRequestFromQueue(O),this.relayer.events.removeListener(ur.publish,k),I())};this.relayer.events.on(ur.publish,k);const P=Qi(new Promise((O,q)=>{this.rpcPublish(y,s).then(O).catch(F=>{this.logger.warn(F,F?.message),q(F)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${w} tag:${x}`);try{await P,this.events.removeListener(ur.publish,k)}catch(O){this.queue.set(w,{request:y,opts:s,attempt:1}),this.logger.warn(O,O?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:w,topic:n,message:i,opts:s}}),await Qi(T,this.publishTimeout,C)}catch(T){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(T),(u=s?.internal)!=null&&u.throwOnFailedPublish)throw T}finally{this.queue.delete(w)}}),Yn(this,"publishCustom",async n=>{var i,s,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:n});const{payload:l,opts:u={}}=n,{attestation:d,tvf:p,publishMethod:x,prompt:w,tag:b,ttl:y=le.FIVE_MINUTES}=u,C=u.id||mo().toString(),T=xc(Uf().protocol),I=x||T.publish,k={id:C,method:I,params:Va(J1(Va({},l),{ttl:y,prompt:w,tag:b,attestation:d}),p)},P=`Failed to publish custom payload, please try again. id:${C} tag:${b}`;try{vr((i=k.params)==null?void 0:i.prompt)&&((s=k.params)==null||delete s.prompt),vr((o=k.params)==null?void 0:o.tag)&&((a=k.params)==null||delete a.tag);const O=new Promise(async q=>{const F=({id:W})=>{var j;((j=k.id)==null?void 0:j.toString())===W.toString()&&(this.removeRequestFromQueue(W),this.relayer.events.removeListener(ur.publish,F),q())};this.relayer.events.on(ur.publish,F);const B=Qi(new Promise((W,j)=>{this.rpcPublish(k,u).then(W).catch(U=>{this.logger.warn(U,U?.message),j(U)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${I} id:${C} tag:${b}`);try{await B,this.events.removeListener(ur.publish,F)}catch(W){this.queue.set(C,{request:k,opts:u,attempt:1}),this.logger.warn(W,W?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:C,payload:l,opts:u}}),await Qi(O,this.publishTimeout,P)}catch(O){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(O),(c=u?.internal)!=null&&c.throwOnFailedPublish)throw O}finally{this.queue.delete(C)}}),Yn(this,"on",(n,i)=>{this.events.on(n,i)}),Yn(this,"once",(n,i)=>{this.events.once(n,i)}),Yn(this,"off",(n,i)=>{this.events.off(n,i)}),Yn(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.relayer=e,this.logger=tn(t,this.name),this.registerEventListeners()}get context(){return Pn(this.logger)}async rpcPublish(e,t){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const n=await this.relayer.request(e);return this.relayer.events.emit(ur.publish,Va(Va({},e),t)),this.logger.debug("Successfully Published Payload"),n}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{var n;const i=e.attempt+1;this.queue.set(t,J1(Va({},e),{attempt:i})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(n=e.request.params)==null?void 0:n.tag}, attempt: ${i}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(ka.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(ur.connection_stalled);return}this.checkQueue()}),this.relayer.on(ur.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var JD=Object.defineProperty,ZD=(r,e,t)=>e in r?JD(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ga=(r,e,t)=>ZD(r,typeof e!="symbol"?e+"":e,t);class XD{constructor(){Ga(this,"map",new Map),Ga(this,"set",(e,t)=>{const n=this.get(e);this.exists(e,t)||this.map.set(e,[...n,t])}),Ga(this,"get",e=>this.map.get(e)||[]),Ga(this,"exists",(e,t)=>this.get(e).includes(t)),Ga(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,t))return;const i=n.filter(s=>s!==t);if(!i.length){this.map.delete(e);return}this.map.set(e,i)}),Ga(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var QD=Object.defineProperty,eM=Object.defineProperties,tM=Object.getOwnPropertyDescriptors,Z1=Object.getOwnPropertySymbols,rM=Object.prototype.hasOwnProperty,nM=Object.prototype.propertyIsEnumerable,Ag=(r,e,t)=>e in r?QD(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,wl=(r,e)=>{for(var t in e||(e={}))rM.call(e,t)&&Ag(r,t,e[t]);if(Z1)for(var t of Z1(e))nM.call(e,t)&&Ag(r,t,e[t]);return r},V0=(r,e)=>eM(r,tM(e)),_t=(r,e,t)=>Ag(r,typeof e!="symbol"?e+"":e,t);class iM extends m8{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,_t(this,"subscriptions",new Map),_t(this,"topicMap",new XD),_t(this,"events",new ci.EventEmitter),_t(this,"name",H7),_t(this,"version",W7),_t(this,"pending",new Map),_t(this,"cached",[]),_t(this,"initialized",!1),_t(this,"storagePrefix",as),_t(this,"subscribeTimeout",le.toMiliseconds(le.ONE_MINUTE)),_t(this,"initialSubscribeTimeout",le.toMiliseconds(le.ONE_SECOND*15)),_t(this,"clientId"),_t(this,"batchSubscribeTopicsLimit",500),_t(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),_t(this,"subscribe",async(n,i)=>{var s;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const o=Uf(i),a={topic:n,relay:o,transportType:i?.transportType};(s=i?.internal)!=null&&s.skipSubscribe||this.pending.set(n,a);const c=await this.rpcSubscribe(n,o,i);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),_t(this,"unsubscribe",async(n,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)}),_t(this,"isSubscribed",n=>new Promise(i=>{i(this.topicMap.topics.includes(n))})),_t(this,"isKnownTopic",n=>new Promise(i=>{i(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(s=>s.topic===n))})),_t(this,"on",(n,i)=>{this.events.on(n,i)}),_t(this,"once",(n,i)=>{this.events.once(n,i)}),_t(this,"off",(n,i)=>{this.events.off(n,i)}),_t(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),_t(this,"start",async()=>{await this.onConnect()}),_t(this,"stop",async()=>{await this.onDisconnect()}),_t(this,"restart",async()=>{await this.restore(),await this.onRestart()}),_t(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(i=>{n.push(i)}),await this.batchSubscribe(n)}),_t(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(ka.pulse,async()=>{await this.checkPending()}),this.events.on(Mn.created,async n=>{const i=Mn.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:n}),await this.persist()}),this.events.on(Mn.deleted,async n=>{const i=Mn.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:n}),await this.persist()})}),this.relayer=e,this.logger=tn(t,this.name),this.clientId=""}get context(){return Pn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let n=!1;try{n=this.getSubscription(e).topic===t}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,t)))}async unsubscribeById(e,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}});try{const i=Uf(n);await this.restartToComplete({topic:e,id:t,relay:i}),await this.rpcUnsubscribe(e,t,i);const s=Qt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,t,n){var i,s;const o=await this.getSubscriptionId(e);if((i=n?.internal)!=null&&i.skipSubscribe)return o;(!n||n?.transportType===Zt.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});const a={method:xc(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(s=n?.internal)==null?void 0:s.throwOnFailedPublish;try{if(n?.transportType===Zt.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(d=>this.logger.warn(d))},le.toMiliseconds(le.ONE_SECOND)),o;const l=new Promise(async d=>{const p=x=>{x.topic===e&&(this.events.removeListener(Mn.created,p),d(x.id))};this.events.on(Mn.created,p);try{const x=await Qi(new Promise((w,b)=>{this.relayer.request(a).catch(y=>{this.logger.warn(y,y?.message),b(y)}).then(w)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Mn.created,p),d(x)}catch{}}),u=await Qi(l,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(l){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(ur.connection_stalled),c)throw l}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,n={method:xc(t.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Qi(new Promise(i=>{this.relayer.request(n).catch(s=>this.logger.warn(s)).then(i)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(ur.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,n={method:xc(t.protocol).batchFetchMessages,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let i;try{i=await await Qi(new Promise((s,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(s)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(ur.connection_stalled)}return i}rpcUnsubscribe(e,t,n){const i={method:xc(n.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,t){this.setSubscription(e,V0(wl({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,wl({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,wl({},t)),this.topicMap.set(t.topic,e),this.events.emit(Mn.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:n}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(Mn.deleted,V0(wl({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Mn.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<t;n++){const i=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(Mn.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(t=>{var n;return t.topic===((n=this.subscriptions.get(t.id))==null?void 0:n.topic)})){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async t=>V0(wl({},t),{id:await this.getSubscriptionId(t.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await pP(le.toMiliseconds(le.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return ei(e+await this.getClientId())}}var sM=Object.defineProperty,X1=Object.getOwnPropertySymbols,oM=Object.prototype.hasOwnProperty,aM=Object.prototype.propertyIsEnumerable,_g=(r,e,t)=>e in r?sM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Q1=(r,e)=>{for(var t in e||(e={}))oM.call(e,t)&&_g(r,t,e[t]);if(X1)for(var t of X1(e))aM.call(e,t)&&_g(r,t,e[t]);return r},st=(r,e,t)=>_g(r,typeof e!="symbol"?e+"":e,t);class cM extends p8{constructor(e){super(e),st(this,"protocol","wc"),st(this,"version",2),st(this,"core"),st(this,"logger"),st(this,"events",new ci.EventEmitter),st(this,"provider"),st(this,"messages"),st(this,"subscriber"),st(this,"publisher"),st(this,"name",$7),st(this,"transportExplicitlyClosed",!1),st(this,"initialized",!1),st(this,"connectionAttemptInProgress",!1),st(this,"relayUrl"),st(this,"projectId"),st(this,"packageName"),st(this,"bundleId"),st(this,"hasExperiencedNetworkDisruption",!1),st(this,"pingTimeout"),st(this,"heartBeatTimeout",le.toMiliseconds(le.THIRTY_SECONDS+le.FIVE_SECONDS)),st(this,"reconnectTimeout"),st(this,"connectPromise"),st(this,"reconnectInProgress",!1),st(this,"requestsInFlight",[]),st(this,"connectTimeout",le.toMiliseconds(le.ONE_SECOND*15)),st(this,"request",async t=>{var n,i;this.logger.debug("Publishing Request Payload");const s=t.id||mo().toString();await this.toEstablishConnection();try{this.logger.trace({id:s,method:t.method,topic:(n=t.params)==null?void 0:n.topic},"relayer.request - publishing...");const o=`${s}:${((i=t.params)==null?void 0:i.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(t);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${s}`),o}}),st(this,"resetPingTimeout",()=>{Of()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var t,n,i,s;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(s=(i=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:i.terminate)==null||s.call(i)}catch(o){this.logger.warn(o,o?.message)}},this.heartBeatTimeout))}),st(this,"onPayloadHandler",t=>{this.onProviderPayload(t),this.resetPingTimeout()}),st(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected 🛜"),this.startPingTimeout(),this.events.emit(ur.connect)}),st(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected 🛑"),this.requestsInFlight=[],this.onProviderDisconnect()}),st(this,"onProviderErrorHandler",t=>{this.logger.fatal(`Fatal socket error: ${t.message}`),this.events.emit(ur.error,t),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),st(this,"registerProviderListeners",()=>{this.provider.on(Gn.payload,this.onPayloadHandler),this.provider.on(Gn.connect,this.onConnectHandler),this.provider.on(Gn.disconnect,this.onDisconnectHandler),this.provider.on(Gn.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?tn(e.logger,this.name):td(Kc({level:e.logger||B7})),this.messages=new HD(this.logger,e.core),this.subscriber=new iM(this,this.logger),this.publisher=new YD(this,this.logger),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||sA,XT()?this.packageName=jy():QT()&&(this.bundleId=jy()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return Pn(this.logger)}get connected(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,t,n){this.isInitialized(),await this.publisher.publish(e,t,n),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:Zt.relay},sf.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,t){var n,i,s;this.isInitialized(),(!(t!=null&&t.transportType)||t?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((n=t?.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(i=t?.internal)==null?void 0:i.throwOnFailedPublish;let a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(Mn.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(Mn.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(e,Q1({internal:{throwOnFailedPublish:o}},t)).catch(p=>{o&&d(p)})||a,u()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Qi(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,n)=>{await this.connect(e).then(t).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await R1())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((n,i)=>n.publishedAt-i.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(const n of t)try{await this.onMessageEvent(n)}catch(i){this.logger.warn(i,"Error while processing batch message event: "+i?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:n}=e;if(!t.sessionExists){const i=wr(le.FIVE_MINUTES),s={topic:n,expiry:i,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,s)}this.events.emit(ur.message,e),await this.recordMessageEvent(e,sf.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(n,i)=>{const s=()=>{i(new Error("Connection interrupted while trying to connect"))};this.provider.once(Gn.disconnect,s),await Qi(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{i(o)}).finally(()=>{this.provider.off(Gn.disconnect,s),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{i(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Gn.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Gn.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const i=n;this.logger.warn({},i.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(n=>setTimeout(n,le.toMiliseconds(t*1))),t++}}startPingTimeout(){var e,t,n,i,s;if(Of())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((s=(i=(n=this.provider)==null?void 0:n.connection)==null?void 0:i.socket)==null||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new li(new C7(iP({sdkVersion:yg,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){const{topic:n,message:i}=e;await this.messages.set(n,i,t)}async shouldIgnoreMessageEvent(e){const{topic:t,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;const i=this.messages.has(t,n);return i&&this.logger.warn(`Ignoring duplicate message: ${n}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),km(e)){if(!e.method.endsWith(L7))return;const t=e.params,{topic:n,message:i,publishedAt:s,attestation:o}=t.data,a={topic:n,message:i,publishedAt:s,transportType:Zt.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Q1({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Eh(e)&&this.events.emit(ur.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,sf.inbound),this.events.emit(ur.message,e))}async acknowledgePayload(e){const t=Su(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Gn.payload,this.onPayloadHandler),this.provider.off(Gn.connect,this.onConnectHandler),this.provider.off(Gn.disconnect,this.onDisconnectHandler),this.provider.off(Gn.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await R1();z9(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(n=>this.logger.error(n,n?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(ka.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&G9())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(t){this.logger.warn(t,t?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(ur.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},le.toMiliseconds(F7)))))}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function lM(r,e){return r===e||Number.isNaN(r)&&Number.isNaN(e)}function ew(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function tw(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const uM="[object RegExp]",dM="[object String]",fM="[object Number]",hM="[object Boolean]",rw="[object Arguments]",pM="[object Symbol]",gM="[object Date]",mM="[object Map]",bM="[object Set]",yM="[object Array]",wM="[object Function]",xM="[object ArrayBuffer]",G0="[object Object]",vM="[object Error]",EM="[object DataView]",AM="[object Uint8Array]",_M="[object Uint8ClampedArray]",CM="[object Uint16Array]",SM="[object Uint32Array]",NM="[object BigUint64Array]",IM="[object Int8Array]",TM="[object Int16Array]",PM="[object Int32Array]",RM="[object BigInt64Array]",OM="[object Float32Array]",kM="[object Float64Array]";function DM(){}function nw(r){if(!r||typeof r!="object")return!1;const e=Object.getPrototypeOf(r);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(r)==="[object Object]":!1}function MM(r,e,t){return Pl(r,e,void 0,void 0,void 0,void 0,t)}function Pl(r,e,t,n,i,s,o){const a=o(r,e,t,n,i,s);if(a!==void 0)return a;if(typeof r==typeof e)switch(typeof r){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return r===e;case"number":return r===e||Object.is(r,e);case"function":return r===e;case"object":return ql(r,e,s,o)}return ql(r,e,s,o)}function ql(r,e,t,n){if(Object.is(r,e))return!0;let i=tw(r),s=tw(e);if(i===rw&&(i=G0),s===rw&&(s=G0),i!==s)return!1;switch(i){case dM:return r.toString()===e.toString();case fM:{const c=r.valueOf(),l=e.valueOf();return lM(c,l)}case hM:case gM:case pM:return Object.is(r.valueOf(),e.valueOf());case uM:return r.source===e.source&&r.flags===e.flags;case wM:return r===e}t=t??new Map;const o=t.get(r),a=t.get(e);if(o!=null&&a!=null)return o===e;t.set(r,e),t.set(e,r);try{switch(i){case mM:{if(r.size!==e.size)return!1;for(const[c,l]of r.entries())if(!e.has(c)||!Pl(l,e.get(c),c,r,e,t,n))return!1;return!0}case bM:{if(r.size!==e.size)return!1;const c=Array.from(r.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const d=c[u],p=l.findIndex(x=>Pl(d,x,void 0,r,e,t,n));if(p===-1)return!1;l.splice(p,1)}return!0}case yM:case AM:case _M:case CM:case SM:case NM:case IM:case TM:case PM:case RM:case OM:case kM:{if(typeof Buffer<"u"&&Buffer.isBuffer(r)!==Buffer.isBuffer(e)||r.length!==e.length)return!1;for(let c=0;c<r.length;c++)if(!Pl(r[c],e[c],c,r,e,t,n))return!1;return!0}case xM:return r.byteLength!==e.byteLength?!1:ql(new Uint8Array(r),new Uint8Array(e),t,n);case EM:return r.byteLength!==e.byteLength||r.byteOffset!==e.byteOffset?!1:ql(new Uint8Array(r),new Uint8Array(e),t,n);case vM:return r.name===e.name&&r.message===e.message;case G0:{if(!(ql(r.constructor,e.constructor,t,n)||nw(r)&&nw(e)))return!1;const c=[...Object.keys(r),...ew(r)],l=[...Object.keys(e),...ew(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const d=c[u],p=r[d];if(!Object.hasOwn(e,d))return!1;const x=e[d];if(!Pl(p,x,d,r,e,t,n))return!1}return!0}default:return!1}}finally{t.delete(r),t.delete(e)}}function UM(r,e){return MM(r,e,DM)}var BM=Object.defineProperty,iw=Object.getOwnPropertySymbols,$M=Object.prototype.hasOwnProperty,LM=Object.prototype.propertyIsEnumerable,Cg=(r,e,t)=>e in r?BM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,sw=(r,e)=>{for(var t in e||(e={}))$M.call(e,t)&&Cg(r,t,e[t]);if(iw)for(var t of iw(e))LM.call(e,t)&&Cg(r,t,e[t]);return r},mn=(r,e,t)=>Cg(r,typeof e!="symbol"?e+"":e,t);class Ma extends g8{constructor(e,t,n,i=as,s=void 0){super(e,t,n,i),this.core=e,this.logger=t,this.name=n,mn(this,"map",new Map),mn(this,"version",j7),mn(this,"cached",[]),mn(this,"initialized",!1),mn(this,"getKey"),mn(this,"storagePrefix",as),mn(this,"recentlyDeleted",[]),mn(this,"recentlyDeletedLimit",200),mn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!vr(o)?this.map.set(this.getKey(o),o):E9(o)?this.map.set(o.id,o):A9(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),mn(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),mn(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),mn(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>UM(a[c],o[c]))):this.values)),mn(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=sw(sw({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),mn(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=tn(t,this.name),this.storagePrefix=i,this.getKey=s}get context(){return Pn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:i}=ce("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}const{message:n}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}var FM=Object.defineProperty,jM=(r,e,t)=>e in r?FM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,je=(r,e,t)=>jM(r,typeof e!="symbol"?e+"":e,t);class qM{constructor(e,t){this.core=e,this.logger=t,je(this,"name",z7),je(this,"version",K7),je(this,"events",new sm),je(this,"pairings"),je(this,"initialized",!1),je(this,"storagePrefix",as),je(this,"ignoredPayloadTypes",[ks]),je(this,"registeredMethods",[]),je(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),je(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),je(this,"create",async n=>{this.isInitialized();const i=gg(),s=await this.core.crypto.setSymKey(i),o=wr(le.FIVE_MINUTES),a={protocol:iA},c={topic:s,expiry:o,relay:a,active:!1,methods:n?.methods},l=E1({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:i,relay:a,expiryTimestamp:o,methods:n?.methods});return this.events.emit(Xo.create,c),this.core.expirer.set(s,o),await this.pairings.set(s,c),await this.core.relayer.subscribe(s,{transportType:n?.transportType,internal:n?.internal}),{topic:s,uri:l}}),je(this,"pair",async n=>{this.isInitialized();const i=this.core.eventClient.createEvent({properties:{topic:n?.uri,trace:[Hi.pairing_started]}});this.isValidPair(n,i);const{topic:s,symKey:o,relay:a,expiryTimestamp:c,methods:l}=v1(n.uri);i.props.properties.topic=s,i.addTrace(Hi.pairing_uri_validation_success),i.addTrace(Hi.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(s)){if(u=this.pairings.get(s),i.addTrace(Hi.existing_pairing),u.active)throw i.setError(Cs.active_pairing_already_exists),new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);i.addTrace(Hi.pairing_not_expired)}const d=c||wr(le.FIVE_MINUTES),p={topic:s,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(s,d),await this.pairings.set(s,p),i.addTrace(Hi.store_new_pairing),n.activatePairing&&await this.activate({topic:s}),this.events.emit(Xo.create,p),i.addTrace(Hi.emit_inactive_pairing),this.core.crypto.keychain.has(s)||await this.core.crypto.setSymKey(o,s),i.addTrace(Hi.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{i.setError(Cs.no_internet_connection)}try{await this.core.relayer.subscribe(s,{relay:a})}catch(x){throw i.setError(Cs.subscribe_pairing_topic_failure),x}return i.addTrace(Hi.subscribe_pairing_topic_success),p}),je(this,"activate",async({topic:n})=>{this.isInitialized();const i=wr(le.FIVE_MINUTES);this.core.expirer.set(n,i),await this.pairings.update(n,{active:!0,expiry:i})}),je(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=Jo();this.events.once(ht("pairing_ping",s),({error:l})=>{l?c(l):a()}),await o()}}),je(this,"updateExpiry",async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})}),je(this,"updateMetadata",async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})}),je(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),je(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Qt("USER_DISCONNECTED")),await this.deletePairing(i))}),je(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:i,relay:s,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(i);return E1({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:c,relay:s,expiryTimestamp:o,methods:a})}),je(this,"sendRequest",async(n,i,s)=>{const o=Gi(i,s),a=await this.core.crypto.encode(n,o),c=ml[i].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),je(this,"sendResult",async(n,i,s)=>{const o=Su(n,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,n)).request.method,l=ml[c].res;await this.core.relayer.publish(i,a,l),await this.core.history.resolve(o)}),je(this,"sendError",async(n,i,s)=>{const o=vh(n,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,n)).request.method,l=ml[c]?ml[c].res:ml.unregistered_method.res;await this.core.relayer.publish(i,a,l),await this.core.history.resolve(o)}),je(this,"deletePairing",async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Qt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])}),je(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(i=>ao(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))}),je(this,"onRelayEventRequest",async n=>{const{topic:i,payload:s}=n;switch(s.method){case"wc_pairingPing":return await this.onPairingPingRequest(i,s);case"wc_pairingDelete":return await this.onPairingDeleteRequest(i,s);default:return await this.onUnknownRpcMethodRequest(i,s)}}),je(this,"onRelayEventResponse",async n=>{const{topic:i,payload:s}=n,o=(await this.core.history.get(i,s.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(o)}}),je(this,"onPairingPingRequest",async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit(Xo.ping,{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}}),je(this,"onPairingPingResponse",(n,i)=>{const{id:s}=i;setTimeout(()=>{Ki(i)?this.events.emit(ht("pairing_ping",s),{}):ti(i)&&this.events.emit(ht("pairing_ping",s),{error:i.error})},500)}),je(this,"onPairingDeleteRequest",async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Xo.delete,{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}}),je(this,"onUnknownRpcMethodRequest",async(n,i)=>{const{id:s,method:o}=i;try{if(this.registeredMethods.includes(o))return;const a=Qt("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,n,a),this.logger.error(a)}catch(a){await this.sendError(s,n,a),this.logger.error(a)}}),je(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(Qt("WC_METHOD_UNSUPPORTED",n))}),je(this,"isValidPair",(n,i)=>{var s;if(!xn(n)){const{message:a}=ce("MISSING_OR_INVALID",`pair() params: ${n}`);throw i.setError(Cs.malformed_pairing_uri),new Error(a)}if(!v9(n.uri)){const{message:a}=ce("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw i.setError(Cs.malformed_pairing_uri),new Error(a)}const o=v1(n?.uri);if(!((s=o?.relay)!=null&&s.protocol)){const{message:a}=ce("MISSING_OR_INVALID","pair() uri#relay-protocol");throw i.setError(Cs.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=ce("MISSING_OR_INVALID","pair() uri#symKey");throw i.setError(Cs.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&le.toMiliseconds(o?.expiryTimestamp)<Date.now()){i.setError(Cs.pairing_expired);const{message:a}=ce("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),je(this,"isValidPing",async n=>{if(!xn(n)){const{message:s}=ce("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)}),je(this,"isValidDisconnect",async n=>{if(!xn(n)){const{message:s}=ce("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)}),je(this,"isValidPairingTopic",async n=>{if(!gr(n,!1)){const{message:i}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(ao(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=ce("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}}),this.core=e,this.logger=tn(t,this.name),this.pairings=new Ma(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Pn(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(ur.message,async e=>{const{topic:t,message:n,transportType:i}=e;if(this.pairings.keys.includes(t)&&i!==Zt.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const s=await this.core.crypto.decode(t,n);km(s)?(this.core.history.set(t,s),await this.onRelayEventRequest({topic:t,payload:s})):Eh(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.core.history.delete(t,s.id)),await this.core.relayer.messages.ack(t,n)}catch(s){this.logger.error(s)}})}registerExpirerEvents(){this.core.expirer.on(Qn.expired,async e=>{const{topic:t}=i2(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(Xo.expire,{topic:t}))})}}var HM=Object.defineProperty,WM=(r,e,t)=>e in r?HM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,kr=(r,e,t)=>WM(r,typeof e!="symbol"?e+"":e,t);class zM extends d8{constructor(e,t){super(e,t),this.core=e,this.logger=t,kr(this,"records",new Map),kr(this,"events",new ci.EventEmitter),kr(this,"name",V7),kr(this,"version",G7),kr(this,"cached",[]),kr(this,"initialized",!1),kr(this,"storagePrefix",as),kr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),kr(this,"set",(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const o={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s,expiry:wr(le.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(gi.created,o)}),kr(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=ti(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.persist(),this.events.emit(gi.updated,i))}),kr(this,"get",async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i))),kr(this,"delete",(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(gi.deleted,s)}}),this.persist()}),kr(this,"exists",async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1)),kr(this,"on",(n,i)=>{this.events.on(n,i)}),kr(this,"once",(n,i)=>{this.events.once(n,i)}),kr(this,"off",(n,i)=>{this.events.off(n,i)}),kr(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.logger=tn(t,this.name)}get context(){return Pn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:Gi(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:n}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(gi.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(gi.created,e=>{const t=gi.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(gi.updated,e=>{const t=gi.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(gi.deleted,e=>{const t=gi.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(ka.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{le.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(gi.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}var KM=Object.defineProperty,VM=(r,e,t)=>e in r?KM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Vr=(r,e,t)=>VM(r,typeof e!="symbol"?e+"":e,t);class GM extends b8{constructor(e,t){super(e,t),this.core=e,this.logger=t,Vr(this,"expirations",new Map),Vr(this,"events",new ci.EventEmitter),Vr(this,"name",Y7),Vr(this,"version",J7),Vr(this,"cached",[]),Vr(this,"initialized",!1),Vr(this,"storagePrefix",as),Vr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Vr(this,"has",n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}}),Vr(this,"set",(n,i)=>{this.isInitialized();const s=this.formatTarget(n),o={target:s,expiry:i};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(Qn.created,{target:s,expiration:o})}),Vr(this,"get",n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)}),Vr(this,"del",n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(Qn.deleted,{target:i,expiration:s})}}),Vr(this,"on",(n,i)=>{this.events.on(n,i)}),Vr(this,"once",(n,i)=>{this.events.once(n,i)}),Vr(this,"off",(n,i)=>{this.events.off(n,i)}),Vr(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.logger=tn(t,this.name)}get context(){return Pn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return sP(e);if(typeof e=="number")return oP(e);const{message:t}=ce("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Qn.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:n}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return t}checkExpiry(e,t){const{expiry:n}=t;le.toMiliseconds(n)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Qn.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(ka.pulse,()=>this.checkExpirations()),this.events.on(Qn.created,e=>{const t=Qn.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Qn.expired,e=>{const t=Qn.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Qn.deleted,e=>{const t=Qn.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}var YM=Object.defineProperty,JM=(r,e,t)=>e in r?YM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,hr=(r,e,t)=>JM(r,typeof e!="symbol"?e+"":e,t);class ZM extends y8{constructor(e,t,n){super(e,t,n),this.core=e,this.logger=t,this.store=n,hr(this,"name",Z7),hr(this,"abortController"),hr(this,"isDevEnv"),hr(this,"verifyUrlV3",Q7),hr(this,"storagePrefix",as),hr(this,"version",nA),hr(this,"publicKey"),hr(this,"fetchPromise"),hr(this,"init",async()=>{var i;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&le.toMiliseconds((i=this.publicKey)==null?void 0:i.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),hr(this,"register",async i=>{if(!Zc()||this.isDevEnv)return;const s=window.location.origin,{id:o,decryptedId:a}=i,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${s}&id=${o}&decryptedId=${a}`;try{const l=$s.getDocument(),u=this.startAbortTimer(le.ONE_SECOND*5),d=await new Promise((p,x)=>{const w=()=>{window.removeEventListener("message",y),l.body.removeChild(b),x("attestation aborted")};this.abortController.signal.addEventListener("abort",w);const b=l.createElement("iframe");b.src=c,b.style.display="none",b.addEventListener("error",w,{signal:this.abortController.signal});const y=C=>{if(C.data&&typeof C.data=="string")try{const T=JSON.parse(C.data);if(T.type==="verify_attestation"){if(Jp(T.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(b),this.abortController.signal.removeEventListener("abort",w),window.removeEventListener("message",y),p(T.attestation===null?"":T.attestation)}}catch(T){this.logger.warn(T)}};l.body.appendChild(b),window.addEventListener("message",y,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",d),d}catch(l){this.logger.warn(l)}return""}),hr(this,"resolve",async i=>{if(this.isDevEnv)return"";const{attestationId:s,hash:o,encryptedId:a}=i;if(s===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(s){if(Jp(s).payload.id!==a)return;const l=await this.isValidJwtAttestation(s);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(i?.verifyUrl);return this.fetchAttestation(o,c)}),hr(this,"fetchAttestation",async(i,s)=>{this.logger.debug(`resolving attestation: ${i} from url: ${s}`);const o=this.startAbortTimer(le.ONE_SECOND*5),a=await fetch(`${s}/attestation/${i}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),hr(this,"getVerifyUrl",i=>{let s=i||jl;return ek.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${jl}`),s=jl),s}),hr(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const i=this.startAbortTimer(le.FIVE_SECONDS),s=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(i),await s.json()}catch(i){this.logger.warn(i)}}),hr(this,"persistPublicKey",async i=>{this.logger.debug("persisting public key to local storage",i),await this.store.setItem(this.storeKey,i),this.publicKey=i}),hr(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),hr(this,"isValidJwtAttestation",async i=>{const s=await this.getPublicKey();try{if(s)return this.validateAttestation(i,s)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(i,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),hr(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),hr(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async s=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),s(o))});const i=await this.fetchPromise;return this.fetchPromise=void 0,i}),hr(this,"validateAttestation",(i,s)=>{const o=e9(i,s.publicKey),a={hasExpired:le.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=tn(t,this.name),this.abortController=new AbortController,this.isDevEnv=ym(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Pn(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),le.toMiliseconds(e))}}var XM=Object.defineProperty,QM=(r,e,t)=>e in r?XM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ow=(r,e,t)=>QM(r,typeof e!="symbol"?e+"":e,t);class eU extends w8{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,ow(this,"context",tk),ow(this,"registerDeviceToken",async n=>{const{clientId:i,token:s,notificationType:o,enableEncrypted:a=!1}=n,c=`${rk}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:i,type:o,token:s,always_raw:a})})}),this.logger=tn(t,this.context)}}var tU=Object.defineProperty,aw=Object.getOwnPropertySymbols,rU=Object.prototype.hasOwnProperty,nU=Object.prototype.propertyIsEnumerable,Sg=(r,e,t)=>e in r?tU(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,xl=(r,e)=>{for(var t in e||(e={}))rU.call(e,t)&&Sg(r,t,e[t]);if(aw)for(var t of aw(e))nU.call(e,t)&&Sg(r,t,e[t]);return r},Cr=(r,e,t)=>Sg(r,typeof e!="symbol"?e+"":e,t);class iU extends x8{constructor(e,t,n=!0){super(e,t,n),this.core=e,this.logger=t,Cr(this,"context",ik),Cr(this,"storagePrefix",as),Cr(this,"storageVersion",nk),Cr(this,"events",new Map),Cr(this,"shouldPersist",!1),Cr(this,"init",async()=>{if(!ym())try{const i={eventId:Hy(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:r2(this.core.relayer.protocol,this.core.relayer.version,yg)}}};await this.sendEvent([i])}catch(i){this.logger.warn(i)}}),Cr(this,"createEvent",i=>{const{event:s="ERROR",type:o="",properties:{topic:a,trace:c}}=i,l=Hy(),u=this.core.projectId||"",d=Date.now(),p=xl({eventId:l,timestamp:d,props:{event:s,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,p),this.shouldPersist=!0),p}),Cr(this,"getEvent",i=>{const{eventId:s,topic:o}=i;if(s)return this.events.get(s);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return xl(xl({},a),this.setMethods(a.eventId))}),Cr(this,"deleteEvent",i=>{const{eventId:s}=i;this.events.delete(s),this.shouldPersist=!0}),Cr(this,"setEventListeners",()=>{this.core.heartbeat.on(ka.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(i=>{le.fromMiliseconds(Date.now())-le.fromMiliseconds(i.timestamp)>sk&&(this.events.delete(i.eventId),this.shouldPersist=!0)})})}),Cr(this,"setMethods",i=>({addTrace:s=>this.addTrace(i,s),setError:s=>this.setError(i,s)})),Cr(this,"addTrace",(i,s)=>{const o=this.events.get(i);o&&(o.props.properties.trace.push(s),this.events.set(i,o),this.shouldPersist=!0)}),Cr(this,"setError",(i,s)=>{const o=this.events.get(i);o&&(o.props.type=s,o.timestamp=Date.now(),this.events.set(i,o),this.shouldPersist=!0)}),Cr(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Cr(this,"restore",async()=>{try{const i=await this.core.storage.getItem(this.storageKey)||[];if(!i.length)return;i.forEach(s=>{this.events.set(s.eventId,xl(xl({},s),this.setMethods(s.eventId)))})}catch(i){this.logger.warn(i)}}),Cr(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const i=[];for(const[s,o]of this.events)o.props.type&&i.push(o);if(i.length!==0)try{if((await this.sendEvent(i)).ok)for(const s of i)this.events.delete(s.eventId),this.shouldPersist=!0}catch(s){this.logger.warn(s)}}),Cr(this,"sendEvent",async i=>{const s=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${ok}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${yg}${s}`,{method:"POST",body:JSON.stringify(i)})}),Cr(this,"getAppDomain",()=>t2().url),this.logger=tn(t,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var sU=Object.defineProperty,cw=Object.getOwnPropertySymbols,oU=Object.prototype.hasOwnProperty,aU=Object.prototype.propertyIsEnumerable,Ng=(r,e,t)=>e in r?sU(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,lw=(r,e)=>{for(var t in e||(e={}))oU.call(e,t)&&Ng(r,t,e[t]);if(cw)for(var t of cw(e))aU.call(e,t)&&Ng(r,t,e[t]);return r},St=(r,e,t)=>Ng(r,typeof e!="symbol"?e+"":e,t);let cU=class yA extends a8{constructor(e){var t;super(e),St(this,"protocol",rA),St(this,"version",nA),St(this,"name",bg),St(this,"relayUrl"),St(this,"projectId"),St(this,"customStoragePrefix"),St(this,"events",new ci.EventEmitter),St(this,"logger"),St(this,"heartbeat"),St(this,"relayer"),St(this,"crypto"),St(this,"storage"),St(this,"history"),St(this,"expirer"),St(this,"pairing"),St(this,"verify"),St(this,"echoClient"),St(this,"linkModeSupportedApps"),St(this,"eventClient"),St(this,"initialized",!1),St(this,"logChunkController"),St(this,"on",(a,c)=>this.events.on(a,c)),St(this,"once",(a,c)=>this.events.once(a,c)),St(this,"off",(a,c)=>this.events.off(a,c)),St(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),St(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:Zt.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const n=this.getGlobalCore(e?.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||sA,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const i=Kc({level:typeof e?.logger=="string"&&e.logger?e.logger:N7.logger,name:bg}),{logger:s,chunkLoggerController:o}=am({opts:i,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=o,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=tn(s,this.name),this.heartbeat=new oS,this.crypto=new MD(this,this.logger,e?.keychain),this.history=new zM(this,this.logger),this.expirer=new GM(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new qS(lw(lw({},I7),e?.storageOptions)),this.relayer=new cM({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new qM(this,this.logger),this.verify=new ZM(this,this.logger,this.storage),this.echoClient=new eU(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new iU(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const t=new yA(e);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem(q7,n),t}get context(){return Pn(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(j1,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(j1)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const t=`_walletConnectCore_${e}`,n=`${t}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[t]}catch(t){console.warn("Failed to get global WalletConnect core",t);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${((t=e.opts)==null?void 0:t.customStoragePrefix)||""}`;globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&S7.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const lU=cU,wA="wc",xA=2,vA="client",Dm=`${wA}@${xA}:${vA}:`,Y0={name:vA,logger:"error"},uw="WALLETCONNECT_DEEPLINK_CHOICE",uU="proposal",dw="Proposal expired",dU="session",Ya=le.SEVEN_DAYS,fU="engine",Dr={wc_sessionPropose:{req:{ttl:le.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1104},res:{ttl:le.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1106},res:{ttl:le.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:le.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:le.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1112},res:{ttl:le.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1114},res:{ttl:le.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:le.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:le.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1119}}},J0={min:le.FIVE_MINUTES,max:le.SEVEN_DAYS},ji={idle:"IDLE",active:"ACTIVE"},hU={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},pU="request",gU=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],mU="wc",bU="auth",yU="authKeys",wU="pairingTopics",xU="requests",_h=`${mU}@${1.5}:${bU}:`,of=`${_h}:PUB_KEY`;var vU=Object.defineProperty,EU=Object.defineProperties,AU=Object.getOwnPropertyDescriptors,fw=Object.getOwnPropertySymbols,_U=Object.prototype.hasOwnProperty,CU=Object.prototype.propertyIsEnumerable,Ig=(r,e,t)=>e in r?vU(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,mt=(r,e)=>{for(var t in e||(e={}))_U.call(e,t)&&Ig(r,t,e[t]);if(fw)for(var t of fw(e))CU.call(e,t)&&Ig(r,t,e[t]);return r},Gr=(r,e)=>EU(r,AU(e)),ee=(r,e,t)=>Ig(r,typeof e!="symbol"?e+"":e,t);class SU extends _8{constructor(e){super(e),ee(this,"name",fU),ee(this,"events",new sm),ee(this,"initialized",!1),ee(this,"requestQueue",{state:ji.idle,queue:[]}),ee(this,"sessionRequestQueue",{state:ji.idle,queue:[]}),ee(this,"emittedSessionRequests",new gP({limit:500})),ee(this,"requestQueueDelay",le.ONE_SECOND),ee(this,"expectedPairingMethodMap",new Map),ee(this,"recentlyDeletedMap",new Map),ee(this,"recentlyDeletedLimit",200),ee(this,"relayMessageCache",[]),ee(this,"pendingSessions",new Map),ee(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Dr)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},le.toMiliseconds(this.requestQueueDelay)))}),ee(this,"connect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=Gr(mt({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n),n.optionalNamespaces=m9(n.requiredNamespaces,n.optionalNamespaces),n.requiredNamespaces={};const{pairingTopic:i,requiredNamespaces:s,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=n;let u=i,d,p=!1;try{if(u){const O=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),p=O.active}}catch(O){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),O}if(!u||!p){const{topic:O,uri:q}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});u=O,d=q}if(!u){const{message:O}=ce("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(O)}const x=await this.client.core.crypto.generateKeyPair(),w=Dr.wc_sessionPropose.req.ttl||le.FIVE_MINUTES,b=wr(w),y=Gr(mt(mt({requiredNamespaces:s,optionalNamespaces:o,relays:l??[{protocol:iA}],proposer:{publicKey:x,metadata:this.client.metadata},expiryTimestamp:b,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:zi()}),C=ht("session_connect",y.id),{reject:T,resolve:I,done:k}=Jo(w,dw),P=({id:O})=>{O===y.id&&(this.client.events.off("proposal_expire",P),this.pendingSessions.delete(y.id),this.events.emit(C,{error:{message:dw,code:0}}))};return this.client.events.on("proposal_expire",P),this.events.once(C,({error:O,session:q})=>{this.client.events.off("proposal_expire",P),O?T(O):q&&I(q)}),await this.sendProposeSession({proposal:y,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:y.id}}}),await this.setProposal(y.id,y),{uri:d,approval:k}}),ee(this,"pair",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(n){throw this.client.logger.error("pair() failed"),n}}),ee(this,"approve",async t=>{var n,i,s;const o=this.client.core.eventClient.createEvent({properties:{topic:(n=t?.id)==null?void 0:n.toString(),trace:[so.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(B){throw o.setError(bl.no_internet_connection),B}try{await this.isValidProposalId(t?.id)}catch(B){throw this.client.logger.error(`approve() -> proposal.get(${t?.id}) failed`),o.setError(bl.proposal_not_found),B}try{await this.isValidApprove(t)}catch(B){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(bl.session_approve_namespace_validation_failure),B}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:p}=t,x=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:w,proposer:b,requiredNamespaces:y,optionalNamespaces:C}=x;let T=(i=this.client.core.eventClient)==null?void 0:i.getEvent({topic:w});T||(T=(s=this.client.core.eventClient)==null?void 0:s.createEvent({type:so.session_approve_started,properties:{topic:w,trace:[so.session_approve_started,so.session_namespaces_validation_success]}}));const I=await this.client.core.crypto.generateKeyPair(),k=b.publicKey,P=await this.client.core.crypto.generateSharedKey(I,k),O=mt(mt(mt({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:I,metadata:this.client.metadata},expiry:wr(Ya)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),p&&{sessionConfig:p}),q=Zt.relay;T.addTrace(so.subscribing_session_topic);try{await this.client.core.relayer.subscribe(P,{transportType:q,internal:{skipSubscribe:!0}})}catch(B){throw T.setError(bl.subscribe_session_topic_failure),B}T.addTrace(so.subscribe_session_topic_success);const F=Gr(mt({},O),{topic:P,requiredNamespaces:y,optionalNamespaces:C,pairingTopic:w,acknowledged:!1,self:O.controller,peer:{publicKey:b.publicKey,metadata:b.metadata},controller:I,transportType:Zt.relay});await this.client.session.set(P,F),T.addTrace(so.store_session);try{await this.sendApproveSession({sessionTopic:P,proposal:x,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:I},sessionSettleRequest:O,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:a}}}),T.addTrace(so.session_approve_publish_success)}catch(B){throw this.client.logger.error(B),this.client.session.delete(P,Qt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(P),B}return this.client.core.eventClient.deleteEvent({eventId:T.eventId}),await this.client.core.pairing.updateMetadata({topic:w,metadata:b.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:w}),await this.setExpiry(P,wr(Ya)),{topic:P,acknowledged:()=>Promise.resolve(this.client.session.get(P))}}),ee(this,"reject",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:n,reason:i}=t;let s;try{s=this.client.proposal.get(n).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),o}s&&await this.sendError({id:n,topic:s,error:i,rpcOpts:Dr.wc_sessionPropose.reject}),await this.deleteProposal(n)}),ee(this,"update",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:n,namespaces:i}=t,{done:s,resolve:o,reject:a}=Jo(),c=zi(),l=mo().toString(),u=this.client.session.get(n).namespaces;return this.events.once(ht("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(n,{namespaces:i}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:i},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(n,{namespaces:u}),a(d)}),{acknowledged:s}}),ee(this,"extend",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:n}=t,i=zi(),{done:s,resolve:o,reject:a}=Jo();return this.events.once(ht("session_extend",i),({error:c})=>{c?a(c):o()}),await this.setExpiry(n,wr(Ya)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:i,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:s}}),ee(this,"request",async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(y){throw this.client.logger.error("request() -> isValidRequest() failed"),y}const{chainId:n,request:i,topic:s,expiry:o=Dr.wc_sessionRequest.req.ttl}=t,a=this.client.session.get(s);a?.transportType===Zt.relay&&await this.confirmOnlineStateOrThrow();const c=zi(),l=mo().toString(),{done:u,resolve:d,reject:p}=Jo(o,"Request expired. Please try again.");this.events.once(ht("session_request",c),({error:y,result:C})=>{y?p(y):d(C)});const x="wc_sessionRequest",w=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(w)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:s,method:x,params:{request:Gr(mt({},i),{expiryTimestamp:wr(o)}),chainId:n},expiry:o,throwOnFailedPublish:!0,appLink:w}).catch(y=>p(y)),this.client.events.emit("session_request_sent",{topic:s,request:i,chainId:n,id:c}),await u();const b={request:Gr(mt({},i),{expiryTimestamp:wr(o)}),chainId:n};return await Promise.all([new Promise(async y=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:s,method:x,params:b,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,b)}).catch(C=>p(C)),this.client.events.emit("session_request_sent",{topic:s,request:i,chainId:n,id:c}),y()}),new Promise(async y=>{var C;if(!((C=a.sessionConfig)!=null&&C.disableDeepLink)){const T=await uP(this.client.core.storage,uw);await aP({id:c,topic:s,wcDeepLink:T})}y()}),u()]).then(y=>y[2])}),ee(this,"respond",async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:i}=t,{id:s}=i,o=this.client.session.get(n);o.transportType===Zt.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Ki(i)?await this.sendResult({id:s,topic:n,result:i.result,throwOnFailedPublish:!0,appLink:a}):ti(i)&&await this.sendError({id:s,topic:n,error:i.error,appLink:a}),this.cleanupAfterResponse(t)}),ee(this,"ping",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(i){throw this.client.logger.error("ping() -> isValidPing() failed"),i}const{topic:n}=t;if(this.client.session.keys.includes(n)){const i=zi(),s=mo().toString(),{done:o,resolve:a,reject:c}=Jo();this.events.once(ht("session_ping",i),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:i,relayRpcId:s}),o()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))}),ee(this,"emit",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);const{topic:n,event:i,chainId:s}=t,o=mo().toString(),a=zi();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:i,chainId:s},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),ee(this,"disconnect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);const{topic:n}=t;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:Qt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:i}=ce("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(i)}}),ee(this,"find",t=>(this.isInitialized(),this.client.session.getAll().filter(n=>w9(n,t)))),ee(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),ee(this,"authenticate",async(t,n)=>{var i;this.isInitialized(),this.isValidAuthenticate(t);const s=n&&this.client.core.linkModeSupportedApps.includes(n)&&((i=this.client.metadata.redirect)==null?void 0:i.linkMode),o=s?Zt.link_mode:Zt.relay;o===Zt.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:p,exp:x,nbf:w,methods:b=[],expiry:y}=t,C=[...t.resources||[]],{topic:T,uri:I}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:T,uri:I}});const k=await this.client.core.crypto.generateKeyPair(),P=nf(k);if(await Promise.all([this.client.auth.authKeys.set(of,{responseTopic:P,publicKey:k}),this.client.auth.pairingTopics.set(P,{topic:P,pairingTopic:T})]),await this.client.core.relayer.subscribe(P,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${T}`),b.length>0){const{namespace:R}=fa(a[0]);let M=SR(R,"request",b);rf(C)&&(M=IR(M,C.pop())),C.push(M)}const O=y&&y>Dr.wc_sessionAuthenticate.req.ttl?y:Dr.wc_sessionAuthenticate.req.ttl,q={authPayload:{type:p??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:x,nbf:w,resources:C},requester:{publicKey:k,metadata:this.client.metadata},expiryTimestamp:wr(O)},F={eip155:{chains:a,methods:[...new Set(["personal_sign",...b])],events:["chainChanged","accountsChanged"]}},B={requiredNamespaces:{},optionalNamespaces:F,relays:[{protocol:"irn"}],pairingTopic:T,proposer:{publicKey:k,metadata:this.client.metadata},expiryTimestamp:wr(Dr.wc_sessionPropose.req.ttl),id:zi()},{done:W,resolve:j,reject:U}=Jo(O,"Request expired"),_=zi(),f=ht("session_connect",B.id),h=ht("session_request",_),m=async({error:R,session:M})=>{this.events.off(h,A),R?U(R):M&&j({session:M})},A=async R=>{var M,E,g;if(await this.deletePendingAuthRequest(_,{message:"fulfilled",code:0}),R.error){const G=Qt("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return R.error.code===G.code?void 0:(this.events.off(f,m),U(R.error.message))}await this.deleteProposal(B.id),this.events.off(f,m);const{cacaos:N,responder:L}=R.result,v=[],H=[];for(const G of N){await e1({cacao:G,projectId:this.client.core.projectId})||(this.client.logger.error(G,"Signature verification failed"),U(Qt("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:re}=G,X=rf(re.resources),ne=[og(re.iss)],Fe=kf(re.iss);if(X){const ue=t1(X),Ce=r1(X);v.push(...ue),ne.push(...Ce)}for(const ue of ne)H.push(`${ue}:${Fe}`)}const V=await this.client.core.crypto.generateSharedKey(k,L.publicKey);let z;v.length>0&&(z={topic:V,acknowledged:!0,self:{publicKey:k,metadata:this.client.metadata},peer:L,controller:L.publicKey,expiry:wr(Ya),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:T,namespaces:S1([...new Set(v)],[...new Set(H)]),transportType:o},await this.client.core.relayer.subscribe(V,{transportType:o}),await this.client.session.set(V,z),T&&await this.client.core.pairing.updateMetadata({topic:T,metadata:L.metadata}),z=this.client.session.get(V)),(M=this.client.metadata.redirect)!=null&&M.linkMode&&(E=L.metadata.redirect)!=null&&E.linkMode&&(g=L.metadata.redirect)!=null&&g.universal&&n&&(this.client.core.addLinkModeSupportedApp(L.metadata.redirect.universal),this.client.session.update(V,{transportType:Zt.link_mode})),j({auths:N,session:z})};this.events.once(f,m),this.events.once(h,A);let S;try{if(s){const R=Gi("wc_sessionAuthenticate",q,_);this.client.core.history.set(T,R);const M=await this.client.core.crypto.encode("",R,{type:cd,encoding:fo});S=$d(n,T,M)}else await Promise.all([this.sendRequest({topic:T,method:"wc_sessionAuthenticate",params:q,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:_}),this.sendRequest({topic:T,method:"wc_sessionPropose",params:B,expiry:Dr.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:B.id})])}catch(R){throw this.events.off(f,m),this.events.off(h,A),R}return await this.setProposal(B.id,B),await this.setAuthRequest(_,{request:Gr(mt({},q),{verifyContext:{}}),pairingTopic:T,transportType:o}),{uri:S??I,response:W}}),ee(this,"approveSessionAuthenticate",async t=>{const{id:n,auths:i}=t,s=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[zo.authenticated_session_approve_started]}});try{this.isInitialized()}catch(y){throw s.setError(yl.no_internet_connection),y}const o=this.getPendingAuthRequest(n);if(!o)throw s.setError(yl.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const a=o.transportType||Zt.relay;a===Zt.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=nf(c),d={type:ks,receiverPublicKey:c,senderPublicKey:l},p=[],x=[];for(const y of i){if(!await e1({cacao:y,projectId:this.client.core.projectId})){s.setError(yl.invalid_cacao);const P=Qt("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:u,error:P,encodeOpts:d}),new Error(P.message)}s.addTrace(zo.cacaos_verified);const{p:C}=y,T=rf(C.resources),I=[og(C.iss)],k=kf(C.iss);if(T){const P=t1(T),O=r1(T);p.push(...P),I.push(...O)}for(const P of I)x.push(`${P}:${k}`)}const w=await this.client.core.crypto.generateSharedKey(l,c);s.addTrace(zo.create_authenticated_session_topic);let b;if(p?.length>0){b={topic:w,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:wr(Ya),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:S1([...new Set(p)],[...new Set(x)]),transportType:a},s.addTrace(zo.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(w,{transportType:a})}catch(y){throw s.setError(yl.subscribe_authenticated_session_topic_failure),y}s.addTrace(zo.subscribe_authenticated_session_topic_success),await this.client.session.set(w,b),s.addTrace(zo.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}s.addTrace(zo.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:n,result:{cacaos:i,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(y){throw s.setError(yl.authenticated_session_approve_publish_failure),y}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:b}}),ee(this,"rejectSessionAuthenticate",async t=>{this.isInitialized();const{id:n,reason:i}=t,s=this.getPendingAuthRequest(n);if(!s)throw new Error(`Could not find pending auth request with id ${n}`);s.transportType===Zt.relay&&await this.confirmOnlineStateOrThrow();const o=s.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=nf(o),l={type:ks,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:n,topic:c,error:i,encodeOpts:l,rpcOpts:Dr.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(s.requester.metadata,s.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.deleteProposal(n)}),ee(this,"formatAuthMessage",t=>{this.isInitialized();const{request:n,iss:i}=t;return w2(n,i)}),ee(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)}),ee(this,"cleanupDuplicatePairings",async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),i=this.client.core.pairing.pairings.getAll().filter(s=>{var o,a;return((o=s.peerMetadata)==null?void 0:o.url)&&((a=s.peerMetadata)==null?void 0:a.url)===t.peer.metadata.url&&s.topic&&s.topic!==n.topic});if(i.length===0)return;this.client.logger.info(`Cleaning up ${i.length} duplicate pairing(s)`),await Promise.all(i.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}}),ee(this,"deleteSession",async t=>{var n;const{topic:i,expirerHasDeleted:s=!1,emitEvent:o=!0,id:a=0}=t,{self:c}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),await this.client.session.delete(i,Qt("USER_DISCONNECTED")),this.addToRecentlyDeleted(i,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),s||this.client.core.expirer.del(i),this.client.core.storage.removeItem(uw).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===i&&this.deletePendingSessionRequest(l.id,Qt("USER_DISCONNECTED"))}),i===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=ji.idle),o&&this.client.events.emit("session_delete",{id:a,topic:i})}),ee(this,"deleteProposal",async(t,n)=>{if(n)try{const i=this.client.proposal.get(t);this.client.core.eventClient.getEvent({topic:i.pairingTopic})?.setError(bl.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,Qt("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")}),ee(this,"deletePendingSessionRequest",async(t,n,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),i?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(s=>s.id!==t),i&&(this.sessionRequestQueue.state=ji.idle,this.client.events.emit("session_request_expire",{id:t}))}),ee(this,"deletePendingAuthRequest",async(t,n,i=!1)=>{await Promise.all([this.client.auth.requests.delete(t,n),i?Promise.resolve():this.client.core.expirer.del(t)])}),ee(this,"setExpiry",async(t,n)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,n),await this.client.session.update(t,{expiry:n}))}),ee(this,"setProposal",async(t,n)=>{this.client.core.expirer.set(t,wr(Dr.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,n)}),ee(this,"setAuthRequest",async(t,n)=>{const{request:i,pairingTopic:s,transportType:o=Zt.relay}=n;this.client.core.expirer.set(t,i.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:i.authPayload,requester:i.requester,expiryTimestamp:i.expiryTimestamp,id:t,pairingTopic:s,verifyContext:i.verifyContext,transportType:o})}),ee(this,"setPendingSessionRequest",async t=>{const{id:n,topic:i,params:s,verifyContext:o}=t,a=s.request.expiryTimestamp||wr(Dr.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,a),await this.client.pendingRequest.set(n,{id:n,topic:i,params:s,verifyContext:o})}),ee(this,"sendRequest",async t=>{const{topic:n,method:i,params:s,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d,publishOpts:p={}}=t,x=Gi(i,s,c);let w;const b=!!u;try{const T=b?fo:Cn;w=await this.client.core.crypto.encode(n,x,{encoding:T})}catch(T){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),T}let y;if(gU.includes(i)){const T=ei(JSON.stringify(x)),I=ei(w);y=await this.client.core.verify.register({id:I,decryptedId:T})}const C=mt(mt({},Dr[i].req),p);if(C.attestation=y,o&&(C.ttl=o),a&&(C.id=a),this.client.core.history.set(n,x),b){const T=$d(u,n,w);await global.Linking.openURL(T,this.client.name)}else C.tvf=Gr(mt({},d),{correlationId:x.id}),l?(C.internal=Gr(mt({},C.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,w,C)):this.client.core.relayer.publish(n,w,C).catch(T=>this.client.logger.error(T));return x.id}),ee(this,"sendProposeSession",async t=>{const{proposal:n,publishOpts:i}=t,s=Gi("wc_sessionPropose",n,n.id);this.client.core.history.set(n.pairingTopic,s);const o=await this.client.core.crypto.encode(n.pairingTopic,s,{encoding:Cn}),a=ei(JSON.stringify(s)),c=ei(o),l=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:n.pairingTopic,sessionProposal:o},opts:Gr(mt({},i),{publishMethod:"wc_proposeSession",attestation:l})})}),ee(this,"sendApproveSession",async t=>{const{sessionTopic:n,pairingProposalResponse:i,proposal:s,sessionSettleRequest:o,publishOpts:a}=t,c=Su(s.id,i),l=await this.client.core.crypto.encode(s.pairingTopic,c,{encoding:Cn}),u=Gi("wc_sessionSettle",o,a?.id),d=await this.client.core.crypto.encode(n,u,{encoding:Cn});this.client.core.history.set(n,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:n,pairingTopic:s.pairingTopic,sessionProposalResponse:l,sessionSettlementRequest:d},opts:Gr(mt({},a),{publishMethod:"wc_approveSession"})})}),ee(this,"sendResult",async t=>{const{id:n,topic:i,result:s,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=t,l=Su(n,s);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const w=d?fo:Cn;u=await this.client.core.crypto.encode(i,l,Gr(mt({},a||{}),{encoding:w}))}catch(w){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${i} failed`),w}let p,x;try{p=await this.client.core.history.get(i,n);const w=p.request;try{x=this.getTVFParams(n,w.params,s)}catch(b){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${b?.message}`)}}catch(w){throw this.client.logger.error(`sendResult() -> history.get(${i}, ${n}) failed`),w}if(d){const w=$d(c,i,u);await global.Linking.openURL(w,this.client.name)}else{const w=p.request.method,b=Dr[w].res;b.tvf=Gr(mt({},x),{correlationId:n}),o?(b.internal=Gr(mt({},b.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,u,b)):this.client.core.relayer.publish(i,u,b).catch(y=>this.client.logger.error(y))}await this.client.core.history.resolve(l)}),ee(this,"sendError",async t=>{const{id:n,topic:i,error:s,encodeOpts:o,rpcOpts:a,appLink:c}=t,l=vh(n,s);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const x=d?fo:Cn;u=await this.client.core.crypto.encode(i,l,Gr(mt({},o||{}),{encoding:x}))}catch(x){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${i} failed`),x}let p;try{p=await this.client.core.history.get(i,n)}catch(x){throw this.client.logger.error(`sendError() -> history.get(${i}, ${n}) failed`),x}if(d){const x=$d(c,i,u);await global.Linking.openURL(x,this.client.name)}else{const x=p.request.method,w=a||Dr[x].res;this.client.core.relayer.publish(i,u,w)}await this.client.core.history.resolve(l)}),ee(this,"cleanup",async()=>{const t=[],n=[];this.client.session.getAll().forEach(i=>{let s=!1;ao(i.expiry)&&(s=!0),this.client.core.crypto.keychain.has(i.topic)||(s=!0),s&&t.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{ao(i.expiryTimestamp)&&n.push(i.id)}),await Promise.all([...t.map(i=>this.deleteSession({topic:i})),...n.map(i=>this.deleteProposal(i))])}),ee(this,"onProviderMessageEvent",async t=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(t):await this.onRelayMessage(t)}),ee(this,"onRelayEventRequest",async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()}),ee(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===ji.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ji.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=ji.idle}),ee(this,"processRequest",async t=>{const{topic:n,payload:i,attestation:s,transportType:o,encryptedId:a}=t,c=i.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:i,attestation:s,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,i);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,i);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,i);case"wc_sessionPing":return await this.onSessionPingRequest(n,i);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,i);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:i,attestation:s,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(n,i);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:i,attestation:s,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),ee(this,"onRelayEventResponse",async t=>{const{topic:n,payload:i,transportType:s}=t,o=(await this.client.core.history.get(n,i.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(n,i,s);case"wc_sessionSettle":return this.onSessionSettleResponse(n,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,i);case"wc_sessionExtend":return this.onSessionExtendResponse(n,i);case"wc_sessionPing":return this.onSessionPingResponse(n,i);case"wc_sessionRequest":return this.onSessionRequestResponse(n,i);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,i);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),ee(this,"onRelayEventUnknownPayload",t=>{const{topic:n}=t,{message:i}=ce("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(i)}),ee(this,"shouldIgnorePairingRequest",t=>{const{topic:n,requestMethod:i}=t,s=this.expectedPairingMethodMap.get(n);return!s||s.includes(i)?!1:!!(s.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),ee(this,"onSessionProposeRequest",async t=>{const{topic:n,payload:i,attestation:s,encryptedId:o}=t,{params:a,id:c}=i;try{const l=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l?.setError(Cs.proposal_listener_not_found)),this.isValidConnect(mt({},i.params));const u=a.expiryTimestamp||wr(Dr.wc_sessionPropose.req.ttl),d=mt({id:c,pairingTopic:n,expiryTimestamp:u,attestation:s,encryptedId:o},a);await this.setProposal(c,d);const p=await this.getVerifyContext({attestationId:s,hash:ei(JSON.stringify(i)),encryptedId:o,metadata:d.proposer.metadata});l?.addTrace(Hi.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:p})}catch(l){await this.sendError({id:c,topic:n,error:l,rpcOpts:Dr.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),ee(this,"onSessionProposeResponse",async(t,n,i)=>{const{id:s}=n;if(Ki(n)){const{result:o}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(s,{sessionTopic:u,pairingTopic:t,proposalId:s,publicKey:c});const d=await this.client.core.relayer.subscribe(u,{transportType:i});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:t})}else if(ti(n)){await this.deleteProposal(s);const o=ht("session_connect",s);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:n.error})}}),ee(this,"onSessionSettleRequest",async(t,n)=>{const{id:i,params:s}=n;try{this.isValidSessionSettleRequest(s);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:p}=n.params,x=[...this.pendingSessions.values()].find(y=>y.sessionTopic===t);if(!x)return this.client.logger.error(`Pending session not found for topic ${t}`);const w=this.client.proposal.get(x.proposalId),b=Gr(mt(mt(mt({topic:t,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:x.pairingTopic,requiredNamespaces:w.requiredNamespaces,optionalNamespaces:w.optionalNamespaces,controller:a.publicKey,self:{publicKey:x.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),p&&{sessionConfig:p}),{transportType:Zt.relay});await this.client.session.set(b.topic,b),await this.setExpiry(b.topic,b.expiry),await this.client.core.pairing.updateMetadata({topic:x.pairingTopic,metadata:b.peer.metadata}),this.client.events.emit("session_connect",{session:b}),this.events.emit(ht("session_connect",x.proposalId),{session:b}),this.pendingSessions.delete(x.proposalId),this.deleteProposal(x.proposalId,!1),this.cleanupDuplicatePairings(b),await this.sendResult({id:n.id,topic:t,result:!0})}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),ee(this,"onSessionSettleResponse",async(t,n)=>{const{id:i}=n;Ki(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(ht("session_approve",i),{})):ti(n)&&(await this.client.session.delete(t,Qt("USER_DISCONNECTED")),this.events.emit(ht("session_approve",i),{error:n.error}))}),ee(this,"onSessionUpdateRequest",async(t,n)=>{const{params:i,id:s}=n;try{const o=`${t}_session_update`,a=gl.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.warn(`Discarding out of sync request - ${s}`),this.sendError({id:s,topic:t,error:Qt("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(mt({topic:t},i));try{gl.set(o,s),await this.client.session.update(t,{namespaces:i.namespaces}),await this.sendResult({id:s,topic:t,result:!0})}catch(c){throw gl.delete(o),c}this.client.events.emit("session_update",{id:s,topic:t,params:i})}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),ee(this,"isRequestOutOfSync",(t,n)=>n.toString().slice(0,-3)<t.toString().slice(0,-3)),ee(this,"onSessionUpdateResponse",(t,n)=>{const{id:i}=n,s=ht("session_update",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Ki(n)?this.events.emit(ht("session_update",i),{}):ti(n)&&this.events.emit(ht("session_update",i),{error:n.error})}),ee(this,"onSessionExtendRequest",async(t,n)=>{const{id:i}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,wr(Ya)),await this.sendResult({id:i,topic:t,result:!0}),this.client.events.emit("session_extend",{id:i,topic:t})}catch(s){await this.sendError({id:i,topic:t,error:s}),this.client.logger.error(s)}}),ee(this,"onSessionExtendResponse",(t,n)=>{const{id:i}=n,s=ht("session_extend",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Ki(n)?this.events.emit(ht("session_extend",i),{}):ti(n)&&this.events.emit(ht("session_extend",i),{error:n.error})}),ee(this,"onSessionPingRequest",async(t,n)=>{const{id:i}=n;try{this.isValidPing({topic:t}),await this.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:i,topic:t})}catch(s){await this.sendError({id:i,topic:t,error:s}),this.client.logger.error(s)}}),ee(this,"onSessionPingResponse",(t,n)=>{const{id:i}=n,s=ht("session_ping",i);setTimeout(()=>{if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners 2176`);Ki(n)?this.events.emit(ht("session_ping",i),{}):ti(n)&&this.events.emit(ht("session_ping",i),{error:n.error})},500)}),ee(this,"onSessionDeleteRequest",async(t,n)=>{const{id:i}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),await Promise.all([new Promise(s=>{this.client.core.relayer.once(ur.publish,async()=>{s(await this.deleteSession({topic:t,id:i}))})}),this.sendResult({id:i,topic:t,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:Qt("USER_DISCONNECTED")})]).catch(s=>this.client.logger.error(s))}catch(s){this.client.logger.error(s)}}),ee(this,"onSessionRequest",async t=>{var n,i,s;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=t,{id:d,params:p}=a;try{await this.isValidRequest(mt({topic:o},p));const x=this.client.session.get(o),w=await this.getVerifyContext({attestationId:c,hash:ei(JSON.stringify(Gi("wc_sessionRequest",p,d))),encryptedId:l,metadata:x.peer.metadata,transportType:u}),b={id:d,topic:o,params:p,verifyContext:w};await this.setPendingSessionRequest(b),u===Zt.link_mode&&(n=x.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((i=x.peer.metadata.redirect)==null?void 0:i.universal),(s=this.client.signConfig)!=null&&s.disableRequestQueue?this.emitSessionRequest(b):(this.addSessionRequestToSessionRequestQueue(b),this.processSessionRequestQueue())}catch(x){await this.sendError({id:d,topic:o,error:x}),this.client.logger.error(x)}}),ee(this,"onSessionRequestResponse",(t,n)=>{const{id:i}=n,s=ht("session_request",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Ki(n)?this.events.emit(ht("session_request",i),{result:n.result}):ti(n)&&this.events.emit(ht("session_request",i),{error:n.error})}),ee(this,"onSessionEventRequest",async(t,n)=>{const{id:i,params:s}=n;try{const o=`${t}_session_event_${s.event.name}`,a=gl.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.info(`Discarding out of sync request - ${i}`);return}this.isValidEmit(mt({topic:t},s)),this.client.events.emit("session_event",{id:i,topic:t,params:s}),gl.set(o,i)}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),ee(this,"onSessionAuthenticateResponse",(t,n)=>{const{id:i}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:n}),Ki(n)?this.events.emit(ht("session_request",i),{result:n.result}):ti(n)&&this.events.emit(ht("session_request",i),{error:n.error})}),ee(this,"onSessionAuthenticateRequest",async t=>{var n;const{topic:i,payload:s,attestation:o,encryptedId:a,transportType:c}=t;try{const{requester:l,authPayload:u,expiryTimestamp:d}=s.params,p=await this.getVerifyContext({attestationId:o,hash:ei(JSON.stringify(s)),encryptedId:a,metadata:l.metadata,transportType:c}),x={requester:l,pairingTopic:i,id:s.id,authPayload:u,verifyContext:p,expiryTimestamp:d};await this.setAuthRequest(s.id,{request:x,pairingTopic:i,transportType:c}),c===Zt.link_mode&&(n=l.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:i,params:s.params,id:s.id,verifyContext:p})}catch(l){this.client.logger.error(l);const u=s.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),p=this.getAppLinkIfEnabled(s.params.requester.metadata,c),x={type:ks,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:s.id,topic:i,error:l,encodeOpts:x,rpcOpts:Dr.wc_sessionAuthenticate.autoReject,appLink:p})}}),ee(this,"addSessionRequestToSessionRequestQueue",t=>{this.sessionRequestQueue.queue.push(t)}),ee(this,"cleanupAfterResponse",t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ji.idle,this.processSessionRequestQueue()},le.toMiliseconds(this.requestQueueDelay))}),ee(this,"cleanupPendingSentRequestsForTopic",({topic:t,error:n})=>{const i=this.client.core.history.pending;i.length>0&&i.filter(s=>s.topic===t&&s.request.method==="wc_sessionRequest").forEach(s=>{const o=s.request.id,a=ht("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(ht("session_request",s.request.id),{error:n})})}),ee(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===ji.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(t)}catch(n){this.client.logger.error(n)}}),ee(this,"emitSessionRequest",t=>{if(this.emittedSessionRequests.has(t.id)){this.client.logger.warn({id:t.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${t.id}`);return}this.sessionRequestQueue.state=ji.active,this.emittedSessionRequests.add(t.id),this.client.events.emit("session_request",t)}),ee(this,"onPairingCreated",t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const n=this.client.proposal.getAll().find(i=>i.pairingTopic===t.topic);n&&this.onSessionProposeRequest({topic:t.topic,payload:Gi("wc_sessionPropose",Gr(mt({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties,scopedProperties:n.scopedProperties}),n.id),attestation:n.attestation,encryptedId:n.encryptedId})}),ee(this,"isValidConnect",async t=>{if(!xn(t)){const{message:l}=ce("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(l)}const{pairingTopic:n,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:o,scopedProperties:a,relays:c}=t;if(vr(n)||await this.isValidPairingTopic(n),!R9(c)){const{message:l}=ce("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(!vr(i)&&ss(i)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(i,"requiredNamespaces")}if(!vr(s)&&ss(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),vr(o)||this.validateSessionProps(o,"sessionProperties"),!vr(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(i||{}).concat(Object.keys(s||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),ee(this,"validateNamespaces",(t,n)=>{const i=P9(t,"connect()",n);if(i)throw new Error(i.message)}),ee(this,"isValidApprove",async t=>{if(!xn(t))throw new Error(ce("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:i,relayProtocol:s,sessionProperties:o,scopedProperties:a}=t;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const c=this.client.proposal.get(n),l=H0(i,"approve()");if(l)throw new Error(l.message);const u=T1(c.requiredNamespaces,i,"approve()");if(u)throw new Error(u.message);if(!gr(s,!0)){const{message:d}=ce("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(d)}if(vr(o)||this.validateSessionProps(o,"sessionProperties"),!vr(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(i));if(!Object.keys(a).every(p=>d.has(p.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),ee(this,"isValidReject",async t=>{if(!xn(t)){const{message:s}=ce("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(s)}const{id:n,reason:i}=t;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!k9(i)){const{message:s}=ce("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(s)}}),ee(this,"isValidSessionSettleRequest",t=>{if(!xn(t)){const{message:l}=ce("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(l)}const{relay:n,controller:i,namespaces:s,expiry:o}=t;if(!J2(n)){const{message:l}=ce("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=_9(i,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=H0(s,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(ao(o)){const{message:l}=ce("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),ee(this,"isValidUpdate",async t=>{if(!xn(t)){const{message:c}=ce("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(c)}const{topic:n,namespaces:i}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const s=this.client.session.get(n),o=H0(i,"update()");if(o)throw new Error(o.message);const a=T1(s.requiredNamespaces,i,"update()");if(a)throw new Error(a.message)}),ee(this,"isValidExtend",async t=>{if(!xn(t)){const{message:i}=ce("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(i)}const{topic:n}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)}),ee(this,"isValidRequest",async t=>{if(!xn(t)){const{message:c}=ce("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(c)}const{topic:n,request:i,chainId:s,expiry:o}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!I1(a,s)){const{message:c}=ce("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(c)}if(!D9(i)){const{message:c}=ce("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(c)}if(!B9(a,s,i.method)){const{message:c}=ce("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(c)}if(o&&!j9(o,J0)){const{message:c}=ce("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${J0.min} and ${J0.max}`);throw new Error(c)}}),ee(this,"isValidRespond",async t=>{var n;if(!xn(t)){const{message:o}=ce("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(o)}const{topic:i,response:s}=t;try{await this.isValidSessionTopic(i)}catch(o){throw(n=t?.response)!=null&&n.id&&this.cleanupAfterResponse(t),o}if(!M9(s)){const{message:o}=ce("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(o)}}),ee(this,"isValidPing",async t=>{if(!xn(t)){const{message:i}=ce("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(i)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),ee(this,"isValidEmit",async t=>{if(!xn(t)){const{message:a}=ce("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(a)}const{topic:n,event:i,chainId:s}=t;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!I1(o,s)){const{message:a}=ce("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(a)}if(!U9(i)){const{message:a}=ce("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}if(!$9(o,s,i.name)){const{message:a}=ce("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}}),ee(this,"isValidDisconnect",async t=>{if(!xn(t)){const{message:i}=ce("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(i)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),ee(this,"isValidAuthenticate",t=>{const{chains:n,uri:i,domain:s,nonce:o}=t;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!gr(i,!1))throw new Error("uri is required parameter");if(!gr(s,!1))throw new Error("domain is required parameter");if(!gr(o,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(c=>fa(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=fa(n[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),ee(this,"getVerifyContext",async t=>{const{attestationId:n,hash:i,encryptedId:s,metadata:o,transportType:a}=t,c={verified:{verifyUrl:o.verifyUrl||jl,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Zt.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:n,hash:i,encryptedId:s,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),ee(this,"validateSessionProps",(t,n)=>{Object.values(t).forEach((i,s)=>{if(i==null){const{message:o}=ce("MISSING_OR_INVALID",`${n} must contain an existing value for each key. Received: ${i} for key ${Object.keys(t)[s]}`);throw new Error(o)}})}),ee(this,"getPendingAuthRequest",t=>{const n=this.client.auth.requests.get(t);return typeof n=="object"?n:void 0}),ee(this,"addToRecentlyDeleted",(t,n)=>{if(this.recentlyDeletedMap.set(t,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let i=0;const s=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(i++>=s)break;this.recentlyDeletedMap.delete(o)}}}),ee(this,"checkRecentlyDeleted",t=>{const n=this.recentlyDeletedMap.get(t);if(n){const{message:i}=ce("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${t}`);throw new Error(i)}}),ee(this,"isLinkModeEnabled",(t,n)=>{var i,s,o,a,c,l,u,d,p;return!t||n!==Zt.link_mode?!1:((s=(i=this.client.metadata)==null?void 0:i.redirect)==null?void 0:s.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=t?.redirect)==null?void 0:u.universal)!==void 0&&((d=t?.redirect)==null?void 0:d.universal)!==""&&((p=t?.redirect)==null?void 0:p.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),ee(this,"getAppLinkIfEnabled",(t,n)=>{var i;return this.isLinkModeEnabled(t,n)?(i=t?.redirect)==null?void 0:i.universal:void 0}),ee(this,"handleLinkModeMessage",({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const n=qy(t,"topic")||"",i=decodeURIComponent(qy(t,"wc_ev")||""),s=this.client.session.keys.includes(n);s&&this.client.session.update(n,{transportType:Zt.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:i,sessionExists:s})}),ee(this,"registerLinkModeListeners",async()=>{var t;if(ym()||No()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){const n=global==null?void 0:global.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const i=await n.getInitialURL();i&&setTimeout(()=>{this.handleLinkModeMessage({url:i})},50)}}}),ee(this,"getTVFParams",(t,n,i)=>{var s,o,a;if(!((s=n.request)!=null&&s.method))return{};const c={correlationId:t,rpcMethods:[n.request.method],chainId:n.chainId};try{const l=this.extractTxHashesFromResult(n.request,i);c.txHashes=l,c.contractAddresses=this.isValidContractData(n.request.params)?[(a=(o=n.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn("Error getting TVF params",l)}return c}),ee(this,"isValidContractData",t=>{var n;if(!t)return!1;try{const i=t?.data||((n=t?.[0])==null?void 0:n.data);if(!i.startsWith("0x"))return!1;const s=i.slice(2);return/^[0-9a-fA-F]*$/.test(s)?s.length%2===0:!1}catch{}return!1}),ee(this,"extractTxHashesFromResult",(t,n)=>{var i;try{if(!n)return[];const s=t.method,o=hU[s];if(s==="sui_signTransaction")return[uR(n.transactionBytes)];if(s==="near_signTransaction")return[Jy(n)];if(s==="near_signTransactions")return n.map(c=>Jy(c));if(s==="xrpl_signTransactionFor"||s==="xrpl_signTransaction")return[(i=n.tx_json)==null?void 0:i.hash];if(s==="polkadot_signTransaction")return[r7({transaction:t.params.transactionPayload,signature:n.signature})];if(s==="algo_signTxn")return Ds(n)?n.map(c=>Zy(c)):[Zy(n)];if(s==="cosmos_signDirect")return[fR(n)];if(typeof n=="string")return[n];const a=n[o.key];if(Ds(a))return s==="solana_signAllTransactions"?a.map(c=>lR(c)):a;if(typeof a=="string")return[a]}catch(s){this.client.logger.warn("Error extracting tx hashes from result",s)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,i]of Object.entries(t))for(const s of i)try{await this.onProviderMessageEvent({topic:n,message:s,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${s}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(ur.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:t,message:n,attestation:i,transportType:s}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(of)?this.client.auth.authKeys.get(of):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(t,n,{receiverPublicKey:o,encoding:s===Zt.link_mode?fo:Cn});km(a)?(this.client.core.history.set(t,a),await this.onRelayEventRequest({topic:t,payload:a,attestation:i,transportType:s,encryptedId:ei(n)})):Eh(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a,transportType:s}),this.client.core.history.delete(t,a.id)):await this.onRelayEventUnknownPayload({topic:t,payload:a,transportType:s}),await this.client.core.relayer.messages.ack(t,n)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Qn.expired,async e=>{const{topic:t,id:n}=i2(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,ce("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,ce("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Xo.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(Xo.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!gr(e,!1)){const{message:t}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(ao(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ce("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!gr(e,!1)){const{message:t}=ce("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(ao(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=ce("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=ce("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(gr(e,!1)){const{message:t}=ce("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ce("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!O9(e)){const{message:t}=ce("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(ao(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=ce("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class NU extends Ma{constructor(e,t){super(e,t,uU,Dm),this.core=e,this.logger=t}}let IU=class extends Ma{constructor(e,t){super(e,t,dU,Dm),this.core=e,this.logger=t}};class TU extends Ma{constructor(e,t){super(e,t,pU,Dm,n=>n.id),this.core=e,this.logger=t}}class PU extends Ma{constructor(e,t){super(e,t,yU,_h,()=>of),this.core=e,this.logger=t}}class RU extends Ma{constructor(e,t){super(e,t,wU,_h),this.core=e,this.logger=t}}class OU extends Ma{constructor(e,t){super(e,t,xU,_h,n=>n.id),this.core=e,this.logger=t}}var kU=Object.defineProperty,DU=(r,e,t)=>e in r?kU(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Z0=(r,e,t)=>DU(r,typeof e!="symbol"?e+"":e,t);class MU{constructor(e,t){this.core=e,this.logger=t,Z0(this,"authKeys"),Z0(this,"pairingTopics"),Z0(this,"requests"),this.authKeys=new PU(this.core,this.logger),this.pairingTopics=new RU(this.core,this.logger),this.requests=new OU(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var UU=Object.defineProperty,BU=(r,e,t)=>e in r?UU(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,qe=(r,e,t)=>BU(r,typeof e!="symbol"?e+"":e,t);let $U=class EA extends A8{constructor(e){super(e),qe(this,"protocol",wA),qe(this,"version",xA),qe(this,"name",Y0.name),qe(this,"metadata"),qe(this,"core"),qe(this,"logger"),qe(this,"events",new ci.EventEmitter),qe(this,"engine"),qe(this,"session"),qe(this,"proposal"),qe(this,"pendingRequest"),qe(this,"auth"),qe(this,"signConfig"),qe(this,"on",(n,i)=>this.events.on(n,i)),qe(this,"once",(n,i)=>this.events.once(n,i)),qe(this,"off",(n,i)=>this.events.off(n,i)),qe(this,"removeListener",(n,i)=>this.events.removeListener(n,i)),qe(this,"removeAllListeners",n=>this.events.removeAllListeners(n)),qe(this,"connect",async n=>{try{return await this.engine.connect(n)}catch(i){throw this.logger.error(i.message),i}}),qe(this,"pair",async n=>{try{return await this.engine.pair(n)}catch(i){throw this.logger.error(i.message),i}}),qe(this,"approve",async n=>{try{return await this.engine.approve(n)}catch(i){throw this.logger.error(i.message),i}}),qe(this,"reject",async n=>{try{return await this.engine.reject(n)}catch(i){throw this.logger.error(i.message),i}}),qe(this,"update",async n=>{try{return await this.engine.update(n)}catch(i){throw this.logger.error(i.message),i}}),qe(this,"extend",async n=>{try{return await this.engine.extend(n)}catch(i){throw this.logger.error(i.message),i}}),qe(this,"request",async n=>{try{return await this.engine.request(n)}catch(i){throw this.logger.error(i.message),i}}),qe(this,"respond",async n=>{try{return await this.engine.respond(n)}catch(i){throw this.logger.error(i.message),i}}),qe(this,"ping",async n=>{try{return await this.engine.ping(n)}catch(i){throw this.logger.error(i.message),i}}),qe(this,"emit",async n=>{try{return await this.engine.emit(n)}catch(i){throw this.logger.error(i.message),i}}),qe(this,"disconnect",async n=>{try{return await this.engine.disconnect(n)}catch(i){throw this.logger.error(i.message),i}}),qe(this,"find",n=>{try{return this.engine.find(n)}catch(i){throw this.logger.error(i.message),i}}),qe(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}}),qe(this,"authenticate",async(n,i)=>{try{return await this.engine.authenticate(n,i)}catch(s){throw this.logger.error(s.message),s}}),qe(this,"formatAuthMessage",n=>{try{return this.engine.formatAuthMessage(n)}catch(i){throw this.logger.error(i.message),i}}),qe(this,"approveSessionAuthenticate",async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(i){throw this.logger.error(i.message),i}}),qe(this,"rejectSessionAuthenticate",async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(i){throw this.logger.error(i.message),i}}),this.name=e?.name||Y0.name,this.metadata=tP(e?.metadata),this.signConfig=e?.signConfig;const t=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:td(Kc({level:e?.logger||Y0.logger}));this.core=e?.core||new lU(e),this.logger=tn(t,this.name),this.session=new IU(this.core,this.logger),this.proposal=new NU(this.core,this.logger),this.pendingRequest=new TU(this.core,this.logger),this.engine=new SU(this),this.auth=new MU(this.core,this.logger)}static async init(e){const t=new EA(e);return await t.initialize(),t}get context(){return Pn(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Ld={exports:{}},hw;function LU(){return hw||(hw=1,(function(r,e){var t=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Ei<"u"&&Ei,n=(function(){function s(){this.fetch=!1,this.DOMException=t.DOMException}return s.prototype=t,new s})();(function(s){(function(o){var a=typeof s<"u"&&s||typeof self<"u"&&self||typeof Ei<"u"&&Ei||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(h){return h&&DataView.prototype.isPrototypeOf(h)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(h){return h&&u.indexOf(Object.prototype.toString.call(h))>-1};function p(h){if(typeof h!="string"&&(h=String(h)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(h)||h==="")throw new TypeError('Invalid character in header field name: "'+h+'"');return h.toLowerCase()}function x(h){return typeof h!="string"&&(h=String(h)),h}function w(h){var m={next:function(){var A=h.shift();return{done:A===void 0,value:A}}};return c.iterable&&(m[Symbol.iterator]=function(){return m}),m}function b(h){this.map={},h instanceof b?h.forEach(function(m,A){this.append(A,m)},this):Array.isArray(h)?h.forEach(function(m){if(m.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+m.length);this.append(m[0],m[1])},this):h&&Object.getOwnPropertyNames(h).forEach(function(m){this.append(m,h[m])},this)}b.prototype.append=function(h,m){h=p(h),m=x(m);var A=this.map[h];this.map[h]=A?A+", "+m:m},b.prototype.delete=function(h){delete this.map[p(h)]},b.prototype.get=function(h){return h=p(h),this.has(h)?this.map[h]:null},b.prototype.has=function(h){return this.map.hasOwnProperty(p(h))},b.prototype.set=function(h,m){this.map[p(h)]=x(m)},b.prototype.forEach=function(h,m){for(var A in this.map)this.map.hasOwnProperty(A)&&h.call(m,this.map[A],A,this)},b.prototype.keys=function(){var h=[];return this.forEach(function(m,A){h.push(A)}),w(h)},b.prototype.values=function(){var h=[];return this.forEach(function(m){h.push(m)}),w(h)},b.prototype.entries=function(){var h=[];return this.forEach(function(m,A){h.push([A,m])}),w(h)},c.iterable&&(b.prototype[Symbol.iterator]=b.prototype.entries);function y(h){if(!h._noBody){if(h.bodyUsed)return Promise.reject(new TypeError("Already read"));h.bodyUsed=!0}}function C(h){return new Promise(function(m,A){h.onload=function(){m(h.result)},h.onerror=function(){A(h.error)}})}function T(h){var m=new FileReader,A=C(m);return m.readAsArrayBuffer(h),A}function I(h){var m=new FileReader,A=C(m),S=/charset=([A-Za-z0-9_-]+)/.exec(h.type),R=S?S[1]:"utf-8";return m.readAsText(h,R),A}function k(h){for(var m=new Uint8Array(h),A=new Array(m.length),S=0;S<m.length;S++)A[S]=String.fromCharCode(m[S]);return A.join("")}function P(h){if(h.slice)return h.slice(0);var m=new Uint8Array(h.byteLength);return m.set(new Uint8Array(h)),m.buffer}function O(){return this.bodyUsed=!1,this._initBody=function(h){this.bodyUsed=this.bodyUsed,this._bodyInit=h,h?typeof h=="string"?this._bodyText=h:c.blob&&Blob.prototype.isPrototypeOf(h)?this._bodyBlob=h:c.formData&&FormData.prototype.isPrototypeOf(h)?this._bodyFormData=h:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(h)?this._bodyText=h.toString():c.arrayBuffer&&c.blob&&l(h)?(this._bodyArrayBuffer=P(h.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(h)||d(h))?this._bodyArrayBuffer=P(h):this._bodyText=h=Object.prototype.toString.call(h):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof h=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(h)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var h=y(this);if(h)return h;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var h=y(this);return h||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(T);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var h=y(this);if(h)return h;if(this._bodyBlob)return I(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(k(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(W)}),this.json=function(){return this.text().then(JSON.parse)},this}var q=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function F(h){var m=h.toUpperCase();return q.indexOf(m)>-1?m:h}function B(h,m){if(!(this instanceof B))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');m=m||{};var A=m.body;if(h instanceof B){if(h.bodyUsed)throw new TypeError("Already read");this.url=h.url,this.credentials=h.credentials,m.headers||(this.headers=new b(h.headers)),this.method=h.method,this.mode=h.mode,this.signal=h.signal,!A&&h._bodyInit!=null&&(A=h._bodyInit,h.bodyUsed=!0)}else this.url=String(h);if(this.credentials=m.credentials||this.credentials||"same-origin",(m.headers||!this.headers)&&(this.headers=new b(m.headers)),this.method=F(m.method||this.method||"GET"),this.mode=m.mode||this.mode||null,this.signal=m.signal||this.signal||(function(){if("AbortController"in a){var M=new AbortController;return M.signal}})(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&A)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(A),(this.method==="GET"||this.method==="HEAD")&&(m.cache==="no-store"||m.cache==="no-cache")){var S=/([?&])_=[^&]*/;if(S.test(this.url))this.url=this.url.replace(S,"$1_="+new Date().getTime());else{var R=/\?/;this.url+=(R.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}B.prototype.clone=function(){return new B(this,{body:this._bodyInit})};function W(h){var m=new FormData;return h.trim().split("&").forEach(function(A){if(A){var S=A.split("="),R=S.shift().replace(/\+/g," "),M=S.join("=").replace(/\+/g," ");m.append(decodeURIComponent(R),decodeURIComponent(M))}}),m}function j(h){var m=new b,A=h.replace(/\r?\n[\t ]+/g," ");return A.split("\r").map(function(S){return S.indexOf(`
`)===0?S.substr(1,S.length):S}).forEach(function(S){var R=S.split(":"),M=R.shift().trim();if(M){var E=R.join(":").trim();try{m.append(M,E)}catch(g){console.warn("Response "+g.message)}}}),m}O.call(B.prototype);function U(h,m){if(!(this instanceof U))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(m||(m={}),this.type="default",this.status=m.status===void 0?200:m.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=m.statusText===void 0?"":""+m.statusText,this.headers=new b(m.headers),this.url=m.url||"",this._initBody(h)}O.call(U.prototype),U.prototype.clone=function(){return new U(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new b(this.headers),url:this.url})},U.error=function(){var h=new U(null,{status:200,statusText:""});return h.ok=!1,h.status=0,h.type="error",h};var _=[301,302,303,307,308];U.redirect=function(h,m){if(_.indexOf(m)===-1)throw new RangeError("Invalid status code");return new U(null,{status:m,headers:{location:h}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(m,A){this.message=m,this.name=A;var S=Error(m);this.stack=S.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function f(h,m){return new Promise(function(A,S){var R=new B(h,m);if(R.signal&&R.signal.aborted)return S(new o.DOMException("Aborted","AbortError"));var M=new XMLHttpRequest;function E(){M.abort()}M.onload=function(){var L={statusText:M.statusText,headers:j(M.getAllResponseHeaders()||"")};R.url.indexOf("file://")===0&&(M.status<200||M.status>599)?L.status=200:L.status=M.status,L.url="responseURL"in M?M.responseURL:L.headers.get("X-Request-URL");var v="response"in M?M.response:M.responseText;setTimeout(function(){A(new U(v,L))},0)},M.onerror=function(){setTimeout(function(){S(new TypeError("Network request failed"))},0)},M.ontimeout=function(){setTimeout(function(){S(new TypeError("Network request timed out"))},0)},M.onabort=function(){setTimeout(function(){S(new o.DOMException("Aborted","AbortError"))},0)};function g(L){try{return L===""&&a.location.href?a.location.href:L}catch{return L}}if(M.open(R.method,g(R.url),!0),R.credentials==="include"?M.withCredentials=!0:R.credentials==="omit"&&(M.withCredentials=!1),"responseType"in M&&(c.blob?M.responseType="blob":c.arrayBuffer&&(M.responseType="arraybuffer")),m&&typeof m.headers=="object"&&!(m.headers instanceof b||a.Headers&&m.headers instanceof a.Headers)){var N=[];Object.getOwnPropertyNames(m.headers).forEach(function(L){N.push(p(L)),M.setRequestHeader(L,x(m.headers[L]))}),R.headers.forEach(function(L,v){N.indexOf(v)===-1&&M.setRequestHeader(v,L)})}else R.headers.forEach(function(L,v){M.setRequestHeader(v,L)});R.signal&&(R.signal.addEventListener("abort",E),M.onreadystatechange=function(){M.readyState===4&&R.signal.removeEventListener("abort",E)}),M.send(typeof R._bodyInit>"u"?null:R._bodyInit)})}return f.polyfill=!0,a.fetch||(a.fetch=f,a.Headers=b,a.Request=B,a.Response=U),o.Headers=b,o.Request=B,o.Response=U,o.fetch=f,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=t.fetch?t:n;e=i.fetch,e.default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,r.exports=e})(Ld,Ld.exports)),Ld.exports}var FU=LU();const pw=qs(FU);var jU=Object.defineProperty,qU=Object.defineProperties,HU=Object.getOwnPropertyDescriptors,gw=Object.getOwnPropertySymbols,WU=Object.prototype.hasOwnProperty,zU=Object.prototype.propertyIsEnumerable,mw=(r,e,t)=>e in r?jU(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,bw=(r,e)=>{for(var t in e||(e={}))WU.call(e,t)&&mw(r,t,e[t]);if(gw)for(var t of gw(e))zU.call(e,t)&&mw(r,t,e[t]);return r},yw=(r,e)=>qU(r,HU(e));const KU={Accept:"application/json","Content-Type":"application/json"},VU="POST",ww={headers:KU,method:VU},xw=10;let Ui=class{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new ci.EventEmitter,this.isAvailable=!1,this.registering=!1,!U1(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=Bs(e),n=await(await pw(this.url,yw(bw({},ww),{body:t}))).json();this.onPayload({data:n})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!U1(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return i(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Bs({id:1,jsonrpc:"2.0",method:"test",params:[]});await pw(e,yw(bw({},ww),{body:t}))}this.onOpen()}catch(t){const n=this.parseError(t);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?ya(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),i=n.message||n.toString(),s=vh(e,i);this.events.emit("payload",s)}parseError(e,t=this.url){return Q2(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>xw&&this.events.setMaxListeners(xw)}};const vw="error",GU="wss://relay.walletconnect.org",YU="wc",JU="universal_provider",Fd=`${YU}@2:${JU}:`,AA="https://rpc.walletconnect.org/v1/",_A="generic",ZU=`${AA}bundler`,ui={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function Mm(r){return r==null||typeof r!="object"&&typeof r!="function"}function CA(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function SA(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const XU="[object RegExp]",NA="[object String]",IA="[object Number]",TA="[object Boolean]",PA="[object Arguments]",QU="[object Symbol]",eB="[object Date]",tB="[object Map]",rB="[object Set]",nB="[object Array]",iB="[object ArrayBuffer]",sB="[object Object]",oB="[object DataView]",aB="[object Uint8Array]",cB="[object Uint8ClampedArray]",lB="[object Uint16Array]",uB="[object Uint32Array]",dB="[object Int8Array]",fB="[object Int16Array]",hB="[object Int32Array]",pB="[object Float32Array]",gB="[object Float64Array]";function Um(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function mB(r,e){return Ec(r,void 0,r,new Map,e)}function Ec(r,e,t,n=new Map,i=void 0){const s=i?.(r,e,t,n);if(s!=null)return s;if(Mm(r))return r;if(n.has(r))return n.get(r);if(Array.isArray(r)){const o=new Array(r.length);n.set(r,o);for(let a=0;a<r.length;a++)o[a]=Ec(r[a],a,t,n,i);return Object.hasOwn(r,"index")&&(o.index=r.index),Object.hasOwn(r,"input")&&(o.input=r.input),o}if(r instanceof Date)return new Date(r.getTime());if(r instanceof RegExp){const o=new RegExp(r.source,r.flags);return o.lastIndex=r.lastIndex,o}if(r instanceof Map){const o=new Map;n.set(r,o);for(const[a,c]of r)o.set(a,Ec(c,a,t,n,i));return o}if(r instanceof Set){const o=new Set;n.set(r,o);for(const a of r)o.add(Ec(a,void 0,t,n,i));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(r))return r.subarray();if(Um(r)){const o=new(Object.getPrototypeOf(r)).constructor(r.length);n.set(r,o);for(let a=0;a<r.length;a++)o[a]=Ec(r[a],a,t,n,i);return o}if(r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer)return r.slice(0);if(r instanceof DataView){const o=new DataView(r.buffer.slice(0),r.byteOffset,r.byteLength);return n.set(r,o),Qo(o,r,t,n,i),o}if(typeof File<"u"&&r instanceof File){const o=new File([r],r.name,{type:r.type});return n.set(r,o),Qo(o,r,t,n,i),o}if(r instanceof Blob){const o=new Blob([r],{type:r.type});return n.set(r,o),Qo(o,r,t,n,i),o}if(r instanceof Error){const o=new r.constructor;return n.set(r,o),o.message=r.message,o.name=r.name,o.stack=r.stack,o.cause=r.cause,Qo(o,r,t,n,i),o}if(typeof r=="object"&&bB(r)){const o=Object.create(Object.getPrototypeOf(r));return n.set(r,o),Qo(o,r,t,n,i),o}return r}function Qo(r,e,t=r,n,i){const s=[...Object.keys(e),...CA(e)];for(let o=0;o<s.length;o++){const a=s[o],c=Object.getOwnPropertyDescriptor(r,a);(c==null||c.writable)&&(r[a]=Ec(e[a],a,t,n,i))}}function bB(r){switch(SA(r)){case PA:case nB:case iB:case oB:case TA:case eB:case pB:case gB:case dB:case fB:case hB:case tB:case IA:case sB:case XU:case rB:case NA:case QU:case aB:case cB:case lB:case uB:return!0;default:return!1}}function yB(r,e){return mB(r,(t,n,i,s)=>{if(typeof r=="object")switch(Object.prototype.toString.call(r)){case IA:case NA:case TA:{const o=new r.constructor(r?.valueOf());return Qo(o,r),o}case PA:{const o={};return Qo(o,r),o.length=r.length,o[Symbol.iterator]=r[Symbol.iterator],o}default:return}})}function Ew(r){return yB(r)}function Aw(r){return r!==null&&typeof r=="object"&&SA(r)==="[object Arguments]"}function _w(r){return typeof r=="object"&&r!==null}function wB(){}function xB(r){return Um(r)}function vB(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const t=r[Symbol.toStringTag];return t==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${t}]`}let e=r;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e}function EB(r){if(Mm(r))return r;if(Array.isArray(r)||Um(r)||r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer)return r.slice(0);const e=Object.getPrototypeOf(r),t=e.constructor;if(r instanceof Date||r instanceof Map||r instanceof Set)return new t(r);if(r instanceof RegExp){const n=new t(r);return n.lastIndex=r.lastIndex,n}if(r instanceof DataView)return new t(r.buffer.slice(0));if(r instanceof Error){const n=new t(r.message);return n.stack=r.stack,n.name=r.name,n.cause=r.cause,n}if(typeof File<"u"&&r instanceof File)return new t([r],r.name,{type:r.type,lastModified:r.lastModified});if(typeof r=="object"){const n=Object.create(e);return Object.assign(n,r)}return r}function AB(r,...e){const t=e.slice(0,-1),n=e[e.length-1];let i=r;for(let s=0;s<t.length;s++){const o=t[s];i=Tg(i,o,n,new Map)}return i}function Tg(r,e,t,n){if(Mm(r)&&(r=Object(r)),e==null||typeof e!="object")return r;if(n.has(e))return EB(n.get(e));if(n.set(e,r),Array.isArray(e)){e=e.slice();for(let s=0;s<e.length;s++)e[s]=e[s]??void 0}const i=[...Object.keys(e),...CA(e)];for(let s=0;s<i.length;s++){const o=i[s];let a=e[o],c=r[o];if(Aw(a)&&(a={...a}),Aw(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=Ew(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],d=Reflect.ownKeys(c);for(let p=0;p<d.length;p++){const x=d[p];u[x]=c[x]}c=u}else c=[];const l=t(c,a,o,r,e,n);l!=null?r[o]=l:Array.isArray(a)||_w(c)&&_w(a)?r[o]=Tg(c,a,t,n):c==null&&vB(a)?r[o]=Tg({},a,t,n):c==null&&xB(a)?r[o]=Ew(a):(c===void 0||a!==void 0)&&(r[o]=a)}return r}function _B(r,...e){return AB(r,...e,wB)}var CB=Object.defineProperty,SB=Object.defineProperties,NB=Object.getOwnPropertyDescriptors,Cw=Object.getOwnPropertySymbols,IB=Object.prototype.hasOwnProperty,TB=Object.prototype.propertyIsEnumerable,Sw=(r,e,t)=>e in r?CB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,jd=(r,e)=>{for(var t in e||(e={}))IB.call(e,t)&&Sw(r,t,e[t]);if(Cw)for(var t of Cw(e))TB.call(e,t)&&Sw(r,t,e[t]);return r},PB=(r,e)=>SB(r,NB(e));function Hn(r,e,t){var n;const i=fa(r);return((n=e.rpcMap)==null?void 0:n[i.reference])||`${AA}?chainId=${i.namespace}:${i.reference}&projectId=${t}`}function Ua(r){return r.includes(":")?r.split(":")[1]:r}function RA(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function RB(r,e){const t=Object.keys(e.namespaces).filter(i=>i.includes(r));if(!t.length)return[];const n=[];return t.forEach(i=>{const s=e.namespaces[i].accounts;n.push(...s)}),n}function Nw(r){return Object.fromEntries(Object.entries(r).filter(([e,t])=>{var n,i;return((n=t?.chains)==null?void 0:n.length)&&((i=t?.chains)==null?void 0:i.length)>0}))}function qd(r={},e={}){const t=Nw(Iw(r)),n=Nw(Iw(e));return _B(t,n)}function Iw(r){var e,t,n,i,s;const o={};if(!ss(r))return o;for(const[a,c]of Object.entries(r)){const l=xh(a)?[a]:c.chains,u=c.methods||[],d=c.events||[],p=c.rpcMap||{},x=vc(a);o[x]=PB(jd(jd({},o[x]),c),{chains:is(l,(e=o[x])==null?void 0:e.chains),methods:is(u,(t=o[x])==null?void 0:t.methods),events:is(d,(n=o[x])==null?void 0:n.events)}),(ss(p)||ss(((i=o[x])==null?void 0:i.rpcMap)||{}))&&(o[x].rpcMap=jd(jd({},p),(s=o[x])==null?void 0:s.rpcMap))}return o}function Tw(r){return r.includes(":")?r.split(":")[2]:r}function Pw(r){const e={};for(const[t,n]of Object.entries(r)){const i=n.methods||[],s=n.events||[],o=n.accounts||[],a=xh(t)?[t]:n.chains?n.chains:RA(n.accounts);e[t]={chains:a,methods:i,events:s,accounts:o}}return e}function X0(r){return typeof r=="number"?r:r.includes("0x")?parseInt(r,16):(r=r.includes(":")?r.split(":")[1]:r,isNaN(Number(r))?r:Number(r))}const OA={},at=r=>OA[r],Q0=(r,e)=>{OA[r]=e};var OB=Object.defineProperty,Rw=Object.getOwnPropertySymbols,kB=Object.prototype.hasOwnProperty,DB=Object.prototype.propertyIsEnumerable,Ow=(r,e,t)=>e in r?OB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,kw=(r,e)=>{for(var t in e||(e={}))kB.call(e,t)&&Ow(r,t,e[t]);if(Rw)for(var t of Rw(e))DB.call(e,t)&&Ow(r,t,e[t]);return r};const Dw="eip155",MB=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],UB=r=>r&&r.startsWith("0x")?BigInt(r).toString(10):r,ep=r=>r&&r.startsWith("0x")?r:`0x${BigInt(r).toString(16)}`,Mw=r=>Object.keys(r).filter(e=>MB.includes(e)).reduce((e,t)=>(e[t]=r[t],e),{}),BB=(r,e,t)=>{const{sessionProperties:n={},scopedProperties:i={}}=r,s={};if(!ss(i)&&!ss(n))return;const o=Mw(n);for(const a of t){const c=UB(a);if(!c)continue;s[ep(c)]=o;const l=i?.[`${Dw}:${c}`];if(l){const u=l?.[`${Dw}:${c}:${e}`];s[ep(c)]=kw(kw({},s[ep(c)]),Mw(u||l))}}for(const[a,c]of Object.entries(s))Object.keys(c).length===0&&delete s[a];return Object.keys(s).length>0?s:void 0};var $B=Object.defineProperty,LB=(r,e,t)=>e in r?$B(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ja=(r,e,t)=>LB(r,typeof e!="symbol"?e+"":e,t);class FB{constructor(e){Ja(this,"name","polkadot"),Ja(this,"client"),Ja(this,"httpProviders"),Ja(this,"events"),Ja(this,"namespace"),Ja(this,"chainId"),this.namespace=e.namespace,this.events=at("events"),this.client=at("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const i=Ua(t);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||Hn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new li(new Ui(n,at("disableProviderPing")))}}var jB=Object.defineProperty,qB=Object.defineProperties,HB=Object.getOwnPropertyDescriptors,Uw=Object.getOwnPropertySymbols,WB=Object.prototype.hasOwnProperty,zB=Object.prototype.propertyIsEnumerable,Pg=(r,e,t)=>e in r?jB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Bw=(r,e)=>{for(var t in e||(e={}))WB.call(e,t)&&Pg(r,t,e[t]);if(Uw)for(var t of Uw(e))zB.call(e,t)&&Pg(r,t,e[t]);return r},$w=(r,e)=>qB(r,HB(e)),Za=(r,e,t)=>Pg(r,typeof e!="symbol"?e+"":e,t);class KB{constructor(e){Za(this,"name","eip155"),Za(this,"client"),Za(this,"chainId"),Za(this,"namespace"),Za(this,"httpProviders"),Za(this,"events"),this.namespace=e.namespace,this.events=at("events"),this.client=at("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const n=t||Hn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new li(new Ui(n,at("disableProviderPing")))}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const i=parseInt(Ua(t));e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,n;let i=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";i=i.startsWith("0x")?i:`0x${i}`;const s=parseInt(i,16);if(this.isChainApproved(s))this.setDefaultChain(`${s}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:i}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${s}`);else throw new Error(`Failed to switch to chain 'eip155:${s}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,n,i,s,o;const a=(n=(t=e.request)==null?void 0:t.params)==null?void 0:n[0],c=((s=(i=e.request)==null?void 0:i.params)==null?void 0:s[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const l=this.client.session.get(e.topic),u=((o=l?.sessionProperties)==null?void 0:o.capabilities)||{},d=`${a}${c.join(",")}`,p=u?.[d];if(p)return p;let x;try{x=BB(l,a,c)}catch(b){console.warn("Failed to extract capabilities from session",b)}if(x)return x;const w=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:$w(Bw({},l.sessionProperties||{}),{capabilities:$w(Bw({},u||{}),{[d]:w})})})}catch(b){console.warn("Failed to update session with capabilities",b)}return w}async getCallStatus(e){var t,n;const i=this.client.session.get(e.topic),s=(t=i.sessionProperties)==null?void 0:t.bundler_name;if(s){const a=this.getBundlerUrl(e.chainId,s);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(n=i.sessionProperties)==null?void 0:n.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var n;const i=new URL(e),s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Gi("eth_getUserOperationReceipt",[(n=t.request.params)==null?void 0:n[0]]))});if(!s.ok)throw new Error(`Failed to fetch user operation receipt - ${s.status}`);return await s.json()}getBundlerUrl(e,t){return`${ZU}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var VB=Object.defineProperty,GB=(r,e,t)=>e in r?VB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Xa=(r,e,t)=>GB(r,typeof e!="symbol"?e+"":e,t);class YB{constructor(e){Xa(this,"name","solana"),Xa(this,"client"),Xa(this,"httpProviders"),Xa(this,"events"),Xa(this,"namespace"),Xa(this,"chainId"),this.namespace=e.namespace,this.events=at("events"),this.client=at("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const i=Ua(t);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||Hn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new li(new Ui(n,at("disableProviderPing")))}}var JB=Object.defineProperty,ZB=(r,e,t)=>e in r?JB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Qa=(r,e,t)=>ZB(r,typeof e!="symbol"?e+"":e,t);class XB{constructor(e){Qa(this,"name","cosmos"),Qa(this,"client"),Qa(this,"httpProviders"),Qa(this,"events"),Qa(this,"namespace"),Qa(this,"chainId"),this.namespace=e.namespace,this.events=at("events"),this.client=at("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const i=Ua(t);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||Hn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new li(new Ui(n,at("disableProviderPing")))}}var QB=Object.defineProperty,e$=(r,e,t)=>e in r?QB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ec=(r,e,t)=>e$(r,typeof e!="symbol"?e+"":e,t);class t${constructor(e){ec(this,"name","algorand"),ec(this,"client"),ec(this,"httpProviders"),ec(this,"events"),ec(this,"namespace"),ec(this,"chainId"),this.namespace=e.namespace,this.events=at("events"),this.client=at("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const n=t||Hn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.chainId=e,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;e[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||Hn(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new li(new Ui(n,at("disableProviderPing")))}}var r$=Object.defineProperty,n$=(r,e,t)=>e in r?r$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,tc=(r,e,t)=>n$(r,typeof e!="symbol"?e+"":e,t);class i${constructor(e){tc(this,"name","cip34"),tc(this,"client"),tc(this,"httpProviders"),tc(this,"events"),tc(this,"namespace"),tc(this,"chainId"),this.namespace=e.namespace,this.events=at("events"),this.client=at("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=this.getCardanoRPCUrl(t),i=Ua(t);e[i]=this.createHttpProvider(i,n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||this.getCardanoRPCUrl(e);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new li(new Ui(n,at("disableProviderPing")))}}var s$=Object.defineProperty,o$=(r,e,t)=>e in r?s$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,rc=(r,e,t)=>o$(r,typeof e!="symbol"?e+"":e,t);class a${constructor(e){rc(this,"name","elrond"),rc(this,"client"),rc(this,"httpProviders"),rc(this,"events"),rc(this,"namespace"),rc(this,"chainId"),this.namespace=e.namespace,this.events=at("events"),this.client=at("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const i=Ua(t);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||Hn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new li(new Ui(n,at("disableProviderPing")))}}var c$=Object.defineProperty,l$=(r,e,t)=>e in r?c$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,nc=(r,e,t)=>l$(r,typeof e!="symbol"?e+"":e,t);class u${constructor(e){nc(this,"name","multiversx"),nc(this,"client"),nc(this,"httpProviders"),nc(this,"events"),nc(this,"namespace"),nc(this,"chainId"),this.namespace=e.namespace,this.events=at("events"),this.client=at("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const i=Ua(t);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||Hn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new li(new Ui(n,at("disableProviderPing")))}}var d$=Object.defineProperty,f$=(r,e,t)=>e in r?d$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ic=(r,e,t)=>f$(r,typeof e!="symbol"?e+"":e,t);class h${constructor(e){ic(this,"name","near"),ic(this,"client"),ic(this,"httpProviders"),ic(this,"events"),ic(this,"namespace"),ic(this,"chainId"),this.namespace=e.namespace,this.events=at("events"),this.client=at("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||Hn(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;e[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||Hn(e,this.namespace);return typeof n>"u"?void 0:new li(new Ui(n,at("disableProviderPing")))}}var p$=Object.defineProperty,g$=(r,e,t)=>e in r?p$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,sc=(r,e,t)=>g$(r,typeof e!="symbol"?e+"":e,t);class m${constructor(e){sc(this,"name","tezos"),sc(this,"client"),sc(this,"httpProviders"),sc(this,"events"),sc(this,"namespace"),sc(this,"chainId"),this.namespace=e.namespace,this.events=at("events"),this.client=at("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||Hn(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||Hn(e,this.namespace);return typeof n>"u"?void 0:new li(new Ui(n))}}var b$=Object.defineProperty,y$=(r,e,t)=>e in r?b$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,oc=(r,e,t)=>y$(r,typeof e!="symbol"?e+"":e,t);class w${constructor(e){oc(this,"name",_A),oc(this,"client"),oc(this,"httpProviders"),oc(this,"events"),oc(this,"namespace"),oc(this,"chainId"),this.namespace=e.namespace,this.events=at("events"),this.client=at("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return fa(e).namespace}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const n={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(i=>{const s=fa(i);n[s.reference]=this.createHttpProvider(i)}),n}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||Hn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new li(new Ui(n,at("disableProviderPing")))}}var x$=Object.defineProperty,v$=Object.defineProperties,E$=Object.getOwnPropertyDescriptors,Lw=Object.getOwnPropertySymbols,A$=Object.prototype.hasOwnProperty,_$=Object.prototype.propertyIsEnumerable,Rg=(r,e,t)=>e in r?x$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Hd=(r,e)=>{for(var t in e||(e={}))A$.call(e,t)&&Rg(r,t,e[t]);if(Lw)for(var t of Lw(e))_$.call(e,t)&&Rg(r,t,e[t]);return r},tp=(r,e)=>v$(r,E$(e)),Jn=(r,e,t)=>Rg(r,typeof e!="symbol"?e+"":e,t);let C$=class kA{constructor(e){Jn(this,"client"),Jn(this,"namespaces"),Jn(this,"optionalNamespaces"),Jn(this,"sessionProperties"),Jn(this,"scopedProperties"),Jn(this,"events",new sm),Jn(this,"rpcProviders",{}),Jn(this,"session"),Jn(this,"providerOpts"),Jn(this,"logger"),Jn(this,"uri"),Jn(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:td(Kc({level:e?.logger||vw})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const t=new kA(e);return await t.initialize(),t}async request(e,t,n){const[i,s]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:Hd({},e),chainId:`${i}:${s}`,topic:this.session.topic,expiry:n})}sendAsync(e,t,n,i){const s=new Date().getTime();this.request(e,n,i).then(o=>t(null,Su(s,o))).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Qt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:n,response:i}=await this.client.authenticate(e,t);n&&(this.uri=n,this.events.emit("display_uri",n));const s=await i();if(this.session=s.session,this.session){const o=Pw(this.session.namespaces);this.namespaces=qd(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return s}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));const i=await n();this.session=i;const s=Pw(i.namespaces);return this.namespaces=qd(this.namespaces,s),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[n,i]=this.validateChain(e);this.getProvider(n).setDefaultChain(i,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(!Ds(t))return;for(const n of t)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}catch(t){this.logger.warn("Failed to cleanup pending pairings",t)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await $U.init({core:this.providerOpts.core,logger:this.providerOpts.logger||vw,relayUrl:this.providerOpts.relayUrl||GU,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(n){throw this.logger.error("Failed to get session",n),new Error(`The provided session: ${(t=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:t.topic} doesn't exist in the Sign client`)}else{const n=this.client.session.getAll();this.session=n[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>vc(t)))];Q0("client",this.client),Q0("events",this.events),Q0("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const n=RB(t,this.session);if(n?.length===0)return;const i=RA(n),s=qd(this.namespaces,this.optionalNamespaces),o=tp(Hd({},s[t]),{accounts:n,chains:i});switch(t){case"eip155":this.rpcProviders[t]=new KB({namespace:o});break;case"algorand":this.rpcProviders[t]=new t$({namespace:o});break;case"solana":this.rpcProviders[t]=new YB({namespace:o});break;case"cosmos":this.rpcProviders[t]=new XB({namespace:o});break;case"polkadot":this.rpcProviders[t]=new FB({namespace:o});break;case"cip34":this.rpcProviders[t]=new i$({namespace:o});break;case"elrond":this.rpcProviders[t]=new a$({namespace:o});break;case"multiversx":this.rpcProviders[t]=new u$({namespace:o});break;case"near":this.rpcProviders[t]=new h$({namespace:o});break;case"tezos":this.rpcProviders[t]=new m$({namespace:o});break;default:this.rpcProviders[t]=new w$({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;const{topic:n}=e;n===((t=this.session)==null?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;const{params:n,topic:i}=e;if(i!==((t=this.session)==null?void 0:t.topic))return;const{event:s}=n;if(s.name==="accountsChanged"){const o=s.data;o&&Ds(o)&&this.events.emit("accountsChanged",o.map(Tw))}else if(s.name==="chainChanged"){const o=n.chainId,a=n.event.data,c=vc(o),l=X0(o)!==X0(a)?`${c}:${X0(a)}`:o;this.onChainChanged(l)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var n,i;if(e!==((n=this.session)==null?void 0:n.topic))return;const{namespaces:s}=t,o=(i=this.client)==null?void 0:i.session.get(e);this.session=tp(Hd({},o),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===((t=this.session)==null?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",tp(Hd({},Qt("USER_DISCONNECTED")),{data:e.topic})))}),this.on(ui.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[_A]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t={},optionalNamespaces:n={},sessionProperties:i,scopedProperties:s}=e;this.optionalNamespaces=qd(t,n),this.sessionProperties=i,this.scopedProperties=s}validateChain(e){const[t,n]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,n];if(t&&!Object.keys(this.namespaces||{}).map(o=>vc(o)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const i=vc(Object.keys(this.namespaces)[0]),s=this.rpcProviders[i].getDefaultChain();return[i,s]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;const[n,i]=this.validateChain(e);if(!i)return;this.updateNamespaceChain(n,i);const s=this.getProvider(n).getDefaultChain();t?(this.events.emit("chainChanged",i),this.emitAccountsChangedOnChainChange({namespace:n,previousChainId:s,newChainId:e})):this.getProvider(n).setDefaultChain(i),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:t,newChainId:n}){var i,s;try{if(t===n)return;const o=(s=(i=this.session)==null?void 0:i.namespaces[e])==null?void 0:s.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${n}:`)).map(Tw);if(!Ds(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,t){if(!this.namespaces)return;const n=this.namespaces[e]?e:`${e}:${t}`,i={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[n]?this.namespaces[n]&&(this.namespaces[n].defaultChain=t):this.namespaces[n]=i}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var n;const i=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.setItem(`${Fd}/${e}${i}`,t)}async getFromStore(e){var t;const n=((t=this.session)==null?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${Fd}/${e}${n}`)}async deleteFromStore(e){var t;const n=((t=this.session)==null?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${Fd}/${e}${n}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const t=await this.client.core.storage.getKeys();for(const n of t)n.startsWith(Fd)&&await this.client.core.storage.removeItem(n)}catch(t){this.logger.warn("Failed to cleanup storage",t)}}},Ko=null;const Ln={getSIWX(){return Z.state.siwx},async initializeIfEnabled(r=$.getActiveCaipAddress()){const e=Z.state.siwx;if(!(e&&r))return;const[t,n,i]=r.split(":");if($.checkIfSupportedNetwork(t,`${t}:${n}`))try{if(Z.state.remoteFeatures?.emailCapture){const o=$.getAccountData(t)?.user;await He.open({view:"DataCapture",data:{email:o?.email??void 0}});return}if(Ko&&await Ko,(await e.getSessions(`${t}:${n}`,i)).length)return;await He.open({view:"SIWXSignMessage"})}catch(s){console.error("SIWXUtil:initializeIfEnabled",s),Qe.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await de._getClient()?.disconnect().catch(console.error),Te.reset("Connect"),Xi.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const r=Z.state.siwx,e=be.getPlainAddress($.getActiveCaipAddress()),t=Nl(),n=de._getClient();if(!r)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!t)throw new Error("No ActiveCaipNetwork or client found");if(!n)throw new Error("No ConnectionController client found");try{const i=await r.createMessage({chainId:t.caipNetworkId,accountAddress:e}),s=i.toString();ae.getConnectorId(t.chainNamespace)===Y.CONNECTOR_ID.AUTH&&Te.pushTransactionStack({});const a=await n.signMessage(s);await r.addSession({data:i,message:s,signature:a}),$.setLastConnectedSIWECaipNetwork(t),He.close(),Qe.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(i){const s=this.getSIWXEventProperties();(!He.state.open||Te.state.view==="ApproveTransaction")&&await He.open({view:"SIWXSignMessage"}),Xi.showError("Error signing message"),Qe.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:s}),console.error("SWIXUtil:requestSignMessage",i)}},async cancelSignMessage(){try{const r=this.getSIWX();if(r?.getRequired?.()){const t=$.getLastConnectedSIWECaipNetwork();if(t){const n=await r?.getSessions(t?.caipNetworkId,be.getPlainAddress($.getActiveCaipAddress())||"");n&&n.length>0?await $.switchActiveNetwork(t):await de.disconnect()}else await de.disconnect()}else He.close();He.close(),Qe.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(r){console.error("SIWXUtil:cancelSignMessage",r)}},async getAllSessions(){const r=this.getSIWX(),e=$.getAllRequestedCaipNetworks(),t=[];return await Promise.all(e.map(async n=>{const i=await r?.getSessions(n.caipNetworkId,be.getPlainAddress($.getActiveCaipAddress())||"");i&&t.push(...i)})),t},async getSessions(r){const e=Z.state.siwx;let t=r?.address;if(!t){const i=$.getActiveCaipAddress();t=be.getPlainAddress(i)}let n=r?.caipNetworkId;return n||(n=$.getActiveCaipNetwork()?.caipNetworkId),e&&t&&n?e.getSessions(n,t):[]},async isSIWXCloseDisabled(){const r=this.getSIWX();if(r){const e=Te.state.view==="ApproveTransaction",t=Te.state.view==="SIWXSignMessage";if(e||t)return r.getRequired?.()&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:r,chainId:e,socialUri:t,preferredAccountType:n,chainNamespace:i}){const s=Ln.getSIWX(),o=Nl();if(!s||!i.includes(Y.CHAIN.EVM)||Z.state.remoteFeatures?.emailCapture){const d=await r.connect({chainId:e,socialUri:t,preferredAccountType:n});return{address:d.address,chainId:d.chainId,accounts:d.accounts}}const a=`${i}:${e}`,c=await s.createMessage({chainId:a,accountAddress:"<<AccountAddress>>"}),l={accountAddress:c.accountAddress,chainId:c.chainId,domain:c.domain,uri:c.uri,version:c.version,nonce:c.nonce,notBefore:c.notBefore,statement:c.statement,resources:c.resources,requestId:c.requestId,issuedAt:c.issuedAt,expirationTime:c.expirationTime,serializedMessage:c.toString()},u=await r.connect({chainId:e,socialUri:t,siwxMessage:l,preferredAccountType:n});return l.accountAddress=u.address,l.serializedMessage=u.message||"",u.signature&&u.message&&await Ln.addEmbeddedWalletSession(l,u.message,u.signature),$.setLastConnectedSIWECaipNetwork(o),{address:u.address,chainId:u.chainId,accounts:u.accounts}},async addEmbeddedWalletSession(r,e,t){if(Ko)return Ko;const n=Ln.getSIWX();return n?(Ko=n.addSession({data:r,message:e,signature:t}).finally(()=>{Ko=null}),Ko):Promise.resolve()},async universalProviderAuthenticate({universalProvider:r,chains:e,methods:t}){const n=Ln.getSIWX(),i=Nl(),s=new Set(e.map(c=>c.split(":")[0]));if(!n||s.size!==1||!s.has("eip155"))return!1;const o=await n.createMessage({chainId:Nl()?.caipNetworkId||"",accountAddress:""}),a=await r.authenticate({nonce:o.nonce,domain:o.domain,uri:o.uri,exp:o.expirationTime,iat:o.issuedAt,nbf:o.notBefore,requestId:o.requestId,version:o.version,resources:o.resources,statement:o.statement,chainId:o.chainId,methods:t,chains:[o.chainId,...e.filter(c=>c!==o.chainId)]});if(Xi.showLoading("Authenticating...",{autoClose:!1}),ye.setConnectedWalletInfo({...a.session.peer.metadata,name:a.session.peer.metadata.name,icon:a.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"},Array.from(s)[0]),a?.auths?.length){const c=a.auths.map(l=>{const u=r.client.formatAuthMessage({request:l.p,iss:l.p.iss});return{data:{...l.p,accountAddress:l.p.iss.split(":").slice(-1).join(""),chainId:l.p.iss.split(":").slice(2,4).join(":"),uri:l.p.aud,version:l.p.version||o.version,expirationTime:l.p.exp,issuedAt:l.p.iat,notBefore:l.p.nbf},message:u,signature:l.s.s,cacao:l}});try{await n.setSessions(c),i&&$.setLastConnectedSIWECaipNetwork(i),Qe.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:Ln.getSIWXEventProperties()})}catch(l){throw console.error("SIWX:universalProviderAuth - failed to set sessions",l),Qe.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:Ln.getSIWXEventProperties()}),await r.disconnect().catch(console.error),l}finally{Xi.hide()}}return!0},getSIWXEventProperties(){const r=$.state.activeChain;if(!r)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:$.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:qn(r)===_r.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){const r=this.getSIWX();r&&await r.setSessions([])}},Ye={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",OKX_CONNECTOR_NAME:"OKX Wallet",EIP155:Y.CHAIN.EVM,ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"},Ji={ConnectorExplorerIds:{[Y.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[Y.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[Y.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[Y.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[Y.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[Ye.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[Ye.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[Ye.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[Ye.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[Ye.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[Ye.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[Ye.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[Ye.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[Ye.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[Ye.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[Ye.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13",[Ye.OKX_CONNECTOR_NAME]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200","00000008819873e925422c1ff0f99f7c":"b3406e4a-bbfc-44fb-e3a6-89673c78b700"},ConnectorImageIds:{[Y.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[Y.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[Y.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[Y.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[Y.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[Y.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[Y.CONNECTOR_ID.INJECTED]:"Browser Wallet",[Y.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[Y.CONNECTOR_ID.COINBASE]:"Coinbase",[Y.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[Y.CONNECTOR_ID.LEDGER]:"Ledger",[Y.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[Y.CONNECTOR_ID.INJECTED]:"INJECTED",[Y.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[Y.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[Y.CONNECTOR_ID.AUTH]:"AUTH",[Ye.CONNECTOR_TYPE_AUTH]:"AUTH"}},Ar={getCaipTokens(r){if(!r)return;const e={};return Object.entries(r).forEach(([t,n])=>{e[`${Ye.EIP155}:${t}`]=n}),e},isLowerCaseMatch(r,e){return r?.toLowerCase()===e?.toLowerCase()},getActiveNamespaceConnectedToAuth(){const r=$.state.activeChain;return Y.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>ae.getConnectorId(e)===Y.CONNECTOR_ID.AUTH&&e===r)},withRetry({conditionFn:r,intervalMs:e,maxRetries:t}){let n=0;return new Promise(i=>{async function s(){return n+=1,await r()?i(!0):n>=t?i(!1):(setTimeout(s,e),null)}s()})},userChainIdToChainNamespace(r){if(typeof r=="number")return Y.CHAIN.EVM;const[e]=r.split(":");return e},getOtherAuthNamespaces(r){return r?Y.AUTH_CONNECTOR_SUPPORTED_CHAINS.filter(n=>n!==r):[]}},S$=new AbortController,Yr={EmbeddedWalletAbortController:S$,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{code:"APKT001",displayMessage:"Network Not Found",debugMessage:"The specified network is not recognized. Please ensure it is included in the `networks` array of your `createAppKit` configuration."},ORIGIN_NOT_ALLOWED:{code:"APKT002",displayMessage:"Invalid App Configuration",debugMessage:()=>`The origin ${wc()?window.origin:"unknown"} is not in your allow list. Please update your allowed domains at https://dashboard.reown.com.`},IFRAME_LOAD_FAILED:{code:"APKT003",displayMessage:"Network Error: Wallet Load Failed",debugMessage:()=>"Failed to load the embedded wallet. This may be due to network issues or server downtime. Please check your network connection and try again shortly. Contact support if the issue persists."},IFRAME_REQUEST_TIMEOUT:{code:"APKT004",displayMessage:"Wallet Request Timeout",debugMessage:()=>"The request to the embedded wallet timed out. Please check your network connection and try again shortly. Contact support if the issue persists."},UNVERIFIED_DOMAIN:{code:"APKT005",displayMessage:"Unverified Domain",debugMessage:()=>"Embedded wallet load failed. Ensure your domain is verified in https://dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{code:"APKT006",displayMessage:"Session Expired",debugMessage:"Your session is invalid or expired. Please check your system’s date and time settings, then reconnect."},INVALID_PROJECT_ID:{code:"APKT007",displayMessage:"Invalid Project ID",debugMessage:"The specified project ID is invalid. Please visit https://dashboard.reown.com to obtain a valid project ID."},PROJECT_ID_NOT_CONFIGURED:{code:"APKT008",displayMessage:"Project ID Missing",debugMessage:"No project ID is configured. You can create and configure a project ID at https://dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{code:"APKT009",displayMessage:"Server Error",debugMessage:r=>`Unable to fetch App Configuration. ${r}. Please check your network connection and try again shortly. Contact support if the issue persists.`},RATE_LIMITED_APP_CONFIGURATION:{code:"APKT010",displayMessage:"Rate Limited",debugMessage:"You have been rate limited while retrieving App Configuration. Please wait a few minutes and try again. Contact support if the issue persists."}},ALERT_WARNINGS:{LOCAL_CONFIGURATION_IGNORED:{debugMessage:r=>`[Reown Config Notice] ${r}`},INACTIVE_NAMESPACE_NOT_CONNECTED:{code:"APKTW001",displayMessage:"Inactive Namespace Not Connected",debugMessage:(r,e)=>`An error occurred while connecting an inactive namespace ${r}: "${e}"`},INVALID_EMAIL:{code:"APKTW002",displayMessage:"Invalid Email Address",debugMessage:"Please enter a valid email address"}}},N$={createLogger(r,e="error"){const t=Kc({level:e}),{logger:n}=am({opts:t});return n.error=(...i)=>{for(const s of i)if(s instanceof Error){r(s,...i);return}r(void 0,...i)},n}},I$="rpc.walletconnect.org";function Fw(r,e){const t=new URL("https://rpc.walletconnect.org/v1/");return t.searchParams.set("chainId",r),t.searchParams.set("projectId",e),t.toString()}const rp=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","eip155:80094","eip155:80069","eip155:560048","eip155:31","eip155:2818","eip155:57054","eip155:911867","eip155:534351","eip155:1112","eip155:534352","eip155:1111","eip155:146","eip155:130","eip155:1284","eip155:30","eip155:2810","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],hc={extendRpcUrlWithProjectId(r,e){let t=!1;try{t=new URL(r).host===I$}catch{t=!1}if(t){const n=new URL(r);return n.searchParams.has("projectId")||n.searchParams.set("projectId",e),n.toString()}return r},isCaipNetwork(r){return"chainNamespace"in r&&"caipNetworkId"in r},getChainNamespace(r){return this.isCaipNetwork(r)?r.chainNamespace:Y.CHAIN.EVM},getCaipNetworkId(r){return this.isCaipNetwork(r)?r.caipNetworkId:`${Y.CHAIN.EVM}:${r.id}`},getDefaultRpcUrl(r,e,t){const n=r.rpcUrls?.default?.http?.[0];return rp.includes(e)?Fw(e,t):n||""},extendCaipNetwork(r,{customNetworkImageUrls:e,projectId:t,customRpcUrls:n}){const i=this.getChainNamespace(r),s=this.getCaipNetworkId(r),o=r.rpcUrls?.default?.http?.[0],a=this.getDefaultRpcUrl(r,s,t),c=r?.rpcUrls?.chainDefault?.http?.[0]||o,l=n?.[s]?.map(p=>p.url)||[],u=[...l,...a?[a]:[]],d=[...l];return c&&!d.includes(c)&&d.push(c),{...r,chainNamespace:i,caipNetworkId:s,assets:{imageId:Ji.NetworkImageIds[r.id],imageUrl:e?.[r.id]},rpcUrls:{...r.rpcUrls,default:{http:u},chainDefault:{http:d}}}},extendCaipNetworks(r,{customNetworkImageUrls:e,projectId:t,customRpcUrls:n}){return r.map(i=>hc.extendCaipNetwork(i,{customNetworkImageUrls:e,customRpcUrls:n,projectId:t}))},getViemTransport(r,e,t){const n=[];return t?.forEach(i=>{n.push(Cd(i.url,i.config))}),rp.includes(r.caipNetworkId)&&n.push(Cd(Fw(r.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),r?.rpcUrls?.default?.http?.forEach(i=>{n.push(Cd(i))}),kb(n)},extendWagmiTransports(r,e,t){if(rp.includes(r.caipNetworkId)){const n=this.getDefaultRpcUrl(r,r.caipNetworkId,e);return kb([t,Cd(n)])}return t},getUnsupportedNetwork(r){return{id:r.split(":")[1],caipNetworkId:r,name:Y.UNSUPPORTED_NETWORK_NAME,chainNamespace:r.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(r){const e=Q.getActiveCaipNetworkId(),t=$.getAllRequestedCaipNetworks(),n=Array.from($.state.chains?.keys()||[]),i=e?.split(":")[0],s=i?n.includes(i):!1,o=t?.find(c=>c.caipNetworkId===e);return s&&!o&&e?this.getUnsupportedNetwork(e):o||r||t?.[0]}},$f={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0,sui:void 0,stacks:void 0},bn=It({providers:{...$f},providerIds:{...$f}}),Ve={state:bn,subscribeKey(r,e){return en(bn,r,e)},subscribe(r){return Lr(bn,()=>{r(bn)})},subscribeProviders(r){return Lr(bn.providers,()=>r(bn.providers))},setProvider(r,e){r&&e&&(bn.providers[r]=ma(e))},getProvider(r){if(r)return bn.providers[r]},setProviderId(r,e){e&&(bn.providerIds[r]=e)},getProviderId(r){if(r)return bn.providerIds[r]},reset(){bn.providers={...$f},bn.providerIds={...$f}},resetChain(r){bn.providers[r]=void 0,bn.providerIds[r]=void 0}},jw={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},Mr={set(r,e){Fn.isClient&&localStorage.setItem(`${xe.STORAGE_KEY}${r}`,e)},get(r){return Fn.isClient?localStorage.getItem(`${xe.STORAGE_KEY}${r}`):null},delete(r,e){Fn.isClient&&(e?localStorage.removeItem(r):localStorage.removeItem(`${xe.STORAGE_KEY}${r}`))}},Wd=30*1e3,Fn={checkIfAllowedToTriggerEmail(){const r=Mr.get(xe.LAST_EMAIL_LOGIN_TIME);if(r){const e=Date.now()-Number(r);if(e<Wd){const t=Math.ceil((Wd-e)/1e3);throw new Error(`Please try again after ${t} seconds`)}}},getTimeToNextEmailLogin(){const r=Mr.get(xe.LAST_EMAIL_LOGIN_TIME);if(r){const e=Date.now()-Number(r);if(e<Wd)return Math.ceil((Wd-e)/1e3)}return 0},checkIfRequestExists(r){return _r.NOT_SAFE_RPC_METHODS.includes(r.method)||_r.SAFE_RPC_METHODS.includes(r.method)},getResponseType(r){return typeof r=="string"&&(r?.match(jw.transactionHash)||r?.match(jw.signedMessage))?xe.RPC_RESPONSE_TYPE_TX:xe.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(r){return _r.SAFE_RPC_METHODS.includes(r.method)},isClient:typeof window<"u"};var ot;(function(r){r.assertEqual=i=>i;function e(i){}r.assertIs=e;function t(i){throw new Error}r.assertNever=t,r.arrayToEnum=i=>{const s={};for(const o of i)s[o]=o;return s},r.getValidEnumValues=i=>{const s=r.objectKeys(i).filter(a=>typeof i[i[a]]!="number"),o={};for(const a of s)o[a]=i[a];return r.objectValues(o)},r.objectValues=i=>r.objectKeys(i).map(function(s){return i[s]}),r.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&s.push(o);return s},r.find=(i,s)=>{for(const o of i)if(s(o))return o},r.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function n(i,s=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}r.joinValues=n,r.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(ot||(ot={}));var Og;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(Og||(Og={}));const pe=ot.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ho=r=>{switch(typeof r){case"undefined":return pe.undefined;case"string":return pe.string;case"number":return isNaN(r)?pe.nan:pe.number;case"boolean":return pe.boolean;case"function":return pe.function;case"bigint":return pe.bigint;case"symbol":return pe.symbol;case"object":return Array.isArray(r)?pe.array:r===null?pe.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?pe.promise:typeof Map<"u"&&r instanceof Map?pe.map:typeof Set<"u"&&r instanceof Set?pe.set:typeof Date<"u"&&r instanceof Date?pe.date:pe.object;default:return pe.unknown}},se=ot.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),T$=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class Oi extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(s){return s.message},n={_errors:[]},i=s=>{for(const o of s.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)n._errors.push(t(o));else{let a=n,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(t(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return i(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,ot.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const i of this.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}Oi.create=r=>new Oi(r);const Nu=(r,e)=>{let t;switch(r.code){case se.invalid_type:r.received===pe.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case se.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,ot.jsonStringifyReplacer)}`;break;case se.unrecognized_keys:t=`Unrecognized key(s) in object: ${ot.joinValues(r.keys,", ")}`;break;case se.invalid_union:t="Invalid input";break;case se.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${ot.joinValues(r.options)}`;break;case se.invalid_enum_value:t=`Invalid enum value. Expected ${ot.joinValues(r.options)}, received '${r.received}'`;break;case se.invalid_arguments:t="Invalid function arguments";break;case se.invalid_return_type:t="Invalid function return type";break;case se.invalid_date:t="Invalid date";break;case se.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:ot.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case se.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case se.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case se.custom:t="Invalid input";break;case se.invalid_intersection_types:t="Intersection results could not be merged";break;case se.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case se.not_finite:t="Number must be finite";break;default:t=e.defaultError,ot.assertNever(r)}return{message:t}};let DA=Nu;function P$(r){DA=r}function Lf(){return DA}const Ff=r=>{const{data:e,path:t,errorMaps:n,issueData:i}=r,s=[...t,...i.path||[]],o={...i,path:s};let a="";const c=n.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...i,path:s,message:i.message||a}},R$=[];function we(r,e){const t=Ff({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Lf(),Nu].filter(n=>!!n)});r.common.issues.push(t)}class Qr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const i of t){if(i.status==="aborted")return ke;i.status==="dirty"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const i of t)n.push({key:await i.key,value:await i.value});return Qr.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const i of t){const{key:s,value:o}=i;if(s.status==="aborted"||o.status==="aborted")return ke;s.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(n[s.value]=o.value)}return{status:e.value,value:n}}}const ke=Object.freeze({status:"aborted"}),MA=r=>({status:"dirty",value:r}),dn=r=>({status:"valid",value:r}),kg=r=>r.status==="aborted",Dg=r=>r.status==="dirty",Iu=r=>r.status==="valid",jf=r=>typeof Promise<"u"&&r instanceof Promise;var Ne;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e?.message})(Ne||(Ne={}));class cs{constructor(e,t,n,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const qw=(r,e)=>{if(Iu(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Oi(r.common.issues);return this._error=t,this._error}}};function Me(r){if(!r)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:i}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:n??a.defaultError}:{message:t??a.defaultError},description:i}}class Be{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return ho(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ho(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Qr,ctx:{common:e.parent.common,data:e.data,parsedType:ho(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(jf(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const i={common:{issues:[],async:(n=t?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ho(e)},s=this._parseSync({data:e,path:i.path,parent:i});return qw(i,s)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ho(e)},i=this._parse({data:e,path:n.path,parent:n}),s=await(jf(i)?i:Promise.resolve(i));return qw(n,s)}refine(e,t){const n=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,s)=>{const o=e(i),a=()=>s.addIssue({code:se.custom,...n(i)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof t=="function"?t(n,i):t),!1))}_refinement(e){return new Di({schema:this,typeName:Pe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Ms.create(this,this._def)}nullable(){return _a.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ki.create(this,this._def)}promise(){return Fc.create(this,this._def)}or(e){return Ou.create([this,e],this._def)}and(e){return ku.create(this,e,this._def)}transform(e){return new Di({...Me(this._def),schema:this,typeName:Pe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new $u({...Me(this._def),innerType:this,defaultValue:t,typeName:Pe.ZodDefault})}brand(){return new BA({typeName:Pe.ZodBranded,type:this,...Me(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new zf({...Me(this._def),innerType:this,catchValue:t,typeName:Pe.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return ud.create(this,e)}readonly(){return Vf.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const O$=/^c[^\s-]{8,}$/i,k$=/^[a-z][a-z0-9]*$/,D$=/^[0-9A-HJKMNP-TV-Z]{26}$/,M$=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,U$=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,B$="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let np;const $$=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,L$=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,F$=r=>r.precision?r.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${r.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${r.precision}}Z$`):r.precision===0?r.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):r.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function j$(r,e){return!!((e==="v4"||!e)&&$$.test(r)||(e==="v6"||!e)&&L$.test(r))}class Ii extends Be{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==pe.string){const s=this._getOrReturnCtx(e);return we(s,{code:se.invalid_type,expected:pe.string,received:s.parsedType}),ke}const n=new Qr;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),we(i,{code:se.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),we(i,{code:se.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){const o=e.data.length>s.value,a=e.data.length<s.value;(o||a)&&(i=this._getOrReturnCtx(e,i),o?we(i,{code:se.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&we(i,{code:se.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")U$.test(e.data)||(i=this._getOrReturnCtx(e,i),we(i,{validation:"email",code:se.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")np||(np=new RegExp(B$,"u")),np.test(e.data)||(i=this._getOrReturnCtx(e,i),we(i,{validation:"emoji",code:se.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")M$.test(e.data)||(i=this._getOrReturnCtx(e,i),we(i,{validation:"uuid",code:se.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")O$.test(e.data)||(i=this._getOrReturnCtx(e,i),we(i,{validation:"cuid",code:se.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")k$.test(e.data)||(i=this._getOrReturnCtx(e,i),we(i,{validation:"cuid2",code:se.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")D$.test(e.data)||(i=this._getOrReturnCtx(e,i),we(i,{validation:"ulid",code:se.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),we(i,{validation:"url",code:se.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),we(i,{validation:"regex",code:se.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),we(i,{code:se.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),we(i,{code:se.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),we(i,{code:se.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?F$(s).test(e.data)||(i=this._getOrReturnCtx(e,i),we(i,{code:se.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="ip"?j$(e.data,s.version)||(i=this._getOrReturnCtx(e,i),we(i,{validation:"ip",code:se.invalid_string,message:s.message}),n.dirty()):ot.assertNever(s);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(i=>e.test(i),{validation:t,code:se.invalid_string,...Ne.errToObj(n)})}_addCheck(e){return new Ii({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Ne.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Ne.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Ne.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Ne.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Ne.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Ne.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Ne.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Ne.errToObj(e)})}datetime(e){var t;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(t=e?.offset)!==null&&t!==void 0?t:!1,...Ne.errToObj(e?.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Ne.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...Ne.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Ne.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Ne.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Ne.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Ne.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Ne.errToObj(t)})}nonempty(e){return this.min(1,Ne.errToObj(e))}trim(){return new Ii({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ii({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ii({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Ii.create=r=>{var e;return new Ii({checks:[],typeName:Pe.ZodString,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...Me(r)})};function q$(r,e){const t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=t>n?t:n,s=parseInt(r.toFixed(i).replace(".","")),o=parseInt(e.toFixed(i).replace(".",""));return s%o/Math.pow(10,i)}class Ao extends Be{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==pe.number){const s=this._getOrReturnCtx(e);return we(s,{code:se.invalid_type,expected:pe.number,received:s.parsedType}),ke}let n;const i=new Qr;for(const s of this._def.checks)s.kind==="int"?ot.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{code:se.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),we(n,{code:se.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),we(n,{code:se.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?q$(e.data,s.value)!==0&&(n=this._getOrReturnCtx(e,n),we(n,{code:se.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),we(n,{code:se.not_finite,message:s.message}),i.dirty()):ot.assertNever(s);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Ne.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Ne.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Ne.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Ne.toString(t))}setLimit(e,t,n,i){return new Ao({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Ne.toString(i)}]})}_addCheck(e){return new Ao({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Ne.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ne.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ne.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ne.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ne.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Ne.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Ne.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ne.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ne.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ot.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Ao.create=r=>new Ao({checks:[],typeName:Pe.ZodNumber,coerce:r?.coerce||!1,...Me(r)});class _o extends Be{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==pe.bigint){const s=this._getOrReturnCtx(e);return we(s,{code:se.invalid_type,expected:pe.bigint,received:s.parsedType}),ke}let n;const i=new Qr;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),we(n,{code:se.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),we(n,{code:se.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),we(n,{code:se.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):ot.assertNever(s);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Ne.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Ne.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Ne.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Ne.toString(t))}setLimit(e,t,n,i){return new _o({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Ne.toString(i)}]})}_addCheck(e){return new _o({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ne.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ne.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ne.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ne.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Ne.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}_o.create=r=>{var e;return new _o({checks:[],typeName:Pe.ZodBigInt,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...Me(r)})};class Tu extends Be{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==pe.boolean){const n=this._getOrReturnCtx(e);return we(n,{code:se.invalid_type,expected:pe.boolean,received:n.parsedType}),ke}return dn(e.data)}}Tu.create=r=>new Tu({typeName:Pe.ZodBoolean,coerce:r?.coerce||!1,...Me(r)});class Ea extends Be{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==pe.date){const s=this._getOrReturnCtx(e);return we(s,{code:se.invalid_type,expected:pe.date,received:s.parsedType}),ke}if(isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return we(s,{code:se.invalid_date}),ke}const n=new Qr;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),we(i,{code:se.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),we(i,{code:se.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):ot.assertNever(s);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ea({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Ne.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Ne.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Ea.create=r=>new Ea({checks:[],coerce:r?.coerce||!1,typeName:Pe.ZodDate,...Me(r)});class qf extends Be{_parse(e){if(this._getType(e)!==pe.symbol){const n=this._getOrReturnCtx(e);return we(n,{code:se.invalid_type,expected:pe.symbol,received:n.parsedType}),ke}return dn(e.data)}}qf.create=r=>new qf({typeName:Pe.ZodSymbol,...Me(r)});class Pu extends Be{_parse(e){if(this._getType(e)!==pe.undefined){const n=this._getOrReturnCtx(e);return we(n,{code:se.invalid_type,expected:pe.undefined,received:n.parsedType}),ke}return dn(e.data)}}Pu.create=r=>new Pu({typeName:Pe.ZodUndefined,...Me(r)});class Ru extends Be{_parse(e){if(this._getType(e)!==pe.null){const n=this._getOrReturnCtx(e);return we(n,{code:se.invalid_type,expected:pe.null,received:n.parsedType}),ke}return dn(e.data)}}Ru.create=r=>new Ru({typeName:Pe.ZodNull,...Me(r)});class Lc extends Be{constructor(){super(...arguments),this._any=!0}_parse(e){return dn(e.data)}}Lc.create=r=>new Lc({typeName:Pe.ZodAny,...Me(r)});class ha extends Be{constructor(){super(...arguments),this._unknown=!0}_parse(e){return dn(e.data)}}ha.create=r=>new ha({typeName:Pe.ZodUnknown,...Me(r)});class Fs extends Be{_parse(e){const t=this._getOrReturnCtx(e);return we(t,{code:se.invalid_type,expected:pe.never,received:t.parsedType}),ke}}Fs.create=r=>new Fs({typeName:Pe.ZodNever,...Me(r)});class Hf extends Be{_parse(e){if(this._getType(e)!==pe.undefined){const n=this._getOrReturnCtx(e);return we(n,{code:se.invalid_type,expected:pe.void,received:n.parsedType}),ke}return dn(e.data)}}Hf.create=r=>new Hf({typeName:Pe.ZodVoid,...Me(r)});class ki extends Be{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),i=this._def;if(t.parsedType!==pe.array)return we(t,{code:se.invalid_type,expected:pe.array,received:t.parsedType}),ke;if(i.exactLength!==null){const o=t.data.length>i.exactLength.value,a=t.data.length<i.exactLength.value;(o||a)&&(we(t,{code:o?se.too_big:se.too_small,minimum:a?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(i.minLength!==null&&t.data.length<i.minLength.value&&(we(t,{code:se.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),i.maxLength!==null&&t.data.length>i.maxLength.value&&(we(t,{code:se.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>i.type._parseAsync(new cs(t,o,t.path,a)))).then(o=>Qr.mergeArray(n,o));const s=[...t.data].map((o,a)=>i.type._parseSync(new cs(t,o,t.path,a)));return Qr.mergeArray(n,s)}get element(){return this._def.type}min(e,t){return new ki({...this._def,minLength:{value:e,message:Ne.toString(t)}})}max(e,t){return new ki({...this._def,maxLength:{value:e,message:Ne.toString(t)}})}length(e,t){return new ki({...this._def,exactLength:{value:e,message:Ne.toString(t)}})}nonempty(e){return this.min(1,e)}}ki.create=(r,e)=>new ki({type:r,minLength:null,maxLength:null,exactLength:null,typeName:Pe.ZodArray,...Me(e)});function pc(r){if(r instanceof rr){const e={};for(const t in r.shape){const n=r.shape[t];e[t]=Ms.create(pc(n))}return new rr({...r._def,shape:()=>e})}else return r instanceof ki?new ki({...r._def,type:pc(r.element)}):r instanceof Ms?Ms.create(pc(r.unwrap())):r instanceof _a?_a.create(pc(r.unwrap())):r instanceof ls?ls.create(r.items.map(e=>pc(e))):r}class rr extends Be{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=ot.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==pe.object){const l=this._getOrReturnCtx(e);return we(l,{code:se.invalid_type,expected:pe.object,received:l.parsedType}),ke}const{status:n,ctx:i}=this._processInputParams(e),{shape:s,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Fs&&this._def.unknownKeys==="strip"))for(const l in i.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const u=s[l],d=i.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new cs(i,d,i.path,l)),alwaysSet:l in i.data})}if(this._def.catchall instanceof Fs){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:i.data[u]}});else if(l==="strict")a.length>0&&(we(i,{code:se.unrecognized_keys,keys:a}),n.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of a){const d=i.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new cs(i,d,i.path,u)),alwaysSet:u in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const d=await u.key;l.push({key:d,value:await u.value,alwaysSet:u.alwaysSet})}return l}).then(l=>Qr.mergeObjectSync(n,l)):Qr.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return Ne.errToObj,new rr({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var i,s,o,a;const c=(o=(s=(i=this._def).errorMap)===null||s===void 0?void 0:s.call(i,t,n).message)!==null&&o!==void 0?o:n.defaultError;return t.code==="unrecognized_keys"?{message:(a=Ne.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new rr({...this._def,unknownKeys:"strip"})}passthrough(){return new rr({...this._def,unknownKeys:"passthrough"})}extend(e){return new rr({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new rr({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Pe.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new rr({...this._def,catchall:e})}pick(e){const t={};return ot.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new rr({...this._def,shape:()=>t})}omit(e){const t={};return ot.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new rr({...this._def,shape:()=>t})}deepPartial(){return pc(this)}partial(e){const t={};return ot.objectKeys(this.shape).forEach(n=>{const i=this.shape[n];e&&!e[n]?t[n]=i:t[n]=i.optional()}),new rr({...this._def,shape:()=>t})}required(e){const t={};return ot.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof Ms;)s=s._def.innerType;t[n]=s}}),new rr({...this._def,shape:()=>t})}keyof(){return UA(ot.objectKeys(this.shape))}}rr.create=(r,e)=>new rr({shape:()=>r,unknownKeys:"strip",catchall:Fs.create(),typeName:Pe.ZodObject,...Me(e)});rr.strictCreate=(r,e)=>new rr({shape:()=>r,unknownKeys:"strict",catchall:Fs.create(),typeName:Pe.ZodObject,...Me(e)});rr.lazycreate=(r,e)=>new rr({shape:r,unknownKeys:"strip",catchall:Fs.create(),typeName:Pe.ZodObject,...Me(e)});class Ou extends Be{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function i(s){for(const a of s)if(a.result.status==="valid")return a.result;for(const a of s)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;const o=s.map(a=>new Oi(a.ctx.common.issues));return we(t,{code:se.invalid_union,unionErrors:o}),ke}if(t.common.async)return Promise.all(n.map(async s=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await s._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(i);{let s;const o=[];for(const c of n){const l={...t,common:{...t.common,issues:[]},parent:null},u=c._parseSync({data:t.data,path:t.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!s&&(s={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(s)return t.common.issues.push(...s.ctx.common.issues),s.result;const a=o.map(c=>new Oi(c));return we(t,{code:se.invalid_union,unionErrors:a}),ke}}get options(){return this._def.options}}Ou.create=(r,e)=>new Ou({options:r,typeName:Pe.ZodUnion,...Me(e)});const af=r=>r instanceof Mu?af(r.schema):r instanceof Di?af(r.innerType()):r instanceof Uu?[r.value]:r instanceof Co?r.options:r instanceof Bu?Object.keys(r.enum):r instanceof $u?af(r._def.innerType):r instanceof Pu?[void 0]:r instanceof Ru?[null]:null;class Ch extends Be{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==pe.object)return we(t,{code:se.invalid_type,expected:pe.object,received:t.parsedType}),ke;const n=this.discriminator,i=t.data[n],s=this.optionsMap.get(i);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(we(t,{code:se.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),ke)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const i=new Map;for(const s of t){const o=af(s.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(i.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);i.set(a,s)}}return new Ch({typeName:Pe.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...Me(n)})}}function Mg(r,e){const t=ho(r),n=ho(e);if(r===e)return{valid:!0,data:r};if(t===pe.object&&n===pe.object){const i=ot.objectKeys(e),s=ot.objectKeys(r).filter(a=>i.indexOf(a)!==-1),o={...r,...e};for(const a of s){const c=Mg(r[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(t===pe.array&&n===pe.array){if(r.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<r.length;s++){const o=r[s],a=e[s],c=Mg(o,a);if(!c.valid)return{valid:!1};i.push(c.data)}return{valid:!0,data:i}}else return t===pe.date&&n===pe.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}class ku extends Be{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=(s,o)=>{if(kg(s)||kg(o))return ke;const a=Mg(s.value,o.value);return a.valid?((Dg(s)||Dg(o))&&t.dirty(),{status:t.value,value:a.data}):(we(n,{code:se.invalid_intersection_types}),ke)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,o])=>i(s,o)):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}ku.create=(r,e,t)=>new ku({left:r,right:e,typeName:Pe.ZodIntersection,...Me(t)});class ls extends Be{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==pe.array)return we(n,{code:se.invalid_type,expected:pe.array,received:n.parsedType}),ke;if(n.data.length<this._def.items.length)return we(n,{code:se.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ke;!this._def.rest&&n.data.length>this._def.items.length&&(we(n,{code:se.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const s=[...n.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new cs(n,o,n.path,a)):null}).filter(o=>!!o);return n.common.async?Promise.all(s).then(o=>Qr.mergeArray(t,o)):Qr.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new ls({...this._def,rest:e})}}ls.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ls({items:r,typeName:Pe.ZodTuple,rest:null,...Me(e)})};class Du extends Be{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==pe.object)return we(n,{code:se.invalid_type,expected:pe.object,received:n.parsedType}),ke;const i=[],s=this._def.keyType,o=this._def.valueType;for(const a in n.data)i.push({key:s._parse(new cs(n,a,n.path,a)),value:o._parse(new cs(n,n.data[a],n.path,a))});return n.common.async?Qr.mergeObjectAsync(t,i):Qr.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof Be?new Du({keyType:e,valueType:t,typeName:Pe.ZodRecord,...Me(n)}):new Du({keyType:Ii.create(),valueType:e,typeName:Pe.ZodRecord,...Me(t)})}}class Wf extends Be{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==pe.map)return we(n,{code:se.invalid_type,expected:pe.map,received:n.parsedType}),ke;const i=this._def.keyType,s=this._def.valueType,o=[...n.data.entries()].map(([a,c],l)=>({key:i._parse(new cs(n,a,n.path,[l,"key"])),value:s._parse(new cs(n,c,n.path,[l,"value"]))}));if(n.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return ke;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(l.value,u.value)}return{status:t.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return ke;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(l.value,u.value)}return{status:t.value,value:a}}}}Wf.create=(r,e,t)=>new Wf({valueType:e,keyType:r,typeName:Pe.ZodMap,...Me(t)});class Aa extends Be{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==pe.set)return we(n,{code:se.invalid_type,expected:pe.set,received:n.parsedType}),ke;const i=this._def;i.minSize!==null&&n.data.size<i.minSize.value&&(we(n,{code:se.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),i.maxSize!==null&&n.data.size>i.maxSize.value&&(we(n,{code:se.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const s=this._def.valueType;function o(c){const l=new Set;for(const u of c){if(u.status==="aborted")return ke;u.status==="dirty"&&t.dirty(),l.add(u.value)}return{status:t.value,value:l}}const a=[...n.data.values()].map((c,l)=>s._parse(new cs(n,c,n.path,l)));return n.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,t){return new Aa({...this._def,minSize:{value:e,message:Ne.toString(t)}})}max(e,t){return new Aa({...this._def,maxSize:{value:e,message:Ne.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Aa.create=(r,e)=>new Aa({valueType:r,minSize:null,maxSize:null,typeName:Pe.ZodSet,...Me(e)});class Sc extends Be{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==pe.function)return we(t,{code:se.invalid_type,expected:pe.function,received:t.parsedType}),ke;function n(a,c){return Ff({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Lf(),Nu].filter(l=>!!l),issueData:{code:se.invalid_arguments,argumentsError:c}})}function i(a,c){return Ff({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Lf(),Nu].filter(l=>!!l),issueData:{code:se.invalid_return_type,returnTypeError:c}})}const s={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof Fc){const a=this;return dn(async function(...c){const l=new Oi([]),u=await a._def.args.parseAsync(c,s).catch(x=>{throw l.addIssue(n(c,x)),l}),d=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(d,s).catch(x=>{throw l.addIssue(i(d,x)),l})})}else{const a=this;return dn(function(...c){const l=a._def.args.safeParse(c,s);if(!l.success)throw new Oi([n(c,l.error)]);const u=Reflect.apply(o,this,l.data),d=a._def.returns.safeParse(u,s);if(!d.success)throw new Oi([i(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Sc({...this._def,args:ls.create(e).rest(ha.create())})}returns(e){return new Sc({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new Sc({args:e||ls.create([]).rest(ha.create()),returns:t||ha.create(),typeName:Pe.ZodFunction,...Me(n)})}}class Mu extends Be{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Mu.create=(r,e)=>new Mu({getter:r,typeName:Pe.ZodLazy,...Me(e)});class Uu extends Be{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return we(t,{received:t.data,code:se.invalid_literal,expected:this._def.value}),ke}return{status:"valid",value:e.data}}get value(){return this._def.value}}Uu.create=(r,e)=>new Uu({value:r,typeName:Pe.ZodLiteral,...Me(e)});function UA(r,e){return new Co({values:r,typeName:Pe.ZodEnum,...Me(e)})}class Co extends Be{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return we(t,{expected:ot.joinValues(n),received:t.parsedType,code:se.invalid_type}),ke}if(this._def.values.indexOf(e.data)===-1){const t=this._getOrReturnCtx(e),n=this._def.values;return we(t,{received:t.data,code:se.invalid_enum_value,options:n}),ke}return dn(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return Co.create(e)}exclude(e){return Co.create(this.options.filter(t=>!e.includes(t)))}}Co.create=UA;class Bu extends Be{_parse(e){const t=ot.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==pe.string&&n.parsedType!==pe.number){const i=ot.objectValues(t);return we(n,{expected:ot.joinValues(i),received:n.parsedType,code:se.invalid_type}),ke}if(t.indexOf(e.data)===-1){const i=ot.objectValues(t);return we(n,{received:n.data,code:se.invalid_enum_value,options:i}),ke}return dn(e.data)}get enum(){return this._def.values}}Bu.create=(r,e)=>new Bu({values:r,typeName:Pe.ZodNativeEnum,...Me(e)});class Fc extends Be{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==pe.promise&&t.common.async===!1)return we(t,{code:se.invalid_type,expected:pe.promise,received:t.parsedType}),ke;const n=t.parsedType===pe.promise?t.data:Promise.resolve(t.data);return dn(n.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Fc.create=(r,e)=>new Fc({type:r,typeName:Pe.ZodPromise,...Me(e)});class Di extends Be{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Pe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:o=>{we(n,o),o.fatal?t.abort():t.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const o=i.transform(n.data,s);return n.common.issues.length?{status:"dirty",value:n.data}:n.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:n.path,parent:n})):this._def.schema._parseSync({data:o,path:n.path,parent:n})}if(i.type==="refinement"){const o=a=>{const c=i.refinement(a,s);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?ke:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?ke:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(i.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Iu(o))return o;const a=i.transform(o.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>Iu(o)?Promise.resolve(i.transform(o.value,s)).then(a=>({status:t.value,value:a})):o);ot.assertNever(i)}}Di.create=(r,e,t)=>new Di({schema:r,typeName:Pe.ZodEffects,effect:e,...Me(t)});Di.createWithPreprocess=(r,e,t)=>new Di({schema:e,effect:{type:"preprocess",transform:r},typeName:Pe.ZodEffects,...Me(t)});class Ms extends Be{_parse(e){return this._getType(e)===pe.undefined?dn(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ms.create=(r,e)=>new Ms({innerType:r,typeName:Pe.ZodOptional,...Me(e)});class _a extends Be{_parse(e){return this._getType(e)===pe.null?dn(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}_a.create=(r,e)=>new _a({innerType:r,typeName:Pe.ZodNullable,...Me(e)});class $u extends Be{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===pe.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}$u.create=(r,e)=>new $u({innerType:r,typeName:Pe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Me(e)});class zf extends Be{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return jf(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Oi(n.common.issues)},input:n.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Oi(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}zf.create=(r,e)=>new zf({innerType:r,typeName:Pe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Me(e)});class Kf extends Be{_parse(e){if(this._getType(e)!==pe.nan){const n=this._getOrReturnCtx(e);return we(n,{code:se.invalid_type,expected:pe.nan,received:n.parsedType}),ke}return{status:"valid",value:e.data}}}Kf.create=r=>new Kf({typeName:Pe.ZodNaN,...Me(r)});const H$=Symbol("zod_brand");class BA extends Be{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class ud extends Be{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?ke:s.status==="dirty"?(t.dirty(),MA(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{const i=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?ke:i.status==="dirty"?(t.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:n.path,parent:n})}}static create(e,t){return new ud({in:e,out:t,typeName:Pe.ZodPipeline})}}class Vf extends Be{_parse(e){const t=this._def.innerType._parse(e);return Iu(t)&&(t.value=Object.freeze(t.value)),t}}Vf.create=(r,e)=>new Vf({innerType:r,typeName:Pe.ZodReadonly,...Me(e)});const $A=(r,e={},t)=>r?Lc.create().superRefine((n,i)=>{var s,o;if(!r(n)){const a=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,c=(o=(s=a.fatal)!==null&&s!==void 0?s:t)!==null&&o!==void 0?o:!0,l=typeof a=="string"?{message:a}:a;i.addIssue({code:"custom",...l,fatal:c})}}):Lc.create(),W$={object:rr.lazycreate};var Pe;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(Pe||(Pe={}));const z$=(r,e={message:`Input not instance of ${r.name}`})=>$A(t=>t instanceof r,e),LA=Ii.create,FA=Ao.create,K$=Kf.create,V$=_o.create,jA=Tu.create,G$=Ea.create,Y$=qf.create,J$=Pu.create,Z$=Ru.create,X$=Lc.create,Q$=ha.create,eL=Fs.create,tL=Hf.create,rL=ki.create,nL=rr.create,iL=rr.strictCreate,sL=Ou.create,oL=Ch.create,aL=ku.create,cL=ls.create,lL=Du.create,uL=Wf.create,dL=Aa.create,fL=Sc.create,hL=Mu.create,pL=Uu.create,gL=Co.create,mL=Bu.create,bL=Fc.create,Hw=Di.create,yL=Ms.create,wL=_a.create,xL=Di.createWithPreprocess,vL=ud.create,EL=()=>LA().optional(),AL=()=>FA().optional(),_L=()=>jA().optional(),CL={string:(r=>Ii.create({...r,coerce:!0})),number:(r=>Ao.create({...r,coerce:!0})),boolean:(r=>Tu.create({...r,coerce:!0})),bigint:(r=>_o.create({...r,coerce:!0})),date:(r=>Ea.create({...r,coerce:!0}))},SL=ke;var D=Object.freeze({__proto__:null,defaultErrorMap:Nu,setErrorMap:P$,getErrorMap:Lf,makeIssue:Ff,EMPTY_PATH:R$,addIssueToContext:we,ParseStatus:Qr,INVALID:ke,DIRTY:MA,OK:dn,isAborted:kg,isDirty:Dg,isValid:Iu,isAsync:jf,get util(){return ot},get objectUtil(){return Og},ZodParsedType:pe,getParsedType:ho,ZodType:Be,ZodString:Ii,ZodNumber:Ao,ZodBigInt:_o,ZodBoolean:Tu,ZodDate:Ea,ZodSymbol:qf,ZodUndefined:Pu,ZodNull:Ru,ZodAny:Lc,ZodUnknown:ha,ZodNever:Fs,ZodVoid:Hf,ZodArray:ki,ZodObject:rr,ZodUnion:Ou,ZodDiscriminatedUnion:Ch,ZodIntersection:ku,ZodTuple:ls,ZodRecord:Du,ZodMap:Wf,ZodSet:Aa,ZodFunction:Sc,ZodLazy:Mu,ZodLiteral:Uu,ZodEnum:Co,ZodNativeEnum:Bu,ZodPromise:Fc,ZodEffects:Di,ZodTransformer:Di,ZodOptional:Ms,ZodNullable:_a,ZodDefault:$u,ZodCatch:zf,ZodNaN:Kf,BRAND:H$,ZodBranded:BA,ZodPipeline:ud,ZodReadonly:Vf,custom:$A,Schema:Be,ZodSchema:Be,late:W$,get ZodFirstPartyTypeKind(){return Pe},coerce:CL,any:X$,array:rL,bigint:V$,boolean:jA,date:G$,discriminatedUnion:oL,effect:Hw,enum:gL,function:fL,instanceof:z$,intersection:aL,lazy:hL,literal:pL,map:uL,nan:K$,nativeEnum:mL,never:eL,null:Z$,nullable:wL,number:FA,object:nL,oboolean:_L,onumber:AL,optional:yL,ostring:EL,pipeline:vL,preprocess:xL,promise:bL,record:lL,set:dL,strictObject:iL,string:LA,symbol:Y$,transformer:Hw,tuple:cL,undefined:J$,union:sL,unknown:Q$,void:tL,NEVER:SL,ZodIssueCode:se,quotelessJson:T$,ZodError:Oi});const ir=D.object({message:D.string()});function ge(r){return D.literal(xe[r])}const Sh=D.object({serializedMessage:D.string().optional(),accountAddress:D.string(),chainId:D.string(),notBefore:D.string().optional(),domain:D.string(),uri:D.string(),version:D.string(),nonce:D.string(),statement:D.string().optional(),resources:D.array(D.string()).optional(),requestId:D.string().optional(),issuedAt:D.string().optional(),expirationTime:D.string().optional()});D.object({accessList:D.array(D.string()),blockHash:D.string().nullable(),blockNumber:D.string().nullable(),chainId:D.string().or(D.number()),from:D.string(),gas:D.string(),hash:D.string(),input:D.string().nullable(),maxFeePerGas:D.string(),maxPriorityFeePerGas:D.string(),nonce:D.string(),r:D.string(),s:D.string(),to:D.string(),transactionIndex:D.string().nullable(),type:D.string(),v:D.string(),value:D.string()});const NL=D.object({chainId:D.string().or(D.number()),rpcUrl:D.optional(D.string())}),IL=D.object({email:D.string().email()}),TL=D.object({otp:D.string()}),PL=D.object({uri:D.string(),preferredAccountType:D.optional(D.string()),chainId:D.optional(D.string().or(D.number())),siwxMessage:D.optional(Sh),rpcUrl:D.optional(D.string())}),RL=D.object({chainId:D.optional(D.string().or(D.number())),preferredAccountType:D.optional(D.string()),socialUri:D.optional(D.string()),siwxMessage:D.optional(Sh),rpcUrl:D.optional(D.string())}),OL=D.object({provider:D.enum(["google","github","apple","facebook","x","discord"])}),kL=D.object({email:D.string().email()}),DL=D.object({otp:D.string()}),ML=D.object({otp:D.string()}),UL=D.object({themeMode:D.optional(D.enum(["light","dark"])),themeVariables:D.optional(D.record(D.string(),D.string().or(D.number()))),w3mThemeVariables:D.optional(D.record(D.string(),D.string()))}),BL=D.object({metadata:D.object({name:D.string(),description:D.string(),url:D.string(),icons:D.array(D.string())}).optional(),sdkVersion:D.string().optional(),sdkType:D.string().optional(),projectId:D.string()}),$L=D.object({type:D.string()}),LL=D.object({action:D.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),FL=D.object({url:D.string()}),jL=D.object({userName:D.string()}),qL=D.object({email:D.string().optional().nullable(),address:D.string(),chainId:D.string().or(D.number()),accounts:D.array(D.object({address:D.string(),type:D.enum([_r.ACCOUNT_TYPES.EOA,_r.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:D.string().optional().nullable(),preferredAccountType:D.optional(D.string()),signature:D.string().optional(),message:D.string().optional(),siwxMessage:D.optional(Sh)}),HL=D.object({action:D.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),WL=D.object({email:D.string().email().optional().nullable(),address:D.string(),chainId:D.string().or(D.number()),smartAccountDeployed:D.optional(D.boolean()),accounts:D.array(D.object({address:D.string(),type:D.enum([_r.ACCOUNT_TYPES.EOA,_r.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:D.optional(D.string()),signature:D.string().optional(),message:D.string().optional(),siwxMessage:D.optional(Sh)}),zL=D.object({uri:D.string()}),KL=D.object({isConnected:D.boolean()}),VL=D.object({chainId:D.string().or(D.number())}),GL=D.object({chainId:D.string().or(D.number())}),YL=D.object({newEmail:D.string().email()}),JL=D.object({smartAccountEnabledNetworks:D.array(D.number())});D.object({address:D.string(),isDeployed:D.boolean()});const ZL=D.object({version:D.string().optional()}),XL=D.object({type:D.string(),address:D.string()}),QL=D.any(),eF=D.object({method:D.literal("eth_accounts")}),tF=D.object({method:D.literal("eth_blockNumber")}),rF=D.object({method:D.literal("eth_call"),params:D.array(D.any())}),nF=D.object({method:D.literal("eth_chainId")}),iF=D.object({method:D.literal("eth_estimateGas"),params:D.array(D.any())}),sF=D.object({method:D.literal("eth_feeHistory"),params:D.array(D.any())}),oF=D.object({method:D.literal("eth_gasPrice")}),aF=D.object({method:D.literal("eth_getAccount"),params:D.array(D.any())}),cF=D.object({method:D.literal("eth_getBalance"),params:D.array(D.any())}),lF=D.object({method:D.literal("eth_getBlockByHash"),params:D.array(D.any())}),uF=D.object({method:D.literal("eth_getBlockByNumber"),params:D.array(D.any())}),dF=D.object({method:D.literal("eth_getBlockReceipts"),params:D.array(D.any())}),fF=D.object({method:D.literal("eth_getBlockTransactionCountByHash"),params:D.array(D.any())}),hF=D.object({method:D.literal("eth_getBlockTransactionCountByNumber"),params:D.array(D.any())}),pF=D.object({method:D.literal("eth_getCode"),params:D.array(D.any())}),gF=D.object({method:D.literal("eth_getFilterChanges"),params:D.array(D.any())}),mF=D.object({method:D.literal("eth_getFilterLogs"),params:D.array(D.any())}),bF=D.object({method:D.literal("eth_getLogs"),params:D.array(D.any())}),yF=D.object({method:D.literal("eth_getProof"),params:D.array(D.any())}),wF=D.object({method:D.literal("eth_getStorageAt"),params:D.array(D.any())}),xF=D.object({method:D.literal("eth_getTransactionByBlockHashAndIndex"),params:D.array(D.any())}),vF=D.object({method:D.literal("eth_getTransactionByBlockNumberAndIndex"),params:D.array(D.any())}),EF=D.object({method:D.literal("eth_getTransactionByHash"),params:D.array(D.any())}),AF=D.object({method:D.literal("eth_getTransactionCount"),params:D.array(D.any())}),_F=D.object({method:D.literal("eth_getTransactionReceipt"),params:D.array(D.any())}),CF=D.object({method:D.literal("eth_getUncleCountByBlockHash"),params:D.array(D.any())}),SF=D.object({method:D.literal("eth_getUncleCountByBlockNumber"),params:D.array(D.any())}),NF=D.object({method:D.literal("eth_maxPriorityFeePerGas")}),IF=D.object({method:D.literal("eth_newBlockFilter")}),TF=D.object({method:D.literal("eth_newFilter"),params:D.array(D.any())}),PF=D.object({method:D.literal("eth_newPendingTransactionFilter")}),RF=D.object({method:D.literal("eth_sendRawTransaction"),params:D.array(D.any())}),OF=D.object({method:D.literal("eth_syncing"),params:D.array(D.any())}),kF=D.object({method:D.literal("eth_uninstallFilter"),params:D.array(D.any())}),Ww=D.object({method:D.literal("personal_sign"),params:D.array(D.any())}),DF=D.object({method:D.literal("eth_signTypedData_v4"),params:D.array(D.any())}),MF=D.object({method:D.literal("eth_sendTransaction"),params:D.array(D.any())}),UF=D.object({method:D.literal("solana_signMessage"),params:D.object({message:D.string(),pubkey:D.string()})}),BF=D.object({method:D.literal("solana_signTransaction"),params:D.object({transaction:D.string()})}),$F=D.object({method:D.literal("solana_signAllTransactions"),params:D.object({transactions:D.array(D.string())})}),LF=D.object({method:D.literal("solana_signAndSendTransaction"),params:D.object({transaction:D.string(),options:D.object({skipPreflight:D.boolean().optional(),preflightCommitment:D.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:D.number().optional(),minContextSlot:D.number().optional()}).optional()})}),FF=D.object({method:D.literal("wallet_sendCalls"),params:D.array(D.object({chainId:D.string().or(D.number()).optional(),from:D.string().optional(),version:D.string().optional(),capabilities:D.any().optional(),calls:D.array(D.object({to:D.string().startsWith("0x"),data:D.string().startsWith("0x").optional(),value:D.string().optional()}))}))}),jF=D.object({method:D.literal("wallet_getCallsStatus"),params:D.array(D.string())}),qF=D.object({method:D.literal("wallet_getCapabilities"),params:D.array(D.string().or(D.number()).optional()).optional()}),HF=D.object({method:D.literal("wallet_grantPermissions"),params:D.array(D.any())}),WF=D.object({method:D.literal("wallet_revokePermissions"),params:D.any()}),zF=D.object({method:D.literal("wallet_getAssets"),params:D.any()}),zw=D.object({token:D.string()}),me=D.object({id:D.string().optional()}),ip={appEvent:me.extend({type:ge("APP_SWITCH_NETWORK"),payload:NL}).or(me.extend({type:ge("APP_CONNECT_EMAIL"),payload:IL})).or(me.extend({type:ge("APP_CONNECT_DEVICE")})).or(me.extend({type:ge("APP_CONNECT_OTP"),payload:TL})).or(me.extend({type:ge("APP_CONNECT_SOCIAL"),payload:PL})).or(me.extend({type:ge("APP_GET_FARCASTER_URI")})).or(me.extend({type:ge("APP_CONNECT_FARCASTER")})).or(me.extend({type:ge("APP_GET_USER"),payload:D.optional(RL)})).or(me.extend({type:ge("APP_GET_SOCIAL_REDIRECT_URI"),payload:OL})).or(me.extend({type:ge("APP_SIGN_OUT")})).or(me.extend({type:ge("APP_IS_CONNECTED"),payload:D.optional(zw)})).or(me.extend({type:ge("APP_GET_CHAIN_ID")})).or(me.extend({type:ge("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(me.extend({type:ge("APP_INIT_SMART_ACCOUNT")})).or(me.extend({type:ge("APP_SET_PREFERRED_ACCOUNT"),payload:$L})).or(me.extend({type:ge("APP_RPC_REQUEST"),payload:Ww.or(zF).or(eF).or(tF).or(rF).or(nF).or(iF).or(sF).or(oF).or(aF).or(cF).or(lF).or(uF).or(dF).or(fF).or(hF).or(pF).or(gF).or(mF).or(bF).or(yF).or(wF).or(xF).or(vF).or(EF).or(AF).or(_F).or(CF).or(SF).or(NF).or(IF).or(TF).or(PF).or(RF).or(OF).or(kF).or(Ww).or(DF).or(MF).or(UF).or(BF).or($F).or(LF).or(jF).or(FF).or(qF).or(HF).or(WF).and(D.object({chainId:D.string().or(D.number()).optional(),chainNamespace:D.enum(["eip155","solana","polkadot","bip122","cosmos"]).optional(),rpcUrl:D.string().optional()}))})).or(me.extend({type:ge("APP_UPDATE_EMAIL"),payload:kL})).or(me.extend({type:ge("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:DL})).or(me.extend({type:ge("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:ML})).or(me.extend({type:ge("APP_SYNC_THEME"),payload:UL})).or(me.extend({type:ge("APP_SYNC_DAPP_DATA"),payload:BL})).or(me.extend({type:ge("APP_RELOAD")})).or(me.extend({type:ge("APP_RPC_ABORT")})),frameEvent:me.extend({type:ge("FRAME_SWITCH_NETWORK_ERROR"),payload:ir}).or(me.extend({type:ge("FRAME_SWITCH_NETWORK_SUCCESS"),payload:GL})).or(me.extend({type:ge("FRAME_CONNECT_EMAIL_SUCCESS"),payload:LL})).or(me.extend({type:ge("FRAME_CONNECT_EMAIL_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:FL})).or(me.extend({type:ge("FRAME_GET_FARCASTER_URI_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:jL})).or(me.extend({type:ge("FRAME_CONNECT_FARCASTER_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_CONNECT_OTP_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_CONNECT_OTP_SUCCESS")})).or(me.extend({type:ge("FRAME_CONNECT_DEVICE_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_CONNECT_DEVICE_SUCCESS")})).or(me.extend({type:ge("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:qL})).or(me.extend({type:ge("FRAME_CONNECT_SOCIAL_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_GET_USER_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_GET_USER_SUCCESS"),payload:WL})).or(me.extend({type:ge("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:zL})).or(me.extend({type:ge("FRAME_SIGN_OUT_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_SIGN_OUT_SUCCESS")})).or(me.extend({type:ge("FRAME_IS_CONNECTED_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_IS_CONNECTED_SUCCESS"),payload:KL})).or(me.extend({type:ge("FRAME_GET_CHAIN_ID_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_GET_CHAIN_ID_SUCCESS"),payload:VL})).or(me.extend({type:ge("FRAME_RPC_REQUEST_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_RPC_REQUEST_SUCCESS"),payload:QL})).or(me.extend({type:ge("FRAME_SESSION_UPDATE"),payload:zw})).or(me.extend({type:ge("FRAME_UPDATE_EMAIL_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_UPDATE_EMAIL_SUCCESS"),payload:HL})).or(me.extend({type:ge("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(me.extend({type:ge("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:YL})).or(me.extend({type:ge("FRAME_SYNC_THEME_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_SYNC_THEME_SUCCESS")})).or(me.extend({type:ge("FRAME_SYNC_DAPP_DATA_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(me.extend({type:ge("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:JL})).or(me.extend({type:ge("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:XL})).or(me.extend({type:ge("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_READY"),payload:ZL})).or(me.extend({type:ge("FRAME_RELOAD_ERROR"),payload:ir})).or(me.extend({type:ge("FRAME_RELOAD_SUCCESS")}))};function sp(r,e={}){return typeof e?.type=="string"&&e?.type?.includes(r)}function KF({projectId:r,chainId:e,enableLogger:t,rpcUrl:n=Y.BLOCKCHAIN_API_RPC_URL,enableCloudAuthAccount:i=!1}){const s=new URL(ZC);return s.searchParams.set("projectId",r),s.searchParams.set("chainId",String(e)),s.searchParams.set("version",QC),s.searchParams.set("enableLogger",String(t)),s.searchParams.set("rpcUrl",n),i&&s.searchParams.set("enableCloudAuthAccount","true"),s.toString()}class VF{constructor({projectId:e,isAppClient:t=!1,chainId:n="eip155:1",enableLogger:i=!0,enableCloudAuthAccount:s=!1,rpcUrl:o=Y.BLOCKCHAIN_API_RPC_URL}){if(this.iframe=null,this.iframeIsReady=!1,this.initFrame=()=>{const a=document.getElementById("w3m-iframe");this.iframe&&!a&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(a,c,l)=>{function u({data:d}){if(!sp(xe.FRAME_EVENT_KEY,d))return;const p=ip.frameEvent.safeParse(d);if(!p.success){console.warn("W3mFrame: invalid frame event",p.error.message);return}p.data?.id===a&&(c(p.data),window.removeEventListener("message",u))}Fn.isClient&&(window.addEventListener("message",u),l.addEventListener("abort",()=>{window.removeEventListener("message",u)}))},onFrameEvent:a=>{Fn.isClient&&window.addEventListener("message",({data:c})=>{if(!sp(xe.FRAME_EVENT_KEY,c))return;const l=ip.frameEvent.safeParse(c);l.success?a(l.data):console.warn("W3mFrame: invalid frame event",l.error.message)})},onAppEvent:a=>{Fn.isClient&&window.addEventListener("message",({data:c})=>{if(!sp(xe.APP_EVENT_KEY,c))return;const l=ip.appEvent.safeParse(c);l.success||console.warn("W3mFrame: invalid app event",l.error.message),a(c)})},postAppEvent:a=>{if(Fn.isClient){if(!this.iframe?.contentWindow)throw new Error("W3mFrame: iframe is not set");this.iframe.contentWindow.postMessage(a,"*")}},postFrameEvent:a=>{if(Fn.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");parent.postMessage(a,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),this.rpcUrl=o,t&&(this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),Fn.isClient)){const a=document.createElement("iframe");a.id="w3m-iframe",a.src=KF({projectId:e,chainId:n,enableLogger:i,rpcUrl:this.rpcUrl,enableCloudAuthAccount:s}),a.name="w3m-secure-iframe",a.style.position="fixed",a.style.zIndex="999999",a.style.display="none",a.style.border="none",a.style.animationDelay="0s, 50ms",a.style.borderBottomLeftRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",a.style.borderBottomRightRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",this.iframe=a,this.iframe.onerror=()=>{this.frameLoadPromiseResolver?.reject("Unable to load email login dependency")},this.events.onFrameEvent(c=>{c.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,this.frameLoadPromiseResolver?.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(t=>({[t]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${t}&projectId=${this.projectId}`,chainId:t}}));return Object.assign({},...e)}}class GF{constructor(e){const t=Kc({level:XC}),{logger:n,chunkLoggerController:i}=am({opts:t});this.logger=tn(n,this.constructor.name),this.chunkLoggerController=i,typeof window<"u"&&this.chunkLoggerController?.downloadLogsBlobInBrowser&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{this.chunkLoggerController?.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class YF{constructor({projectId:e,chainId:t,enableLogger:n=!0,onTimeout:i,abortController:s,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:c}){this.openRpcRequests=new Map,this.isInitialized=!1,n&&(this.w3mLogger=new GF(e)),this.abortController=s,this.getActiveCaipNetwork=o,this.getCaipNetworks=a;const l=this.getRpcUrl(t);this.w3mFrame=new VF({projectId:e,isAppClient:!0,chainId:t,enableLogger:n,rpcUrl:l,enableCloudAuthAccount:c}),this.onTimeout=i,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(t=>{t.type===xe.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!Mr.get(xe.EMAIL_LOGIN_USED_KEY)}getEmail(){return Mr.get(xe.EMAIL)}getUsername(){return Mr.get(xe.SOCIAL_USERNAME)}async reload(){try{await this.appEvent({type:xe.APP_RELOAD})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error reloading iframe"),e}}async connectEmail(e){try{Fn.checkIfAllowedToTriggerEmail(),await this.init();const t=await this.appEvent({type:xe.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),t}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error connecting email"),t}}async connectDevice(){try{return this.appEvent({type:xe.APP_CONNECT_DEVICE})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting device"),e}}async connectOtp(e){try{return this.appEvent({type:xe.APP_CONNECT_OTP,payload:e})}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error connecting otp"),t}}async isConnected(){try{if(!this.getLoginEmailUsed())return{isConnected:!1};const e=await this.appEvent({type:xe.APP_IS_CONNECTED});return e?.isConnected||this.deleteAuthLoginCache(),e}catch(e){throw this.deleteAuthLoginCache(),this.w3mLogger?.logger.error({error:e},"Error checking connection"),e}}async getChainId(){try{const e=await this.appEvent({type:xe.APP_GET_CHAIN_ID});return this.setLastUsedChainId(e.chainId),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting chain id"),e}}async getSocialRedirectUri(e){try{return await this.init(),this.appEvent({type:xe.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error getting social redirect uri"),t}}async updateEmail(e){try{const t=await this.appEvent({type:xe.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),t}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error updating email"),t}}async updateEmailPrimaryOtp(e){try{return this.appEvent({type:xe.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error updating email primary otp"),t}}async updateEmailSecondaryOtp(e){try{const t=await this.appEvent({type:xe.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(t.newEmail),t}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error updating email secondary otp"),t}}async syncTheme(e){try{return this.appEvent({type:xe.APP_SYNC_THEME,payload:e})}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error syncing theme"),t}}async syncDappData(e){try{return this.appEvent({type:xe.APP_SYNC_DAPP_DATA,payload:e})}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error syncing dapp data"),t}}async getSmartAccountEnabledNetworks(){try{const e=await this.appEvent({type:xe.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(e.smartAccountEnabledNetworks),e}catch(e){throw this.persistSmartAccountEnabledNetworks([]),this.w3mLogger?.logger.error({error:e},"Error getting smart account enabled networks"),e}}async setPreferredAccount(e){try{return this.appEvent({type:xe.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error setting preferred account"),t}}async connect(e){if(e?.socialUri)try{await this.init();const t=this.getRpcUrl(e.chainId),n=await this.appEvent({type:xe.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType,chainId:e.chainId,siwxMessage:e.siwxMessage,rpcUrl:t}});return n.userName&&this.setSocialLoginSuccess(n.userName),this.setLoginSuccess(n.email),this.setLastUsedChainId(n.chainId),this.user=n,n}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error connecting social"),t}else try{const t=e?.chainId||this.getLastUsedChainId()||1,n=await this.getUser({chainId:t,preferredAccountType:e?.preferredAccountType,siwxMessage:e?.siwxMessage,rpcUrl:this.getRpcUrl(t)});return this.setLoginSuccess(n.email),this.setLastUsedChainId(n.chainId),this.user=n,n}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error connecting"),t}}async getUser(e){try{await this.init();const t=e?.chainId||this.getLastUsedChainId()||1,n=await this.appEvent({type:xe.APP_GET_USER,payload:{...e,chainId:t,rpcUrl:this.getRpcUrl(t)}});return this.user=n,n}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error connecting"),t}}async connectSocial({uri:e,chainId:t,preferredAccountType:n}){try{await this.init();const i=this.getRpcUrl(t),s=await this.appEvent({type:xe.APP_CONNECT_SOCIAL,payload:{uri:e,chainId:t,rpcUrl:i,preferredAccountType:n}});return s.userName&&this.setSocialLoginSuccess(s.userName),s}catch(i){throw this.w3mLogger?.logger.error({error:i},"Error connecting social"),i}}async getFarcasterUri(){try{return await this.init(),await this.appEvent({type:xe.APP_GET_FARCASTER_URI})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting farcaster uri"),e}}async connectFarcaster(){try{const e=await this.appEvent({type:xe.APP_CONNECT_FARCASTER});return e.userName&&this.setSocialLoginSuccess(e.userName),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting farcaster"),e}}async switchNetwork({chainId:e}){try{const t=this.getRpcUrl(e),n=await this.appEvent({type:xe.APP_SWITCH_NETWORK,payload:{chainId:e,rpcUrl:t}});return this.setLastUsedChainId(n.chainId),n}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error switching network"),t}}async disconnect(){try{return this.deleteAuthLoginCache(),await new Promise(async t=>{const n=setTimeout(()=>{t()},3e3);await this.appEvent({type:xe.APP_SIGN_OUT}),clearTimeout(n),t()})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error disconnecting"),e}}async request(e){const t=e;try{if(_r.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();const n=e.chainNamespace||"eip155",i=this.getActiveCaipNetwork(n)?.id;t.chainNamespace=n,t.chainId=i,t.rpcUrl=this.getRpcUrl(i),this.rpcRequestHandler?.(e);const s=await this.appEvent({type:xe.APP_RPC_REQUEST,payload:t});return this.rpcSuccessHandler?.(s,t),s}catch(n){throw this.rpcErrorHandler?.(n,t),this.w3mLogger?.logger.error({error:n},"Error requesting"),n}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===xe.FRAME_IS_CONNECTED_SUCCESS&&t.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===xe.FRAME_IS_CONNECTED_ERROR&&e(),t.type===xe.FRAME_IS_CONNECTED_SUCCESS&&!t.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===xe.FRAME_GET_USER_SUCCESS&&e(t.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===xe.FRAME_CONNECT_SOCIAL_SUCCESS&&e(t.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===xe.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(t.payload):t.type===xe.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:_r.ACCOUNT_TYPES.EOA})})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}async rejectRpcRequests(){try{await Promise.all(Array.from(this.openRpcRequests.values()).map(async({abortController:e,method:t})=>{_r.SAFE_RPC_METHODS.includes(t)||e.abort(),await this.appEvent({type:xe.APP_RPC_ABORT})})),this.openRpcRequests.clear()}catch(e){this.w3mLogger?.logger.error({error:e},"Error aborting RPC request")}}async appEvent(e){let t,n;function i(c){return c.replace("@w3m-app/","")}const s=[xe.APP_SYNC_DAPP_DATA,xe.APP_SYNC_THEME,xe.APP_SET_PREFERRED_ACCOUNT],o=i(e.type);return!this.w3mFrame.iframeIsReady&&!s.includes(e.type)&&(n=setTimeout(()=>{this.onTimeout?.("iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(n),[xe.APP_CONNECT_EMAIL,xe.APP_CONNECT_DEVICE,xe.APP_CONNECT_OTP,xe.APP_CONNECT_SOCIAL,xe.APP_GET_SOCIAL_REDIRECT_URI].map(i).includes(o)&&(t=setTimeout(()=>{this.onTimeout?.("iframe_request_timeout"),this.abortController.abort()},12e4)),new Promise((c,l)=>{const u=Math.random().toString(36).substring(7);this.w3mLogger?.logger.info?.({event:e,id:u},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:u});const d=new AbortController;if(o==="RPC_REQUEST"){const x=e;this.openRpcRequests.set(u,{...x.payload,abortController:d})}d.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?l(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&l(new Error("Something went wrong"))});const p=(x,w)=>{x.id===u&&(w?.logger.info?.({framEvent:x,id:u},"Received frame response"),this.openRpcRequests.delete(x.id),x.type===`@w3m-frame/${o}_SUCCESS`?(t&&clearTimeout(t),n&&clearTimeout(n),"payload"in x&&c(x.payload),c(void 0)):x.type===`@w3m-frame/${o}_ERROR`&&(t&&clearTimeout(t),n&&clearTimeout(n),"payload"in x&&l(new Error(x.payload?.message||"An error occurred")),l(new Error("An error occurred"))))};this.w3mFrame.events.registerFrameEventHandler(u,x=>p(x,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){Mr.set(xe.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){Mr.set(xe.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&Mr.set(xe.EMAIL,e),Mr.set(xe.EMAIL_LOGIN_USED_KEY,"true"),Mr.delete(xe.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){Mr.delete(xe.EMAIL_LOGIN_USED_KEY),Mr.delete(xe.EMAIL),Mr.delete(xe.LAST_USED_CHAIN_KEY),Mr.delete(xe.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&Mr.set(xe.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=Mr.get(xe.LAST_USED_CHAIN_KEY)??void 0,t=Number(e);return isNaN(t)?e:t}persistSmartAccountEnabledNetworks(e){Mr.set(xe.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}getRpcUrl(e){let t=e===void 0?void 0:"eip155";typeof e=="string"&&(e.includes(":")?t=on.parseCaipNetworkId(e)?.chainNamespace:Number.isInteger(Number(e))?t="eip155":t="solana");const n=this.getCaipNetworks(t);return(e?n.find(s=>String(s.id)===String(e)||s.caipNetworkId===e):n[0])?.rpcUrls.default.http?.[0]}}class Hl{constructor(){}static getInstance({projectId:e,chainId:t,enableLogger:n,onTimeout:i,abortController:s,getActiveCaipNetwork:o,getCaipNetworks:a}){return Hl.instance||(Hl.instance=new YF({projectId:e,chainId:t,enableLogger:n,onTimeout:i,abortController:s,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:!!Z.state.remoteFeatures?.emailCapture})),Hl.instance}}var Kw={};const JF={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof process<"u"&&typeof Kw<"u"?Kw.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120},VIEWS_WITH_LEGAL_FOOTER:["Connect","ConnectWallets","OnRampTokenSelect","OnRampFiatSelect","OnRampProviders"],VIEWS_WITH_DEFAULT_FOOTER:["Networks"]},Ug={filterOutDuplicatesByRDNS(r){const e=Z.state.enableEIP6963?ae.state.connectors:[],t=Q.getRecentWallets(),n=e.map(a=>a.info?.rdns).filter(Boolean),i=t.map(a=>a.rdns).filter(Boolean),s=n.concat(i);if(s.includes("io.metamask.mobile")&&be.isMobile()){const a=s.indexOf("io.metamask.mobile");s[a]="io.metamask"}return r.filter(a=>!(a?.rdns&&s.includes(String(a.rdns))||!a?.rdns&&e.some(l=>l.name===a.name)))},filterOutDuplicatesByIds(r){const e=ae.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),t=Q.getRecentWallets(),n=e.map(a=>a.explorerId),i=t.map(a=>a.id),s=n.concat(i);return r.filter(a=>!s.includes(a?.id))},filterOutDuplicateWallets(r){const e=this.filterOutDuplicatesByRDNS(r);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(r){const{connectors:e}=ae.state,{featuredWalletIds:t}=Z.state,n=e.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>(a.info?.rdns&&(o[a.info.rdns]=!0),o),{});return r.map(o=>({...o,installed:!!o.rdns&&!!n[o.rdns??""]})).sort((o,a)=>{const c=Number(a.installed)-Number(o.installed);if(c!==0)return c;if(t?.length){const l=t.indexOf(o.id),u=t.indexOf(a.id);if(l!==-1&&u!==-1)return l-u;if(l!==-1)return-1;if(u!==-1)return 1}return 0})},getConnectOrderMethod(r,e){const t=r?.connectMethodsOrder||Z.state.features?.connectMethodsOrder,n=e||ae.state.connectors;if(t)return t;const{injected:i,announced:s}=cf.getConnectorsByType(n,_e.state.recommended,_e.state.featured),o=i.filter(cf.showConnector),a=s.filter(cf.showConnector);return o.length||a.length?["wallet","email","social"]:JF.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(r){const e=!!r.rdns&&_e.state.excludedWallets.some(n=>n.rdns===r.rdns),t=!!r.name&&_e.state.excludedWallets.some(n=>Ar.isLowerCaseMatch(n.name,r.name));return e||t},markWalletsWithDisplayIndex(r){return r.map((e,t)=>({...e,display_index:t}))}},cf={getConnectorsByType(r,e,t){const{customWallets:n}=Z.state,i=Q.getRecentWallets(),s=Ug.filterOutDuplicateWallets(e),o=Ug.filterOutDuplicateWallets(t),a=r.filter(d=>d.type==="MULTI_CHAIN"),c=r.filter(d=>d.type==="ANNOUNCED"),l=r.filter(d=>d.type==="INJECTED"),u=r.filter(d=>d.type==="EXTERNAL");return{custom:n,recent:i,external:u,multiChain:a,announced:c,injected:l,recommended:s,featured:o}},showConnector(r){const e=r.info?.rdns,t=!!e&&_e.state.excludedWallets.some(i=>!!i.rdns&&i.rdns===e),n=!!r.name&&_e.state.excludedWallets.some(i=>Ar.isLowerCaseMatch(i.name,r.name));return!(r.type==="INJECTED"&&(r.name==="Browser Wallet"&&(!be.isMobile()||be.isMobile()&&!e&&!de.checkInstalled())||t||n)||(r.type==="ANNOUNCED"||r.type==="EXTERNAL")&&(t||n))},getIsConnectedWithWC(){return Array.from($.state.chains.values()).some(t=>ae.getConnectorId(t.namespace)===Y.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:r,featured:e,custom:t,recent:n,announced:i,injected:s,multiChain:o,external:a,overriddenConnectors:c=Z.state.features?.connectorTypeOrder??[]}){const d=[{type:"walletConnect",isEnabled:Z.state.enableWalletConnect},{type:"recent",isEnabled:n.length>0},{type:"injected",isEnabled:[...s,...i,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:t&&t.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:r.length>0}].filter(b=>b.isEnabled),p=new Set(d.map(b=>b.type)),x=c.filter(b=>p.has(b)).map(b=>({type:b,isEnabled:!0})),w=d.filter(({type:b})=>!x.some(({type:C})=>C===b));return Array.from(new Set([...x,...w].map(({type:b})=>b)))},getAuthName({email:r,socialUsername:e,socialProvider:t}){return e?t&&t==="discord"&&e.endsWith("0")?e.slice(0,-1):e:r.length>30?`${r.slice(0,-3)}...`:r},async fetchProviderData(r){try{if(r.name==="Browser Wallet"&&!be.isMobile())return{accounts:[],chainId:void 0};if(r.id===Y.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[e,t]=await Promise.all([r.provider?.request({method:"eth_accounts"}),r.provider?.request({method:"eth_chainId"}).then(n=>Number(n))]);return{accounts:e,chainId:t}}catch(e){return console.warn(`Failed to fetch provider data for ${r.name}`,e),{accounts:[],chainId:void 0}}}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const lf=globalThis,Bm=lf.ShadowRoot&&(lf.ShadyCSS===void 0||lf.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,$m=Symbol(),Vw=new WeakMap;let qA=class{constructor(e,t,n){if(this._$cssResult$=!0,n!==$m)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(Bm&&e===void 0){const n=t!==void 0&&t.length===1;n&&(e=Vw.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&Vw.set(t,e))}return e}toString(){return this.cssText}};const xi=r=>new qA(typeof r=="string"?r:r+"",void 0,$m),po=(r,...e)=>{const t=r.length===1?r[0]:e.reduce(((n,i,s)=>n+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+r[s+1]),r[0]);return new qA(t,r,$m)},ZF=(r,e)=>{if(Bm)r.adoptedStyleSheets=e.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet));else for(const t of e){const n=document.createElement("style"),i=lf.litNonce;i!==void 0&&n.setAttribute("nonce",i),n.textContent=t.cssText,r.appendChild(n)}},Gw=Bm?r=>r:r=>r instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return xi(t)})(r):r;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:XF,defineProperty:QF,getOwnPropertyDescriptor:ej,getOwnPropertyNames:tj,getOwnPropertySymbols:rj,getPrototypeOf:nj}=Object,Nh=globalThis,Yw=Nh.trustedTypes,ij=Yw?Yw.emptyScript:"",sj=Nh.reactiveElementPolyfillSupport,Wl=(r,e)=>r,Bg={toAttribute(r,e){switch(e){case Boolean:r=r?ij:null;break;case Object:case Array:r=r==null?r:JSON.stringify(r)}return r},fromAttribute(r,e){let t=r;switch(e){case Boolean:t=r!==null;break;case Number:t=r===null?null:Number(r);break;case Object:case Array:try{t=JSON.parse(r)}catch{t=null}}return t}},HA=(r,e)=>!XF(r,e),Jw={attribute:!0,type:String,converter:Bg,reflect:!1,useDefault:!1,hasChanged:HA};Symbol.metadata??=Symbol("metadata"),Nh.litPropertyMetadata??=new WeakMap;let gc=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=Jw){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const n=Symbol(),i=this.getPropertyDescriptor(e,n,t);i!==void 0&&QF(this.prototype,e,i)}}static getPropertyDescriptor(e,t,n){const{get:i,set:s}=ej(this.prototype,e)??{get(){return this[t]},set(o){this[t]=o}};return{get:i,set(o){const a=i?.call(this);s?.call(this,o),this.requestUpdate(e,a,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Jw}static _$Ei(){if(this.hasOwnProperty(Wl("elementProperties")))return;const e=nj(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Wl("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Wl("properties"))){const t=this.properties,n=[...tj(t),...rj(t)];for(const i of n)this.createProperty(i,t[i])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[n,i]of t)this.elementProperties.set(n,i)}this._$Eh=new Map;for(const[t,n]of this.elementProperties){const i=this._$Eu(t,n);i!==void 0&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const i of n)t.unshift(Gw(i))}else e!==void 0&&t.push(Gw(e));return t}static _$Eu(e,t){const n=t.attribute;return n===!1?void 0:typeof n=="string"?n:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((e=>e(this)))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const n of t.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return ZF(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((e=>e.hostConnected?.()))}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach((e=>e.hostDisconnected?.()))}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$ET(e,t){const n=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,n);if(i!==void 0&&n.reflect===!0){const s=(n.converter?.toAttribute!==void 0?n.converter:Bg).toAttribute(t,n.type);this._$Em=e,s==null?this.removeAttribute(i):this.setAttribute(i,s),this._$Em=null}}_$AK(e,t){const n=this.constructor,i=n._$Eh.get(e);if(i!==void 0&&this._$Em!==i){const s=n.getPropertyOptions(i),o=typeof s.converter=="function"?{fromAttribute:s.converter}:s.converter?.fromAttribute!==void 0?s.converter:Bg;this._$Em=i;const a=o.fromAttribute(t,s.type);this[i]=a??this._$Ej?.get(i)??a,this._$Em=null}}requestUpdate(e,t,n){if(e!==void 0){const i=this.constructor,s=this[e];if(n??=i.getPropertyOptions(e),!((n.hasChanged??HA)(s,t)||n.useDefault&&n.reflect&&s===this._$Ej?.get(e)&&!this.hasAttribute(i._$Eu(e,n))))return;this.C(e,t,n)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,t,{useDefault:n,reflect:i,wrapped:s},o){n&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,o??t??this[e]),s!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||n||(t=void 0),this._$AL.set(e,t)),i===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[i,s]of this._$Ep)this[i]=s;this._$Ep=void 0}const n=this.constructor.elementProperties;if(n.size>0)for(const[i,s]of n){const{wrapped:o}=s,a=this[i];o!==!0||this._$AL.has(i)||a===void 0||this.C(i,void 0,s,a)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$EO?.forEach((n=>n.hostUpdate?.())),this.update(t)):this._$EM()}catch(n){throw e=!1,this._$EM(),n}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach((t=>t.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach((t=>this._$ET(t,this[t]))),this._$EM()}updated(e){}firstUpdated(e){}};gc.elementStyles=[],gc.shadowRootOptions={mode:"open"},gc[Wl("elementProperties")]=new Map,gc[Wl("finalized")]=new Map,sj?.({ReactiveElement:gc}),(Nh.reactiveElementVersions??=[]).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Lm=globalThis,Gf=Lm.trustedTypes,Zw=Gf?Gf.createPolicy("lit-html",{createHTML:r=>r}):void 0,WA="$lit$",go=`lit$${Math.random().toFixed(9).slice(2)}$`,zA="?"+go,oj=`<${zA}>`,Ca=document,Lu=()=>Ca.createComment(""),Fu=r=>r===null||typeof r!="object"&&typeof r!="function",Fm=Array.isArray,aj=r=>Fm(r)||typeof r?.[Symbol.iterator]=="function",op=`[ 	
\f\r]`,vl=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Xw=/-->/g,Qw=/>/g,Vo=RegExp(`>|${op}(?:([^\\s"'>=/]+)(${op}*=${op}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),ex=/'/g,tx=/"/g,KA=/^(?:script|style|textarea|title)$/i,VA=r=>(e,...t)=>({_$litType$:r,strings:e,values:t}),RV=VA(1),OV=VA(2),jc=Symbol.for("lit-noChange"),Ir=Symbol.for("lit-nothing"),rx=new WeakMap,ca=Ca.createTreeWalker(Ca,129);function GA(r,e){if(!Fm(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return Zw!==void 0?Zw.createHTML(e):e}const cj=(r,e)=>{const t=r.length-1,n=[];let i,s=e===2?"<svg>":e===3?"<math>":"",o=vl;for(let a=0;a<t;a++){const c=r[a];let l,u,d=-1,p=0;for(;p<c.length&&(o.lastIndex=p,u=o.exec(c),u!==null);)p=o.lastIndex,o===vl?u[1]==="!--"?o=Xw:u[1]!==void 0?o=Qw:u[2]!==void 0?(KA.test(u[2])&&(i=RegExp("</"+u[2],"g")),o=Vo):u[3]!==void 0&&(o=Vo):o===Vo?u[0]===">"?(o=i??vl,d=-1):u[1]===void 0?d=-2:(d=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?Vo:u[3]==='"'?tx:ex):o===tx||o===ex?o=Vo:o===Xw||o===Qw?o=vl:(o=Vo,i=void 0);const x=o===Vo&&r[a+1].startsWith("/>")?" ":"";s+=o===vl?c+oj:d>=0?(n.push(l),c.slice(0,d)+WA+c.slice(d)+go+x):c+go+(d===-2?a:x)}return[GA(r,s+(r[t]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),n]};let $g=class YA{constructor({strings:e,_$litType$:t},n){let i;this.parts=[];let s=0,o=0;const a=e.length-1,c=this.parts,[l,u]=cj(e,t);if(this.el=YA.createElement(l,n),ca.currentNode=this.el.content,t===2||t===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(i=ca.nextNode())!==null&&c.length<a;){if(i.nodeType===1){if(i.hasAttributes())for(const d of i.getAttributeNames())if(d.endsWith(WA)){const p=u[o++],x=i.getAttribute(d).split(go),w=/([.?@])?(.*)/.exec(p);c.push({type:1,index:s,name:w[2],strings:x,ctor:w[1]==="."?uj:w[1]==="?"?dj:w[1]==="@"?fj:Ih}),i.removeAttribute(d)}else d.startsWith(go)&&(c.push({type:6,index:s}),i.removeAttribute(d));if(KA.test(i.tagName)){const d=i.textContent.split(go),p=d.length-1;if(p>0){i.textContent=Gf?Gf.emptyScript:"";for(let x=0;x<p;x++)i.append(d[x],Lu()),ca.nextNode(),c.push({type:2,index:++s});i.append(d[p],Lu())}}}else if(i.nodeType===8)if(i.data===zA)c.push({type:2,index:s});else{let d=-1;for(;(d=i.data.indexOf(go,d+1))!==-1;)c.push({type:7,index:s}),d+=go.length-1}s++}}static createElement(e,t){const n=Ca.createElement("template");return n.innerHTML=e,n}};function qc(r,e,t=r,n){if(e===jc)return e;let i=n!==void 0?t._$Co?.[n]:t._$Cl;const s=Fu(e)?void 0:e._$litDirective$;return i?.constructor!==s&&(i?._$AO?.(!1),s===void 0?i=void 0:(i=new s(r),i._$AT(r,t,n)),n!==void 0?(t._$Co??=[])[n]=i:t._$Cl=i),i!==void 0&&(e=qc(r,i._$AS(r,e.values),i,n)),e}class lj{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:n}=this._$AD,i=(e?.creationScope??Ca).importNode(t,!0);ca.currentNode=i;let s=ca.nextNode(),o=0,a=0,c=n[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new dd(s,s.nextSibling,this,e):c.type===1?l=new c.ctor(s,c.name,c.strings,this,e):c.type===6&&(l=new hj(s,this,e)),this._$AV.push(l),c=n[++a]}o!==c?.index&&(s=ca.nextNode(),o++)}return ca.currentNode=Ca,i}p(e){let t=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}}class dd{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,n,i){this.type=2,this._$AH=Ir,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&e?.nodeType===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=qc(this,e,t),Fu(e)?e===Ir||e==null||e===""?(this._$AH!==Ir&&this._$AR(),this._$AH=Ir):e!==this._$AH&&e!==jc&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):aj(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Ir&&Fu(this._$AH)?this._$AA.nextSibling.data=e:this.T(Ca.createTextNode(e)),this._$AH=e}$(e){const{values:t,_$litType$:n}=e,i=typeof n=="number"?this._$AC(e):(n.el===void 0&&(n.el=$g.createElement(GA(n.h,n.h[0]),this.options)),n);if(this._$AH?._$AD===i)this._$AH.p(t);else{const s=new lj(i,this),o=s.u(this.options);s.p(t),this.T(o),this._$AH=s}}_$AC(e){let t=rx.get(e.strings);return t===void 0&&rx.set(e.strings,t=new $g(e)),t}k(e){Fm(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,i=0;for(const s of e)i===t.length?t.push(n=new dd(this.O(Lu()),this.O(Lu()),this,this.options)):n=t[i],n._$AI(s),i++;i<t.length&&(this._$AR(n&&n._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e!==this._$AB;){const n=e.nextSibling;e.remove(),e=n}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}}class Ih{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,n,i,s){this.type=1,this._$AH=Ir,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=s,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=Ir}_$AI(e,t=this,n,i){const s=this.strings;let o=!1;if(s===void 0)e=qc(this,e,t,0),o=!Fu(e)||e!==this._$AH&&e!==jc,o&&(this._$AH=e);else{const a=e;let c,l;for(e=s[0],c=0;c<s.length-1;c++)l=qc(this,a[n+c],t,c),l===jc&&(l=this._$AH[c]),o||=!Fu(l)||l!==this._$AH[c],l===Ir?e=Ir:e!==Ir&&(e+=(l??"")+s[c+1]),this._$AH[c]=l}o&&!i&&this.j(e)}j(e){e===Ir?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class uj extends Ih{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Ir?void 0:e}}class dj extends Ih{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Ir)}}class fj extends Ih{constructor(e,t,n,i,s){super(e,t,n,i,s),this.type=5}_$AI(e,t=this){if((e=qc(this,e,t,0)??Ir)===jc)return;const n=this._$AH,i=e===Ir&&n!==Ir||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,s=e!==Ir&&(n===Ir||i);i&&this.element.removeEventListener(this.name,this,n),s&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class hj{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){qc(this,e)}}const pj=Lm.litHtmlPolyfillSupport;pj?.($g,dd),(Lm.litHtmlVersions??=[]).push("3.3.1");const gj=(r,e,t)=>{const n=t?.renderBefore??e;let i=n._$litPart$;if(i===void 0){const s=t?.renderBefore??null;n._$litPart$=i=new dd(e.insertBefore(Lu(),s),s,void 0,t??{})}return i._$AI(r),i};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const jm=globalThis;class uf extends gc{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=gj(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return jc}}uf._$litElement$=!0,uf.finalized=!0,jm.litElementHydrateSupport?.({LitElement:uf});const mj=jm.litElementPolyfillSupport;mj?.({LitElement:uf});(jm.litElementVersions??=[]).push("4.2.1");const bj={black:"#202020",white:"#FFFFFF",white010:"rgba(255, 255, 255, 0.1)",accent010:"rgba(9, 136, 240, 0.1)",accent020:"rgba(9, 136, 240, 0.2)",accent030:"rgba(9, 136, 240, 0.3)",accent040:"rgba(9, 136, 240, 0.4)",accent050:"rgba(9, 136, 240, 0.5)",accent060:"rgba(9, 136, 240, 0.6)",accent070:"rgba(9, 136, 240, 0.7)",accent080:"rgba(9, 136, 240, 0.8)",accent090:"rgba(9, 136, 240, 0.9)",accent100:"rgba(9, 136, 240, 1.0)",accentSecondary010:"rgba(199, 185, 148, 0.1)",accentSecondary020:"rgba(199, 185, 148, 0.2)",accentSecondary030:"rgba(199, 185, 148, 0.3)",accentSecondary040:"rgba(199, 185, 148, 0.4)",accentSecondary050:"rgba(199, 185, 148, 0.5)",accentSecondary060:"rgba(199, 185, 148, 0.6)",accentSecondary070:"rgba(199, 185, 148, 0.7)",accentSecondary080:"rgba(199, 185, 148, 0.8)",accentSecondary090:"rgba(199, 185, 148, 0.9)",accentSecondary100:"rgba(199, 185, 148, 1.0)",productWalletKit:"#FFB800",productAppKit:"#FF573B",productCloud:"#0988F0",productDocumentation:"#008847",neutrals050:"#F6F6F6",neutrals100:"#F3F3F3",neutrals200:"#E9E9E9",neutrals300:"#D0D0D0",neutrals400:"#BBB",neutrals500:"#9A9A9A",neutrals600:"#6C6C6C",neutrals700:"#4F4F4F",neutrals800:"#363636",neutrals900:"#2A2A2A",neutrals1000:"#252525",semanticSuccess010:"rgba(48, 164, 107, 0.1)",semanticSuccess020:"rgba(48, 164, 107, 0.2)",semanticSuccess030:"rgba(48, 164, 107, 0.3)",semanticSuccess040:"rgba(48, 164, 107, 0.4)",semanticSuccess050:"rgba(48, 164, 107, 0.5)",semanticSuccess060:"rgba(48, 164, 107, 0.6)",semanticSuccess070:"rgba(48, 164, 107, 0.7)",semanticSuccess080:"rgba(48, 164, 107, 0.8)",semanticSuccess090:"rgba(48, 164, 107, 0.9)",semanticSuccess100:"rgba(48, 164, 107, 1.0)",semanticError010:"rgba(223, 74, 52, 0.1)",semanticError020:"rgba(223, 74, 52, 0.2)",semanticError030:"rgba(223, 74, 52, 0.3)",semanticError040:"rgba(223, 74, 52, 0.4)",semanticError050:"rgba(223, 74, 52, 0.5)",semanticError060:"rgba(223, 74, 52, 0.6)",semanticError070:"rgba(223, 74, 52, 0.7)",semanticError080:"rgba(223, 74, 52, 0.8)",semanticError090:"rgba(223, 74, 52, 0.9)",semanticError100:"rgba(223, 74, 52, 1.0)",semanticWarning010:"rgba(243, 161, 63, 0.1)",semanticWarning020:"rgba(243, 161, 63, 0.2)",semanticWarning030:"rgba(243, 161, 63, 0.3)",semanticWarning040:"rgba(243, 161, 63, 0.4)",semanticWarning050:"rgba(243, 161, 63, 0.5)",semanticWarning060:"rgba(243, 161, 63, 0.6)",semanticWarning070:"rgba(243, 161, 63, 0.7)",semanticWarning080:"rgba(243, 161, 63, 0.8)",semanticWarning090:"rgba(243, 161, 63, 0.9)",semanticWarning100:"rgba(243, 161, 63, 1.0)"},Yf={core:{backgroundAccentPrimary:"#0988F0",backgroundAccentCertified:"#C7B994",backgroundWalletKit:"#FFB800",backgroundAppKit:"#FF573B",backgroundCloud:"#0988F0",backgroundDocumentation:"#008847",backgroundSuccess:"rgba(48, 164, 107, 0.20)",backgroundError:"rgba(223, 74, 52, 0.20)",backgroundWarning:"rgba(243, 161, 63, 0.20)",textAccentPrimary:"#0988F0",textAccentCertified:"#C7B994",textWalletKit:"#FFB800",textAppKit:"#FF573B",textCloud:"#0988F0",textDocumentation:"#008847",textSuccess:"#30A46B",textError:"#DF4A34",textWarning:"#F3A13F",borderAccentPrimary:"#0988F0",borderSecondary:"#C7B994",borderSuccess:"#30A46B",borderError:"#DF4A34",borderWarning:"#F3A13F",foregroundAccent010:"rgba(9, 136, 240, 0.1)",foregroundAccent020:"rgba(9, 136, 240, 0.2)",foregroundAccent040:"rgba(9, 136, 240, 0.4)",foregroundAccent060:"rgba(9, 136, 240, 0.6)",foregroundSecondary020:"rgba(199, 185, 148, 0.2)",foregroundSecondary040:"rgba(199, 185, 148, 0.4)",foregroundSecondary060:"rgba(199, 185, 148, 0.6)",iconAccentPrimary:"#0988F0",iconAccentCertified:"#C7B994",iconSuccess:"#30A46B",iconError:"#DF4A34",iconWarning:"#F3A13F",glass010:"rgba(255, 255, 255, 0.1)"},dark:{overlay:"rgba(0, 0, 0, 0.50)",backgroundPrimary:"#202020",backgroundInvert:"#FFFFFF",textPrimary:"#FFFFFF",textSecondary:"#9A9A9A",textTertiary:"#BBBBBB",textInvert:"#202020",borderPrimary:"#2A2A2A",borderPrimaryDark:"#363636",borderSecondary:"#4F4F4F",foregroundPrimary:"#252525",foregroundSecondary:"#2A2A2A",foregroundTertiary:"#363636",iconDefault:"#9A9A9A",iconInverse:"#FFFFFF"},light:{overlay:"rgba(230 , 230, 230, 0.5)",backgroundPrimary:"#FFFFFF",borderPrimaryDark:"#E9E9E9",backgroundInvert:"#202020",textPrimary:"#202020",textSecondary:"#9A9A9A",textTertiary:"#6C6C6C",textInvert:"#FFFFFF",borderPrimary:"#E9E9E9",borderSecondary:"#D0D0D0",foregroundPrimary:"#F3F3F3",foregroundSecondary:"#E9E9E9",foregroundTertiary:"#D0D0D0",iconDefault:"#9A9A9A",iconInverse:"#202020"}},yj={1:"4px",2:"8px",10:"10px",3:"12px",4:"16px",6:"24px",5:"20px",8:"32px",16:"64px",20:"80px",32:"128px",64:"256px",128:"512px",round:"9999px"},wj={0:"0px","01":"2px",1:"4px",2:"8px",3:"12px",4:"16px",5:"20px",6:"24px",7:"28px",8:"32px",9:"36px",10:"40px",12:"48px",14:"56px",16:"64px",20:"80px",32:"128px",64:"256px"},xj={regular:"KHTeka",mono:"KHTekaMono"},vj={regular:"400",medium:"500"},Ej={h1:"50px",h2:"44px",h3:"38px",h4:"32px",h5:"26px",h6:"20px",large:"16px",medium:"14px",small:"12px"},Aj={"h1-regular-mono":{lineHeight:"50px",letterSpacing:"-3px"},"h1-regular":{lineHeight:"50px",letterSpacing:"-1px"},"h1-medium":{lineHeight:"50px",letterSpacing:"-0.84px"},"h2-regular-mono":{lineHeight:"44px",letterSpacing:"-2.64px"},"h2-regular":{lineHeight:"44px",letterSpacing:"-0.88px"},"h2-medium":{lineHeight:"44px",letterSpacing:"-0.88px"},"h3-regular-mono":{lineHeight:"38px",letterSpacing:"-2.28px"},"h3-regular":{lineHeight:"38px",letterSpacing:"-0.76px"},"h3-medium":{lineHeight:"38px",letterSpacing:"-0.76px"},"h4-regular-mono":{lineHeight:"32px",letterSpacing:"-1.92px"},"h4-regular":{lineHeight:"32px",letterSpacing:"-0.32px"},"h4-medium":{lineHeight:"32px",letterSpacing:"-0.32px"},"h5-regular-mono":{lineHeight:"26px",letterSpacing:"-1.56px"},"h5-regular":{lineHeight:"26px",letterSpacing:"-0.26px"},"h5-medium":{lineHeight:"26px",letterSpacing:"-0.26px"},"h6-regular-mono":{lineHeight:"20px",letterSpacing:"-1.2px"},"h6-regular":{lineHeight:"20px",letterSpacing:"-0.6px"},"h6-medium":{lineHeight:"20px",letterSpacing:"-0.6px"},"lg-regular-mono":{lineHeight:"16px",letterSpacing:"-0.96px"},"lg-regular":{lineHeight:"18px",letterSpacing:"-0.16px"},"lg-medium":{lineHeight:"18px",letterSpacing:"-0.16px"},"md-regular-mono":{lineHeight:"14px",letterSpacing:"-0.84px"},"md-regular":{lineHeight:"16px",letterSpacing:"-0.14px"},"md-medium":{lineHeight:"16px",letterSpacing:"-0.14px"},"sm-regular-mono":{lineHeight:"12px",letterSpacing:"-0.72px"},"sm-regular":{lineHeight:"14px",letterSpacing:"-0.12px"},"sm-medium":{lineHeight:"14px",letterSpacing:"-0.12px"}},_j={"ease-out-power-2":"cubic-bezier(0.23, 0.09, 0.08, 1.13)","ease-out-power-1":"cubic-bezier(0.12, 0.04, 0.2, 1.06)","ease-in-power-2":"cubic-bezier(0.92, -0.13, 0.77, 0.91)","ease-in-power-1":"cubic-bezier(0.88, -0.06, 0.8, 0.96)","ease-inout-power-2":"cubic-bezier(0.77, 0.09, 0.23, 1.13)","ease-inout-power-1":"cubic-bezier(0.88, 0.04, 0.12, 1.06)"},Cj={xl:"400ms",lg:"200ms",md:"125ms",sm:"75ms"},Lg={colors:bj,fontFamily:xj,fontWeight:vj,textSize:Ej,typography:Aj,tokens:{core:Yf.core,theme:Yf.dark},borderRadius:yj,spacing:wj,durations:Cj,easings:_j},nx="--apkt",Ns={createCSSVariables(r){const e={},t={};function n(s,o,a=""){for(const[c,l]of Object.entries(s)){const u=a?`${a}-${c}`:c;l&&typeof l=="object"&&Object.keys(l).length?(o[c]={},n(l,o[c],u)):typeof l=="string"&&(o[c]=`${nx}-${u}`)}}function i(s,o){for(const[a,c]of Object.entries(s))c&&typeof c=="object"?(o[a]={},i(c,o[a])):typeof c=="string"&&(o[a]=`var(${c})`)}return n(r,e),i(e,t),{cssVariables:e,cssVariablesVarPrefix:t}},assignCSSVariables(r,e){const t={};function n(i,s,o){for(const[a,c]of Object.entries(i)){const l=o?`${o}-${a}`:a,u=s[a];c&&typeof c=="object"?n(c,u,l):typeof u=="string"&&(t[`${nx}-${l}`]=u)}}return n(r,e),t},createRootStyles(r,e){const t={...Lg,tokens:{...Lg.tokens,theme:r==="light"?Yf.light:Yf.dark}},{cssVariables:n}=Ns.createCSSVariables(t),i=Ns.assignCSSVariables(n,t),s=Ns.generateW3MVariables(e),o=Ns.generateW3MOverrides(e),a=Ns.generateScaledVariables(e),c=Ns.generateBaseVariables(i),l={...i,...c,...s,...o,...a},u=Ns.applyColorMixToVariables(e,l),d={...l,...u};return`:root {${Object.entries(d).map(([x,w])=>`${x}:${w.replace("/[:;{}</>]/g","")};`).join("")}}`},generateW3MVariables(r){if(!r)return{};const e={};return e["--w3m-font-family"]=r["--w3m-font-family"]||"KHTeka",e["--w3m-accent"]=r["--w3m-accent"]||"#0988F0",e["--w3m-color-mix"]=r["--w3m-color-mix"]||"#000",e["--w3m-color-mix-strength"]=`${r["--w3m-color-mix-strength"]||0}%`,e["--w3m-font-size-master"]=r["--w3m-font-size-master"]||"10px",e["--w3m-border-radius-master"]=r["--w3m-border-radius-master"]||"4px",r["--w3m-z-index"]&&(e["--apkt-z-index"]=`${r["--w3m-z-index"]}`),e},generateW3MOverrides(r){if(!r)return{};const e={};if(r["--w3m-accent"]){const t=r["--w3m-accent"];e["--apkt-tokens-core-iconAccentPrimary"]=t,e["--apkt-tokens-core-borderAccentPrimary"]=t,e["--apkt-tokens-core-textAccentPrimary"]=t,e["--apkt-tokens-core-backgroundAccentPrimary"]=t}return r["--w3m-font-family"]&&(e["--apkt-fontFamily-regular"]=r["--w3m-font-family"]),e},generateScaledVariables(r){if(!r)return{};const e={};if(r["--w3m-font-size-master"]){const t=parseFloat(r["--w3m-font-size-master"].replace("px",""));e["--apkt-textSize-h1"]=`${Number(t)*5}px`,e["--apkt-textSize-h2"]=`${Number(t)*4.4}px`,e["--apkt-textSize-h3"]=`${Number(t)*3.8}px`,e["--apkt-textSize-h4"]=`${Number(t)*3.2}px`,e["--apkt-textSize-h5"]=`${Number(t)*2.6}px`,e["--apkt-textSize-h6"]=`${Number(t)*2}px`,e["--apkt-textSize-large"]=`${Number(t)*1.6}px`,e["--apkt-textSize-medium"]=`${Number(t)*1.4}px`,e["--apkt-textSize-small"]=`${Number(t)*1.2}px`}if(r["--w3m-border-radius-master"]){const t=parseFloat(r["--w3m-border-radius-master"].replace("px",""));e["--apkt-borderRadius-1"]=`${Number(t)}px`,e["--apkt-borderRadius-2"]=`${Number(t)*2}px`,e["--apkt-borderRadius-3"]=`${Number(t)*3}px`,e["--apkt-borderRadius-4"]=`${Number(t)*4}px`,e["--apkt-borderRadius-5"]=`${Number(t)*5}px`,e["--apkt-borderRadius-6"]=`${Number(t)*6}px`,e["--apkt-borderRadius-8"]=`${Number(t)*8}px`,e["--apkt-borderRadius-16"]=`${Number(t)*16}px`,e["--apkt-borderRadius-20"]=`${Number(t)*20}px`,e["--apkt-borderRadius-32"]=`${Number(t)*32}px`,e["--apkt-borderRadius-64"]=`${Number(t)*64}px`,e["--apkt-borderRadius-128"]=`${Number(t)*128}px`}return e},generateColorMixCSS(r,e){if(!r?.["--w3m-color-mix"]||!r["--w3m-color-mix-strength"])return"";const t=r["--w3m-color-mix"],n=r["--w3m-color-mix-strength"];if(!n||n===0)return"";const i=Object.keys(e||{}).filter(o=>{const a=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon"),c=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return a&&!c});return i.length===0?"":` @supports (background: color-mix(in srgb, white 50%, black)) {
      :root {
        ${i.map(o=>{const a=e?.[o]||"";return a.includes("color-mix")||a.startsWith("#")||a.startsWith("rgb")?`${o}: color-mix(in srgb, ${t} ${n}%, ${a});`:`${o}: color-mix(in srgb, ${t} ${n}%, var(${o}-base, ${a}));`}).join("")}
      }
    }`},generateBaseVariables(r){const e={},t=r["--apkt-tokens-theme-backgroundPrimary"];t&&(e["--apkt-tokens-theme-backgroundPrimary-base"]=t);const n=r["--apkt-tokens-core-backgroundAccentPrimary"];return n&&(e["--apkt-tokens-core-backgroundAccentPrimary-base"]=n),e},applyColorMixToVariables(r,e){const t={};if(e?.["--apkt-tokens-theme-backgroundPrimary"]&&(t["--apkt-tokens-theme-backgroundPrimary"]="var(--apkt-tokens-theme-backgroundPrimary-base)"),e?.["--apkt-tokens-core-backgroundAccentPrimary"]&&(t["--apkt-tokens-core-backgroundAccentPrimary"]="var(--apkt-tokens-core-backgroundAccentPrimary-base)"),!r?.["--w3m-color-mix"]||!r["--w3m-color-mix-strength"])return t;const n=r["--w3m-color-mix"],i=r["--w3m-color-mix-strength"];if(!i||i===0)return t;const s=Object.keys(e||{}).filter(o=>{const a=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon")||o.includes("-tokens-theme-overlay"),c=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return a&&!c});return s.length===0||s.forEach(o=>{const a=e?.[o]||"";o.endsWith("-base")||(o==="--apkt-tokens-theme-backgroundPrimary"||o==="--apkt-tokens-core-backgroundAccentPrimary"?t[o]=`color-mix(in srgb, ${n} ${i}%, var(${o}-base))`:a.includes("color-mix")||a.startsWith("#")||a.startsWith("rgb")?t[o]=`color-mix(in srgb, ${n} ${i}%, ${a})`:t[o]=`color-mix(in srgb, ${n} ${i}%, var(${o}-base, ${a}))`)}),t}},{cssVariablesVarPrefix:Sj}=Ns.createCSSVariables(Lg);function kV(r,...e){return po(r,...e.map(t=>xi(typeof t=="function"?t(Sj):t)))}let ea,la,es,_i,Jf;const Ss={"KHTeka-500-woff2":"https://fonts.reown.com/KHTeka-Medium.woff2","KHTeka-400-woff2":"https://fonts.reown.com/KHTeka-Regular.woff2","KHTeka-300-woff2":"https://fonts.reown.com/KHTeka-Light.woff2","KHTekaMono-400-woff2":"https://fonts.reown.com/KHTekaMono-Regular.woff2","KHTeka-500-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTeka-400-woff":"https://fonts.reown.com/KHTeka-Regular.woff","KHTeka-300-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTekaMono-400-woff":"https://fonts.reown.com/KHTekaMono-Regular.woff"};function Zf(r,e="dark"){ea&&document.head.removeChild(ea),ea=document.createElement("style"),ea.textContent=Ns.createRootStyles(e,r),document.head.appendChild(ea)}function DV(r,e="dark"){if(Jf=r,la=document.createElement("style"),es=document.createElement("style"),_i=document.createElement("style"),la.textContent=Nc(r).core.cssText,es.textContent=Nc(r).dark.cssText,_i.textContent=Nc(r).light.cssText,document.head.appendChild(la),document.head.appendChild(es),document.head.appendChild(_i),Zf(r,e),Fg(e),!r?.["--w3m-font-family"])for(const[t,n]of Object.entries(Ss)){const i=document.createElement("link");i.rel="preload",i.href=n,i.as="font",i.type=t.includes("woff2")?"font/woff2":"font/woff",i.crossOrigin="anonymous",document.head.appendChild(i)}Fg(e)}function Fg(r="dark"){es&&_i&&ea&&(r==="light"?(Zf(Jf,r),es.removeAttribute("media"),_i.media="enabled"):(Zf(Jf,r),_i.removeAttribute("media"),es.media="enabled"))}function Nj(r){if(Jf=r,la&&es&&_i&&(la.textContent=Nc(r).core.cssText,es.textContent=Nc(r).dark.cssText,_i.textContent=Nc(r).light.cssText,r?.["--w3m-font-family"])){const e=r["--w3m-font-family"];la.textContent=la.textContent?.replace("font-family: KHTeka",`font-family: ${e}`),es.textContent=es.textContent?.replace("font-family: KHTeka",`font-family: ${e}`),_i.textContent=_i.textContent?.replace("font-family: KHTeka",`font-family: ${e}`)}if(ea){const e=_i?.media==="enabled"?"light":"dark";Zf(r,e)}}function Nc(r){const e=!!r?.["--w3m-font-family"];return{core:po`
      ${e?po``:po`
            @font-face {
              font-family: 'KHTeka';
              src:
                url(${xi(Ss["KHTeka-400-woff2"])}) format('woff2'),
                url(${xi(Ss["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
              font-display: swap;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${xi(Ss["KHTeka-300-woff2"])}) format('woff2'),
                url(${xi(Ss["KHTeka-300-woff"])}) format('woff');
              font-weight: 300;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTekaMono';
              src:
                url(${xi(Ss["KHTekaMono-400-woff2"])}) format('woff2'),
                url(${xi(Ss["KHTekaMono-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${xi(Ss["KHTeka-400-woff2"])}) format('woff2'),
                url(${xi(Ss["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }
          `}

      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --apkt-modal-width: 370px;

        --apkt-visual-size-inherit: inherit;
        --apkt-visual-size-sm: 40px;
        --apkt-visual-size-md: 55px;
        --apkt-visual-size-lg: 80px;

        --apkt-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --apkt-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --apkt-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --apkt-width-network-sm: 36px;
        --apkt-width-network-md: 48px;
        --apkt-width-network-lg: 86px;

        --apkt-duration-dynamic: 0ms;
        --apkt-height-network-sm: 40px;
        --apkt-height-network-md: 54px;
        --apkt-height-network-lg: 96px;
      }
    `,dark:po`
      :root {
      }
    `,light:po`
      :root {
      }
    `}}const MV=po`
  div,
  span,
  iframe,
  a,
  img,
  form,
  button,
  label,
  *::after,
  *::before {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    backface-visibility: hidden;
  }

  :host {
    font-family: var(--apkt-fontFamily-regular);
  }
`,UV=po`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;

    will-change: background-color, color, border, box-shadow, width, height, transform, opacity;
    outline: none;
    border: none;
    text-decoration: none;
    transition:
      background-color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      box-shadow var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      width var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      height var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      transform var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      opacity var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      scale var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border-radius var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2);
    will-change:
      background-color, color, border, box-shadow, width, height, transform, opacity, scale,
      border-radius;
  }

  a:active:not([disabled]),
  button:active:not([disabled]) {
    scale: 0.975;
    transform-origin: center;
  }

  button:disabled {
    cursor: default;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,Ic={hexStringToNumber(r){const e=r.startsWith("0x")?r.slice(2):r;return parseInt(e,16)},numberToHexString(r){return`0x${r.toString(16)}`},async getUserInfo(r){const[e,t]=await Promise.all([Ic.getAddresses(r),Ic.getChainId(r)]);return{chainId:t,addresses:e}},async getChainId(r){const e=await r.request({method:"eth_chainId"});return Number(e)},async getAddress(r){const[e]=await r.request({method:"eth_accounts"});return e},async getAddresses(r){return await r.request({method:"eth_accounts"})},async addEthereumChain(r,e){const t=e.rpcUrls.chainDefault?.http||[];await r.request({method:"wallet_addEthereumChain",params:[{chainId:Ic.numberToHexString(e.id),rpcUrls:[...t],chainName:e.name,nativeCurrency:{name:e.nativeCurrency.name,decimals:e.nativeCurrency.decimals,symbol:e.nativeCurrency.symbol},blockExplorerUrls:[e.blockExplorers?.default.url],iconUrls:[Ji.NetworkImageIds[e.id]]}]})}},ac={ACCOUNT_INDEXES:{PAYMENT:0,ORDINAL:1}},Ij=nm({id:42161,name:"Arbitrum One",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockTime:250,rpcUrls:{default:{http:["https://arb1.arbitrum.io/rpc"]}},blockExplorers:{default:{name:"Arbiscan",url:"https://arbiscan.io",apiUrl:"https://api.arbiscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:7654707}}}),Tj=nm({id:56,name:"BNB Smart Chain",blockTime:750,nativeCurrency:{decimals:18,name:"BNB",symbol:"BNB"},rpcUrls:{default:{http:["https://56.rpc.thirdweb.com"]}},blockExplorers:{default:{name:"BscScan",url:"https://bscscan.com",apiUrl:"https://api.bscscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:15921452}}}),Pj=nm({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockTime:12e3,rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensUniversalResolver:{address:"0xeeeeeeee14d718c2b47d9923deab1335e144eeee",blockCreated:23085558},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}});function tl(r){return{formatters:void 0,fees:void 0,serializers:void 0,...r}}const ix=tl({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),sx=tl({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});tl({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});tl({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});tl({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});tl({id:"00000008819873e925422c1ff0f99f7c",caipNetworkId:"bip122:00000008819873e925422c1ff0f99f7c",chainNamespace:"bip122",name:"Bitcoin Signet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});const Rj={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},Us={getMethodsByChainNamespace(r){return Rj[r]||[]},createDefaultNamespace(r){return{methods:this.getMethodsByChainNamespace(r),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(r,e){if(!e)return{...r};const t={...r},n=new Set;if(e.methods&&Object.keys(e.methods).forEach(i=>n.add(i)),e.chains&&Object.keys(e.chains).forEach(i=>n.add(i)),e.events&&Object.keys(e.events).forEach(i=>n.add(i)),e.rpcMap&&Object.keys(e.rpcMap).forEach(i=>{const[s]=i.split(":");s&&n.add(s)}),n.forEach(i=>{t[i]||(t[i]=this.createDefaultNamespace(i))}),e.methods&&Object.entries(e.methods).forEach(([i,s])=>{t[i]&&(t[i].methods=s)}),e.chains&&Object.entries(e.chains).forEach(([i,s])=>{t[i]&&(t[i].chains=s)}),e.events&&Object.entries(e.events).forEach(([i,s])=>{t[i]&&(t[i].events=s)}),e.rpcMap){const i=new Set;Object.entries(e.rpcMap).forEach(([s,o])=>{const[a,c]=s.split(":");!a||!c||!t[a]||(t[a].rpcMap||(t[a].rpcMap={}),i.has(a)||(t[a].rpcMap={},i.add(a)),t[a].rpcMap[c]=o)})}return t},createNamespaces(r,e){const t=r.reduce((n,i)=>{const{id:s,chainNamespace:o,rpcUrls:a}=i,c=a.default.http[0];n[o]||(n[o]=this.createDefaultNamespace(o));const l=`${o}:${s}`,u=n[o];switch(u.chains.push(l),l){case ix.caipNetworkId:u.chains.push(ix.deprecatedCaipNetworkId);break;case sx.caipNetworkId:u.chains.push(sx.deprecatedCaipNetworkId);break}return u?.rpcMap&&c&&(u.rpcMap[s]=c),n},{});return this.applyNamespaceOverrides(t,e)},resolveReownName:async r=>{const e=await kl.resolveName(r);return(Object.values(e?.addresses)||[])[0]?.address||!1},getChainsFromNamespaces(r={}){return Object.values(r).flatMap(e=>{const t=e.chains||[],n=e.accounts.map(i=>{const[s,o]=i.split(":");return`${s}:${o}`});return Array.from(new Set([...t,...n]))})},isSessionEventData(r){return typeof r=="object"&&r!==null&&"id"in r&&"topic"in r&&"params"in r&&typeof r.params=="object"&&r.params!==null&&"chainId"in r.params&&"event"in r.params&&typeof r.params.event=="object"&&r.params.event!==null},isOriginAllowed(r,e,t){for(const n of[...e,...t])if(n.includes("*")){const s=`^${n.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(s,"u").test(r))return!0}else try{if(new URL(n).origin===r)return!0}catch{if(n===r)return!0}return!1},listenWcProvider({universalProvider:r,namespace:e,onConnect:t,onDisconnect:n,onAccountsChanged:i,onChainChanged:s,onDisplayUri:o}){t&&r.on("connect",()=>{const a=Us.getWalletConnectAccounts(r,e);t(a)}),n&&r.on("disconnect",()=>{n()}),i&&r.on("accountsChanged",a=>{try{const c=r.session?.namespaces?.[e]?.accounts||[],l=r.rpcProviders?.[e]?.getDefaultChain(),u=a.map(d=>{const p=c.find(b=>b.includes(`${e}:${l}:${d}`));if(!p)return;const{chainId:x,chainNamespace:w}=on.parseCaipAddress(p);return{address:d,chainId:x,chainNamespace:w}}).filter(d=>d!==void 0);u.length>0&&i(u)}catch(c){console.warn("Failed to parse accounts for namespace on accountsChanged event",e,a,c)}}),s&&r.on("chainChanged",a=>{s(a)}),o&&r.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(r,e){const t=new Set,n=r?.session?.namespaces?.[e]?.accounts?.map(i=>on.parseCaipAddress(i)).filter(({address:i})=>t.has(i.toLowerCase())?!1:(t.add(i.toLowerCase()),!0));return n&&n.length>0?n:[]}};class Oj{constructor(e){this.namespace=e.namespace}async syncConnections(e){switch(this.namespace){case Y.CHAIN.EVM:await this.syncEVMConnections(e);break;case Y.CHAIN.SOLANA:await this.syncSolanaConnections(e);break;case Y.CHAIN.BITCOIN:await this.syncBitcoinConnections(e);break;default:throw new Error(`Unsupported chain namespace: ${this.namespace}`)}}async syncEVMConnections({connectors:e,caipNetworks:t,universalProvider:n,getConnectionStatusInfo:i,onConnection:s,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:l}=i(a.id);return!c&&l}).map(async a=>{if(a.id===Y.CONNECTOR_ID.WALLET_CONNECT){const c=Us.getWalletConnectAccounts(n,this.namespace),l=t.find(u=>u.chainNamespace===this.namespace&&u.id.toString()===c[0]?.chainId?.toString());c.length>0&&s({connectorId:a.id,accounts:c.map(u=>({address:u.address})),caipNetwork:l})}else{const{accounts:c,chainId:l}=await cf.fetchProviderData(a);if(c.length>0&&l){const u=t.find(d=>d.chainNamespace===this.namespace&&d.id.toString()===l.toString());s({connectorId:a.id,accounts:c.map(d=>({address:d})),caipNetwork:u}),a.provider&&a.id!==Y.CONNECTOR_ID.AUTH&&a.id!==Y.CONNECTOR_ID.WALLET_CONNECT&&o(a.id,a.provider)}}}))}async syncSolanaConnections({connectors:e,caipNetwork:t,universalProvider:n,getConnectionStatusInfo:i,onConnection:s,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:l}=i(a.id);return!c&&l}).map(async a=>{if(a.id===Y.CONNECTOR_ID.WALLET_CONNECT){const c=Us.getWalletConnectAccounts(n,this.namespace);c.length>0&&s({connectorId:a.id,accounts:c.map(l=>({address:l.address})),caipNetwork:t})}else{const c=await a.connect({chainId:t?.id});c&&(s({connectorId:a.id,accounts:[{address:c}],caipNetwork:t}),o(a.id,a.provider))}}))}async syncBitcoinConnections({connectors:e,caipNetwork:t,universalProvider:n,getConnectionStatusInfo:i,onConnection:s,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:l}=i(a.id);return!c&&l}).map(async a=>{if(a.id===Y.CONNECTOR_ID.WALLET_CONNECT){const p=Us.getWalletConnectAccounts(n,this.namespace);p.length>0&&s({connectorId:a.id,accounts:p.map(x=>({address:x.address})),caipNetwork:t});return}const c=await a.connect();let u=(await a.getAccountAddresses())?.map(p=>be.createAccount(Y.CHAIN.BITCOIN,p.address,p.purpose||"payment",p.publicKey,p.path));if(u&&u.length>1&&(u=[{namespace:Y.CHAIN.BITCOIN,publicKey:u[ac.ACCOUNT_INDEXES.PAYMENT]?.publicKey??"",path:u[ac.ACCOUNT_INDEXES.PAYMENT]?.path??"",address:u[ac.ACCOUNT_INDEXES.PAYMENT]?.address??"",type:"payment"},{namespace:Y.CHAIN.BITCOIN,publicKey:u[ac.ACCOUNT_INDEXES.ORDINAL]?.publicKey??"",path:u[ac.ACCOUNT_INDEXES.ORDINAL]?.path??"",address:u[ac.ACCOUNT_INDEXES.ORDINAL]?.address??"",type:"ordinal"}]),!(a.chains.find(p=>p.id===t?.id)||a.chains[0]))throw new Error("The connector does not support any of the requested chains");c&&(o(a.id,a.provider),s({connectorId:a.id,accounts:u.map(p=>({address:p.address,type:p.type})),caipNetwork:t}))}))}getConnection({address:e,connectorId:t,connections:n,connectors:i}){if(t){const o=n.find(l=>Ar.isLowerCaseMatch(l.connectorId,t));if(!o)return null;const a=i.find(l=>Ar.isLowerCaseMatch(l.id,o.connectorId)),c=e?o.accounts.find(l=>Ar.isLowerCaseMatch(l.address,e)):o.accounts[0];return{...o,account:c,connector:a}}const s=n.find(o=>o.accounts.length>0&&i.some(a=>Ar.isLowerCaseMatch(a.id,o.connectorId)));if(s){const[o]=s.accounts,a=i.find(c=>Ar.isLowerCaseMatch(c.id,s.connectorId));return{...s,account:o,connector:a}}return null}}const Os={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]};class qm{constructor({provider:e,namespace:t}){this.id=Y.CONNECTOR_ID.WALLET_CONNECT,this.name=Ji.ConnectorNamesMap[Y.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=Ji.ConnectorImageIds[Y.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=$.getCaipNetworks.bind($),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=t}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const t=this.getCaipNetworks(),n=Z.state.universalProviderConfigOverride,i=Us.createNamespaces(t,n);await this.provider.connect({optionalNamespaces:i})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(t=>t.caipNetworkId);return Ln.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:kj})}}const kj=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],Dj=[Y.CONNECTOR_ID.AUTH,Y.CONNECTOR_ID.WALLET_CONNECT];class JA{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=t=>$.getCaipNetworks(t),this.getConnectorId=t=>ae.getConnectorId(t),e&&this.construct(e),e?.namespace&&(this.connectionManager=new Oj({namespace:e.namespace}))}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:t}){const n=this.getCaipNetworks().filter(i=>i.chainNamespace===this.namespace).find(i=>i.id.toString()===t?.toString());e&&n&&this.addConnection({connectorId:Y.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:n})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:Y.CONNECTOR_ID.AUTH,type:"AUTH",name:Y.CONNECTOR_NAMES.AUTH,provider:e,imageId:Ji.ConnectorImageIds[Y.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const t=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(n=>t.has(n.id)?!1:(t.add(n.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){const t=new Set;this.availableConnections=[...e,...this.availableConnections].filter(n=>t.has(n.connectorId.toLowerCase())?!1:(t.add(n.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(t=>!Ar.isLowerCaseMatch(t.connectorId,e)),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,t){ye.setStatus(e,t)}on(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(t)}off(e,t){const n=this.eventListeners.get(e);n&&n.delete(t)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,t){const n=this.eventListeners.get(e);n&&n.forEach(i=>i(t))}async connectWalletConnect(e){return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}async switchNetwork(e){const{caipNetwork:t,providerType:n}=e;if(!e.provider)return;const i="provider"in e.provider?e.provider.provider:e.provider;if(n==="WALLET_CONNECT"){i.setDefaultChain(t.caipNetworkId);return}if(i&&n==="AUTH"){const s=i,o=qn(t.chainNamespace);await s.switchNetwork({chainId:t.caipNetworkId});const a=await s.getUser({chainId:t.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",a)}}getWalletConnectConnector(){const e=this.connectors.find(t=>t instanceof qm);if(!e)throw new Error("WalletConnectConnector not found");return e}onConnect(e,t){if(e.length>0){const{address:n,chainId:i}=be.getAccount(e[0]),s=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===i?.toString()),o=this.connectors.find(a=>a.id===t);n&&(this.emit("accountChanged",{address:n,chainId:i,connector:o}),this.addConnection({connectorId:t,accounts:e.map(a=>{const{address:c}=be.getAccount(a);return{address:c}}),caipNetwork:s}))}}onAccountsChanged(e,t,n=!0){if(e.length>0){const{address:i}=be.getAccount(e[0]),s=this.connectionManager?.getConnection({connectorId:t,connections:this.connections,connectors:this.connectors});i&&Ar.isLowerCaseMatch(this.getConnectorId(Y.CHAIN.EVM),t)&&this.emit("accountChanged",{address:i,chainId:s?.caipNetwork?.id,connector:s?.connector}),this.addConnection({connectorId:t,accounts:e.map(o=>{const{address:a}=be.getAccount(o);return{address:a}}),caipNetwork:s?.caipNetwork})}else n&&this.onDisconnect(t)}onDisconnect(e){this.removeProviderListeners(e),this.deleteConnection(e),Ar.isLowerCaseMatch(this.getConnectorId(Y.CHAIN.EVM),e)&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(e,t){const n=typeof e=="string"&&e.startsWith("0x")?Ic.hexStringToNumber(e).toString():e.toString(),i=this.connectionManager?.getConnection({connectorId:t,connections:this.connections,connectors:this.connectors}),s=this.getCaipNetworks().filter(o=>o.chainNamespace===this.namespace).find(o=>o.id.toString()===n);i&&this.addConnection({connectorId:t,accounts:i.accounts,caipNetwork:s}),Ar.isLowerCaseMatch(this.getConnectorId(Y.CHAIN.EVM),t)&&this.emit("switchNetwork",{chainId:n})}listenProviderEvents(e,t){if(Dj.includes(e))return;const n=o=>this.onAccountsChanged(o,e),i=o=>this.onChainChanged(o,e),s=()=>this.onDisconnect(e);this.providerHandlers[e]||(t.on("disconnect",s),t.on("accountsChanged",n),t.on("chainChanged",i),this.providerHandlers[e]={provider:t,disconnect:s,accountsChanged:n,chainChanged:i})}removeProviderListeners(e){if(this.providerHandlers[e]){const{provider:t,disconnect:n,accountsChanged:i,chainChanged:s}=this.providerHandlers[e];t.removeListener("disconnect",n),t.removeListener("accountsChanged",i),t.removeListener("chainChanged",s),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){const e=this.connectionManager?.getConnection({connections:this.connections,connectors:this.connectors});if(e){const[t]=e.accounts;this.emit("accountChanged",{address:t?.address,chainId:e.caipNetwork?.id,connector:e.connector})}}}class Mj extends JA{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new qm({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:e}){const n=this.provider?.session?.namespaces?.[e]?.accounts?.map(i=>{const[,,s]=i.split(":");return s}).filter((i,s,o)=>o.indexOf(i)===s)||[];return Promise.resolve({accounts:n.map(i=>be.createAccount(e,i,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){if(!(e.caipNetwork&&Ge.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace))||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};if(ye.state.balanceLoading&&e.chainId===$.state.activeCaipNetwork?.id)return{balance:ye.state.balance||"0.00",symbol:ye.state.balanceSymbol||""};const i=(await ye.fetchTokenBalance()).find(s=>s.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&s.symbol===e.caipNetwork?.nativeCurrency.symbol);return{balance:i?.quantity.numeric||"0.00",symbol:i?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){const{provider:t,message:n,address:i}=e;if(!t)throw new Error("UniversalAdapter:signMessage - provider is undefined");let s="";return $.state.activeCaipNetwork?.chainNamespace===Y.CHAIN.SOLANA?s=(await t.request({method:"solana_signMessage",params:{message:Jc.encode(new TextEncoder().encode(n)),pubkey:i}},$.state.activeCaipNetwork?.caipNetworkId)).signature:s=await t.request({method:"personal_sign",params:[n,i]},$.state.activeCaipNetwork?.caipNetworkId),{signature:s}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){const{caipNetwork:t}=e,n=this.getWalletConnectConnector();if(t.chainNamespace===Y.CHAIN.EVM)try{await n.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:_b(t.id)}]})}catch(i){if(i.code===Os.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||i.code===Os.ERROR_INVALID_CHAIN_ID||i.code===Os.ERROR_CODE_DEFAULT||i?.data?.originalError?.code===Os.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await n.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:_b(t.id),rpcUrls:[t?.rpcUrls.chainDefault?.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[t.blockExplorers?.default.url]}]})}catch{throw new Error("Chain is not supported")}}n.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){return this.connectors.find(n=>n.type==="WALLET_CONNECT")?.provider}}const Uj=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture","payWithExchange","payments","reownAuthentication"],zd={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:r=>{if(!r?.config)return!1;const e=r.config;return!!r.isEnabled&&e.includes("email")},processFallback:r=>r===void 0?Ge.DEFAULT_REMOTE_FEATURES.email:!!r},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:r=>{if(!r?.config)return!1;const e=r.config;return r.isEnabled&&e.length>0?e.filter(t=>t!=="email"):!1},processFallback:r=>r===void 0?Ge.DEFAULT_REMOTE_FEATURES.socials:typeof r=="boolean"?r?Ge.DEFAULT_REMOTE_FEATURES.socials:!1:r},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:r=>{if(!r?.config)return!1;const e=r.config;return r.isEnabled&&e.length>0?e:!1},processFallback:r=>r===void 0?Ge.DEFAULT_REMOTE_FEATURES.swaps:typeof r=="boolean"?r?Ge.DEFAULT_REMOTE_FEATURES.swaps:!1:r},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:r=>{if(!r?.config)return!1;const e=r.config;return r.isEnabled&&e.length>0?e:!1},processFallback:r=>r===void 0?Ge.DEFAULT_REMOTE_FEATURES.onramp:typeof r=="boolean"?r?Ge.DEFAULT_REMOTE_FEATURES.onramp:!1:r},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:r=>!!r.isEnabled,processFallback:r=>r===void 0?Ge.DEFAULT_REMOTE_FEATURES.activity:!!r},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:r=>!!r.isEnabled,processFallback:r=>r===void 0?Ge.DEFAULT_REMOTE_FEATURES.reownBranding:!!r},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:r=>r.isEnabled&&(r.config??[]),processFallback:r=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:r=>!!r.isEnabled,processFallback:()=>Ge.DEFAULT_REMOTE_FEATURES.multiWallet},payWithExchange:{apiFeatureName:"fund_from_exchange",localFeatureName:"payWithExchange",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:r=>!!r.isEnabled,processFallback:()=>Ge.DEFAULT_REMOTE_FEATURES.payWithExchange},payments:{apiFeatureName:"payments",localFeatureName:"payments",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:r=>!!r.isEnabled,processFallback:()=>Ge.DEFAULT_REMOTE_FEATURES.payments},reownAuthentication:{apiFeatureName:"reown_authentication",localFeatureName:"reownAuthentication",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:r=>!!r.isEnabled,processFallback:r=>typeof r>"u"?Ge.DEFAULT_REMOTE_FEATURES.reownAuthentication:!!r}},Bj={localSettingsOverridden:new Set,getApiConfig(r,e){return e?.find(t=>t.id===r)},addWarning(r,e){if(r!==void 0){const t=zd[e],n=t.isLegacy?`"features.${t.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(n)}},processFeature(r,e,t,n,i){const s=zd[r],o=e[s.localFeatureName];if(i&&!s.isAvailableOnBasic)return!1;if(n){const a=this.getApiConfig(s.apiFeatureName,t);return a?.config===null?this.processFallbackFeature(r,o):a?.config?(o!==void 0&&this.addWarning(o,r),this.processApiFeature(r,a)):!1}return this.processFallbackFeature(r,o)},processApiFeature(r,e){return zd[r].processApi(e)},processFallbackFeature(r,e){return zd[r].processFallback(e)},async fetchRemoteFeatures(r){const e=r.basic??!1,t=r.features||{};this.localSettingsOverridden.clear();let n=null,i=!1;try{n=await _e.fetchProjectConfig(),i=n!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const s=i&&!e?Ge.DEFAULT_REMOTE_FEATURES:Ge.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of Uj){const a=this.processFeature(o,t,n,i,e);Object.assign(s,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),Ge.DEFAULT_REMOTE_FEATURES}if(i&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;Br.open({debugMessage:Yr.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(o)},"warning")}return s}};class $j{constructor(e){this.chainNamespaces=[],this.features={},this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(t,n)=>{if(t){const i=$.getCaipNetworks(t)?.find(a=>a.id===n);if(i)return i;const s=$.getNetworkData(t)?.caipNetwork;return s||$.getRequestedCaipNetworks(t).filter(a=>a.chainNamespace===t)?.[0]}return $.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const t=this.getCaipNetwork();if(t)return t.id},this.getCaipNetworks=t=>$.getCaipNetworks(t),this.getActiveChainNamespace=()=>$.state.activeChain,this.setRequestedCaipNetworks=(t,n)=>{$.setRequestedCaipNetworks(t,n)},this.getApprovedCaipNetworkIds=()=>$.getAllApprovedCaipNetworkIds(),this.getCaipAddress=t=>$.state.activeChain===t||!t?$.state.activeCaipAddress:$.state.chains.get(t)?.accountState?.caipAddress,this.setClientId=t=>{Ie.setClientId(t)},this.getProvider=t=>Ve.getProvider(t),this.getProviderType=t=>Ve.getProviderId(t),this.getPreferredAccountType=t=>qn(t),this.setCaipAddress=(t,n)=>{ye.setCaipAddress(t,n)},this.setBalance=(t,n,i)=>{ye.setBalance(t,n,i)},this.setProfileName=(t,n)=>{ye.setProfileName(t,n)},this.setProfileImage=(t,n)=>{ye.setProfileImage(t,n)},this.setUser=(t,n)=>{ye.setUser(t,n)},this.resetAccount=t=>{ye.resetAccount(t)},this.setCaipNetwork=t=>{$.setActiveCaipNetwork(t)},this.setCaipNetworkOfNamespace=(t,n)=>{$.setChainNetworkData(n,{caipNetwork:t})},this.setStatus=(t,n)=>{ye.setStatus(t,n),ae.isConnected()?Q.setConnectionStatus("connected"):Q.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=t=>$.state.chains.get(t)?.accountState?.address,this.setConnectors=t=>{const n=[...ae.state.allConnectors,...t];ae.setConnectors(n)},this.setConnections=(t,n)=>{Q.setConnections(t,n),de.setConnections(t,n)},this.fetchIdentity=t=>Ie.fetchIdentity(t),this.getReownName=t=>kl.getNamesForAddress(t),this.getConnectors=()=>ae.getConnectors(),this.getConnectorImage=t=>Ov.getConnectorImage(t),this.getConnections=t=>this.remoteFeatures.multiWallet?Ef.getConnectionsData(t).connections:(Br.open(Y.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=t=>this.remoteFeatures.multiWallet?Ef.getConnectionsData(t).recentConnections:(Br.open(Y.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async t=>{if(!this.remoteFeatures.multiWallet){Br.open(Y.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await de.switchConnection(t)},this.deleteConnection=t=>{if(!this.remoteFeatures.multiWallet){Br.open(Y.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}Q.deleteAddressFromConnection(t),de.syncStorageConnections()},this.setConnectedWalletInfo=(t,n)=>{const i=Ve.getProviderId(n),s=t?{...t,type:i}:void 0;ye.setConnectedWalletInfo(s,n)},this.getIsConnectedState=()=>!!$.state.activeCaipAddress,this.addAddressLabel=(t,n,i)=>{ye.addAddressLabel(t,n,i)},this.removeAddressLabel=(t,n)=>{ye.removeAddressLabel(t,n)},this.getAddress=t=>$.state.activeChain===t||!t?ye.state.address:$.state.chains.get(t)?.accountState?.address,this.setApprovedCaipNetworksData=t=>$.setApprovedCaipNetworksData(t),this.resetNetwork=t=>{$.resetNetwork(t)},this.addConnector=t=>{ae.addConnector(t)},this.resetWcConnection=()=>{de.resetWcConnection()},this.setAddressExplorerUrl=(t,n)=>{ye.setAddressExplorerUrl(t,n)},this.setSmartAccountDeployed=(t,n)=>{ye.setSmartAccountDeployed(t,n)},this.setPreferredAccountType=(t,n)=>{$.setAccountProp("preferredAccountType",t,n)},this.setEIP6963Enabled=t=>{Z.setEIP6963Enabled(t)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,t){const n=e?.map(s=>s.namespace).filter(s=>!!s);if(n?.length)return[...new Set(n)];const i=t?.map(s=>s.chainNamespace);return[...new Set(i)]}async initialize(e){if(this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),Z.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),this.remoteFeatures=await Bj.fetchRemoteFeatures(e),Z.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&Fp.setOnrampProviders(this.remoteFeatures.onramp),(Z.state.remoteFeatures?.email||Array.isArray(Z.state.remoteFeatures?.socials)&&Z.state.remoteFeatures?.socials.length>0)&&await this.checkAllowedOrigins(),Z.state.features?.reownAuthentication||Z.state.remoteFeatures?.reownAuthentication){const{ReownAuthentication:t}=await Nr(async()=>{const{ReownAuthentication:i}=await import("./features-GlrDLqZQ.js");return{ReownAuthentication:i}},[]),n=Z.state.siwx;n instanceof t||(n&&console.warn("ReownAuthentication option is enabled, SIWX configuration will be overridden."),Z.setSIWX(new t))}}async checkAllowedOrigins(){try{const e=await _e.fetchAllowedOrigins();if(!be.isClient())return;const t=window.location.origin;Us.isOriginAllowed(t,e,Os.DEFAULT_ALLOWED_ANCESTORS)||Br.open(Yr.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error))return;switch(e.message){case"RATE_LIMITED":Br.open(Yr.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const t=e.cause instanceof Error?e.cause:e;Br.open({displayMessage:Yr.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:Yr.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(t.message)},"error");break}}}}sendInitializeEvent(e){const{...t}=e;delete t.adapters,delete t.universalProvider,Qe.sendEvent({type:"track",event:"INITIALIZE",properties:{...t,networks:e.networks.map(n=>n.id),siweConfig:{options:e.siweConfig?.options||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&vn.setThemeMode(e.themeMode),e.themeVariables&&vn.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");$.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const t=this.getDefaultNetwork();t&&$.setActiveCaipNetwork(t)}initializeConnectionController(e){de.initialize(e.adapters??[]),de.setWcBasic(e.basic??!1)}initializeConnectorController(){ae.initialize(this.chainNamespaces)}initializeProjectSettings(e){Z.setProjectId(e.projectId),Z.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){Z.setDebug(e.debug!==!1),Z.setEnableWalletConnect(e.enableWalletConnect!==!1),Z.setEnableWalletGuide(e.enableWalletGuide!==!1),Z.setEnableWallets(e.enableWallets!==!1),Z.setEIP6963Enabled(e.enableEIP6963!==!1),Z.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),Z.setEnableReconnect(e.enableReconnect!==!1),Z.setEnableAuthLogger(e.enableAuthLogger!==!1),Z.setCustomRpcUrls(e.customRpcUrls),Z.setEnableEmbedded(e.enableEmbedded),Z.setAllWallets(e.allWallets),Z.setIncludeWalletIds(e.includeWalletIds),Z.setExcludeWalletIds(e.excludeWalletIds),Z.setFeaturedWalletIds(e.featuredWalletIds),Z.setTokens(e.tokens),Z.setTermsConditionsUrl(e.termsConditionsUrl),Z.setPrivacyPolicyUrl(e.privacyPolicyUrl),Z.setCustomWallets(e.customWallets),Z.setFeatures(e.features),Z.setAllowUnsupportedChain(e.allowUnsupportedChain),Z.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),Z.setPreferUniversalLinks(e.experimental_preferUniversalLinks),Z.setDefaultAccountTypes(e.defaultAccountTypes);const t=this.getDefaultMetaData();if(!e.metadata&&t&&(e.metadata=t),Z.setMetadata(e.metadata),Z.setDisableAppend(e.disableAppend),Z.setEnableEmbedded(e.enableEmbedded),Z.setSIWX(e.siwx),this.features=Z.state.features??{},!e.projectId){Br.open(Yr.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(e.adapters?.find(i=>i.namespace===Y.CHAIN.EVM)&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");Z.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return be.isClient()?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){const t=this.getActiveChainNamespace();if(t){const n=hc.getUnsupportedNetwork(`${t}:${e}`);$.setActiveCaipNetwork(n)}}getDefaultNetwork(){return hc.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){return hc.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId})}extendCaipNetworks(e){return hc.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const t=e.networks.find(i=>i.id===e.defaultNetwork?.id);return t?hc.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectNamespace(e,t){try{this.setLoading(!0,e);let n={connections:[]};const i=this.getAdapter(e);return($.state.chains.get(e)?.accountState?.caipAddress||!Z.state.enableReconnect)&&i?.disconnect&&(n=await i.disconnect({id:t})),this.setLoading(!1,e),n}catch(n){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${n.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{const e=$.state.activeChain,t=this.getAdapter(e),n=this.getCaipNetwork(e)?.id,i=de.getConnections(e),s=this.remoteFeatures.multiWallet,o=i.length>0;if(!t)throw new Error("Adapter not found");const a=await t.connectWalletConnect(n);(!o||!s)&&this.close(),this.setClientId(a?.clientId||null),Q.setConnectedNamespaces([...$.state.chains.keys()]),await this.syncWalletConnectAccount(),await Ln.initializeIfEnabled()},connectExternal:async e=>{const t=await this.onConnectExternal(e);return await this.connectInactiveNamespaces(e,t),t?{address:t.address}:void 0},reconnectExternal:async({id:e,info:t,type:n,provider:i})=>{const s=$.state.activeChain,o=this.getAdapter(s);if(!s)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o?.reconnect&&(await o?.reconnect({id:e,info:t,type:n,provider:i,chainId:this.getCaipNetwork()?.id}),Q.addConnectedNamespace(s),this.syncConnectedWalletInfo(s))},disconnect:async e=>{const{id:t,chainNamespace:n,initialDisconnect:i}=e||{},s=n||$.state.activeChain,o=ae.getConnectorId(s),a=t===Y.CONNECTOR_ID.AUTH||o===Y.CONNECTOR_ID.AUTH,c=t===Y.CONNECTOR_ID.WALLET_CONNECT||o===Y.CONNECTOR_ID.WALLET_CONNECT;try{const l=Array.from($.state.chains.keys());let u=n?[n]:l;(c||a)&&(u=l);const d=u.map(async w=>{const b=ae.getConnectorId(w),y=await this.disconnectNamespace(w,t||b);y&&(a&&Q.deleteConnectedSocialProvider(),y.connections.forEach(C=>{Q.addDisconnectedConnectorId(C.connectorId,w)})),i&&this.onDisconnectNamespace({chainNamespace:w,closeModal:!1})}),p=await Promise.allSettled(d);Ke.resetSend(),de.resetWcConnection(),Ln.getSIWX()?.signOutOnDisconnect&&await Ln.clearSessions(),ae.setFilterByNamespace(void 0),de.syncStorageConnections();const x=p.filter(w=>w.status==="rejected");if(x.length>0)throw new Error(x.map(w=>w.reason.message).join(", "));Qe.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:n||"all"}})}catch(l){throw new Error(`Failed to disconnect chains: ${l.message}`)}},checkInstalled:e=>e?e.some(t=>!!window.ethereum?.[String(t)]):!!window.ethereum,signMessage:async e=>{const t=$.state.activeChain,n=this.getAdapter($.state.activeChain);if(!t)throw new Error("signMessage: namespace not found");if(!n)throw new Error("signMessage: adapter not found");return(await n?.signMessage({message:e,address:ye.state.address,provider:Ve.getProvider(t)}))?.signature||""},sendTransaction:async e=>{const t=e.chainNamespace;if(!t)throw new Error("sendTransaction: namespace not found");if(Ge.SEND_SUPPORTED_NAMESPACES.includes(t)){const n=this.getAdapter(t);if(!n)throw new Error("sendTransaction: adapter not found");const i=Ve.getProvider(t);return(await n?.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:i}))?.hash||""}return""},estimateGas:async e=>{const t=e.chainNamespace;if(t===Y.CHAIN.EVM){const n=this.getAdapter(t);if(!n)throw new Error("estimateGas: adapter is required but got undefined");const i=Ve.getProvider(t),s=this.getCaipNetwork();if(!s)throw new Error("estimateGas: caipNetwork is required but got undefined");return(await n?.estimateGas({...e,provider:i,caipNetwork:s}))?.gas||0n}return 0n},getEnsAvatar:async()=>{const e=$.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");return await this.syncIdentity({address:ye.state.address,chainId:Number(this.getCaipNetwork()?.id),chainNamespace:e}),ye.state.profileImage||!1},getEnsAddress:async e=>await Us.resolveReownName(e),writeContract:async e=>{const t=$.state.activeChain,n=this.getAdapter(t);if(!t)throw new Error("writeContract: namespace is required but got undefined");if(!n)throw new Error("writeContract: adapter is required but got undefined");const i=this.getCaipNetwork(),s=this.getCaipAddress(),o=Ve.getProvider(t);if(!i||!s)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");return(await n?.writeContract({...e,caipNetwork:i,provider:o,caipAddress:s}))?.hash},parseUnits:(e,t)=>{const n=this.getAdapter($.state.activeChain);if(!n)throw new Error("parseUnits: adapter is required but got undefined");return n?.parseUnits({value:e,decimals:t})??0n},formatUnits:(e,t)=>{const n=this.getAdapter($.state.activeChain);if(!n)throw new Error("formatUnits: adapter is required but got undefined");return n?.formatUnits({value:e,decimals:t})??"0"},getCapabilities:async e=>{const t=this.getAdapter($.state.activeChain);if(!t)throw new Error("getCapabilities: adapter is required but got undefined");return await t?.getCapabilities(e)},grantPermissions:async e=>{const t=this.getAdapter($.state.activeChain);if(!t)throw new Error("grantPermissions: adapter is required but got undefined");return await t?.grantPermissions(e)},revokePermissions:async e=>{const t=this.getAdapter($.state.activeChain);if(!t)throw new Error("revokePermissions: adapter is required but got undefined");return t?.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{const t=this.getAdapter($.state.activeChain);if(!t)throw new Error("walletGetAssets: adapter is required but got undefined");return await t?.walletGetAssets(e)??{}},updateBalance:e=>{const t=this.getCaipNetwork(e);!t||!ye.state.address||this.updateNativeBalance(ye.state.address,t?.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},de.setClient(this.connectionControllerClient)}async onConnectExternal(e){const t=$.state.activeChain,n=e.chain||t,i=this.getAdapter(n);let s=!0;if(e.type===Ye.CONNECTOR_TYPE_AUTH&&Y.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(d=>ae.getConnectorId(d)===Y.CONNECTOR_ID.AUTH)&&e.chain!==t&&(s=!1),e.chain&&e.chain!==t&&!e.caipNetwork){const l=this.getCaipNetworks().find(u=>u.chainNamespace===e.chain);l&&s&&this.setCaipNetwork(l)}if(!n)throw new Error("connectExternal: namespace not found");if(!i)throw new Error("connectExternal: adapter not found");const o=this.getCaipNetwork(n),a=e.caipNetwork||o,c=await i.connect({id:e.id,address:e.address,info:e.info,type:e.type,provider:e.provider,socialUri:e.socialUri,chainId:e.caipNetwork?.id||o?.id,rpcUrl:e.caipNetwork?.rpcUrls?.default?.http?.[0]||o?.rpcUrls?.default?.http?.[0]});if(c)return Q.addConnectedNamespace(n),this.syncProvider({...c,chainNamespace:n}),this.setStatus("connected",n),this.syncConnectedWalletInfo(n),Q.removeDisconnectedConnectorId(e.id,n),{address:c.address,connectedCaipNetwork:a}}async connectInactiveNamespaces(e,t){const n=e.type===Ye.CONNECTOR_TYPE_AUTH,i=Ar.getOtherAuthNamespaces(t?.connectedCaipNetwork?.chainNamespace),s=$.state.activeCaipNetwork,o=this.getAdapter(s?.chainNamespace),a=Ve.getProvider(s?.chainNamespace);n&&(await Promise.all(i.map(async c=>{try{const l=Ve.getProvider(c),u=this.getCaipNetwork(c);await this.getAdapter(c)?.connect({...e,provider:l,socialUri:void 0,chainId:u?.id,rpcUrl:u?.rpcUrls?.default?.http?.[0]})&&(Q.addConnectedNamespace(c),Q.removeDisconnectedConnectorId(e.id,c),this.setStatus("connected",c),this.syncConnectedWalletInfo(c))}catch(l){Br.warn(Yr.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.displayMessage,Yr.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.debugMessage(c,l instanceof Error?l.message:void 0),Yr.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.code)}})),s&&await o?.switchNetwork({caipNetwork:s,provider:a,providerType:e.type}))}getApprovedCaipNetworksData(){if(Ve.getProviderId($.state.activeChain)===Ye.CONNECTOR_TYPE_WALLET_CONNECT){const t=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:this.universalProvider?.session?.peer?.metadata.name==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(t)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;const t=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const i=Ve.getProvider(t),s=Ve.getProviderId(t);if(e.chainNamespace===$.state.activeChain)await this.getAdapter(t)?.switchNetwork({caipNetwork:e,provider:i,providerType:s});else if(this.setCaipNetwork(e),s===Ye.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(t);o&&this.syncAccount({address:o,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(t=>{const n=t.chains||[],i=t.accounts.map(s=>{const{chainId:o,chainNamespace:a}=on.parseCaipAddress(s);return`${a}:${o}`});return Array.from(new Set([...n,...i]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((t,n)=>{const i=e?.find(s=>s.namespace===n);return i?(i.construct({namespace:n,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),t[n]=i):t[n]=new Mj({namespace:n,networks:this.getCaipNetworks()}),t},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e),await this.chainAdapters?.[e].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){this.getAdapter(e)?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const t=this.getAdapter(e);if(!t)return;const n=Q.getConnectionStatus();Z.state.enableReconnect===!1?this.setStatus("disconnected",e):n==="connected"?this.setStatus("connecting",e):n==="disconnected"?(Q.clearAddressCache(),this.setStatus(n,e)):this.setStatus(n,e),t.on("switchNetwork",({address:i,chainId:s})=>{const o=this.getCaipNetworks().find(l=>l.id.toString()===s.toString()||l.caipNetworkId.toString()===s.toString()),a=$.state.activeChain===e,c=$.state.chains.get(e)?.accountState?.address;if(o){const l=a&&i?i:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(s)}),t.on("disconnect",()=>{const i=this.remoteFeatures.multiWallet,s=Array.from(de.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:e,closeModal:!i||s.length===0})}),t.on("connections",i=>{this.setConnections(i,e)}),t.on("pendingTransactions",()=>{const i=ye.state.address,s=$.state.activeCaipNetwork;!i||!s?.id||this.updateNativeBalance(i,s.id,s.chainNamespace)}),t.on("accountChanged",({address:i,chainId:s,connector:o})=>{const a=$.state.activeChain===e;o?.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e));const c=$.getNetworkData(e)?.caipNetwork?.id,l=s||c;a&&l?this.syncAccount({address:i,chainId:l,chainNamespace:e}):!a&&l?(this.syncAccountInfo(i,l,e),this.syncBalance({address:i,chainId:l,chainNamespace:e})):this.syncAccountInfo(i,s,e),Q.addConnectedNamespace(e)})}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&await this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>de.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async reconnectWalletConnect(){await this.syncWalletConnectAccount();const e=this.getAddress();Qe.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:e,properties:{method:be.isMobile()?"mobile":"qrcode",name:this.universalProvider?.session?.peer?.metadata?.name||"Unknown",reconnect:!0}})}async syncNamespaceConnection(e){try{e===Y.CHAIN.EVM&&be.isSafeApp()&&ae.setConnectorId(Y.CONNECTOR_ID.SAFE,e);const t=ae.getConnectorId(e);switch(this.setStatus("connecting",e),t){case Y.CONNECTOR_ID.WALLET_CONNECT:await this.reconnectWalletConnect();break;case Y.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){const{chainNamespace:t,closeModal:n}=e||{};$.resetAccount(t),$.resetNetwork(t),Q.removeConnectedNamespace(t);const i=Array.from($.state.chains.keys());(t?[t]:i).forEach(o=>Q.addDisconnectedConnectorId(ae.getConnectorId(o)||"",o)),ae.removeConnectorId(t),Ve.resetChain(t),this.setUser(void 0,t),this.setStatus("disconnected",t),this.setConnectedWalletInfo(void 0,t),n!==!1&&He.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{const t=this.getCaipAddress(e),n=this.getCaipNetwork(e);return this.chainAdapters?.[e].syncConnections({connectToFirstConnector:!t,caipNetwork:n,getConnectorStorageInfo(i){const o=Q.getConnections()[e]??[];return{hasDisconnected:Q.isConnectorDisconnected(i,e),hasConnected:o.some(a=>Ar.isLowerCaseMatch(a.connectorId,i))}}})}))}async syncAdapterConnection(e){const t=this.getAdapter(e),n=ae.getConnectorId(e),i=this.getCaipNetwork(e),o=ae.getConnectors(e).find(a=>a.id===n);try{if(!t||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!i?.id)throw new Error("CaipNetwork not found");const a=await t?.syncConnection({namespace:e,id:o.id,chainId:i.id,rpcUrl:i?.rpcUrls?.default?.http?.[0]});a?(this.syncProvider({...a,chainNamespace:e}),await this.syncAccount({...a,chainNamespace:e}),this.setStatus("connected",e),Qe.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:a.address,properties:{method:"browser",name:o.info?.name||o.name||"Unknown",reconnect:!0}})):this.setStatus("disconnected",e)}catch{this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){const e=Object.keys(this.universalProvider?.session?.namespaces||{}),t=this.chainNamespaces.map(async n=>{const i=this.getAdapter(n);if(!i)return;const s=this.universalProvider?.session?.namespaces?.[n]?.accounts||[],o=$.state.activeCaipNetwork?.id,a=s.find(c=>{const{chainId:l}=on.parseCaipAddress(c);return l===o?.toString()})||s[0];if(a){const c=on.validateCaipAddress(a),{chainId:l,address:u}=on.parseCaipAddress(c);if(Ve.setProviderId(n,Ye.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&$.state.activeCaipNetwork&&i.namespace!==Y.CHAIN.EVM){const d=i.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:$.state.activeCaipNetwork});Ve.setProvider(n,d)}else Ve.setProvider(n,this.universalProvider);ae.setConnectorId(Y.CONNECTOR_ID.WALLET_CONNECT,n),Q.addConnectedNamespace(n),await this.syncAccount({address:u,chainId:l,chainNamespace:n})}else e.includes(n)&&this.setStatus("disconnected",n);this.syncConnectedWalletInfo(n),await $.setApprovedCaipNetworksData(n)});await Promise.all(t)}syncProvider({type:e,provider:t,id:n,chainNamespace:i}){Ve.setProviderId(i,e),Ve.setProvider(i,t),ae.setConnectorId(n,i)}async syncAccount(e){const t=e.chainNamespace===$.state.activeChain,n=$.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:i,chainId:s,chainNamespace:o}=e,{chainId:a}=Q.getActiveNetworkProps(),c=s||a,l=$.state.activeCaipNetwork?.name===Y.UNSUPPORTED_NETWORK_NAME,u=$.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let d=this.getCaipNetworks().find(w=>w.id.toString()===c.toString()),p=this.getCaipNetworks().find(w=>w.chainNamespace===o);if(!u&&!d&&!p){const w=this.getApprovedCaipNetworkIds()||[],b=w.find(C=>on.parseCaipNetworkId(C)?.chainId===c.toString()),y=w.find(C=>on.parseCaipNetworkId(C)?.chainNamespace===o);d=this.getCaipNetworks().find(C=>C.caipNetworkId===b),p=this.getCaipNetworks().find(C=>C.caipNetworkId===y||"deprecatedCaipNetworkId"in C&&C.deprecatedCaipNetworkId===y)}const x=d||p;x?.chainNamespace===$.state.activeChain?Z.state.enableNetworkSwitch&&!Z.state.allowUnsupportedChain&&$.state.activeCaipNetwork?.name===Y.UNSUPPORTED_NETWORK_NAME?$.showUnsupportedChainUI():this.setCaipNetwork(x):t||n&&this.setCaipNetworkOfNamespace(n,o),this.syncConnectedWalletInfo(o),Ar.isLowerCaseMatch(i,ye.state.address)||this.syncAccountInfo(i,x?.id,o),t?await this.syncBalance({address:i,chainId:x?.id,chainNamespace:o}):await this.syncBalance({address:i,chainId:n?.id,chainNamespace:o}),this.syncIdentity({address:i,chainId:s,chainNamespace:o})}}async syncAccountInfo(e,t,n){const i=this.getCaipAddress(n),s=t||i?.split(":")[1];if(!s)return;const o=`${n}:${s}:${e}`;this.setCaipAddress(o,n),await this.syncIdentity({address:e,chainId:s,chainNamespace:n})}async syncReownName(e,t){try{const n=await this.getReownName(e);if(n[0]){const i=n[0];this.setProfileName(i.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){const t=ae.getConnectorId(e),n=Ve.getProviderId(e);if(n===Ye.CONNECTOR_TYPE_ANNOUNCED||n===Ye.CONNECTOR_TYPE_INJECTED){if(t){const s=this.getConnectors().find(o=>{const a=o.id===t,c=o.info?.rdns===t,l=o.connectors?.some(u=>u.id===t||u.info?.rdns===t);return a||c||!!l});if(s){const{info:o,name:a,imageUrl:c}=s,l=c||this.getConnectorImage(s);this.setConnectedWalletInfo({name:a,icon:l,...o},e)}}}else if(n===Ye.CONNECTOR_TYPE_WALLET_CONNECT){const i=Ve.getProvider(e);i?.session&&this.setConnectedWalletInfo({...i.session.peer.metadata,name:i.session.peer.metadata.name,icon:i.session.peer.metadata.icons?.[0]},e)}else if(t&&(t===Y.CONNECTOR_ID.COINBASE_SDK||t===Y.CONNECTOR_ID.COINBASE)){const i=this.getConnectors().find(c=>c.id===t),s=i?.name||"Coinbase Wallet",o=i?.imageUrl||this.getConnectorImage(i),a=i?.info;this.setConnectedWalletInfo({...a,name:s,icon:o},e)}}async syncBalance(e){!Nv.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(n=>n.id.toString()===e.chainId?.toString())||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,t,n){const i=this.getAdapter(n),s=$.getCaipNetworkByNamespace(n,t);if(i){const o=await i.getBalance({address:e,chainId:t,caipNetwork:s,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,n),o}}async initializeUniversalAdapter(){const e=N$.createLogger((n,...i)=>{n&&this.handleAlertError(n),console.error(...i)}),t={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:e};Z.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await C$.init(t),Z.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{Us.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:t=>{de.setUri(t)},onConnect:t=>{const{address:n}=be.getAccount(t[0]);de.finalizeWcConnection(n)},onDisconnect:()=>{$.state.noAdapters&&this.resetAccount(e),de.resetWcConnection()},onChainChanged:t=>{const n=$.state.activeChain,i=n&&ae.state.activeConnectorIds[n]===Y.CONNECTOR_ID.WALLET_CONNECT;if(n===e&&($.state.noAdapters||i)){const s=this.getCaipNetworks().find(a=>a.id.toString()===t.toString()||a.caipNetworkId.toString()===t.toString()),o=this.getCaipNetwork();if(!s){this.setUnsupportedNetwork(t);return}o?.id.toString()!==s?.id.toString()&&o?.chainNamespace===s?.chainNamespace&&this.setCaipNetwork(s)}},onAccountsChanged:t=>{const n=$.state.activeChain,i=n&&ae.state.activeConnectorIds[n]===Y.CONNECTOR_ID.WALLET_CONNECT;if(n===e&&($.state.noAdapters||i)){const s=t?.[0];s&&this.syncAccount({address:s.address,chainId:s.chainId,chainNamespace:s.chainNamespace})}}})})}createUniversalProvider(){return!this.universalProviderInitPromise&&be.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){Qe.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const t=Object.entries(Yr.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[n,i]=t??[],{message:s,alertErrorKey:o}=i??{};if(n&&s&&!this.reportedAlertErrors[n]){const a=Yr.ALERT_ERRORS[o];a&&(Br.open(a,"error"),this.reportedAlertErrors[n]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;const t=e.namespace;if(!t)return;this.createClients();const n=e;n.namespace=t,n.construct({namespace:t,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(t)||this.chainNamespaces.push(t),this.chainAdapters&&(this.chainAdapters[t]=n)}async open(e){if(await this.injectModalUi(),e?.uri&&de.setUri(e.uri),e?.arguments)switch(e?.view){case"Swap":return He.open({...e,data:{swap:e.arguments}})}return He.open(e)}async close(){await this.injectModalUi(),He.close()}setLoading(e,t){He.setLoading(e,t)}async disconnect(e){await de.disconnect({namespace:e})}getSIWX(){return Z.state.siwx}getError(){return""}getChainId(){return $.state.activeCaipNetwork?.id}async switchNetwork(e){const t=this.getCaipNetworks().find(n=>n.id===e.id);if(!t){Br.open(Yr.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await $.switchActiveNetwork(t)}getWalletProvider(){return $.state.activeChain?Ve.state.providers[$.state.activeChain]:null}getWalletProviderType(){return Ve.getProviderId($.state.activeChain)}subscribeProviders(e){return Ve.subscribeProviders(e)}getThemeMode(){return vn.state.themeMode}getThemeVariables(){return vn.state.themeVariables}setThemeMode(e){vn.setThemeMode(e),Fg(vn.state.themeMode)}setTermsConditionsUrl(e){Z.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){Z.setPrivacyPolicyUrl(e)}setThemeVariables(e){vn.setThemeVariables(e),Nj(vn.state.themeVariables)}subscribeTheme(e){return vn.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?de.subscribe(e):(Br.open(Y.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){return e?$.state.chains.get(e)?.accountState?.connectedWalletInfo:ye.state.connectedWalletInfo}getAccount(e){const t=e||$.state.activeChain,n=ae.getAuthConnector(t),i=$.getAccountData(t),s=Q.getConnectedConnectorId($.state.activeChain),o=de.getConnections(t);if(!t)throw new Error("AppKit:getAccount - namespace is required");const a=o.flatMap(c=>c.accounts.map(({address:l,type:u,publicKey:d})=>be.createAccount(t,l,u||"eoa",d)));if(i)return{allAccounts:a,caipAddress:i.caipAddress,address:be.getPlainAddress(i.caipAddress),isConnected:!!i.caipAddress,status:i.status,embeddedWalletInfo:n&&s===Y.CONNECTOR_ID.AUTH?{user:i.user?{...i.user,username:Q.getConnectedSocialUsername()}:void 0,authProvider:i.socialProvider||"email",accountType:qn(t),isSmartAccountDeployed:!!i.smartAccountDeployed}:void 0}}subscribeAccount(e,t){const n=()=>{const i=this.getAccount(t);i&&e(i)};t?$.subscribeChainProp("accountState",n,t):$.subscribe(n),ae.subscribe(n)}subscribeNetwork(e){return $.subscribe(({activeCaipNetwork:t})=>{e({caipNetwork:t,chainId:t?.id,caipNetworkId:t?.caipNetworkId})})}subscribeWalletInfo(e,t){return t?ye.subscribeKey("connectedWalletInfo",e,t):ye.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){ye.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){$.subscribeKey("activeCaipNetwork",e)}getState(){return Ni.state}getRemoteFeatures(){return Z.state.remoteFeatures}subscribeState(e){return Ni.subscribe(e)}subscribeRemoteFeatures(e){return Z.subscribeKey("remoteFeatures",e)}showErrorMessage(e){Xi.showError(e)}showSuccessMessage(e){Xi.showSuccess(e)}getEvent(){return{...Qe.state}}subscribeEvents(e){return Qe.subscribe(e)}replace(e){Te.replace(e)}redirect(e){Te.push(e)}popTransactionStack(e){Te.popTransactionStack(e)}isOpen(){return He.state.open}isTransactionStackEmpty(){return Te.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){Z.setFeatures(e)}updateRemoteFeatures(e){Z.setRemoteFeatures(e)}updateOptions(e){const n={...Z.state||{},...e};Z.setOptions(n)}setConnectMethodsOrder(e){Z.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){Z.setWalletFeaturesOrder(e)}setCollapseWallets(e){Z.setCollapseWallets(e)}setSocialsOrder(e){Z.setSocialsOrder(e)}getConnectMethodsOrder(){return Ug.getConnectOrderMethod(Z.state.features,ae.getConnectors())}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const n=this.extendCaipNetwork(t,this.options);this.getCaipNetworks().find(i=>i.id===n.id)||$.addNetwork(n)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(i=>i.id===t)&&$.removeNetwork(e,t)}}let ox=!1;class Lj extends $j{async onAuthProviderConnected(e){const t=Ar.userChainIdToChainNamespace(e?.chainId);if(e.message&&e.signature&&e.siwxMessage&&await Ln.addEmbeddedWalletSession({chainId:e.siwxMessage.chainId,accountAddress:e.address,notBefore:e.siwxMessage.notBefore,statement:e.siwxMessage.statement,resources:e.siwxMessage.resources,requestId:e.siwxMessage.requestId,issuedAt:e.siwxMessage.issuedAt,domain:e.siwxMessage.domain,uri:e.siwxMessage.uri,version:e.siwxMessage.version,nonce:e.siwxMessage.nonce},e.message,e.signature),!t)throw new Error("AppKit:onAuthProviderConnected - namespace is required");const n=t===Y.CHAIN.EVM?`eip155:${e.chainId}:${e.address}`:`${e.chainId}:${e.address}`,i=Z.state.defaultAccountTypes[t],s=qn(t),o=e.preferredAccountType||s||i;this.setCaipAddress(n,t);const{signature:a,siwxMessage:c,message:l,...u}=e;this.setUser({...ye.state.user||{},...u},t),this.setSmartAccountDeployed(!!e.smartAccountDeployed,t),this.setPreferredAccountType(o,t),this.setLoading(!1,t)}setupAuthConnectorListeners(e){e.onRpcRequest(t=>{Fn.checkIfRequestExists(t)?Fn.checkIfRequestIsSafe(t)||this.handleUnsafeRPCRequest():(this.open(),console.error(_r.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:t.method}),setTimeout(()=>{this.showErrorMessage(_r.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((t,n)=>{const i=Fn.checkIfRequestIsSafe(n),s=ye.state.address,o=$.state.activeCaipNetwork;i||(s&&o?.id&&this.updateNativeBalance(s,o.id,o.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{const t=$.state.activeChain;if(!t)throw new Error("AppKit:onNotConnected - namespace is required");ae.getConnectorId(t)===Y.CONNECTOR_ID.AUTH&&(this.setCaipAddress(void 0,t),this.setLoading(!1,t))}),e.onConnect(this.onAuthProviderConnected.bind(this)),e.onSocialConnected(this.onAuthProviderConnected.bind(this)),e.onSetPreferredAccount(({address:t,type:n})=>{const i=$.state.activeChain;if(!i)throw new Error("AppKit:onSetPreferredAccount - namespace is required");t&&this.setPreferredAccountType(n,i)})}async syncAuthConnectorTheme(e){if(!e)return;const t=vn.getSnapshot(),n=Z.getSnapshot();await Promise.all([e.syncDappData({metadata:n.metadata,sdkVersion:n.sdkVersion,projectId:n.projectId,sdkType:n.sdkType}),e.syncTheme({themeMode:t.themeMode,themeVariables:t.themeVariables,w3mThemeVariables:Ql(t.themeVariables,t.themeMode)})])}async syncAuthConnector(e,t){const n=Y.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(t),i=t===$.state.activeChain;if(!n)return;this.setLoading(!0,t);const s=e.getLoginEmailUsed();this.setLoading(s,t),s&&this.setStatus("connecting",t);const o=e.getEmail(),a=e.getUsername();this.setUser({...ye.state?.user||{},username:a,email:o},t),this.setupAuthConnectorListeners(e);const{isConnected:c}=await e.isConnected();if(await this.syncAuthConnectorTheme(e),t&&n&&i){const l=await e.getSmartAccountEnabledNetworks();if($.setSmartAccountEnabledNetworks(l?.smartAccountEnabledNetworks||[],t),c&&this.connectionControllerClient?.connectExternal){await this.connectionControllerClient?.connectExternal({id:Y.CONNECTOR_ID.AUTH,info:{name:Y.CONNECTOR_ID.AUTH},type:Ye.CONNECTOR_TYPE_AUTH,provider:e,chainId:$.getNetworkData(t)?.caipNetwork?.id,chain:t}),this.setStatus("connected",t);const u=Q.getConnectedSocialProvider();u?Qe.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",address:ye.state.address,properties:{provider:u,reconnect:!0}}):Qe.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:ye.state.address,properties:{method:"email",name:this.universalProvider?.session?.peer?.metadata?.name||"Unknown",reconnect:!0}})}else ae.getConnectorId(t)===Y.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",t),Q.removeConnectedNamespace(t))}this.setLoading(!1,t)}async checkExistingTelegramSocialConnection(e){try{if(!be.isTelegram())return;const t=Q.getTelegramSocialProvider();if(!t||!be.isClient())return;const i=new URL(window.location.href).searchParams.get("result_uri");if(!i)return;ye.setSocialProvider(t,e),await this.authProvider?.init();const s=ae.getAuthConnector();t&&s&&(this.setLoading(!0,e),await de.connectExternal({id:s.id,type:s.type,socialUri:i},s.chain),Q.setConnectedSocialProvider(t),Q.removeTelegramSocialProvider(),Qe.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:t}}))}catch(t){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",t)}try{const t=new URL(window.location.href);t.searchParams.delete("result_uri"),window.history.replaceState({},document.title,t.toString())}catch(t){console.error("tma social login failed",t)}}createAuthProvider(e){if(!Y.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const n=this.remoteFeatures?.email,i=Array.isArray(this.remoteFeatures?.socials)&&this.remoteFeatures.socials.length>0,s=n||i,a=Ar.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&this.options?.projectId&&s&&(this.authProvider=Hl.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:this.getCaipNetwork(a)?.caipNetworkId,abortController:Yr.EmbeddedWalletAbortController,onTimeout:l=>{l==="iframe_load_failed"?Br.open(Yr.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):l==="iframe_request_timeout"?Br.open(Yr.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):l==="unverified_domain"&&Br.open(Yr.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:l=>Nl(l),getCaipNetworks:l=>$.getCaipNetworks(l)}),Ni.subscribeOpen(l=>{!l&&this.isTransactionStackEmpty()&&this.authProvider?.rejectRpcRequests()}));const c=e===$.state.activeChain&&Z.state.enableReconnect;Z.state.enableReconnect===!1?this.syncAuthConnectorTheme(this.authProvider):this.authProvider&&c&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){this.createAuthProvider(e),this.authProvider&&this.chainAdapters?.[e]?.setAuthProvider?.(this.authProvider)}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&_e.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){if(!e)return;const t=$.state.activeChain,n=e.chainNamespace,i=this.getAddressByChainNamespace(n);if(n===t&&i){const o=this.getAdapter(n),a=Ve.getProvider(n),c=Ve.getProviderId(n);await o?.switchNetwork({caipNetwork:e,provider:a,providerType:c}),this.setCaipNetwork(e)}else{const a=Ve.getProviderId(t)===Ye.CONNECTOR_TYPE_AUTH,c=Ve.getProviderId(n),l=c===Ye.CONNECTOR_TYPE_AUTH,u=Y.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n);if(!n)throw new Error("AppKit:switchCaipNetwork - networkNamespace is required");if((a&&c===void 0||l)&&u)try{$.state.activeChain=e.chainNamespace,i?await this.getAdapter(n)?.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:c}):await this.connectionControllerClient?.connectExternal?.({id:Y.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:n,chainId:e.id,type:Ye.CONNECTOR_TYPE_AUTH,caipNetwork:e}),this.setCaipNetwork(e)}catch{await this.getAdapter(n)?.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:c})}else if(c===Ye.CONNECTOR_TYPE_WALLET_CONNECT){if(!$.state.noAdapters){const d=this.getAdapter(n),p=Ve.getProvider(n),x=Ve.getProviderId(n);await d?.switchNetwork({caipNetwork:e,provider:p,providerType:x})}this.setCaipNetwork(e),this.syncWalletConnectAccount()}else this.setCaipNetwork(e),i&&this.syncAccount({address:i,chainId:e.id,chainNamespace:n})}}async initialize(e){await super.initialize(e),this.chainNamespaces?.forEach(t=>{this.createAuthProviderForAdapter(t)}),await this.injectModalUi(),Ni.set({initialized:!0})}async syncIdentity({address:e,chainId:t,chainNamespace:n}){const i=`${n}:${t}`;if(this.caipNetworks?.find(a=>a.caipNetworkId===i)?.testnet){this.setProfileName(null,n),this.setProfileImage(null,n);return}const o=ae.getConnectorId(n)===Y.CONNECTOR_ID.AUTH;try{const{name:a,avatar:c}=await this.fetchIdentity({address:e});!a&&o?await this.syncReownName(e,n):(this.setProfileName(a,n),this.setProfileImage(c,n))}catch{t!==1&&this.setProfileImage(null,n)}}syncConnectedWalletInfo(e){const t=Ve.getProviderId(e);if(t===Ye.CONNECTOR_TYPE_AUTH){const n=this.authProvider;if(n){const i=Q.getConnectedSocialProvider()??"email",s=n.getEmail()??n.getUsername();this.setConnectedWalletInfo({name:t,identifier:s,social:i},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(be.isClient()&&!ox)try{const e={...Ge.DEFAULT_FEATURES,...this.options.features},t=this.remoteFeatures;if(await this.loadModalComponents(e,t),be.isClient()&&!document.querySelector("w3m-modal")){const i=document.createElement("w3m-modal");!Z.state.disableAppend&&!Z.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",i)}ox=!0}catch(e){console.error("Error injecting modal UI:",e)}}async loadModalComponents(e,t){if(!be.isClient())return;const n=[];(t.email||t.socials&&t.socials.length>0)&&n.push(Nr(()=>import("./embedded-wallet-tzMmeq4m.js"),__vite__mapDeps([2,3,4,5,6,7,8,9,10,11,12,13,14]))),t.email&&n.push(Nr(()=>import("./email-k_qrNLKJ.js"),__vite__mapDeps([15,3,16,13,7,12,5,6,11,17,9]))),t.socials&&n.push(Nr(()=>import("./socials-PyxQvOiF.js"),__vite__mapDeps([18,3,5,19,6,20,12,21,11,7,22,4,23]))),t.swaps&&t.swaps.length>0&&n.push(Nr(()=>import("./swaps-C56Z5MXw.js"),__vite__mapDeps([24,3,11,7,12,5,25,26,27,23,28,4,9,6]))),e.send&&n.push(Nr(()=>import("./send-C_0PhHCV.js"),__vite__mapDeps([29,3,11,7,12,5,6,30,13,28,4,23,27,9,31,32,33]))),e.receive&&n.push(Nr(()=>import("./receive-Wk-3rqoV.js"),__vite__mapDeps([34,3,5,4,22]))),t.onramp&&t.onramp.length>0&&n.push(Nr(()=>import("./onramp-CXav3Na5.js"),__vite__mapDeps([35,3,5,36,7,19,6,4,37,38,13,30,11,12,21,39,9]))),t.payWithExchange&&n.push(Nr(()=>import("./pay-with-exchange-OXDisRyT.js"),__vite__mapDeps([40,3,11,7,10,4,5,36,23,39,12,9,6,13,31,32]))),t.activity&&n.push(Nr(()=>import("./transactions-BXmHuJwv.js"),__vite__mapDeps([41,3,42,12,5,13,4,23]))),(e.pay||t.payments)&&n.push(Nr(()=>import("./index-C-EC7NX3.js"),__vite__mapDeps([43,3,5,11,7,44,4,12,10,36,32,21]))),t.emailCapture&&n.push(Nr(()=>import("./data-capture-Ccl8rDQd.js"),__vite__mapDeps([45,3,16,13,7,46]))),await Promise.all([...n,Nr(()=>import("./index-BWfdoXnG.js"),__vite__mapDeps([47,3,5,4,7,33,12,48,38,13,30,8,10,36,11,44,42,23,31,25,26,32,6,9,17,19,20,21,22,14,37])),Nr(()=>import("./w3m-modal-BuPrIOmb.js"),__vite__mapDeps([49,3,5,10,4,8,7,12,26,48,38,13,30,27]))])}}const Fj="1.8.1";function jj(r){return new Lj({...r,sdkVersion:be.generateSdkVersion(r.adapters??[],"html",Fj)})}var df={exports:{}};const qj={},Hj=Object.freeze(Object.defineProperty({__proto__:null,default:qj},Symbol.toStringTag,{value:"Module"})),Wj=nr(Hj);var zj=df.exports,ax;function Kj(){return ax||(ax=1,(function(r){(function(e,t){function n(_,f){if(!_)throw new Error(f||"Assertion failed")}function i(_,f){_.super_=f;var h=function(){};h.prototype=f.prototype,_.prototype=new h,_.prototype.constructor=_}function s(_,f,h){if(s.isBN(_))return _;this.negative=0,this.words=null,this.length=0,this.red=null,_!==null&&((f==="le"||f==="be")&&(h=f,f=10),this._init(_||0,f||10,h||"be"))}typeof e=="object"?e.exports=s:t.BN=s,s.BN=s,s.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=Wj.Buffer}catch{}s.isBN=function(f){return f instanceof s?!0:f!==null&&typeof f=="object"&&f.constructor.wordSize===s.wordSize&&Array.isArray(f.words)},s.max=function(f,h){return f.cmp(h)>0?f:h},s.min=function(f,h){return f.cmp(h)<0?f:h},s.prototype._init=function(f,h,m){if(typeof f=="number")return this._initNumber(f,h,m);if(typeof f=="object")return this._initArray(f,h,m);h==="hex"&&(h=16),n(h===(h|0)&&h>=2&&h<=36),f=f.toString().replace(/\s+/g,"");var A=0;f[0]==="-"&&(A++,this.negative=1),A<f.length&&(h===16?this._parseHex(f,A,m):(this._parseBase(f,h,A),m==="le"&&this._initArray(this.toArray(),h,m)))},s.prototype._initNumber=function(f,h,m){f<0&&(this.negative=1,f=-f),f<67108864?(this.words=[f&67108863],this.length=1):f<4503599627370496?(this.words=[f&67108863,f/67108864&67108863],this.length=2):(n(f<9007199254740992),this.words=[f&67108863,f/67108864&67108863,1],this.length=3),m==="le"&&this._initArray(this.toArray(),h,m)},s.prototype._initArray=function(f,h,m){if(n(typeof f.length=="number"),f.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(f.length/3),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var S,R,M=0;if(m==="be")for(A=f.length-1,S=0;A>=0;A-=3)R=f[A]|f[A-1]<<8|f[A-2]<<16,this.words[S]|=R<<M&67108863,this.words[S+1]=R>>>26-M&67108863,M+=24,M>=26&&(M-=26,S++);else if(m==="le")for(A=0,S=0;A<f.length;A+=3)R=f[A]|f[A+1]<<8|f[A+2]<<16,this.words[S]|=R<<M&67108863,this.words[S+1]=R>>>26-M&67108863,M+=24,M>=26&&(M-=26,S++);return this._strip()};function a(_,f){var h=_.charCodeAt(f);if(h>=48&&h<=57)return h-48;if(h>=65&&h<=70)return h-55;if(h>=97&&h<=102)return h-87;n(!1,"Invalid character in "+_)}function c(_,f,h){var m=a(_,h);return h-1>=f&&(m|=a(_,h-1)<<4),m}s.prototype._parseHex=function(f,h,m){this.length=Math.ceil((f.length-h)/6),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var S=0,R=0,M;if(m==="be")for(A=f.length-1;A>=h;A-=2)M=c(f,h,A)<<S,this.words[R]|=M&67108863,S>=18?(S-=18,R+=1,this.words[R]|=M>>>26):S+=8;else{var E=f.length-h;for(A=E%2===0?h+1:h;A<f.length;A+=2)M=c(f,h,A)<<S,this.words[R]|=M&67108863,S>=18?(S-=18,R+=1,this.words[R]|=M>>>26):S+=8}this._strip()};function l(_,f,h,m){for(var A=0,S=0,R=Math.min(_.length,h),M=f;M<R;M++){var E=_.charCodeAt(M)-48;A*=m,E>=49?S=E-49+10:E>=17?S=E-17+10:S=E,n(E>=0&&S<m,"Invalid character"),A+=S}return A}s.prototype._parseBase=function(f,h,m){this.words=[0],this.length=1;for(var A=0,S=1;S<=67108863;S*=h)A++;A--,S=S/h|0;for(var R=f.length-m,M=R%A,E=Math.min(R,R-M)+m,g=0,N=m;N<E;N+=A)g=l(f,N,N+A,h),this.imuln(S),this.words[0]+g<67108864?this.words[0]+=g:this._iaddn(g);if(M!==0){var L=1;for(g=l(f,N,f.length,h),N=0;N<M;N++)L*=h;this.imuln(L),this.words[0]+g<67108864?this.words[0]+=g:this._iaddn(g)}this._strip()},s.prototype.copy=function(f){f.words=new Array(this.length);for(var h=0;h<this.length;h++)f.words[h]=this.words[h];f.length=this.length,f.negative=this.negative,f.red=this.red};function u(_,f){_.words=f.words,_.length=f.length,_.negative=f.negative,_.red=f.red}if(s.prototype._move=function(f){u(f,this)},s.prototype.clone=function(){var f=new s(null);return this.copy(f),f},s.prototype._expand=function(f){for(;this.length<f;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=d}catch{s.prototype.inspect=d}else s.prototype.inspect=d;function d(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],x=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],w=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(f,h){f=f||10,h=h|0||1;var m;if(f===16||f==="hex"){m="";for(var A=0,S=0,R=0;R<this.length;R++){var M=this.words[R],E=((M<<A|S)&16777215).toString(16);S=M>>>24-A&16777215,A+=2,A>=26&&(A-=26,R--),S!==0||R!==this.length-1?m=p[6-E.length]+E+m:m=E+m}for(S!==0&&(m=S.toString(16)+m);m.length%h!==0;)m="0"+m;return this.negative!==0&&(m="-"+m),m}if(f===(f|0)&&f>=2&&f<=36){var g=x[f],N=w[f];m="";var L=this.clone();for(L.negative=0;!L.isZero();){var v=L.modrn(N).toString(f);L=L.idivn(N),L.isZero()?m=v+m:m=p[g-v.length]+v+m}for(this.isZero()&&(m="0"+m);m.length%h!==0;)m="0"+m;return this.negative!==0&&(m="-"+m),m}n(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var f=this.words[0];return this.length===2?f+=this.words[1]*67108864:this.length===3&&this.words[2]===1?f+=4503599627370496+this.words[1]*67108864:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-f:f},s.prototype.toJSON=function(){return this.toString(16,2)},o&&(s.prototype.toBuffer=function(f,h){return this.toArrayLike(o,f,h)}),s.prototype.toArray=function(f,h){return this.toArrayLike(Array,f,h)};var b=function(f,h){return f.allocUnsafe?f.allocUnsafe(h):new f(h)};s.prototype.toArrayLike=function(f,h,m){this._strip();var A=this.byteLength(),S=m||Math.max(1,A);n(A<=S,"byte array longer than desired length"),n(S>0,"Requested array length <= 0");var R=b(f,S),M=h==="le"?"LE":"BE";return this["_toArrayLike"+M](R,A),R},s.prototype._toArrayLikeLE=function(f,h){for(var m=0,A=0,S=0,R=0;S<this.length;S++){var M=this.words[S]<<R|A;f[m++]=M&255,m<f.length&&(f[m++]=M>>8&255),m<f.length&&(f[m++]=M>>16&255),R===6?(m<f.length&&(f[m++]=M>>24&255),A=0,R=0):(A=M>>>24,R+=2)}if(m<f.length)for(f[m++]=A;m<f.length;)f[m++]=0},s.prototype._toArrayLikeBE=function(f,h){for(var m=f.length-1,A=0,S=0,R=0;S<this.length;S++){var M=this.words[S]<<R|A;f[m--]=M&255,m>=0&&(f[m--]=M>>8&255),m>=0&&(f[m--]=M>>16&255),R===6?(m>=0&&(f[m--]=M>>24&255),A=0,R=0):(A=M>>>24,R+=2)}if(m>=0)for(f[m--]=A;m>=0;)f[m--]=0},Math.clz32?s.prototype._countBits=function(f){return 32-Math.clz32(f)}:s.prototype._countBits=function(f){var h=f,m=0;return h>=4096&&(m+=13,h>>>=13),h>=64&&(m+=7,h>>>=7),h>=8&&(m+=4,h>>>=4),h>=2&&(m+=2,h>>>=2),m+h},s.prototype._zeroBits=function(f){if(f===0)return 26;var h=f,m=0;return(h&8191)===0&&(m+=13,h>>>=13),(h&127)===0&&(m+=7,h>>>=7),(h&15)===0&&(m+=4,h>>>=4),(h&3)===0&&(m+=2,h>>>=2),(h&1)===0&&m++,m},s.prototype.bitLength=function(){var f=this.words[this.length-1],h=this._countBits(f);return(this.length-1)*26+h};function y(_){for(var f=new Array(_.bitLength()),h=0;h<f.length;h++){var m=h/26|0,A=h%26;f[h]=_.words[m]>>>A&1}return f}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var f=0,h=0;h<this.length;h++){var m=this._zeroBits(this.words[h]);if(f+=m,m!==26)break}return f},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(f){return this.negative!==0?this.abs().inotn(f).iaddn(1):this.clone()},s.prototype.fromTwos=function(f){return this.testn(f-1)?this.notn(f).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(f){for(;this.length<f.length;)this.words[this.length++]=0;for(var h=0;h<f.length;h++)this.words[h]=this.words[h]|f.words[h];return this._strip()},s.prototype.ior=function(f){return n((this.negative|f.negative)===0),this.iuor(f)},s.prototype.or=function(f){return this.length>f.length?this.clone().ior(f):f.clone().ior(this)},s.prototype.uor=function(f){return this.length>f.length?this.clone().iuor(f):f.clone().iuor(this)},s.prototype.iuand=function(f){var h;this.length>f.length?h=f:h=this;for(var m=0;m<h.length;m++)this.words[m]=this.words[m]&f.words[m];return this.length=h.length,this._strip()},s.prototype.iand=function(f){return n((this.negative|f.negative)===0),this.iuand(f)},s.prototype.and=function(f){return this.length>f.length?this.clone().iand(f):f.clone().iand(this)},s.prototype.uand=function(f){return this.length>f.length?this.clone().iuand(f):f.clone().iuand(this)},s.prototype.iuxor=function(f){var h,m;this.length>f.length?(h=this,m=f):(h=f,m=this);for(var A=0;A<m.length;A++)this.words[A]=h.words[A]^m.words[A];if(this!==h)for(;A<h.length;A++)this.words[A]=h.words[A];return this.length=h.length,this._strip()},s.prototype.ixor=function(f){return n((this.negative|f.negative)===0),this.iuxor(f)},s.prototype.xor=function(f){return this.length>f.length?this.clone().ixor(f):f.clone().ixor(this)},s.prototype.uxor=function(f){return this.length>f.length?this.clone().iuxor(f):f.clone().iuxor(this)},s.prototype.inotn=function(f){n(typeof f=="number"&&f>=0);var h=Math.ceil(f/26)|0,m=f%26;this._expand(h),m>0&&h--;for(var A=0;A<h;A++)this.words[A]=~this.words[A]&67108863;return m>0&&(this.words[A]=~this.words[A]&67108863>>26-m),this._strip()},s.prototype.notn=function(f){return this.clone().inotn(f)},s.prototype.setn=function(f,h){n(typeof f=="number"&&f>=0);var m=f/26|0,A=f%26;return this._expand(m+1),h?this.words[m]=this.words[m]|1<<A:this.words[m]=this.words[m]&~(1<<A),this._strip()},s.prototype.iadd=function(f){var h;if(this.negative!==0&&f.negative===0)return this.negative=0,h=this.isub(f),this.negative^=1,this._normSign();if(this.negative===0&&f.negative!==0)return f.negative=0,h=this.isub(f),f.negative=1,h._normSign();var m,A;this.length>f.length?(m=this,A=f):(m=f,A=this);for(var S=0,R=0;R<A.length;R++)h=(m.words[R]|0)+(A.words[R]|0)+S,this.words[R]=h&67108863,S=h>>>26;for(;S!==0&&R<m.length;R++)h=(m.words[R]|0)+S,this.words[R]=h&67108863,S=h>>>26;if(this.length=m.length,S!==0)this.words[this.length]=S,this.length++;else if(m!==this)for(;R<m.length;R++)this.words[R]=m.words[R];return this},s.prototype.add=function(f){var h;return f.negative!==0&&this.negative===0?(f.negative=0,h=this.sub(f),f.negative^=1,h):f.negative===0&&this.negative!==0?(this.negative=0,h=f.sub(this),this.negative=1,h):this.length>f.length?this.clone().iadd(f):f.clone().iadd(this)},s.prototype.isub=function(f){if(f.negative!==0){f.negative=0;var h=this.iadd(f);return f.negative=1,h._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(f),this.negative=1,this._normSign();var m=this.cmp(f);if(m===0)return this.negative=0,this.length=1,this.words[0]=0,this;var A,S;m>0?(A=this,S=f):(A=f,S=this);for(var R=0,M=0;M<S.length;M++)h=(A.words[M]|0)-(S.words[M]|0)+R,R=h>>26,this.words[M]=h&67108863;for(;R!==0&&M<A.length;M++)h=(A.words[M]|0)+R,R=h>>26,this.words[M]=h&67108863;if(R===0&&M<A.length&&A!==this)for(;M<A.length;M++)this.words[M]=A.words[M];return this.length=Math.max(this.length,M),A!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(f){return this.clone().isub(f)};function C(_,f,h){h.negative=f.negative^_.negative;var m=_.length+f.length|0;h.length=m,m=m-1|0;var A=_.words[0]|0,S=f.words[0]|0,R=A*S,M=R&67108863,E=R/67108864|0;h.words[0]=M;for(var g=1;g<m;g++){for(var N=E>>>26,L=E&67108863,v=Math.min(g,f.length-1),H=Math.max(0,g-_.length+1);H<=v;H++){var V=g-H|0;A=_.words[V]|0,S=f.words[H]|0,R=A*S+L,N+=R/67108864|0,L=R&67108863}h.words[g]=L|0,E=N|0}return E!==0?h.words[g]=E|0:h.length--,h._strip()}var T=function(f,h,m){var A=f.words,S=h.words,R=m.words,M=0,E,g,N,L=A[0]|0,v=L&8191,H=L>>>13,V=A[1]|0,z=V&8191,G=V>>>13,re=A[2]|0,X=re&8191,ne=re>>>13,Fe=A[3]|0,ue=Fe&8191,Ce=Fe>>>13,rn=A[4]|0,Je=rn&8191,dt=rn>>>13,Rn=A[5]|0,ct=Rn&8191,tt=Rn>>>13,On=A[6]|0,lt=On&8191,Ze=On>>>13,nn=A[7]|0,ut=nn&8191,ft=nn>>>13,ps=A[8]|0,vt=ps&8191,Et=ps>>>13,Ro=A[9]|0,Tt=Ro&8191,Pt=Ro>>>13,Oo=S[0]|0,Rt=Oo&8191,Ot=Oo>>>13,ko=S[1]|0,kt=ko&8191,Dt=ko>>>13,Do=S[2]|0,Mt=Do&8191,Ut=Do>>>13,Mo=S[3]|0,Bt=Mo&8191,$t=Mo>>>13,Uo=S[4]|0,Lt=Uo&8191,Ft=Uo>>>13,Bo=S[5]|0,jt=Bo&8191,qt=Bo>>>13,$o=S[6]|0,Ht=$o&8191,Wt=$o>>>13,Lo=S[7]|0,zt=Lo&8191,Kt=Lo>>>13,Fo=S[8]|0,Vt=Fo&8191,Gt=Fo>>>13,jo=S[9]|0,Yt=jo&8191,Jt=jo>>>13;m.negative=f.negative^h.negative,m.length=19,E=Math.imul(v,Rt),g=Math.imul(v,Ot),g=g+Math.imul(H,Rt)|0,N=Math.imul(H,Ot);var Ws=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(Ws>>>26)|0,Ws&=67108863,E=Math.imul(z,Rt),g=Math.imul(z,Ot),g=g+Math.imul(G,Rt)|0,N=Math.imul(G,Ot),E=E+Math.imul(v,kt)|0,g=g+Math.imul(v,Dt)|0,g=g+Math.imul(H,kt)|0,N=N+Math.imul(H,Dt)|0;var zs=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(zs>>>26)|0,zs&=67108863,E=Math.imul(X,Rt),g=Math.imul(X,Ot),g=g+Math.imul(ne,Rt)|0,N=Math.imul(ne,Ot),E=E+Math.imul(z,kt)|0,g=g+Math.imul(z,Dt)|0,g=g+Math.imul(G,kt)|0,N=N+Math.imul(G,Dt)|0,E=E+Math.imul(v,Mt)|0,g=g+Math.imul(v,Ut)|0,g=g+Math.imul(H,Mt)|0,N=N+Math.imul(H,Ut)|0;var Ks=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(Ks>>>26)|0,Ks&=67108863,E=Math.imul(ue,Rt),g=Math.imul(ue,Ot),g=g+Math.imul(Ce,Rt)|0,N=Math.imul(Ce,Ot),E=E+Math.imul(X,kt)|0,g=g+Math.imul(X,Dt)|0,g=g+Math.imul(ne,kt)|0,N=N+Math.imul(ne,Dt)|0,E=E+Math.imul(z,Mt)|0,g=g+Math.imul(z,Ut)|0,g=g+Math.imul(G,Mt)|0,N=N+Math.imul(G,Ut)|0,E=E+Math.imul(v,Bt)|0,g=g+Math.imul(v,$t)|0,g=g+Math.imul(H,Bt)|0,N=N+Math.imul(H,$t)|0;var Vs=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(Vs>>>26)|0,Vs&=67108863,E=Math.imul(Je,Rt),g=Math.imul(Je,Ot),g=g+Math.imul(dt,Rt)|0,N=Math.imul(dt,Ot),E=E+Math.imul(ue,kt)|0,g=g+Math.imul(ue,Dt)|0,g=g+Math.imul(Ce,kt)|0,N=N+Math.imul(Ce,Dt)|0,E=E+Math.imul(X,Mt)|0,g=g+Math.imul(X,Ut)|0,g=g+Math.imul(ne,Mt)|0,N=N+Math.imul(ne,Ut)|0,E=E+Math.imul(z,Bt)|0,g=g+Math.imul(z,$t)|0,g=g+Math.imul(G,Bt)|0,N=N+Math.imul(G,$t)|0,E=E+Math.imul(v,Lt)|0,g=g+Math.imul(v,Ft)|0,g=g+Math.imul(H,Lt)|0,N=N+Math.imul(H,Ft)|0;var Gs=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(Gs>>>26)|0,Gs&=67108863,E=Math.imul(ct,Rt),g=Math.imul(ct,Ot),g=g+Math.imul(tt,Rt)|0,N=Math.imul(tt,Ot),E=E+Math.imul(Je,kt)|0,g=g+Math.imul(Je,Dt)|0,g=g+Math.imul(dt,kt)|0,N=N+Math.imul(dt,Dt)|0,E=E+Math.imul(ue,Mt)|0,g=g+Math.imul(ue,Ut)|0,g=g+Math.imul(Ce,Mt)|0,N=N+Math.imul(Ce,Ut)|0,E=E+Math.imul(X,Bt)|0,g=g+Math.imul(X,$t)|0,g=g+Math.imul(ne,Bt)|0,N=N+Math.imul(ne,$t)|0,E=E+Math.imul(z,Lt)|0,g=g+Math.imul(z,Ft)|0,g=g+Math.imul(G,Lt)|0,N=N+Math.imul(G,Ft)|0,E=E+Math.imul(v,jt)|0,g=g+Math.imul(v,qt)|0,g=g+Math.imul(H,jt)|0,N=N+Math.imul(H,qt)|0;var qh=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(qh>>>26)|0,qh&=67108863,E=Math.imul(lt,Rt),g=Math.imul(lt,Ot),g=g+Math.imul(Ze,Rt)|0,N=Math.imul(Ze,Ot),E=E+Math.imul(ct,kt)|0,g=g+Math.imul(ct,Dt)|0,g=g+Math.imul(tt,kt)|0,N=N+Math.imul(tt,Dt)|0,E=E+Math.imul(Je,Mt)|0,g=g+Math.imul(Je,Ut)|0,g=g+Math.imul(dt,Mt)|0,N=N+Math.imul(dt,Ut)|0,E=E+Math.imul(ue,Bt)|0,g=g+Math.imul(ue,$t)|0,g=g+Math.imul(Ce,Bt)|0,N=N+Math.imul(Ce,$t)|0,E=E+Math.imul(X,Lt)|0,g=g+Math.imul(X,Ft)|0,g=g+Math.imul(ne,Lt)|0,N=N+Math.imul(ne,Ft)|0,E=E+Math.imul(z,jt)|0,g=g+Math.imul(z,qt)|0,g=g+Math.imul(G,jt)|0,N=N+Math.imul(G,qt)|0,E=E+Math.imul(v,Ht)|0,g=g+Math.imul(v,Wt)|0,g=g+Math.imul(H,Ht)|0,N=N+Math.imul(H,Wt)|0;var Hh=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(Hh>>>26)|0,Hh&=67108863,E=Math.imul(ut,Rt),g=Math.imul(ut,Ot),g=g+Math.imul(ft,Rt)|0,N=Math.imul(ft,Ot),E=E+Math.imul(lt,kt)|0,g=g+Math.imul(lt,Dt)|0,g=g+Math.imul(Ze,kt)|0,N=N+Math.imul(Ze,Dt)|0,E=E+Math.imul(ct,Mt)|0,g=g+Math.imul(ct,Ut)|0,g=g+Math.imul(tt,Mt)|0,N=N+Math.imul(tt,Ut)|0,E=E+Math.imul(Je,Bt)|0,g=g+Math.imul(Je,$t)|0,g=g+Math.imul(dt,Bt)|0,N=N+Math.imul(dt,$t)|0,E=E+Math.imul(ue,Lt)|0,g=g+Math.imul(ue,Ft)|0,g=g+Math.imul(Ce,Lt)|0,N=N+Math.imul(Ce,Ft)|0,E=E+Math.imul(X,jt)|0,g=g+Math.imul(X,qt)|0,g=g+Math.imul(ne,jt)|0,N=N+Math.imul(ne,qt)|0,E=E+Math.imul(z,Ht)|0,g=g+Math.imul(z,Wt)|0,g=g+Math.imul(G,Ht)|0,N=N+Math.imul(G,Wt)|0,E=E+Math.imul(v,zt)|0,g=g+Math.imul(v,Kt)|0,g=g+Math.imul(H,zt)|0,N=N+Math.imul(H,Kt)|0;var Wh=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(Wh>>>26)|0,Wh&=67108863,E=Math.imul(vt,Rt),g=Math.imul(vt,Ot),g=g+Math.imul(Et,Rt)|0,N=Math.imul(Et,Ot),E=E+Math.imul(ut,kt)|0,g=g+Math.imul(ut,Dt)|0,g=g+Math.imul(ft,kt)|0,N=N+Math.imul(ft,Dt)|0,E=E+Math.imul(lt,Mt)|0,g=g+Math.imul(lt,Ut)|0,g=g+Math.imul(Ze,Mt)|0,N=N+Math.imul(Ze,Ut)|0,E=E+Math.imul(ct,Bt)|0,g=g+Math.imul(ct,$t)|0,g=g+Math.imul(tt,Bt)|0,N=N+Math.imul(tt,$t)|0,E=E+Math.imul(Je,Lt)|0,g=g+Math.imul(Je,Ft)|0,g=g+Math.imul(dt,Lt)|0,N=N+Math.imul(dt,Ft)|0,E=E+Math.imul(ue,jt)|0,g=g+Math.imul(ue,qt)|0,g=g+Math.imul(Ce,jt)|0,N=N+Math.imul(Ce,qt)|0,E=E+Math.imul(X,Ht)|0,g=g+Math.imul(X,Wt)|0,g=g+Math.imul(ne,Ht)|0,N=N+Math.imul(ne,Wt)|0,E=E+Math.imul(z,zt)|0,g=g+Math.imul(z,Kt)|0,g=g+Math.imul(G,zt)|0,N=N+Math.imul(G,Kt)|0,E=E+Math.imul(v,Vt)|0,g=g+Math.imul(v,Gt)|0,g=g+Math.imul(H,Vt)|0,N=N+Math.imul(H,Gt)|0;var zh=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(zh>>>26)|0,zh&=67108863,E=Math.imul(Tt,Rt),g=Math.imul(Tt,Ot),g=g+Math.imul(Pt,Rt)|0,N=Math.imul(Pt,Ot),E=E+Math.imul(vt,kt)|0,g=g+Math.imul(vt,Dt)|0,g=g+Math.imul(Et,kt)|0,N=N+Math.imul(Et,Dt)|0,E=E+Math.imul(ut,Mt)|0,g=g+Math.imul(ut,Ut)|0,g=g+Math.imul(ft,Mt)|0,N=N+Math.imul(ft,Ut)|0,E=E+Math.imul(lt,Bt)|0,g=g+Math.imul(lt,$t)|0,g=g+Math.imul(Ze,Bt)|0,N=N+Math.imul(Ze,$t)|0,E=E+Math.imul(ct,Lt)|0,g=g+Math.imul(ct,Ft)|0,g=g+Math.imul(tt,Lt)|0,N=N+Math.imul(tt,Ft)|0,E=E+Math.imul(Je,jt)|0,g=g+Math.imul(Je,qt)|0,g=g+Math.imul(dt,jt)|0,N=N+Math.imul(dt,qt)|0,E=E+Math.imul(ue,Ht)|0,g=g+Math.imul(ue,Wt)|0,g=g+Math.imul(Ce,Ht)|0,N=N+Math.imul(Ce,Wt)|0,E=E+Math.imul(X,zt)|0,g=g+Math.imul(X,Kt)|0,g=g+Math.imul(ne,zt)|0,N=N+Math.imul(ne,Kt)|0,E=E+Math.imul(z,Vt)|0,g=g+Math.imul(z,Gt)|0,g=g+Math.imul(G,Vt)|0,N=N+Math.imul(G,Gt)|0,E=E+Math.imul(v,Yt)|0,g=g+Math.imul(v,Jt)|0,g=g+Math.imul(H,Yt)|0,N=N+Math.imul(H,Jt)|0;var Kh=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(Kh>>>26)|0,Kh&=67108863,E=Math.imul(Tt,kt),g=Math.imul(Tt,Dt),g=g+Math.imul(Pt,kt)|0,N=Math.imul(Pt,Dt),E=E+Math.imul(vt,Mt)|0,g=g+Math.imul(vt,Ut)|0,g=g+Math.imul(Et,Mt)|0,N=N+Math.imul(Et,Ut)|0,E=E+Math.imul(ut,Bt)|0,g=g+Math.imul(ut,$t)|0,g=g+Math.imul(ft,Bt)|0,N=N+Math.imul(ft,$t)|0,E=E+Math.imul(lt,Lt)|0,g=g+Math.imul(lt,Ft)|0,g=g+Math.imul(Ze,Lt)|0,N=N+Math.imul(Ze,Ft)|0,E=E+Math.imul(ct,jt)|0,g=g+Math.imul(ct,qt)|0,g=g+Math.imul(tt,jt)|0,N=N+Math.imul(tt,qt)|0,E=E+Math.imul(Je,Ht)|0,g=g+Math.imul(Je,Wt)|0,g=g+Math.imul(dt,Ht)|0,N=N+Math.imul(dt,Wt)|0,E=E+Math.imul(ue,zt)|0,g=g+Math.imul(ue,Kt)|0,g=g+Math.imul(Ce,zt)|0,N=N+Math.imul(Ce,Kt)|0,E=E+Math.imul(X,Vt)|0,g=g+Math.imul(X,Gt)|0,g=g+Math.imul(ne,Vt)|0,N=N+Math.imul(ne,Gt)|0,E=E+Math.imul(z,Yt)|0,g=g+Math.imul(z,Jt)|0,g=g+Math.imul(G,Yt)|0,N=N+Math.imul(G,Jt)|0;var Vh=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(Vh>>>26)|0,Vh&=67108863,E=Math.imul(Tt,Mt),g=Math.imul(Tt,Ut),g=g+Math.imul(Pt,Mt)|0,N=Math.imul(Pt,Ut),E=E+Math.imul(vt,Bt)|0,g=g+Math.imul(vt,$t)|0,g=g+Math.imul(Et,Bt)|0,N=N+Math.imul(Et,$t)|0,E=E+Math.imul(ut,Lt)|0,g=g+Math.imul(ut,Ft)|0,g=g+Math.imul(ft,Lt)|0,N=N+Math.imul(ft,Ft)|0,E=E+Math.imul(lt,jt)|0,g=g+Math.imul(lt,qt)|0,g=g+Math.imul(Ze,jt)|0,N=N+Math.imul(Ze,qt)|0,E=E+Math.imul(ct,Ht)|0,g=g+Math.imul(ct,Wt)|0,g=g+Math.imul(tt,Ht)|0,N=N+Math.imul(tt,Wt)|0,E=E+Math.imul(Je,zt)|0,g=g+Math.imul(Je,Kt)|0,g=g+Math.imul(dt,zt)|0,N=N+Math.imul(dt,Kt)|0,E=E+Math.imul(ue,Vt)|0,g=g+Math.imul(ue,Gt)|0,g=g+Math.imul(Ce,Vt)|0,N=N+Math.imul(Ce,Gt)|0,E=E+Math.imul(X,Yt)|0,g=g+Math.imul(X,Jt)|0,g=g+Math.imul(ne,Yt)|0,N=N+Math.imul(ne,Jt)|0;var Gh=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(Gh>>>26)|0,Gh&=67108863,E=Math.imul(Tt,Bt),g=Math.imul(Tt,$t),g=g+Math.imul(Pt,Bt)|0,N=Math.imul(Pt,$t),E=E+Math.imul(vt,Lt)|0,g=g+Math.imul(vt,Ft)|0,g=g+Math.imul(Et,Lt)|0,N=N+Math.imul(Et,Ft)|0,E=E+Math.imul(ut,jt)|0,g=g+Math.imul(ut,qt)|0,g=g+Math.imul(ft,jt)|0,N=N+Math.imul(ft,qt)|0,E=E+Math.imul(lt,Ht)|0,g=g+Math.imul(lt,Wt)|0,g=g+Math.imul(Ze,Ht)|0,N=N+Math.imul(Ze,Wt)|0,E=E+Math.imul(ct,zt)|0,g=g+Math.imul(ct,Kt)|0,g=g+Math.imul(tt,zt)|0,N=N+Math.imul(tt,Kt)|0,E=E+Math.imul(Je,Vt)|0,g=g+Math.imul(Je,Gt)|0,g=g+Math.imul(dt,Vt)|0,N=N+Math.imul(dt,Gt)|0,E=E+Math.imul(ue,Yt)|0,g=g+Math.imul(ue,Jt)|0,g=g+Math.imul(Ce,Yt)|0,N=N+Math.imul(Ce,Jt)|0;var Yh=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(Yh>>>26)|0,Yh&=67108863,E=Math.imul(Tt,Lt),g=Math.imul(Tt,Ft),g=g+Math.imul(Pt,Lt)|0,N=Math.imul(Pt,Ft),E=E+Math.imul(vt,jt)|0,g=g+Math.imul(vt,qt)|0,g=g+Math.imul(Et,jt)|0,N=N+Math.imul(Et,qt)|0,E=E+Math.imul(ut,Ht)|0,g=g+Math.imul(ut,Wt)|0,g=g+Math.imul(ft,Ht)|0,N=N+Math.imul(ft,Wt)|0,E=E+Math.imul(lt,zt)|0,g=g+Math.imul(lt,Kt)|0,g=g+Math.imul(Ze,zt)|0,N=N+Math.imul(Ze,Kt)|0,E=E+Math.imul(ct,Vt)|0,g=g+Math.imul(ct,Gt)|0,g=g+Math.imul(tt,Vt)|0,N=N+Math.imul(tt,Gt)|0,E=E+Math.imul(Je,Yt)|0,g=g+Math.imul(Je,Jt)|0,g=g+Math.imul(dt,Yt)|0,N=N+Math.imul(dt,Jt)|0;var Jh=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(Jh>>>26)|0,Jh&=67108863,E=Math.imul(Tt,jt),g=Math.imul(Tt,qt),g=g+Math.imul(Pt,jt)|0,N=Math.imul(Pt,qt),E=E+Math.imul(vt,Ht)|0,g=g+Math.imul(vt,Wt)|0,g=g+Math.imul(Et,Ht)|0,N=N+Math.imul(Et,Wt)|0,E=E+Math.imul(ut,zt)|0,g=g+Math.imul(ut,Kt)|0,g=g+Math.imul(ft,zt)|0,N=N+Math.imul(ft,Kt)|0,E=E+Math.imul(lt,Vt)|0,g=g+Math.imul(lt,Gt)|0,g=g+Math.imul(Ze,Vt)|0,N=N+Math.imul(Ze,Gt)|0,E=E+Math.imul(ct,Yt)|0,g=g+Math.imul(ct,Jt)|0,g=g+Math.imul(tt,Yt)|0,N=N+Math.imul(tt,Jt)|0;var Zh=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(Zh>>>26)|0,Zh&=67108863,E=Math.imul(Tt,Ht),g=Math.imul(Tt,Wt),g=g+Math.imul(Pt,Ht)|0,N=Math.imul(Pt,Wt),E=E+Math.imul(vt,zt)|0,g=g+Math.imul(vt,Kt)|0,g=g+Math.imul(Et,zt)|0,N=N+Math.imul(Et,Kt)|0,E=E+Math.imul(ut,Vt)|0,g=g+Math.imul(ut,Gt)|0,g=g+Math.imul(ft,Vt)|0,N=N+Math.imul(ft,Gt)|0,E=E+Math.imul(lt,Yt)|0,g=g+Math.imul(lt,Jt)|0,g=g+Math.imul(Ze,Yt)|0,N=N+Math.imul(Ze,Jt)|0;var Xh=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(Xh>>>26)|0,Xh&=67108863,E=Math.imul(Tt,zt),g=Math.imul(Tt,Kt),g=g+Math.imul(Pt,zt)|0,N=Math.imul(Pt,Kt),E=E+Math.imul(vt,Vt)|0,g=g+Math.imul(vt,Gt)|0,g=g+Math.imul(Et,Vt)|0,N=N+Math.imul(Et,Gt)|0,E=E+Math.imul(ut,Yt)|0,g=g+Math.imul(ut,Jt)|0,g=g+Math.imul(ft,Yt)|0,N=N+Math.imul(ft,Jt)|0;var Qh=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(Qh>>>26)|0,Qh&=67108863,E=Math.imul(Tt,Vt),g=Math.imul(Tt,Gt),g=g+Math.imul(Pt,Vt)|0,N=Math.imul(Pt,Gt),E=E+Math.imul(vt,Yt)|0,g=g+Math.imul(vt,Jt)|0,g=g+Math.imul(Et,Yt)|0,N=N+Math.imul(Et,Jt)|0;var e0=(M+E|0)+((g&8191)<<13)|0;M=(N+(g>>>13)|0)+(e0>>>26)|0,e0&=67108863,E=Math.imul(Tt,Yt),g=Math.imul(Tt,Jt),g=g+Math.imul(Pt,Yt)|0,N=Math.imul(Pt,Jt);var t0=(M+E|0)+((g&8191)<<13)|0;return M=(N+(g>>>13)|0)+(t0>>>26)|0,t0&=67108863,R[0]=Ws,R[1]=zs,R[2]=Ks,R[3]=Vs,R[4]=Gs,R[5]=qh,R[6]=Hh,R[7]=Wh,R[8]=zh,R[9]=Kh,R[10]=Vh,R[11]=Gh,R[12]=Yh,R[13]=Jh,R[14]=Zh,R[15]=Xh,R[16]=Qh,R[17]=e0,R[18]=t0,M!==0&&(R[19]=M,m.length++),m};Math.imul||(T=C);function I(_,f,h){h.negative=f.negative^_.negative,h.length=_.length+f.length;for(var m=0,A=0,S=0;S<h.length-1;S++){var R=A;A=0;for(var M=m&67108863,E=Math.min(S,f.length-1),g=Math.max(0,S-_.length+1);g<=E;g++){var N=S-g,L=_.words[N]|0,v=f.words[g]|0,H=L*v,V=H&67108863;R=R+(H/67108864|0)|0,V=V+M|0,M=V&67108863,R=R+(V>>>26)|0,A+=R>>>26,R&=67108863}h.words[S]=M,m=R,R=A}return m!==0?h.words[S]=m:h.length--,h._strip()}function k(_,f,h){return I(_,f,h)}s.prototype.mulTo=function(f,h){var m,A=this.length+f.length;return this.length===10&&f.length===10?m=T(this,f,h):A<63?m=C(this,f,h):A<1024?m=I(this,f,h):m=k(this,f,h),m},s.prototype.mul=function(f){var h=new s(null);return h.words=new Array(this.length+f.length),this.mulTo(f,h)},s.prototype.mulf=function(f){var h=new s(null);return h.words=new Array(this.length+f.length),k(this,f,h)},s.prototype.imul=function(f){return this.clone().mulTo(f,this)},s.prototype.imuln=function(f){var h=f<0;h&&(f=-f),n(typeof f=="number"),n(f<67108864);for(var m=0,A=0;A<this.length;A++){var S=(this.words[A]|0)*f,R=(S&67108863)+(m&67108863);m>>=26,m+=S/67108864|0,m+=R>>>26,this.words[A]=R&67108863}return m!==0&&(this.words[A]=m,this.length++),this.length=f===0?1:this.length,h?this.ineg():this},s.prototype.muln=function(f){return this.clone().imuln(f)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(f){var h=y(f);if(h.length===0)return new s(1);for(var m=this,A=0;A<h.length&&h[A]===0;A++,m=m.sqr());if(++A<h.length)for(var S=m.sqr();A<h.length;A++,S=S.sqr())h[A]!==0&&(m=m.mul(S));return m},s.prototype.iushln=function(f){n(typeof f=="number"&&f>=0);var h=f%26,m=(f-h)/26,A=67108863>>>26-h<<26-h,S;if(h!==0){var R=0;for(S=0;S<this.length;S++){var M=this.words[S]&A,E=(this.words[S]|0)-M<<h;this.words[S]=E|R,R=M>>>26-h}R&&(this.words[S]=R,this.length++)}if(m!==0){for(S=this.length-1;S>=0;S--)this.words[S+m]=this.words[S];for(S=0;S<m;S++)this.words[S]=0;this.length+=m}return this._strip()},s.prototype.ishln=function(f){return n(this.negative===0),this.iushln(f)},s.prototype.iushrn=function(f,h,m){n(typeof f=="number"&&f>=0);var A;h?A=(h-h%26)/26:A=0;var S=f%26,R=Math.min((f-S)/26,this.length),M=67108863^67108863>>>S<<S,E=m;if(A-=R,A=Math.max(0,A),E){for(var g=0;g<R;g++)E.words[g]=this.words[g];E.length=R}if(R!==0)if(this.length>R)for(this.length-=R,g=0;g<this.length;g++)this.words[g]=this.words[g+R];else this.words[0]=0,this.length=1;var N=0;for(g=this.length-1;g>=0&&(N!==0||g>=A);g--){var L=this.words[g]|0;this.words[g]=N<<26-S|L>>>S,N=L&M}return E&&N!==0&&(E.words[E.length++]=N),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(f,h,m){return n(this.negative===0),this.iushrn(f,h,m)},s.prototype.shln=function(f){return this.clone().ishln(f)},s.prototype.ushln=function(f){return this.clone().iushln(f)},s.prototype.shrn=function(f){return this.clone().ishrn(f)},s.prototype.ushrn=function(f){return this.clone().iushrn(f)},s.prototype.testn=function(f){n(typeof f=="number"&&f>=0);var h=f%26,m=(f-h)/26,A=1<<h;if(this.length<=m)return!1;var S=this.words[m];return!!(S&A)},s.prototype.imaskn=function(f){n(typeof f=="number"&&f>=0);var h=f%26,m=(f-h)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=m)return this;if(h!==0&&m++,this.length=Math.min(m,this.length),h!==0){var A=67108863^67108863>>>h<<h;this.words[this.length-1]&=A}return this._strip()},s.prototype.maskn=function(f){return this.clone().imaskn(f)},s.prototype.iaddn=function(f){return n(typeof f=="number"),n(f<67108864),f<0?this.isubn(-f):this.negative!==0?this.length===1&&(this.words[0]|0)<=f?(this.words[0]=f-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(f),this.negative=1,this):this._iaddn(f)},s.prototype._iaddn=function(f){this.words[0]+=f;for(var h=0;h<this.length&&this.words[h]>=67108864;h++)this.words[h]-=67108864,h===this.length-1?this.words[h+1]=1:this.words[h+1]++;return this.length=Math.max(this.length,h+1),this},s.prototype.isubn=function(f){if(n(typeof f=="number"),n(f<67108864),f<0)return this.iaddn(-f);if(this.negative!==0)return this.negative=0,this.iaddn(f),this.negative=1,this;if(this.words[0]-=f,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var h=0;h<this.length&&this.words[h]<0;h++)this.words[h]+=67108864,this.words[h+1]-=1;return this._strip()},s.prototype.addn=function(f){return this.clone().iaddn(f)},s.prototype.subn=function(f){return this.clone().isubn(f)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(f,h,m){var A=f.length+m,S;this._expand(A);var R,M=0;for(S=0;S<f.length;S++){R=(this.words[S+m]|0)+M;var E=(f.words[S]|0)*h;R-=E&67108863,M=(R>>26)-(E/67108864|0),this.words[S+m]=R&67108863}for(;S<this.length-m;S++)R=(this.words[S+m]|0)+M,M=R>>26,this.words[S+m]=R&67108863;if(M===0)return this._strip();for(n(M===-1),M=0,S=0;S<this.length;S++)R=-(this.words[S]|0)+M,M=R>>26,this.words[S]=R&67108863;return this.negative=1,this._strip()},s.prototype._wordDiv=function(f,h){var m=this.length-f.length,A=this.clone(),S=f,R=S.words[S.length-1]|0,M=this._countBits(R);m=26-M,m!==0&&(S=S.ushln(m),A.iushln(m),R=S.words[S.length-1]|0);var E=A.length-S.length,g;if(h!=="mod"){g=new s(null),g.length=E+1,g.words=new Array(g.length);for(var N=0;N<g.length;N++)g.words[N]=0}var L=A.clone()._ishlnsubmul(S,1,E);L.negative===0&&(A=L,g&&(g.words[E]=1));for(var v=E-1;v>=0;v--){var H=(A.words[S.length+v]|0)*67108864+(A.words[S.length+v-1]|0);for(H=Math.min(H/R|0,67108863),A._ishlnsubmul(S,H,v);A.negative!==0;)H--,A.negative=0,A._ishlnsubmul(S,1,v),A.isZero()||(A.negative^=1);g&&(g.words[v]=H)}return g&&g._strip(),A._strip(),h!=="div"&&m!==0&&A.iushrn(m),{div:g||null,mod:A}},s.prototype.divmod=function(f,h,m){if(n(!f.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var A,S,R;return this.negative!==0&&f.negative===0?(R=this.neg().divmod(f,h),h!=="mod"&&(A=R.div.neg()),h!=="div"&&(S=R.mod.neg(),m&&S.negative!==0&&S.iadd(f)),{div:A,mod:S}):this.negative===0&&f.negative!==0?(R=this.divmod(f.neg(),h),h!=="mod"&&(A=R.div.neg()),{div:A,mod:R.mod}):(this.negative&f.negative)!==0?(R=this.neg().divmod(f.neg(),h),h!=="div"&&(S=R.mod.neg(),m&&S.negative!==0&&S.isub(f)),{div:R.div,mod:S}):f.length>this.length||this.cmp(f)<0?{div:new s(0),mod:this}:f.length===1?h==="div"?{div:this.divn(f.words[0]),mod:null}:h==="mod"?{div:null,mod:new s(this.modrn(f.words[0]))}:{div:this.divn(f.words[0]),mod:new s(this.modrn(f.words[0]))}:this._wordDiv(f,h)},s.prototype.div=function(f){return this.divmod(f,"div",!1).div},s.prototype.mod=function(f){return this.divmod(f,"mod",!1).mod},s.prototype.umod=function(f){return this.divmod(f,"mod",!0).mod},s.prototype.divRound=function(f){var h=this.divmod(f);if(h.mod.isZero())return h.div;var m=h.div.negative!==0?h.mod.isub(f):h.mod,A=f.ushrn(1),S=f.andln(1),R=m.cmp(A);return R<0||S===1&&R===0?h.div:h.div.negative!==0?h.div.isubn(1):h.div.iaddn(1)},s.prototype.modrn=function(f){var h=f<0;h&&(f=-f),n(f<=67108863);for(var m=(1<<26)%f,A=0,S=this.length-1;S>=0;S--)A=(m*A+(this.words[S]|0))%f;return h?-A:A},s.prototype.modn=function(f){return this.modrn(f)},s.prototype.idivn=function(f){var h=f<0;h&&(f=-f),n(f<=67108863);for(var m=0,A=this.length-1;A>=0;A--){var S=(this.words[A]|0)+m*67108864;this.words[A]=S/f|0,m=S%f}return this._strip(),h?this.ineg():this},s.prototype.divn=function(f){return this.clone().idivn(f)},s.prototype.egcd=function(f){n(f.negative===0),n(!f.isZero());var h=this,m=f.clone();h.negative!==0?h=h.umod(f):h=h.clone();for(var A=new s(1),S=new s(0),R=new s(0),M=new s(1),E=0;h.isEven()&&m.isEven();)h.iushrn(1),m.iushrn(1),++E;for(var g=m.clone(),N=h.clone();!h.isZero();){for(var L=0,v=1;(h.words[0]&v)===0&&L<26;++L,v<<=1);if(L>0)for(h.iushrn(L);L-- >0;)(A.isOdd()||S.isOdd())&&(A.iadd(g),S.isub(N)),A.iushrn(1),S.iushrn(1);for(var H=0,V=1;(m.words[0]&V)===0&&H<26;++H,V<<=1);if(H>0)for(m.iushrn(H);H-- >0;)(R.isOdd()||M.isOdd())&&(R.iadd(g),M.isub(N)),R.iushrn(1),M.iushrn(1);h.cmp(m)>=0?(h.isub(m),A.isub(R),S.isub(M)):(m.isub(h),R.isub(A),M.isub(S))}return{a:R,b:M,gcd:m.iushln(E)}},s.prototype._invmp=function(f){n(f.negative===0),n(!f.isZero());var h=this,m=f.clone();h.negative!==0?h=h.umod(f):h=h.clone();for(var A=new s(1),S=new s(0),R=m.clone();h.cmpn(1)>0&&m.cmpn(1)>0;){for(var M=0,E=1;(h.words[0]&E)===0&&M<26;++M,E<<=1);if(M>0)for(h.iushrn(M);M-- >0;)A.isOdd()&&A.iadd(R),A.iushrn(1);for(var g=0,N=1;(m.words[0]&N)===0&&g<26;++g,N<<=1);if(g>0)for(m.iushrn(g);g-- >0;)S.isOdd()&&S.iadd(R),S.iushrn(1);h.cmp(m)>=0?(h.isub(m),A.isub(S)):(m.isub(h),S.isub(A))}var L;return h.cmpn(1)===0?L=A:L=S,L.cmpn(0)<0&&L.iadd(f),L},s.prototype.gcd=function(f){if(this.isZero())return f.abs();if(f.isZero())return this.abs();var h=this.clone(),m=f.clone();h.negative=0,m.negative=0;for(var A=0;h.isEven()&&m.isEven();A++)h.iushrn(1),m.iushrn(1);do{for(;h.isEven();)h.iushrn(1);for(;m.isEven();)m.iushrn(1);var S=h.cmp(m);if(S<0){var R=h;h=m,m=R}else if(S===0||m.cmpn(1)===0)break;h.isub(m)}while(!0);return m.iushln(A)},s.prototype.invm=function(f){return this.egcd(f).a.umod(f)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(f){return this.words[0]&f},s.prototype.bincn=function(f){n(typeof f=="number");var h=f%26,m=(f-h)/26,A=1<<h;if(this.length<=m)return this._expand(m+1),this.words[m]|=A,this;for(var S=A,R=m;S!==0&&R<this.length;R++){var M=this.words[R]|0;M+=S,S=M>>>26,M&=67108863,this.words[R]=M}return S!==0&&(this.words[R]=S,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(f){var h=f<0;if(this.negative!==0&&!h)return-1;if(this.negative===0&&h)return 1;this._strip();var m;if(this.length>1)m=1;else{h&&(f=-f),n(f<=67108863,"Number is too big");var A=this.words[0]|0;m=A===f?0:A<f?-1:1}return this.negative!==0?-m|0:m},s.prototype.cmp=function(f){if(this.negative!==0&&f.negative===0)return-1;if(this.negative===0&&f.negative!==0)return 1;var h=this.ucmp(f);return this.negative!==0?-h|0:h},s.prototype.ucmp=function(f){if(this.length>f.length)return 1;if(this.length<f.length)return-1;for(var h=0,m=this.length-1;m>=0;m--){var A=this.words[m]|0,S=f.words[m]|0;if(A!==S){A<S?h=-1:A>S&&(h=1);break}}return h},s.prototype.gtn=function(f){return this.cmpn(f)===1},s.prototype.gt=function(f){return this.cmp(f)===1},s.prototype.gten=function(f){return this.cmpn(f)>=0},s.prototype.gte=function(f){return this.cmp(f)>=0},s.prototype.ltn=function(f){return this.cmpn(f)===-1},s.prototype.lt=function(f){return this.cmp(f)===-1},s.prototype.lten=function(f){return this.cmpn(f)<=0},s.prototype.lte=function(f){return this.cmp(f)<=0},s.prototype.eqn=function(f){return this.cmpn(f)===0},s.prototype.eq=function(f){return this.cmp(f)===0},s.red=function(f){return new j(f)},s.prototype.toRed=function(f){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),f.convertTo(this)._forceRed(f)},s.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(f){return this.red=f,this},s.prototype.forceRed=function(f){return n(!this.red,"Already a number in reduction context"),this._forceRed(f)},s.prototype.redAdd=function(f){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,f)},s.prototype.redIAdd=function(f){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,f)},s.prototype.redSub=function(f){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,f)},s.prototype.redISub=function(f){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,f)},s.prototype.redShl=function(f){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,f)},s.prototype.redMul=function(f){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.mul(this,f)},s.prototype.redIMul=function(f){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.imul(this,f)},s.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(f){return n(this.red&&!f.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,f)};var P={k256:null,p224:null,p192:null,p25519:null};function O(_,f){this.name=_,this.p=new s(f,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}O.prototype._tmp=function(){var f=new s(null);return f.words=new Array(Math.ceil(this.n/13)),f},O.prototype.ireduce=function(f){var h=f,m;do this.split(h,this.tmp),h=this.imulK(h),h=h.iadd(this.tmp),m=h.bitLength();while(m>this.n);var A=m<this.n?-1:h.ucmp(this.p);return A===0?(h.words[0]=0,h.length=1):A>0?h.isub(this.p):h.strip!==void 0?h.strip():h._strip(),h},O.prototype.split=function(f,h){f.iushrn(this.n,0,h)},O.prototype.imulK=function(f){return f.imul(this.k)};function q(){O.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(q,O),q.prototype.split=function(f,h){for(var m=4194303,A=Math.min(f.length,9),S=0;S<A;S++)h.words[S]=f.words[S];if(h.length=A,f.length<=9){f.words[0]=0,f.length=1;return}var R=f.words[9];for(h.words[h.length++]=R&m,S=10;S<f.length;S++){var M=f.words[S]|0;f.words[S-10]=(M&m)<<4|R>>>22,R=M}R>>>=22,f.words[S-10]=R,R===0&&f.length>10?f.length-=10:f.length-=9},q.prototype.imulK=function(f){f.words[f.length]=0,f.words[f.length+1]=0,f.length+=2;for(var h=0,m=0;m<f.length;m++){var A=f.words[m]|0;h+=A*977,f.words[m]=h&67108863,h=A*64+(h/67108864|0)}return f.words[f.length-1]===0&&(f.length--,f.words[f.length-1]===0&&f.length--),f};function F(){O.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(F,O);function B(){O.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(B,O);function W(){O.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(W,O),W.prototype.imulK=function(f){for(var h=0,m=0;m<f.length;m++){var A=(f.words[m]|0)*19+h,S=A&67108863;A>>>=26,f.words[m]=S,h=A}return h!==0&&(f.words[f.length++]=h),f},s._prime=function(f){if(P[f])return P[f];var h;if(f==="k256")h=new q;else if(f==="p224")h=new F;else if(f==="p192")h=new B;else if(f==="p25519")h=new W;else throw new Error("Unknown prime "+f);return P[f]=h,h};function j(_){if(typeof _=="string"){var f=s._prime(_);this.m=f.p,this.prime=f}else n(_.gtn(1),"modulus must be greater than 1"),this.m=_,this.prime=null}j.prototype._verify1=function(f){n(f.negative===0,"red works only with positives"),n(f.red,"red works only with red numbers")},j.prototype._verify2=function(f,h){n((f.negative|h.negative)===0,"red works only with positives"),n(f.red&&f.red===h.red,"red works only with red numbers")},j.prototype.imod=function(f){return this.prime?this.prime.ireduce(f)._forceRed(this):(u(f,f.umod(this.m)._forceRed(this)),f)},j.prototype.neg=function(f){return f.isZero()?f.clone():this.m.sub(f)._forceRed(this)},j.prototype.add=function(f,h){this._verify2(f,h);var m=f.add(h);return m.cmp(this.m)>=0&&m.isub(this.m),m._forceRed(this)},j.prototype.iadd=function(f,h){this._verify2(f,h);var m=f.iadd(h);return m.cmp(this.m)>=0&&m.isub(this.m),m},j.prototype.sub=function(f,h){this._verify2(f,h);var m=f.sub(h);return m.cmpn(0)<0&&m.iadd(this.m),m._forceRed(this)},j.prototype.isub=function(f,h){this._verify2(f,h);var m=f.isub(h);return m.cmpn(0)<0&&m.iadd(this.m),m},j.prototype.shl=function(f,h){return this._verify1(f),this.imod(f.ushln(h))},j.prototype.imul=function(f,h){return this._verify2(f,h),this.imod(f.imul(h))},j.prototype.mul=function(f,h){return this._verify2(f,h),this.imod(f.mul(h))},j.prototype.isqr=function(f){return this.imul(f,f.clone())},j.prototype.sqr=function(f){return this.mul(f,f)},j.prototype.sqrt=function(f){if(f.isZero())return f.clone();var h=this.m.andln(3);if(n(h%2===1),h===3){var m=this.m.add(new s(1)).iushrn(2);return this.pow(f,m)}for(var A=this.m.subn(1),S=0;!A.isZero()&&A.andln(1)===0;)S++,A.iushrn(1);n(!A.isZero());var R=new s(1).toRed(this),M=R.redNeg(),E=this.m.subn(1).iushrn(1),g=this.m.bitLength();for(g=new s(2*g*g).toRed(this);this.pow(g,E).cmp(M)!==0;)g.redIAdd(M);for(var N=this.pow(g,A),L=this.pow(f,A.addn(1).iushrn(1)),v=this.pow(f,A),H=S;v.cmp(R)!==0;){for(var V=v,z=0;V.cmp(R)!==0;z++)V=V.redSqr();n(z<H);var G=this.pow(N,new s(1).iushln(H-z-1));L=L.redMul(G),N=G.redSqr(),v=v.redMul(N),H=z}return L},j.prototype.invm=function(f){var h=f._invmp(this.m);return h.negative!==0?(h.negative=0,this.imod(h).redNeg()):this.imod(h)},j.prototype.pow=function(f,h){if(h.isZero())return new s(1).toRed(this);if(h.cmpn(1)===0)return f.clone();var m=4,A=new Array(1<<m);A[0]=new s(1).toRed(this),A[1]=f;for(var S=2;S<A.length;S++)A[S]=this.mul(A[S-1],f);var R=A[0],M=0,E=0,g=h.bitLength()%26;for(g===0&&(g=26),S=h.length-1;S>=0;S--){for(var N=h.words[S],L=g-1;L>=0;L--){var v=N>>L&1;if(R!==A[0]&&(R=this.sqr(R)),v===0&&M===0){E=0;continue}M<<=1,M|=v,E++,!(E!==m&&(S!==0||L!==0))&&(R=this.mul(R,A[M]),E=0,M=0)}g=26}return R},j.prototype.convertTo=function(f){var h=f.umod(this.m);return h===f?h.clone():h},j.prototype.convertFrom=function(f){var h=f.clone();return h.red=null,h},s.mont=function(f){return new U(f)};function U(_){j.call(this,_),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(U,j),U.prototype.convertTo=function(f){return this.imod(f.ushln(this.shift))},U.prototype.convertFrom=function(f){var h=this.imod(f.mul(this.rinv));return h.red=null,h},U.prototype.imul=function(f,h){if(f.isZero()||h.isZero())return f.words[0]=0,f.length=1,f;var m=f.imul(h),A=m.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=m.isub(A).iushrn(this.shift),R=S;return S.cmp(this.m)>=0?R=S.isub(this.m):S.cmpn(0)<0&&(R=S.iadd(this.m)),R._forceRed(this)},U.prototype.mul=function(f,h){if(f.isZero()||h.isZero())return new s(0)._forceRed(this);var m=f.mul(h),A=m.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=m.isub(A).iushrn(this.shift),R=S;return S.cmp(this.m)>=0?R=S.isub(this.m):S.cmpn(0)<0&&(R=S.iadd(this.m)),R._forceRed(this)},U.prototype.invm=function(f){var h=this.imod(f._invmp(this.m).mul(this.r2));return h._forceRed(this)}})(r,zj)})(df)),df.exports}var Vj=Kj();const Re=qs(Vj),Gj="logger/5.8.0";let cx=!1,lx=!1;const ff={debug:1,default:2,info:2,warning:3,error:4,off:5};let ux=ff.default,ap=null;function Yj(){try{const r=[];if(["NFD","NFC","NFKD","NFKC"].forEach(e=>{try{if("test".normalize(e)!=="test")throw new Error("bad normalize")}catch{r.push(e)}}),r.length)throw new Error("missing "+r.join(", "));if("é".normalize("NFD")!=="é")throw new Error("broken implementation")}catch(r){return r.message}return null}const dx=Yj();var Xf;(function(r){r.DEBUG="DEBUG",r.INFO="INFO",r.WARNING="WARNING",r.ERROR="ERROR",r.OFF="OFF"})(Xf||(Xf={}));var ri;(function(r){r.UNKNOWN_ERROR="UNKNOWN_ERROR",r.NOT_IMPLEMENTED="NOT_IMPLEMENTED",r.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",r.NETWORK_ERROR="NETWORK_ERROR",r.SERVER_ERROR="SERVER_ERROR",r.TIMEOUT="TIMEOUT",r.BUFFER_OVERRUN="BUFFER_OVERRUN",r.NUMERIC_FAULT="NUMERIC_FAULT",r.MISSING_NEW="MISSING_NEW",r.INVALID_ARGUMENT="INVALID_ARGUMENT",r.MISSING_ARGUMENT="MISSING_ARGUMENT",r.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",r.CALL_EXCEPTION="CALL_EXCEPTION",r.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",r.NONCE_EXPIRED="NONCE_EXPIRED",r.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",r.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",r.TRANSACTION_REPLACED="TRANSACTION_REPLACED",r.ACTION_REJECTED="ACTION_REJECTED"})(ri||(ri={}));const fx="0123456789abcdef";class K{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,t){const n=e.toLowerCase();ff[n]==null&&this.throwArgumentError("invalid log level name","logLevel",e),!(ux>ff[n])&&console.log.apply(console,t)}debug(...e){this._log(K.levels.DEBUG,e)}info(...e){this._log(K.levels.INFO,e)}warn(...e){this._log(K.levels.WARNING,e)}makeError(e,t,n){if(lx)return this.makeError("censored error",t,{});t||(t=K.errors.UNKNOWN_ERROR),n||(n={});const i=[];Object.keys(n).forEach(c=>{const l=n[c];try{if(l instanceof Uint8Array){let u="";for(let d=0;d<l.length;d++)u+=fx[l[d]>>4],u+=fx[l[d]&15];i.push(c+"=Uint8Array(0x"+u+")")}else i.push(c+"="+JSON.stringify(l))}catch{i.push(c+"="+JSON.stringify(n[c].toString()))}}),i.push(`code=${t}`),i.push(`version=${this.version}`);const s=e;let o="";switch(t){case ri.NUMERIC_FAULT:{o="NUMERIC_FAULT";const c=e;switch(c){case"overflow":case"underflow":case"division-by-zero":o+="-"+c;break;case"negative-power":case"negative-width":o+="-unsupported";break;case"unbound-bitwise-result":o+="-unbound-result";break}break}case ri.CALL_EXCEPTION:case ri.INSUFFICIENT_FUNDS:case ri.MISSING_NEW:case ri.NONCE_EXPIRED:case ri.REPLACEMENT_UNDERPRICED:case ri.TRANSACTION_REPLACED:case ri.UNPREDICTABLE_GAS_LIMIT:o=t;break}o&&(e+=" [ See: https://links.ethers.org/v5-errors-"+o+" ]"),i.length&&(e+=" ("+i.join(", ")+")");const a=new Error(e);return a.reason=s,a.code=t,Object.keys(n).forEach(function(c){a[c]=n[c]}),a}throwError(e,t,n){throw this.makeError(e,t,n)}throwArgumentError(e,t,n){return this.throwError(e,K.errors.INVALID_ARGUMENT,{argument:t,value:n})}assert(e,t,n,i){e||this.throwError(t,n,i)}assertArgument(e,t,n,i){e||this.throwArgumentError(t,n,i)}checkNormalize(e){dx&&this.throwError("platform missing String.prototype.normalize",K.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:dx})}checkSafeUint53(e,t){typeof e=="number"&&(t==null&&(t="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(t,K.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(t,K.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,t,n){n?n=": "+n:n="",e<t&&this.throwError("missing argument"+n,K.errors.MISSING_ARGUMENT,{count:e,expectedCount:t}),e>t&&this.throwError("too many arguments"+n,K.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:t})}checkNew(e,t){(e===Object||e==null)&&this.throwError("missing new",K.errors.MISSING_NEW,{name:t.name})}checkAbstract(e,t){e===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",K.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):(e===Object||e==null)&&this.throwError("missing new",K.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return ap||(ap=new K(Gj)),ap}static setCensorship(e,t){if(!e&&t&&this.globalLogger().throwError("cannot permanently disable censorship",K.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),cx){if(!e)return;this.globalLogger().throwError("error censorship permanent",K.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}lx=!!e,cx=!!t}static setLogLevel(e){const t=ff[e.toLowerCase()];if(t==null){K.globalLogger().warn("invalid log level - "+e);return}ux=t}static from(e){return new K(e)}}K.errors=ri;K.levels=Xf;const Jj=Object.freeze(Object.defineProperty({__proto__:null,get ErrorCode(){return ri},get LogLevel(){return Xf},Logger:K},Symbol.toStringTag,{value:"Module"})),Zj="bytes/5.8.0",sr=new K(Zj);function ZA(r){return!!r.toHexString}function Tc(r){return r.slice||(r.slice=function(){const e=Array.prototype.slice.call(arguments);return Tc(new Uint8Array(Array.prototype.slice.apply(r,e)))}),r}function fd(r){return We(r)&&!(r.length%2)||Ba(r)}function hx(r){return typeof r=="number"&&r==r&&r%1===0}function Ba(r){if(r==null)return!1;if(r.constructor===Uint8Array)return!0;if(typeof r=="string"||!hx(r.length)||r.length<0)return!1;for(let e=0;e<r.length;e++){const t=r[e];if(!hx(t)||t<0||t>=256)return!1}return!0}function te(r,e){if(e||(e={}),typeof r=="number"){sr.checkSafeUint53(r,"invalid arrayify value");const t=[];for(;r;)t.unshift(r&255),r=parseInt(String(r/256));return t.length===0&&t.push(0),Tc(new Uint8Array(t))}if(e.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),ZA(r)&&(r=r.toHexString()),We(r)){let t=r.substring(2);t.length%2&&(e.hexPad==="left"?t="0"+t:e.hexPad==="right"?t+="0":sr.throwArgumentError("hex data is odd-length","value",r));const n=[];for(let i=0;i<t.length;i+=2)n.push(parseInt(t.substring(i,i+2),16));return Tc(new Uint8Array(n))}return Ba(r)?Tc(new Uint8Array(r)):sr.throwArgumentError("invalid arrayify value","value",r)}function Nt(r){const e=r.map(i=>te(i)),t=e.reduce((i,s)=>i+s.length,0),n=new Uint8Array(t);return e.reduce((i,s)=>(n.set(s,i),i+s.length),0),Tc(n)}function os(r){let e=te(r);if(e.length===0)return e;let t=0;for(;t<e.length&&e[t]===0;)t++;return t&&(e=e.slice(t)),e}function zl(r,e){r=te(r),r.length>e&&sr.throwArgumentError("value out of range","value",arguments[0]);const t=new Uint8Array(e);return t.set(r,e-r.length),Tc(t)}function We(r,e){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||e&&r.length!==2+2*e)}const cp="0123456789abcdef";function oe(r,e){if(e||(e={}),typeof r=="number"){sr.checkSafeUint53(r,"invalid hexlify value");let t="";for(;r;)t=cp[r&15]+t,r=Math.floor(r/16);return t.length?(t.length%2&&(t="0"+t),"0x"+t):"0x00"}if(typeof r=="bigint")return r=r.toString(16),r.length%2?"0x0"+r:"0x"+r;if(e.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),ZA(r))return r.toHexString();if(We(r))return r.length%2&&(e.hexPad==="left"?r="0x0"+r.substring(2):e.hexPad==="right"?r+="0":sr.throwArgumentError("hex data is odd-length","value",r)),r.toLowerCase();if(Ba(r)){let t="0x";for(let n=0;n<r.length;n++){let i=r[n];t+=cp[(i&240)>>4]+cp[i&15]}return t}return sr.throwArgumentError("invalid hexlify value","value",r)}function us(r){if(typeof r!="string")r=oe(r);else if(!We(r)||r.length%2)return null;return(r.length-2)/2}function dr(r,e,t){return typeof r!="string"?r=oe(r):(!We(r)||r.length%2)&&sr.throwArgumentError("invalid hexData","value",r),e=2+2*e,t!=null?"0x"+r.substring(e,2+2*t):"0x"+r.substring(e)}function an(r){let e="0x";return r.forEach(t=>{e+=oe(t).substring(2)}),e}function Th(r){const e=XA(oe(r,{hexPad:"left"}));return e==="0x"?"0x0":e}function XA(r){typeof r!="string"&&(r=oe(r)),We(r)||sr.throwArgumentError("invalid hex string","value",r),r=r.substring(2);let e=0;for(;e<r.length&&r[e]==="0";)e++;return"0x"+r.substring(e)}function Ct(r,e){for(typeof r!="string"?r=oe(r):We(r)||sr.throwArgumentError("invalid hex string","value",r),r.length>2*e+2&&sr.throwArgumentError("value out of range","value",arguments[1]);r.length<2*e+2;)r="0x0"+r.substring(2);return r}function $a(r){const e={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(fd(r)){let t=te(r);t.length===64?(e.v=27+(t[32]>>7),t[32]&=127,e.r=oe(t.slice(0,32)),e.s=oe(t.slice(32,64))):t.length===65?(e.r=oe(t.slice(0,32)),e.s=oe(t.slice(32,64)),e.v=t[64]):sr.throwArgumentError("invalid signature string","signature",r),e.v<27&&(e.v===0||e.v===1?e.v+=27:sr.throwArgumentError("signature invalid v byte","signature",r)),e.recoveryParam=1-e.v%2,e.recoveryParam&&(t[32]|=128),e._vs=oe(t.slice(32,64))}else{if(e.r=r.r,e.s=r.s,e.v=r.v,e.recoveryParam=r.recoveryParam,e._vs=r._vs,e._vs!=null){const i=zl(te(e._vs),32);e._vs=oe(i);const s=i[0]>=128?1:0;e.recoveryParam==null?e.recoveryParam=s:e.recoveryParam!==s&&sr.throwArgumentError("signature recoveryParam mismatch _vs","signature",r),i[0]&=127;const o=oe(i);e.s==null?e.s=o:e.s!==o&&sr.throwArgumentError("signature v mismatch _vs","signature",r)}if(e.recoveryParam==null)e.v==null?sr.throwArgumentError("signature missing v and recoveryParam","signature",r):e.v===0||e.v===1?e.recoveryParam=e.v:e.recoveryParam=1-e.v%2;else if(e.v==null)e.v=27+e.recoveryParam;else{const i=e.v===0||e.v===1?e.v:1-e.v%2;e.recoveryParam!==i&&sr.throwArgumentError("signature recoveryParam mismatch v","signature",r)}e.r==null||!We(e.r)?sr.throwArgumentError("signature missing or invalid r","signature",r):e.r=Ct(e.r,32),e.s==null||!We(e.s)?sr.throwArgumentError("signature missing or invalid s","signature",r):e.s=Ct(e.s,32);const t=te(e.s);t[0]>=128&&sr.throwArgumentError("signature s out of range","signature",r),e.recoveryParam&&(t[0]|=128);const n=oe(t);e._vs&&(We(e._vs)||sr.throwArgumentError("signature invalid _vs","signature",r),e._vs=Ct(e._vs,32)),e._vs==null?e._vs=n:e._vs!==n&&sr.throwArgumentError("signature _vs mismatch v and s","signature",r)}return e.yParityAndS=e._vs,e.compact=e.r+e.yParityAndS.substring(2),e}function jg(r){return r=$a(r),oe(Nt([r.r,r.s,r.recoveryParam?"0x1c":"0x1b"]))}const Xj=Object.freeze(Object.defineProperty({__proto__:null,arrayify:te,concat:Nt,hexConcat:an,hexDataLength:us,hexDataSlice:dr,hexStripZeros:XA,hexValue:Th,hexZeroPad:Ct,hexlify:oe,isBytes:Ba,isBytesLike:fd,isHexString:We,joinSignature:jg,splitSignature:$a,stripZeros:os,zeroPad:zl},Symbol.toStringTag,{value:"Module"})),QA="bignumber/5.8.0";var ju=Re.BN;const Is=new K(QA),lp={},px=9007199254740991;function Qj(r){return r!=null&&(ie.isBigNumber(r)||typeof r=="number"&&r%1===0||typeof r=="string"&&!!r.match(/^-?[0-9]+$/)||We(r)||typeof r=="bigint"||Ba(r))}let gx=!1;class ie{constructor(e,t){e!==lp&&Is.throwError("cannot call constructor directly; use BigNumber.from",K.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=t,this._isBigNumber=!0,Object.freeze(this)}fromTwos(e){return yn(Le(this).fromTwos(e))}toTwos(e){return yn(Le(this).toTwos(e))}abs(){return this._hex[0]==="-"?ie.from(this._hex.substring(1)):this}add(e){return yn(Le(this).add(Le(e)))}sub(e){return yn(Le(this).sub(Le(e)))}div(e){return ie.from(e).isZero()&&Zn("division-by-zero","div"),yn(Le(this).div(Le(e)))}mul(e){return yn(Le(this).mul(Le(e)))}mod(e){const t=Le(e);return t.isNeg()&&Zn("division-by-zero","mod"),yn(Le(this).umod(t))}pow(e){const t=Le(e);return t.isNeg()&&Zn("negative-power","pow"),yn(Le(this).pow(t))}and(e){const t=Le(e);return(this.isNegative()||t.isNeg())&&Zn("unbound-bitwise-result","and"),yn(Le(this).and(t))}or(e){const t=Le(e);return(this.isNegative()||t.isNeg())&&Zn("unbound-bitwise-result","or"),yn(Le(this).or(t))}xor(e){const t=Le(e);return(this.isNegative()||t.isNeg())&&Zn("unbound-bitwise-result","xor"),yn(Le(this).xor(t))}mask(e){return(this.isNegative()||e<0)&&Zn("negative-width","mask"),yn(Le(this).maskn(e))}shl(e){return(this.isNegative()||e<0)&&Zn("negative-width","shl"),yn(Le(this).shln(e))}shr(e){return(this.isNegative()||e<0)&&Zn("negative-width","shr"),yn(Le(this).shrn(e))}eq(e){return Le(this).eq(Le(e))}lt(e){return Le(this).lt(Le(e))}lte(e){return Le(this).lte(Le(e))}gt(e){return Le(this).gt(Le(e))}gte(e){return Le(this).gte(Le(e))}isNegative(){return this._hex[0]==="-"}isZero(){return Le(this).isZero()}toNumber(){try{return Le(this).toNumber()}catch{Zn("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch{}return Is.throwError("this platform does not support BigInt",K.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(arguments[0]===10?gx||(gx=!0,Is.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):arguments[0]===16?Is.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",K.errors.UNEXPECTED_ARGUMENT,{}):Is.throwError("BigNumber.toString does not accept parameters",K.errors.UNEXPECTED_ARGUMENT,{})),Le(this).toString(10)}toHexString(){return this._hex}toJSON(e){return{type:"BigNumber",hex:this.toHexString()}}static from(e){if(e instanceof ie)return e;if(typeof e=="string")return e.match(/^-?0x[0-9a-f]+$/i)?new ie(lp,qu(e)):e.match(/^-?[0-9]+$/)?new ie(lp,qu(new ju(e))):Is.throwArgumentError("invalid BigNumber string","value",e);if(typeof e=="number")return e%1&&Zn("underflow","BigNumber.from",e),(e>=px||e<=-px)&&Zn("overflow","BigNumber.from",e),ie.from(String(e));const t=e;if(typeof t=="bigint")return ie.from(t.toString());if(Ba(t))return ie.from(oe(t));if(t)if(t.toHexString){const n=t.toHexString();if(typeof n=="string")return ie.from(n)}else{let n=t._hex;if(n==null&&t.type==="BigNumber"&&(n=t.hex),typeof n=="string"&&(We(n)||n[0]==="-"&&We(n.substring(1))))return ie.from(n)}return Is.throwArgumentError("invalid BigNumber value","value",e)}static isBigNumber(e){return!!(e&&e._isBigNumber)}}function qu(r){if(typeof r!="string")return qu(r.toString(16));if(r[0]==="-")return r=r.substring(1),r[0]==="-"&&Is.throwArgumentError("invalid hex","value",r),r=qu(r),r==="0x00"?r:"-"+r;if(r.substring(0,2)!=="0x"&&(r="0x"+r),r==="0x")return"0x00";for(r.length%2&&(r="0x0"+r.substring(2));r.length>4&&r.substring(0,4)==="0x00";)r="0x"+r.substring(4);return r}function yn(r){return ie.from(qu(r))}function Le(r){const e=ie.from(r).toHexString();return e[0]==="-"?new ju("-"+e.substring(3),16):new ju(e.substring(2),16)}function Zn(r,e,t){const n={fault:r,operation:e};return t!=null&&(n.value=t),Is.throwError(r,K.errors.NUMERIC_FAULT,n)}function eq(r){return new ju(r,36).toString(16)}function tq(r){return new ju(r,16).toString(36)}const cn=new K(QA),Kl={},e_=ie.from(0),t_=ie.from(-1);function r_(r,e,t,n){const i={fault:e,operation:t};return n!==void 0&&(i.value=n),cn.throwError(r,K.errors.NUMERIC_FAULT,i)}let Vl="0";for(;Vl.length<256;)Vl+=Vl;function Hm(r){if(typeof r!="number")try{r=ie.from(r).toNumber()}catch{}return typeof r=="number"&&r>=0&&r<=256&&!(r%1)?"1"+Vl.substring(0,r):cn.throwArgumentError("invalid decimal size","decimals",r)}function hf(r,e){e==null&&(e=0);const t=Hm(e);r=ie.from(r);const n=r.lt(e_);n&&(r=r.mul(t_));let i=r.mod(t).toString();for(;i.length<t.length-1;)i="0"+i;i=i.match(/^([0-9]*[1-9]|0)(0*)/)[1];const s=r.div(t).toString();return t.length===1?r=s:r=s+"."+i,n&&(r="-"+r),r}function Wi(r,e){e==null&&(e=0);const t=Hm(e);(typeof r!="string"||!r.match(/^-?[0-9.]+$/))&&cn.throwArgumentError("invalid decimal value","value",r);const n=r.substring(0,1)==="-";n&&(r=r.substring(1)),r==="."&&cn.throwArgumentError("missing value","value",r);const i=r.split(".");i.length>2&&cn.throwArgumentError("too many decimal points","value",r);let s=i[0],o=i[1];for(s||(s="0"),o||(o="0");o[o.length-1]==="0";)o=o.substring(0,o.length-1);for(o.length>t.length-1&&r_("fractional component exceeds decimals","underflow","parseFixed"),o===""&&(o="0");o.length<t.length-1;)o+="0";const a=ie.from(s),c=ie.from(o);let l=a.mul(t).add(c);return n&&(l=l.mul(t_)),l}class Pc{constructor(e,t,n,i){e!==Kl&&cn.throwError("cannot use FixedFormat constructor; use FixedFormat.from",K.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.signed=t,this.width=n,this.decimals=i,this.name=(t?"":"u")+"fixed"+String(n)+"x"+String(i),this._multiplier=Hm(i),Object.freeze(this)}static from(e){if(e instanceof Pc)return e;typeof e=="number"&&(e=`fixed128x${e}`);let t=!0,n=128,i=18;if(typeof e=="string"){if(e!=="fixed")if(e==="ufixed")t=!1;else{const s=e.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);s||cn.throwArgumentError("invalid fixed format","format",e),t=s[1]!=="u",n=parseInt(s[2]),i=parseInt(s[3])}}else if(e){const s=(o,a,c)=>e[o]==null?c:(typeof e[o]!==a&&cn.throwArgumentError("invalid fixed format ("+o+" not "+a+")","format."+o,e[o]),e[o]);t=s("signed","boolean",t),n=s("width","number",n),i=s("decimals","number",i)}return n%8&&cn.throwArgumentError("invalid fixed format width (not byte aligned)","format.width",n),i>80&&cn.throwArgumentError("invalid fixed format (decimals too large)","format.decimals",i),new Pc(Kl,t,n,i)}}class Ur{constructor(e,t,n,i){e!==Kl&&cn.throwError("cannot use FixedNumber constructor; use FixedNumber.from",K.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.format=i,this._hex=t,this._value=n,this._isFixedNumber=!0,Object.freeze(this)}_checkFormat(e){this.format.name!==e.format.name&&cn.throwArgumentError("incompatible format; use fixedNumber.toFormat","other",e)}addUnsafe(e){this._checkFormat(e);const t=Wi(this._value,this.format.decimals),n=Wi(e._value,e.format.decimals);return Ur.fromValue(t.add(n),this.format.decimals,this.format)}subUnsafe(e){this._checkFormat(e);const t=Wi(this._value,this.format.decimals),n=Wi(e._value,e.format.decimals);return Ur.fromValue(t.sub(n),this.format.decimals,this.format)}mulUnsafe(e){this._checkFormat(e);const t=Wi(this._value,this.format.decimals),n=Wi(e._value,e.format.decimals);return Ur.fromValue(t.mul(n).div(this.format._multiplier),this.format.decimals,this.format)}divUnsafe(e){this._checkFormat(e);const t=Wi(this._value,this.format.decimals),n=Wi(e._value,e.format.decimals);return Ur.fromValue(t.mul(this.format._multiplier).div(n),this.format.decimals,this.format)}floor(){const e=this.toString().split(".");e.length===1&&e.push("0");let t=Ur.from(e[0],this.format);const n=!e[1].match(/^(0*)$/);return this.isNegative()&&n&&(t=t.subUnsafe(mx.toFormat(t.format))),t}ceiling(){const e=this.toString().split(".");e.length===1&&e.push("0");let t=Ur.from(e[0],this.format);const n=!e[1].match(/^(0*)$/);return!this.isNegative()&&n&&(t=t.addUnsafe(mx.toFormat(t.format))),t}round(e){e==null&&(e=0);const t=this.toString().split(".");if(t.length===1&&t.push("0"),(e<0||e>80||e%1)&&cn.throwArgumentError("invalid decimal count","decimals",e),t[1].length<=e)return this;const n=Ur.from("1"+Vl.substring(0,e),this.format),i=rq.toFormat(this.format);return this.mulUnsafe(n).addUnsafe(i).floor().divUnsafe(n)}isZero(){return this._value==="0.0"||this._value==="0"}isNegative(){return this._value[0]==="-"}toString(){return this._value}toHexString(e){if(e==null)return this._hex;e%8&&cn.throwArgumentError("invalid byte width","width",e);const t=ie.from(this._hex).fromTwos(this.format.width).toTwos(e).toHexString();return Ct(t,e/8)}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return Ur.fromString(this._value,e)}static fromValue(e,t,n){return n==null&&t!=null&&!Qj(t)&&(n=t,t=null),t==null&&(t=0),n==null&&(n="fixed"),Ur.fromString(hf(e,t),Pc.from(n))}static fromString(e,t){t==null&&(t="fixed");const n=Pc.from(t),i=Wi(e,n.decimals);!n.signed&&i.lt(e_)&&r_("unsigned value cannot be negative","overflow","value",e);let s=null;n.signed?s=i.toTwos(n.width).toHexString():(s=i.toHexString(),s=Ct(s,n.width/8));const o=hf(i,n.decimals);return new Ur(Kl,s,o,n)}static fromBytes(e,t){t==null&&(t="fixed");const n=Pc.from(t);if(te(e).length>n.width/8)throw new Error("overflow");let i=ie.from(e);n.signed&&(i=i.fromTwos(n.width));const s=i.toTwos((n.signed?0:1)+n.width).toHexString(),o=hf(i,n.decimals);return new Ur(Kl,s,o,n)}static from(e,t){if(typeof e=="string")return Ur.fromString(e,t);if(Ba(e))return Ur.fromBytes(e,t);try{return Ur.fromValue(e,0,t)}catch(n){if(n.code!==K.errors.INVALID_ARGUMENT)throw n}return cn.throwArgumentError("invalid FixedNumber value","value",e)}static isFixedNumber(e){return!!(e&&e._isFixedNumber)}}const mx=Ur.from(1),rq=Ur.from("0.5"),nq="properties/5.8.0";var iq=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};const Qf=new K(nq);function J(r,e,t){Object.defineProperty(r,e,{enumerable:!0,value:t,writable:!1})}function Ti(r,e){for(let t=0;t<32;t++){if(r[e])return r[e];if(!r.prototype||typeof r.prototype!="object")break;r=Object.getPrototypeOf(r.prototype).constructor}return null}function or(r){return iq(this,void 0,void 0,function*(){const e=Object.keys(r).map(n=>{const i=r[n];return Promise.resolve(i).then(s=>({key:n,value:s}))});return(yield Promise.all(e)).reduce((n,i)=>(n[i.key]=i.value,n),{})})}function Wm(r,e){(!r||typeof r!="object")&&Qf.throwArgumentError("invalid object","object",r),Object.keys(r).forEach(t=>{e[t]||Qf.throwArgumentError("invalid object key - "+t,"transaction:"+t,r)})}function mr(r){const e={};for(const t in r)e[t]=r[t];return e}const sq={bigint:!0,boolean:!0,function:!0,number:!0,string:!0};function n_(r){if(r==null||sq[typeof r])return!0;if(Array.isArray(r)||typeof r=="object"){if(!Object.isFrozen(r))return!1;const e=Object.keys(r);for(let t=0;t<e.length;t++){let n=null;try{n=r[e[t]]}catch{continue}if(!n_(n))return!1}return!0}return Qf.throwArgumentError(`Cannot deepCopy ${typeof r}`,"object",r)}function oq(r){if(n_(r))return r;if(Array.isArray(r))return Object.freeze(r.map(e=>ds(e)));if(typeof r=="object"){const e={};for(const t in r){const n=r[t];n!==void 0&&J(e,t,ds(n))}return e}return Qf.throwArgumentError(`Cannot deepCopy ${typeof r}`,"object",r)}function ds(r){return oq(r)}class Io{constructor(e){for(const t in e)this[t]=ds(e[t])}}const aq=Object.freeze(Object.defineProperty({__proto__:null,Description:Io,checkProperties:Wm,deepCopy:ds,defineReadOnly:J,getStatic:Ti,resolveProperties:or,shallowCopy:mr},Symbol.toStringTag,{value:"Module"})),hd="abi/5.8.0",ze=new K(hd),Sa={};let bx={calldata:!0,memory:!0,storage:!0},cq={calldata:!0,memory:!0};function Kd(r,e){if(r==="bytes"||r==="string"){if(bx[e])return!0}else if(r==="address"){if(e==="payable")return!0}else if((r.indexOf("[")>=0||r==="tuple")&&cq[e])return!0;return(bx[e]||e==="payable")&&ze.throwArgumentError("invalid modifier","name",e),!1}function lq(r,e){let t=r;function n(a){ze.throwArgumentError(`unexpected character at position ${a}`,"param",r)}r=r.replace(/\s/g," ");function i(a){let c={type:"",name:"",parent:a,state:{allowType:!0}};return e&&(c.indexed=!1),c}let s={type:"",name:"",state:{allowType:!0}},o=s;for(let a=0;a<r.length;a++){let c=r[a];switch(c){case"(":o.state.allowType&&o.type===""?o.type="tuple":o.state.allowParams||n(a),o.state.allowType=!1,o.type=mc(o.type),o.components=[i(o)],o=o.components[0];break;case")":delete o.state,o.name==="indexed"&&(e||n(a),o.indexed=!0,o.name=""),Kd(o.type,o.name)&&(o.name=""),o.type=mc(o.type);let l=o;o=o.parent,o||n(a),delete l.parent,o.state.allowParams=!1,o.state.allowName=!0,o.state.allowArray=!0;break;case",":delete o.state,o.name==="indexed"&&(e||n(a),o.indexed=!0,o.name=""),Kd(o.type,o.name)&&(o.name=""),o.type=mc(o.type);let u=i(o.parent);o.parent.components.push(u),delete o.parent,o=u;break;case" ":o.state.allowType&&o.type!==""&&(o.type=mc(o.type),delete o.state.allowType,o.state.allowName=!0,o.state.allowParams=!0),o.state.allowName&&o.name!==""&&(o.name==="indexed"?(e||n(a),o.indexed&&n(a),o.indexed=!0,o.name=""):Kd(o.type,o.name)?o.name="":o.state.allowName=!1);break;case"[":o.state.allowArray||n(a),o.type+=c,o.state.allowArray=!1,o.state.allowName=!1,o.state.readArray=!0;break;case"]":o.state.readArray||n(a),o.type+=c,o.state.readArray=!1,o.state.allowArray=!0,o.state.allowName=!0;break;default:o.state.allowType?(o.type+=c,o.state.allowParams=!0,o.state.allowArray=!0):o.state.allowName?(o.name+=c,delete o.state.allowArray):o.state.readArray?o.type+=c:n(a)}}return o.parent&&ze.throwArgumentError("unexpected eof","param",r),delete s.state,o.name==="indexed"?(e||n(t.length-7),o.indexed&&n(t.length-7),o.indexed=!0,o.name=""):Kd(o.type,o.name)&&(o.name=""),s.type=mc(s.type),s}function pf(r,e){for(let t in e)J(r,t,e[t])}const et=Object.freeze({sighash:"sighash",minimal:"minimal",full:"full",json:"json"}),uq=new RegExp(/^(.*)\[([0-9]*)\]$/);class Er{constructor(e,t){e!==Sa&&ze.throwError("use fromString",K.errors.UNSUPPORTED_OPERATION,{operation:"new ParamType()"}),pf(this,t);let n=this.type.match(uq);n?pf(this,{arrayLength:parseInt(n[2]||"-1"),arrayChildren:Er.fromObject({type:n[1],components:this.components}),baseType:"array"}):pf(this,{arrayLength:null,arrayChildren:null,baseType:this.components!=null?"tuple":this.type}),this._isParamType=!0,Object.freeze(this)}format(e){if(e||(e=et.sighash),et[e]||ze.throwArgumentError("invalid format type","format",e),e===et.json){let n={type:this.baseType==="tuple"?"tuple":this.type,name:this.name||void 0};return typeof this.indexed=="boolean"&&(n.indexed=this.indexed),this.components&&(n.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(n)}let t="";return this.baseType==="array"?(t+=this.arrayChildren.format(e),t+="["+(this.arrayLength<0?"":String(this.arrayLength))+"]"):this.baseType==="tuple"?(e!==et.sighash&&(t+=this.type),t+="("+this.components.map(n=>n.format(e)).join(e===et.full?", ":",")+")"):t+=this.type,e!==et.sighash&&(this.indexed===!0&&(t+=" indexed"),e===et.full&&this.name&&(t+=" "+this.name)),t}static from(e,t){return typeof e=="string"?Er.fromString(e,t):Er.fromObject(e)}static fromObject(e){return Er.isParamType(e)?e:new Er(Sa,{name:e.name||null,type:mc(e.type),indexed:e.indexed==null?null:!!e.indexed,components:e.components?e.components.map(Er.fromObject):null})}static fromString(e,t){function n(i){return Er.fromObject({name:i.name,type:i.type,indexed:i.indexed,components:i.components})}return n(lq(e,!!t))}static isParamType(e){return!!(e!=null&&e._isParamType)}}function Hu(r,e){return fq(r).map(t=>Er.fromString(t,e))}class ts{constructor(e,t){e!==Sa&&ze.throwError("use a static from method",K.errors.UNSUPPORTED_OPERATION,{operation:"new Fragment()"}),pf(this,t),this._isFragment=!0,Object.freeze(this)}static from(e){return ts.isFragment(e)?e:typeof e=="string"?ts.fromString(e):ts.fromObject(e)}static fromObject(e){if(ts.isFragment(e))return e;switch(e.type){case"function":return Si.fromObject(e);case"event":return Zi.fromObject(e);case"constructor":return Ci.fromObject(e);case"error":return Rs.fromObject(e);case"fallback":case"receive":return null}return ze.throwArgumentError("invalid fragment object","value",e)}static fromString(e){return e=e.replace(/\s/g," "),e=e.replace(/\(/g," (").replace(/\)/g,") ").replace(/\s+/g," "),e=e.trim(),e.split(" ")[0]==="event"?Zi.fromString(e.substring(5).trim()):e.split(" ")[0]==="function"?Si.fromString(e.substring(8).trim()):e.split("(")[0].trim()==="constructor"?Ci.fromString(e.trim()):e.split(" ")[0]==="error"?Rs.fromString(e.substring(5).trim()):ze.throwArgumentError("unsupported fragment","value",e)}static isFragment(e){return!!(e&&e._isFragment)}}class Zi extends ts{format(e){if(e||(e=et.sighash),et[e]||ze.throwArgumentError("invalid format type","format",e),e===et.json)return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});let t="";return e!==et.sighash&&(t+="event "),t+=this.name+"("+this.inputs.map(n=>n.format(e)).join(e===et.full?", ":",")+") ",e!==et.sighash&&this.anonymous&&(t+="anonymous "),t.trim()}static from(e){return typeof e=="string"?Zi.fromString(e):Zi.fromObject(e)}static fromObject(e){if(Zi.isEventFragment(e))return e;e.type!=="event"&&ze.throwArgumentError("invalid event object","value",e);const t={name:Wu(e.name),anonymous:e.anonymous,inputs:e.inputs?e.inputs.map(Er.fromObject):[],type:"event"};return new Zi(Sa,t)}static fromString(e){let t=e.match(zu);t||ze.throwArgumentError("invalid event string","value",e);let n=!1;return t[3].split(" ").forEach(i=>{switch(i.trim()){case"anonymous":n=!0;break;case"":break;default:ze.warn("unknown modifier: "+i)}}),Zi.fromObject({name:t[1].trim(),anonymous:n,inputs:Hu(t[2],!0),type:"event"})}static isEventFragment(e){return e&&e._isFragment&&e.type==="event"}}function i_(r,e){e.gas=null;let t=r.split("@");return t.length!==1?(t.length>2&&ze.throwArgumentError("invalid human-readable ABI signature","value",r),t[1].match(/^[0-9]+$/)||ze.throwArgumentError("invalid human-readable ABI signature gas","value",r),e.gas=ie.from(t[1]),t[0]):r}function s_(r,e){e.constant=!1,e.payable=!1,e.stateMutability="nonpayable",r.split(" ").forEach(t=>{switch(t.trim()){case"constant":e.constant=!0;break;case"payable":e.payable=!0,e.stateMutability="payable";break;case"nonpayable":e.payable=!1,e.stateMutability="nonpayable";break;case"pure":e.constant=!0,e.stateMutability="pure";break;case"view":e.constant=!0,e.stateMutability="view";break;case"external":case"public":case"":break;default:console.log("unknown modifier: "+t)}})}function o_(r){let e={constant:!1,payable:!0,stateMutability:"payable"};return r.stateMutability!=null?(e.stateMutability=r.stateMutability,e.constant=e.stateMutability==="view"||e.stateMutability==="pure",r.constant!=null&&!!r.constant!==e.constant&&ze.throwArgumentError("cannot have constant function with mutability "+e.stateMutability,"value",r),e.payable=e.stateMutability==="payable",r.payable!=null&&!!r.payable!==e.payable&&ze.throwArgumentError("cannot have payable function with mutability "+e.stateMutability,"value",r)):r.payable!=null?(e.payable=!!r.payable,r.constant==null&&!e.payable&&r.type!=="constructor"&&ze.throwArgumentError("unable to determine stateMutability","value",r),e.constant=!!r.constant,e.constant?e.stateMutability="view":e.stateMutability=e.payable?"payable":"nonpayable",e.payable&&e.constant&&ze.throwArgumentError("cannot have constant payable function","value",r)):r.constant!=null?(e.constant=!!r.constant,e.payable=!e.constant,e.stateMutability=e.constant?"view":"payable"):r.type!=="constructor"&&ze.throwArgumentError("unable to determine stateMutability","value",r),e}class Ci extends ts{format(e){if(e||(e=et.sighash),et[e]||ze.throwArgumentError("invalid format type","format",e),e===et.json)return JSON.stringify({type:"constructor",stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});e===et.sighash&&ze.throwError("cannot format a constructor for sighash",K.errors.UNSUPPORTED_OPERATION,{operation:"format(sighash)"});let t="constructor("+this.inputs.map(n=>n.format(e)).join(e===et.full?", ":",")+") ";return this.stateMutability&&this.stateMutability!=="nonpayable"&&(t+=this.stateMutability+" "),t.trim()}static from(e){return typeof e=="string"?Ci.fromString(e):Ci.fromObject(e)}static fromObject(e){if(Ci.isConstructorFragment(e))return e;e.type!=="constructor"&&ze.throwArgumentError("invalid constructor object","value",e);let t=o_(e);t.constant&&ze.throwArgumentError("constructor cannot be constant","value",e);const n={name:null,type:e.type,inputs:e.inputs?e.inputs.map(Er.fromObject):[],payable:t.payable,stateMutability:t.stateMutability,gas:e.gas?ie.from(e.gas):null};return new Ci(Sa,n)}static fromString(e){let t={type:"constructor"};e=i_(e,t);let n=e.match(zu);return(!n||n[1].trim()!=="constructor")&&ze.throwArgumentError("invalid constructor string","value",e),t.inputs=Hu(n[2].trim(),!1),s_(n[3].trim(),t),Ci.fromObject(t)}static isConstructorFragment(e){return e&&e._isFragment&&e.type==="constructor"}}class Si extends Ci{format(e){if(e||(e=et.sighash),et[e]||ze.throwArgumentError("invalid format type","format",e),e===et.json)return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map(n=>JSON.parse(n.format(e))),outputs:this.outputs.map(n=>JSON.parse(n.format(e)))});let t="";return e!==et.sighash&&(t+="function "),t+=this.name+"("+this.inputs.map(n=>n.format(e)).join(e===et.full?", ":",")+") ",e!==et.sighash&&(this.stateMutability?this.stateMutability!=="nonpayable"&&(t+=this.stateMutability+" "):this.constant&&(t+="view "),this.outputs&&this.outputs.length&&(t+="returns ("+this.outputs.map(n=>n.format(e)).join(", ")+") "),this.gas!=null&&(t+="@"+this.gas.toString()+" ")),t.trim()}static from(e){return typeof e=="string"?Si.fromString(e):Si.fromObject(e)}static fromObject(e){if(Si.isFunctionFragment(e))return e;e.type!=="function"&&ze.throwArgumentError("invalid function object","value",e);let t=o_(e);const n={type:e.type,name:Wu(e.name),constant:t.constant,inputs:e.inputs?e.inputs.map(Er.fromObject):[],outputs:e.outputs?e.outputs.map(Er.fromObject):[],payable:t.payable,stateMutability:t.stateMutability,gas:e.gas?ie.from(e.gas):null};return new Si(Sa,n)}static fromString(e){let t={type:"function"};e=i_(e,t);let n=e.split(" returns ");n.length>2&&ze.throwArgumentError("invalid function string","value",e);let i=n[0].match(zu);if(i||ze.throwArgumentError("invalid function signature","value",e),t.name=i[1].trim(),t.name&&Wu(t.name),t.inputs=Hu(i[2],!1),s_(i[3].trim(),t),n.length>1){let s=n[1].match(zu);(s[1].trim()!=""||s[3].trim()!="")&&ze.throwArgumentError("unexpected tokens","value",e),t.outputs=Hu(s[2],!1)}else t.outputs=[];return Si.fromObject(t)}static isFunctionFragment(e){return e&&e._isFragment&&e.type==="function"}}function yx(r){const e=r.format();return(e==="Error(string)"||e==="Panic(uint256)")&&ze.throwArgumentError(`cannot specify user defined ${e} error`,"fragment",r),r}class Rs extends ts{format(e){if(e||(e=et.sighash),et[e]||ze.throwArgumentError("invalid format type","format",e),e===et.json)return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});let t="";return e!==et.sighash&&(t+="error "),t+=this.name+"("+this.inputs.map(n=>n.format(e)).join(e===et.full?", ":",")+") ",t.trim()}static from(e){return typeof e=="string"?Rs.fromString(e):Rs.fromObject(e)}static fromObject(e){if(Rs.isErrorFragment(e))return e;e.type!=="error"&&ze.throwArgumentError("invalid error object","value",e);const t={type:e.type,name:Wu(e.name),inputs:e.inputs?e.inputs.map(Er.fromObject):[]};return yx(new Rs(Sa,t))}static fromString(e){let t={type:"error"},n=e.match(zu);return n||ze.throwArgumentError("invalid error signature","value",e),t.name=n[1].trim(),t.name&&Wu(t.name),t.inputs=Hu(n[2],!1),yx(Rs.fromObject(t))}static isErrorFragment(e){return e&&e._isFragment&&e.type==="error"}}function mc(r){return r.match(/^uint($|[^1-9])/)?r="uint256"+r.substring(4):r.match(/^int($|[^1-9])/)&&(r="int256"+r.substring(3)),r}const dq=new RegExp("^[a-zA-Z$_][a-zA-Z0-9$_]*$");function Wu(r){return(!r||!r.match(dq))&&ze.throwArgumentError(`invalid identifier "${r}"`,"value",r),r}const zu=new RegExp("^([^)(]*)\\((.*)\\)([^)(]*)$");function fq(r){r=r.trim();let e=[],t="",n=0;for(let i=0;i<r.length;i++){let s=r[i];s===","&&n===0?(e.push(t),t=""):(t+=s,s==="("?n++:s===")"&&(n--,n===-1&&ze.throwArgumentError("unbalanced parenthesis","value",r)))}return t&&e.push(t),e}const zm=new K(hd);function a_(r){const e=[],t=function(n,i){if(Array.isArray(i))for(let s in i){const o=n.slice();o.push(s);try{t(o,i[s])}catch(a){e.push({path:o,error:a})}}};return t([],r),e}class Hs{constructor(e,t,n,i){this.name=e,this.type=t,this.localName=n,this.dynamic=i}_throwError(e,t){zm.throwArgumentError(e,this.localName,t)}}class qg{constructor(e){J(this,"wordSize",e||32),this._data=[],this._dataLength=0,this._padding=new Uint8Array(e)}get data(){return an(this._data)}get length(){return this._dataLength}_writeData(e){return this._data.push(e),this._dataLength+=e.length,e.length}appendWriter(e){return this._writeData(Nt(e._data))}writeBytes(e){let t=te(e);const n=t.length%this.wordSize;return n&&(t=Nt([t,this._padding.slice(n)])),this._writeData(t)}_getValue(e){let t=te(ie.from(e));return t.length>this.wordSize&&zm.throwError("value out-of-bounds",K.errors.BUFFER_OVERRUN,{length:this.wordSize,offset:t.length}),t.length%this.wordSize&&(t=Nt([this._padding.slice(t.length%this.wordSize),t])),t}writeValue(e){return this._writeData(this._getValue(e))}writeUpdatableValue(){const e=this._data.length;return this._data.push(this._padding),this._dataLength+=this.wordSize,t=>{this._data[e]=this._getValue(t)}}}class eh{constructor(e,t,n,i){J(this,"_data",te(e)),J(this,"wordSize",t||32),J(this,"_coerceFunc",n),J(this,"allowLoose",i),this._offset=0}get data(){return oe(this._data)}get consumed(){return this._offset}static coerce(e,t){let n=e.match("^u?int([0-9]+)$");return n&&parseInt(n[1])<=48&&(t=t.toNumber()),t}coerce(e,t){return this._coerceFunc?this._coerceFunc(e,t):eh.coerce(e,t)}_peekBytes(e,t,n){let i=Math.ceil(t/this.wordSize)*this.wordSize;return this._offset+i>this._data.length&&(this.allowLoose&&n&&this._offset+t<=this._data.length?i=t:zm.throwError("data out-of-bounds",K.errors.BUFFER_OVERRUN,{length:this._data.length,offset:this._offset+i})),this._data.slice(this._offset,this._offset+i)}subReader(e){return new eh(this._data.slice(this._offset+e),this.wordSize,this._coerceFunc,this.allowLoose)}readBytes(e,t){let n=this._peekBytes(0,e,!!t);return this._offset+=n.length,n.slice(0,e)}readValue(){return ie.from(this.readBytes(this.wordSize))}}var up={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */var wx;function hq(){return wx||(wx=1,(function(r){(function(){var e="input is invalid type",t="finalize already called",n=typeof window=="object",i=n?window:{};i.JS_SHA3_NO_WINDOW&&(n=!1);var s=!n&&typeof self=="object",o=!i.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;o?i=Ei:s&&(i=self);var a=!i.JS_SHA3_NO_COMMON_JS&&!0&&r.exports,c=!i.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",l="0123456789abcdef".split(""),u=[31,7936,2031616,520093696],d=[4,1024,262144,67108864],p=[1,256,65536,16777216],x=[6,1536,393216,100663296],w=[0,8,16,24],b=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],y=[224,256,384,512],C=[128,256],T=["hex","buffer","arrayBuffer","array","digest"],I={128:168,256:136};(i.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(v){return Object.prototype.toString.call(v)==="[object Array]"}),c&&(i.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(v){return typeof v=="object"&&v.buffer&&v.buffer.constructor===ArrayBuffer});for(var k=function(v,H,V){return function(z){return new g(v,H,v).update(z)[V]()}},P=function(v,H,V){return function(z,G){return new g(v,H,G).update(z)[V]()}},O=function(v,H,V){return function(z,G,re,X){return f["cshake"+v].update(z,G,re,X)[V]()}},q=function(v,H,V){return function(z,G,re,X){return f["kmac"+v].update(z,G,re,X)[V]()}},F=function(v,H,V,z){for(var G=0;G<T.length;++G){var re=T[G];v[re]=H(V,z,re)}return v},B=function(v,H){var V=k(v,H,"hex");return V.create=function(){return new g(v,H,v)},V.update=function(z){return V.create().update(z)},F(V,k,v,H)},W=function(v,H){var V=P(v,H,"hex");return V.create=function(z){return new g(v,H,z)},V.update=function(z,G){return V.create(G).update(z)},F(V,P,v,H)},j=function(v,H){var V=I[v],z=O(v,H,"hex");return z.create=function(G,re,X){return!re&&!X?f["shake"+v].create(G):new g(v,H,G).bytepad([re,X],V)},z.update=function(G,re,X,ne){return z.create(re,X,ne).update(G)},F(z,O,v,H)},U=function(v,H){var V=I[v],z=q(v,H,"hex");return z.create=function(G,re,X){return new N(v,H,re).bytepad(["KMAC",X],V).bytepad([G],V)},z.update=function(G,re,X,ne){return z.create(G,X,ne).update(re)},F(z,q,v,H)},_=[{name:"keccak",padding:p,bits:y,createMethod:B},{name:"sha3",padding:x,bits:y,createMethod:B},{name:"shake",padding:u,bits:C,createMethod:W},{name:"cshake",padding:d,bits:C,createMethod:j},{name:"kmac",padding:d,bits:C,createMethod:U}],f={},h=[],m=0;m<_.length;++m)for(var A=_[m],S=A.bits,R=0;R<S.length;++R){var M=A.name+"_"+S[R];if(h.push(M),f[M]=A.createMethod(S[R],A.padding),A.name!=="sha3"){var E=A.name+S[R];h.push(E),f[E]=f[M]}}function g(v,H,V){this.blocks=[],this.s=[],this.padding=H,this.outputBits=V,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(v<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=V>>5,this.extraBytes=(V&31)>>3;for(var z=0;z<50;++z)this.s[z]=0}g.prototype.update=function(v){if(this.finalized)throw new Error(t);var H,V=typeof v;if(V!=="string"){if(V==="object"){if(v===null)throw new Error(e);if(c&&v.constructor===ArrayBuffer)v=new Uint8Array(v);else if(!Array.isArray(v)&&(!c||!ArrayBuffer.isView(v)))throw new Error(e)}else throw new Error(e);H=!0}for(var z=this.blocks,G=this.byteCount,re=v.length,X=this.blockCount,ne=0,Fe=this.s,ue,Ce;ne<re;){if(this.reset)for(this.reset=!1,z[0]=this.block,ue=1;ue<X+1;++ue)z[ue]=0;if(H)for(ue=this.start;ne<re&&ue<G;++ne)z[ue>>2]|=v[ne]<<w[ue++&3];else for(ue=this.start;ne<re&&ue<G;++ne)Ce=v.charCodeAt(ne),Ce<128?z[ue>>2]|=Ce<<w[ue++&3]:Ce<2048?(z[ue>>2]|=(192|Ce>>6)<<w[ue++&3],z[ue>>2]|=(128|Ce&63)<<w[ue++&3]):Ce<55296||Ce>=57344?(z[ue>>2]|=(224|Ce>>12)<<w[ue++&3],z[ue>>2]|=(128|Ce>>6&63)<<w[ue++&3],z[ue>>2]|=(128|Ce&63)<<w[ue++&3]):(Ce=65536+((Ce&1023)<<10|v.charCodeAt(++ne)&1023),z[ue>>2]|=(240|Ce>>18)<<w[ue++&3],z[ue>>2]|=(128|Ce>>12&63)<<w[ue++&3],z[ue>>2]|=(128|Ce>>6&63)<<w[ue++&3],z[ue>>2]|=(128|Ce&63)<<w[ue++&3]);if(this.lastByteIndex=ue,ue>=G){for(this.start=ue-G,this.block=z[X],ue=0;ue<X;++ue)Fe[ue]^=z[ue];L(Fe),this.reset=!0}else this.start=ue}return this},g.prototype.encode=function(v,H){var V=v&255,z=1,G=[V];for(v=v>>8,V=v&255;V>0;)G.unshift(V),v=v>>8,V=v&255,++z;return H?G.push(z):G.unshift(z),this.update(G),G.length},g.prototype.encodeString=function(v){var H,V=typeof v;if(V!=="string"){if(V==="object"){if(v===null)throw new Error(e);if(c&&v.constructor===ArrayBuffer)v=new Uint8Array(v);else if(!Array.isArray(v)&&(!c||!ArrayBuffer.isView(v)))throw new Error(e)}else throw new Error(e);H=!0}var z=0,G=v.length;if(H)z=G;else for(var re=0;re<v.length;++re){var X=v.charCodeAt(re);X<128?z+=1:X<2048?z+=2:X<55296||X>=57344?z+=3:(X=65536+((X&1023)<<10|v.charCodeAt(++re)&1023),z+=4)}return z+=this.encode(z*8),this.update(v),z},g.prototype.bytepad=function(v,H){for(var V=this.encode(H),z=0;z<v.length;++z)V+=this.encodeString(v[z]);var G=H-V%H,re=[];return re.length=G,this.update(re),this},g.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var v=this.blocks,H=this.lastByteIndex,V=this.blockCount,z=this.s;if(v[H>>2]|=this.padding[H&3],this.lastByteIndex===this.byteCount)for(v[0]=v[V],H=1;H<V+1;++H)v[H]=0;for(v[V-1]|=2147483648,H=0;H<V;++H)z[H]^=v[H];L(z)}},g.prototype.toString=g.prototype.hex=function(){this.finalize();for(var v=this.blockCount,H=this.s,V=this.outputBlocks,z=this.extraBytes,G=0,re=0,X="",ne;re<V;){for(G=0;G<v&&re<V;++G,++re)ne=H[G],X+=l[ne>>4&15]+l[ne&15]+l[ne>>12&15]+l[ne>>8&15]+l[ne>>20&15]+l[ne>>16&15]+l[ne>>28&15]+l[ne>>24&15];re%v===0&&(L(H),G=0)}return z&&(ne=H[G],X+=l[ne>>4&15]+l[ne&15],z>1&&(X+=l[ne>>12&15]+l[ne>>8&15]),z>2&&(X+=l[ne>>20&15]+l[ne>>16&15])),X},g.prototype.arrayBuffer=function(){this.finalize();var v=this.blockCount,H=this.s,V=this.outputBlocks,z=this.extraBytes,G=0,re=0,X=this.outputBits>>3,ne;z?ne=new ArrayBuffer(V+1<<2):ne=new ArrayBuffer(X);for(var Fe=new Uint32Array(ne);re<V;){for(G=0;G<v&&re<V;++G,++re)Fe[re]=H[G];re%v===0&&L(H)}return z&&(Fe[G]=H[G],ne=ne.slice(0,X)),ne},g.prototype.buffer=g.prototype.arrayBuffer,g.prototype.digest=g.prototype.array=function(){this.finalize();for(var v=this.blockCount,H=this.s,V=this.outputBlocks,z=this.extraBytes,G=0,re=0,X=[],ne,Fe;re<V;){for(G=0;G<v&&re<V;++G,++re)ne=re<<2,Fe=H[G],X[ne]=Fe&255,X[ne+1]=Fe>>8&255,X[ne+2]=Fe>>16&255,X[ne+3]=Fe>>24&255;re%v===0&&L(H)}return z&&(ne=re<<2,Fe=H[G],X[ne]=Fe&255,z>1&&(X[ne+1]=Fe>>8&255),z>2&&(X[ne+2]=Fe>>16&255)),X};function N(v,H,V){g.call(this,v,H,V)}N.prototype=new g,N.prototype.finalize=function(){return this.encode(this.outputBits,!0),g.prototype.finalize.call(this)};var L=function(v){var H,V,z,G,re,X,ne,Fe,ue,Ce,rn,Je,dt,Rn,ct,tt,On,lt,Ze,nn,ut,ft,ps,vt,Et,Ro,Tt,Pt,Oo,Rt,Ot,ko,kt,Dt,Do,Mt,Ut,Mo,Bt,$t,Uo,Lt,Ft,Bo,jt,qt,$o,Ht,Wt,Lo,zt,Kt,Fo,Vt,Gt,jo,Yt,Jt,Ws,zs,Ks,Vs,Gs;for(z=0;z<48;z+=2)G=v[0]^v[10]^v[20]^v[30]^v[40],re=v[1]^v[11]^v[21]^v[31]^v[41],X=v[2]^v[12]^v[22]^v[32]^v[42],ne=v[3]^v[13]^v[23]^v[33]^v[43],Fe=v[4]^v[14]^v[24]^v[34]^v[44],ue=v[5]^v[15]^v[25]^v[35]^v[45],Ce=v[6]^v[16]^v[26]^v[36]^v[46],rn=v[7]^v[17]^v[27]^v[37]^v[47],Je=v[8]^v[18]^v[28]^v[38]^v[48],dt=v[9]^v[19]^v[29]^v[39]^v[49],H=Je^(X<<1|ne>>>31),V=dt^(ne<<1|X>>>31),v[0]^=H,v[1]^=V,v[10]^=H,v[11]^=V,v[20]^=H,v[21]^=V,v[30]^=H,v[31]^=V,v[40]^=H,v[41]^=V,H=G^(Fe<<1|ue>>>31),V=re^(ue<<1|Fe>>>31),v[2]^=H,v[3]^=V,v[12]^=H,v[13]^=V,v[22]^=H,v[23]^=V,v[32]^=H,v[33]^=V,v[42]^=H,v[43]^=V,H=X^(Ce<<1|rn>>>31),V=ne^(rn<<1|Ce>>>31),v[4]^=H,v[5]^=V,v[14]^=H,v[15]^=V,v[24]^=H,v[25]^=V,v[34]^=H,v[35]^=V,v[44]^=H,v[45]^=V,H=Fe^(Je<<1|dt>>>31),V=ue^(dt<<1|Je>>>31),v[6]^=H,v[7]^=V,v[16]^=H,v[17]^=V,v[26]^=H,v[27]^=V,v[36]^=H,v[37]^=V,v[46]^=H,v[47]^=V,H=Ce^(G<<1|re>>>31),V=rn^(re<<1|G>>>31),v[8]^=H,v[9]^=V,v[18]^=H,v[19]^=V,v[28]^=H,v[29]^=V,v[38]^=H,v[39]^=V,v[48]^=H,v[49]^=V,Rn=v[0],ct=v[1],qt=v[11]<<4|v[10]>>>28,$o=v[10]<<4|v[11]>>>28,Pt=v[20]<<3|v[21]>>>29,Oo=v[21]<<3|v[20]>>>29,zs=v[31]<<9|v[30]>>>23,Ks=v[30]<<9|v[31]>>>23,Lt=v[40]<<18|v[41]>>>14,Ft=v[41]<<18|v[40]>>>14,Dt=v[2]<<1|v[3]>>>31,Do=v[3]<<1|v[2]>>>31,tt=v[13]<<12|v[12]>>>20,On=v[12]<<12|v[13]>>>20,Ht=v[22]<<10|v[23]>>>22,Wt=v[23]<<10|v[22]>>>22,Rt=v[33]<<13|v[32]>>>19,Ot=v[32]<<13|v[33]>>>19,Vs=v[42]<<2|v[43]>>>30,Gs=v[43]<<2|v[42]>>>30,Vt=v[5]<<30|v[4]>>>2,Gt=v[4]<<30|v[5]>>>2,Mt=v[14]<<6|v[15]>>>26,Ut=v[15]<<6|v[14]>>>26,lt=v[25]<<11|v[24]>>>21,Ze=v[24]<<11|v[25]>>>21,Lo=v[34]<<15|v[35]>>>17,zt=v[35]<<15|v[34]>>>17,ko=v[45]<<29|v[44]>>>3,kt=v[44]<<29|v[45]>>>3,vt=v[6]<<28|v[7]>>>4,Et=v[7]<<28|v[6]>>>4,jo=v[17]<<23|v[16]>>>9,Yt=v[16]<<23|v[17]>>>9,Mo=v[26]<<25|v[27]>>>7,Bt=v[27]<<25|v[26]>>>7,nn=v[36]<<21|v[37]>>>11,ut=v[37]<<21|v[36]>>>11,Kt=v[47]<<24|v[46]>>>8,Fo=v[46]<<24|v[47]>>>8,Bo=v[8]<<27|v[9]>>>5,jt=v[9]<<27|v[8]>>>5,Ro=v[18]<<20|v[19]>>>12,Tt=v[19]<<20|v[18]>>>12,Jt=v[29]<<7|v[28]>>>25,Ws=v[28]<<7|v[29]>>>25,$t=v[38]<<8|v[39]>>>24,Uo=v[39]<<8|v[38]>>>24,ft=v[48]<<14|v[49]>>>18,ps=v[49]<<14|v[48]>>>18,v[0]=Rn^~tt&lt,v[1]=ct^~On&Ze,v[10]=vt^~Ro&Pt,v[11]=Et^~Tt&Oo,v[20]=Dt^~Mt&Mo,v[21]=Do^~Ut&Bt,v[30]=Bo^~qt&Ht,v[31]=jt^~$o&Wt,v[40]=Vt^~jo&Jt,v[41]=Gt^~Yt&Ws,v[2]=tt^~lt&nn,v[3]=On^~Ze&ut,v[12]=Ro^~Pt&Rt,v[13]=Tt^~Oo&Ot,v[22]=Mt^~Mo&$t,v[23]=Ut^~Bt&Uo,v[32]=qt^~Ht&Lo,v[33]=$o^~Wt&zt,v[42]=jo^~Jt&zs,v[43]=Yt^~Ws&Ks,v[4]=lt^~nn&ft,v[5]=Ze^~ut&ps,v[14]=Pt^~Rt&ko,v[15]=Oo^~Ot&kt,v[24]=Mo^~$t&Lt,v[25]=Bt^~Uo&Ft,v[34]=Ht^~Lo&Kt,v[35]=Wt^~zt&Fo,v[44]=Jt^~zs&Vs,v[45]=Ws^~Ks&Gs,v[6]=nn^~ft&Rn,v[7]=ut^~ps&ct,v[16]=Rt^~ko&vt,v[17]=Ot^~kt&Et,v[26]=$t^~Lt&Dt,v[27]=Uo^~Ft&Do,v[36]=Lo^~Kt&Bo,v[37]=zt^~Fo&jt,v[46]=zs^~Vs&Vt,v[47]=Ks^~Gs&Gt,v[8]=ft^~Rn&tt,v[9]=ps^~ct&On,v[18]=ko^~vt&Ro,v[19]=kt^~Et&Tt,v[28]=Lt^~Dt&Mt,v[29]=Ft^~Do&Ut,v[38]=Kt^~Bo&qt,v[39]=Fo^~jt&$o,v[48]=Vs^~Vt&jo,v[49]=Gs^~Gt&Yt,v[0]^=b[z],v[1]^=b[z+1]};if(a)r.exports=f;else for(m=0;m<h.length;++m)i[h[m]]=f[h[m]]})()})(up)),up.exports}var pq=hq();const gq=qs(pq);function xt(r){return"0x"+gq.keccak_256(te(r))}const mq=Object.freeze(Object.defineProperty({__proto__:null,keccak256:xt},Symbol.toStringTag,{value:"Module"})),bq="rlp/5.8.0",Vi=new K(bq);function xx(r){const e=[];for(;r;)e.unshift(r&255),r>>=8;return e}function vx(r,e,t){let n=0;for(let i=0;i<t;i++)n=n*256+r[e+i];return n}function c_(r){if(Array.isArray(r)){let n=[];if(r.forEach(function(s){n=n.concat(c_(s))}),n.length<=55)return n.unshift(192+n.length),n;const i=xx(n.length);return i.unshift(247+i.length),i.concat(n)}fd(r)||Vi.throwArgumentError("RLP object must be BytesLike","object",r);const e=Array.prototype.slice.call(te(r));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const t=xx(e.length);return t.unshift(183+t.length),t.concat(e)}function Na(r){return oe(c_(r))}function Ex(r,e,t,n){const i=[];for(;t<e+1+n;){const s=l_(r,t);i.push(s.result),t+=s.consumed,t>e+1+n&&Vi.throwError("child data too short",K.errors.BUFFER_OVERRUN,{})}return{consumed:1+n,result:i}}function l_(r,e){if(r.length===0&&Vi.throwError("data too short",K.errors.BUFFER_OVERRUN,{}),r[e]>=248){const t=r[e]-247;e+1+t>r.length&&Vi.throwError("data short segment too short",K.errors.BUFFER_OVERRUN,{});const n=vx(r,e+1,t);return e+1+t+n>r.length&&Vi.throwError("data long segment too short",K.errors.BUFFER_OVERRUN,{}),Ex(r,e,e+1+t,t+n)}else if(r[e]>=192){const t=r[e]-192;return e+1+t>r.length&&Vi.throwError("data array too short",K.errors.BUFFER_OVERRUN,{}),Ex(r,e,e+1,t)}else if(r[e]>=184){const t=r[e]-183;e+1+t>r.length&&Vi.throwError("data array too short",K.errors.BUFFER_OVERRUN,{});const n=vx(r,e+1,t);e+1+t+n>r.length&&Vi.throwError("data array too short",K.errors.BUFFER_OVERRUN,{});const i=oe(r.slice(e+1+t,e+1+t+n));return{consumed:1+t+n,result:i}}else if(r[e]>=128){const t=r[e]-128;e+1+t>r.length&&Vi.throwError("data too short",K.errors.BUFFER_OVERRUN,{});const n=oe(r.slice(e+1,e+1+t));return{consumed:1+t,result:n}}return{consumed:1,result:oe(r[e])}}function Ph(r){const e=te(r),t=l_(e,0);return t.consumed!==e.length&&Vi.throwArgumentError("invalid rlp data","data",r),t.result}const yq=Object.freeze(Object.defineProperty({__proto__:null,decode:Ph,encode:Na},Symbol.toStringTag,{value:"Module"})),wq="address/5.8.0",bo=new K(wq);function Ax(r){We(r,20)||bo.throwArgumentError("invalid address","address",r),r=r.toLowerCase();const e=r.substring(2).split(""),t=new Uint8Array(40);for(let i=0;i<40;i++)t[i]=e[i].charCodeAt(0);const n=te(xt(t));for(let i=0;i<40;i+=2)n[i>>1]>>4>=8&&(e[i]=e[i].toUpperCase()),(n[i>>1]&15)>=8&&(e[i+1]=e[i+1].toUpperCase());return"0x"+e.join("")}const xq=9007199254740991;function vq(r){return Math.log10?Math.log10(r):Math.log(r)/Math.LN10}const Km={};for(let r=0;r<10;r++)Km[String(r)]=String(r);for(let r=0;r<26;r++)Km[String.fromCharCode(65+r)]=String(10+r);const _x=Math.floor(vq(xq));function u_(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let e=r.split("").map(n=>Km[n]).join("");for(;e.length>=_x;){let n=e.substring(0,_x);e=parseInt(n,10)%97+e.substring(n.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}function pt(r){let e=null;if(typeof r!="string"&&bo.throwArgumentError("invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/))r.substring(0,2)!=="0x"&&(r="0x"+r),e=Ax(r),r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&e!==r&&bo.throwArgumentError("bad address checksum","address",r);else if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(r.substring(2,4)!==u_(r)&&bo.throwArgumentError("bad icap checksum","address",r),e=eq(r.substring(4));e.length<40;)e="0"+e;e=Ax("0x"+e)}else bo.throwArgumentError("invalid address","address",r);return e}function Eq(r){try{return pt(r),!0}catch{}return!1}function Aq(r){let e=tq(pt(r).substring(2)).toUpperCase();for(;e.length<30;)e="0"+e;return"XE"+u_("XE00"+e)+e}function Vm(r){let e=null;try{e=pt(r.from)}catch{bo.throwArgumentError("missing from address","transaction",r)}const t=os(te(ie.from(r.nonce).toHexString()));return pt(dr(xt(Na([e,t])),12))}function _q(r,e,t){return us(e)!==32&&bo.throwArgumentError("salt must be 32 bytes","salt",e),us(t)!==32&&bo.throwArgumentError("initCodeHash must be 32 bytes","initCodeHash",t),pt(dr(xt(Nt(["0xff",pt(r),e,t])),12))}const Cq=Object.freeze(Object.defineProperty({__proto__:null,getAddress:pt,getContractAddress:Vm,getCreate2Address:_q,getIcapAddress:Aq,isAddress:Eq},Symbol.toStringTag,{value:"Module"}));class Sq extends Hs{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){try{t=pt(t)}catch(n){this._throwError(n.message,t)}return e.writeValue(t)}decode(e){return pt(Ct(e.readValue().toHexString(),20))}}class Nq extends Hs{constructor(e){super(e.name,e.type,void 0,e.dynamic),this.coder=e}defaultValue(){return this.coder.defaultValue()}encode(e,t){return this.coder.encode(e,t)}decode(e){return this.coder.decode(e)}}const Ac=new K(hd);function d_(r,e,t){let n=null;if(Array.isArray(t))n=t;else if(t&&typeof t=="object"){let c={};n=e.map(l=>{const u=l.localName;return u||Ac.throwError("cannot encode object for signature with missing names",K.errors.INVALID_ARGUMENT,{argument:"values",coder:l,value:t}),c[u]&&Ac.throwError("cannot encode object for signature with duplicate names",K.errors.INVALID_ARGUMENT,{argument:"values",coder:l,value:t}),c[u]=!0,t[u]})}else Ac.throwArgumentError("invalid tuple value","tuple",t);e.length!==n.length&&Ac.throwArgumentError("types/value length mismatch","tuple",t);let i=new qg(r.wordSize),s=new qg(r.wordSize),o=[];e.forEach((c,l)=>{let u=n[l];if(c.dynamic){let d=s.length;c.encode(s,u);let p=i.writeUpdatableValue();o.push(x=>{p(x+d)})}else c.encode(i,u)}),o.forEach(c=>{c(i.length)});let a=r.appendWriter(i);return a+=r.appendWriter(s),a}function f_(r,e){let t=[],n=r.subReader(0);e.forEach(s=>{let o=null;if(s.dynamic){let a=r.readValue(),c=n.subReader(a.toNumber());try{o=s.decode(c)}catch(l){if(l.code===K.errors.BUFFER_OVERRUN)throw l;o=l,o.baseType=s.name,o.name=s.localName,o.type=s.type}}else try{o=s.decode(r)}catch(a){if(a.code===K.errors.BUFFER_OVERRUN)throw a;o=a,o.baseType=s.name,o.name=s.localName,o.type=s.type}o!=null&&t.push(o)});const i=e.reduce((s,o)=>{const a=o.localName;return a&&(s[a]||(s[a]=0),s[a]++),s},{});e.forEach((s,o)=>{let a=s.localName;if(!a||i[a]!==1||(a==="length"&&(a="_length"),t[a]!=null))return;const c=t[o];c instanceof Error?Object.defineProperty(t,a,{enumerable:!0,get:()=>{throw c}}):t[a]=c});for(let s=0;s<t.length;s++){const o=t[s];o instanceof Error&&Object.defineProperty(t,s,{enumerable:!0,get:()=>{throw o}})}return Object.freeze(t)}class Iq extends Hs{constructor(e,t,n){const i=e.type+"["+(t>=0?t:"")+"]",s=t===-1||e.dynamic;super("array",i,n,s),this.coder=e,this.length=t}defaultValue(){const e=this.coder.defaultValue(),t=[];for(let n=0;n<this.length;n++)t.push(e);return t}encode(e,t){Array.isArray(t)||this._throwError("expected array value",t);let n=this.length;n===-1&&(n=t.length,e.writeValue(t.length)),Ac.checkArgumentCount(t.length,n,"coder array"+(this.localName?" "+this.localName:""));let i=[];for(let s=0;s<t.length;s++)i.push(this.coder);return d_(e,i,t)}decode(e){let t=this.length;t===-1&&(t=e.readValue().toNumber(),t*32>e._data.length&&Ac.throwError("insufficient data length",K.errors.BUFFER_OVERRUN,{length:e._data.length,count:t}));let n=[];for(let i=0;i<t;i++)n.push(new Nq(this.coder));return e.coerce(this.name,f_(e,n))}}class Tq extends Hs{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){return e.writeValue(t?1:0)}decode(e){return e.coerce(this.type,!e.readValue().isZero())}}class h_ extends Hs{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=te(t);let n=e.writeValue(t.length);return n+=e.writeBytes(t),n}decode(e){return e.readBytes(e.readValue().toNumber(),!0)}}class Pq extends h_{constructor(e){super("bytes",e)}decode(e){return e.coerce(this.name,oe(super.decode(e)))}}class Rq extends Hs{constructor(e,t){let n="bytes"+String(e);super(n,n,t,!1),this.size=e}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(e,t){let n=te(t);return n.length!==this.size&&this._throwError("incorrect data length",t),e.writeBytes(n)}decode(e){return e.coerce(this.name,oe(e.readBytes(this.size)))}}class Oq extends Hs{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes([])}decode(e){return e.readBytes(0),e.coerce(this.name,null)}}const kq="0x0000000000000000000000000000000000000000",Dq=ie.from(-1),p_=ie.from(0),Mq=ie.from(1),Uq=ie.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),g_="0x0000000000000000000000000000000000000000000000000000000000000000";class Bq extends Hs{constructor(e,t,n){const i=(t?"int":"uint")+e*8;super(i,i,n,!1),this.size=e,this.signed=t}defaultValue(){return 0}encode(e,t){let n=ie.from(t),i=Uq.mask(e.wordSize*8);if(this.signed){let s=i.mask(this.size*8-1);(n.gt(s)||n.lt(s.add(Mq).mul(Dq)))&&this._throwError("value out-of-bounds",t)}else(n.lt(p_)||n.gt(i.mask(this.size*8)))&&this._throwError("value out-of-bounds",t);return n=n.toTwos(this.size*8).mask(this.size*8),this.signed&&(n=n.fromTwos(this.size*8).toTwos(8*e.wordSize)),e.writeValue(n)}decode(e){let t=e.readValue().mask(this.size*8);return this.signed&&(t=t.fromTwos(this.size*8)),e.coerce(this.name,t)}}const $q="strings/5.8.0",m_=new K($q);var fs;(function(r){r.current="",r.NFC="NFC",r.NFD="NFD",r.NFKC="NFKC",r.NFKD="NFKD"})(fs||(fs={}));var Sn;(function(r){r.UNEXPECTED_CONTINUE="unexpected continuation byte",r.BAD_PREFIX="bad codepoint prefix",r.OVERRUN="string overrun",r.MISSING_CONTINUE="missing continuation byte",r.OUT_OF_RANGE="out of UTF-8 range",r.UTF16_SURROGATE="UTF-16 surrogate",r.OVERLONG="overlong representation"})(Sn||(Sn={}));function Lq(r,e,t,n,i){return m_.throwArgumentError(`invalid codepoint at offset ${e}; ${r}`,"bytes",t)}function b_(r,e,t,n,i){if(r===Sn.BAD_PREFIX||r===Sn.UNEXPECTED_CONTINUE){let s=0;for(let o=e+1;o<t.length&&t[o]>>6===2;o++)s++;return s}return r===Sn.OVERRUN?t.length-e-1:0}function Fq(r,e,t,n,i){return r===Sn.OVERLONG?(n.push(i),0):(n.push(65533),b_(r,e,t))}const y_=Object.freeze({error:Lq,ignore:b_,replace:Fq});function Gm(r,e){e==null&&(e=y_.error),r=te(r);const t=[];let n=0;for(;n<r.length;){const i=r[n++];if(i>>7===0){t.push(i);continue}let s=null,o=null;if((i&224)===192)s=1,o=127;else if((i&240)===224)s=2,o=2047;else if((i&248)===240)s=3,o=65535;else{(i&192)===128?n+=e(Sn.UNEXPECTED_CONTINUE,n-1,r,t):n+=e(Sn.BAD_PREFIX,n-1,r,t);continue}if(n-1+s>=r.length){n+=e(Sn.OVERRUN,n-1,r,t);continue}let a=i&(1<<8-s-1)-1;for(let c=0;c<s;c++){let l=r[n];if((l&192)!=128){n+=e(Sn.MISSING_CONTINUE,n,r,t),a=null;break}a=a<<6|l&63,n++}if(a!==null){if(a>1114111){n+=e(Sn.OUT_OF_RANGE,n-1-s,r,t,a);continue}if(a>=55296&&a<=57343){n+=e(Sn.UTF16_SURROGATE,n-1-s,r,t,a);continue}if(a<=o){n+=e(Sn.OVERLONG,n-1-s,r,t,a);continue}t.push(a)}}return t}function ar(r,e=fs.current){e!=fs.current&&(m_.checkNormalize(),r=r.normalize(e));let t=[];for(let n=0;n<r.length;n++){const i=r.charCodeAt(n);if(i<128)t.push(i);else if(i<2048)t.push(i>>6|192),t.push(i&63|128);else if((i&64512)==55296){n++;const s=r.charCodeAt(n);if(n>=r.length||(s&64512)!==56320)throw new Error("invalid utf-8 string");const o=65536+((i&1023)<<10)+(s&1023);t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(o&63|128)}else t.push(i>>12|224),t.push(i>>6&63|128),t.push(i&63|128)}return te(t)}function dp(r){const e="0000"+r.toString(16);return"\\u"+e.substring(e.length-4)}function jq(r,e){return'"'+Gm(r,e).map(t=>{if(t<256){switch(t){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 13:return"\\r";case 34:return'\\"';case 92:return"\\\\"}if(t>=32&&t<127)return String.fromCharCode(t)}return t<=65535?dp(t):(t-=65536,dp((t>>10&1023)+55296)+dp((t&1023)+56320))}).join("")+'"'}function Hg(r){return r.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function To(r,e){return Hg(Gm(r,e))}function th(r,e=fs.current){return Gm(ar(r,e))}function qq(r){const e=ar(r);if(e.length>31)throw new Error("bytes32 string must be less than 32 bytes");return oe(Nt([e,g_]).slice(0,32))}function Hq(r){const e=te(r);if(e.length!==32)throw new Error("invalid bytes32 - not 32 bytes long");if(e[31]!==0)throw new Error("invalid bytes32 string - no null terminator");let t=31;for(;e[t-1]===0;)t--;return To(e.slice(0,t))}function Wq(r){if(r.length%4!==0)throw new Error("bad data");let e=[];for(let t=0;t<r.length;t+=4)e.push(parseInt(r.substring(t,t+4),16));return e}function Ym(r,e){e||(e=function(i){return[parseInt(i,16)]});let t=0,n={};return r.split(",").forEach(i=>{let s=i.split(":");t+=parseInt(s[0],16),n[t]=e(s[1])}),n}function w_(r){let e=0;return r.split(",").map(t=>{let n=t.split("-");n.length===1?n[1]="0":n[1]===""&&(n[1]="1");let i=e+parseInt(n[0],16);return e=parseInt(n[1],16),{l:i,h:e}})}function Jm(r,e){let t=0;for(let n=0;n<e.length;n++){let i=e[n];if(t+=i.l,r>=t&&r<=t+i.h&&(r-t)%(i.d||1)===0){if(i.e&&i.e.indexOf(r-t)!==-1)continue;return i}}return null}const zq=w_("221,13-1b,5f-,40-10,51-f,11-3,3-3,2-2,2-4,8,2,15,2d,28-8,88,48,27-,3-5,11-20,27-,8,28,3-5,12,18,b-a,1c-4,6-16,2-d,2-2,2,1b-4,17-9,8f-,10,f,1f-2,1c-34,33-14e,4,36-,13-,6-2,1a-f,4,9-,3-,17,8,2-2,5-,2,8-,3-,4-8,2-3,3,6-,16-6,2-,7-3,3-,17,8,3,3,3-,2,6-3,3-,4-a,5,2-6,10-b,4,8,2,4,17,8,3,6-,b,4,4-,2-e,2-4,b-10,4,9-,3-,17,8,3-,5-,9-2,3-,4-7,3-3,3,4-3,c-10,3,7-2,4,5-2,3,2,3-2,3-2,4-2,9,4-3,6-2,4,5-8,2-e,d-d,4,9,4,18,b,6-3,8,4,5-6,3-8,3-3,b-11,3,9,4,18,b,6-3,8,4,5-6,3-6,2,3-3,b-11,3,9,4,18,11-3,7-,4,5-8,2-7,3-3,b-11,3,13-2,19,a,2-,8-2,2-3,7,2,9-11,4-b,3b-3,1e-24,3,2-,3,2-,2-5,5,8,4,2,2-,3,e,4-,6,2,7-,b-,3-21,49,23-5,1c-3,9,25,10-,2-2f,23,6,3,8-2,5-5,1b-45,27-9,2a-,2-3,5b-4,45-4,53-5,8,40,2,5-,8,2,5-,28,2,5-,20,2,5-,8,2,5-,8,8,18,20,2,5-,8,28,14-5,1d-22,56-b,277-8,1e-2,52-e,e,8-a,18-8,15-b,e,4,3-b,5e-2,b-15,10,b-5,59-7,2b-555,9d-3,5b-5,17-,7-,27-,7-,9,2,2,2,20-,36,10,f-,7,14-,4,a,54-3,2-6,6-5,9-,1c-10,13-1d,1c-14,3c-,10-6,32-b,240-30,28-18,c-14,a0,115-,3,66-,b-76,5,5-,1d,24,2,5-2,2,8-,35-2,19,f-10,1d-3,311-37f,1b,5a-b,d7-19,d-3,41,57-,68-4,29-3,5f,29-37,2e-2,25-c,2c-2,4e-3,30,78-3,64-,20,19b7-49,51a7-59,48e-2,38-738,2ba5-5b,222f-,3c-94,8-b,6-4,1b,6,2,3,3,6d-20,16e-f,41-,37-7,2e-2,11-f,5-b,18-,b,14,5-3,6,88-,2,bf-2,7-,7-,7-,4-2,8,8-9,8-2ff,20,5-b,1c-b4,27-,27-cbb1,f7-9,28-2,b5-221,56,48,3-,2-,3-,5,d,2,5,3,42,5-,9,8,1d,5,6,2-2,8,153-3,123-3,33-27fd,a6da-5128,21f-5df,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3,2-1d,61-ff7d"),Kq="ad,34f,1806,180b,180c,180d,200b,200c,200d,2060,feff".split(",").map(r=>parseInt(r,16)),Vq=[{h:25,s:32,l:65},{h:30,s:32,e:[23],l:127},{h:54,s:1,e:[48],l:64,d:2},{h:14,s:1,l:57,d:2},{h:44,s:1,l:17,d:2},{h:10,s:1,e:[2,6,8],l:61,d:2},{h:16,s:1,l:68,d:2},{h:84,s:1,e:[18,24,66],l:19,d:2},{h:26,s:32,e:[17],l:435},{h:22,s:1,l:71,d:2},{h:15,s:80,l:40},{h:31,s:32,l:16},{h:32,s:1,l:80,d:2},{h:52,s:1,l:42,d:2},{h:12,s:1,l:55,d:2},{h:40,s:1,e:[38],l:15,d:2},{h:14,s:1,l:48,d:2},{h:37,s:48,l:49},{h:148,s:1,l:6351,d:2},{h:88,s:1,l:160,d:2},{h:15,s:16,l:704},{h:25,s:26,l:854},{h:25,s:32,l:55915},{h:37,s:40,l:1247},{h:25,s:-119711,l:53248},{h:25,s:-119763,l:52},{h:25,s:-119815,l:52},{h:25,s:-119867,e:[1,4,5,7,8,11,12,17],l:52},{h:25,s:-119919,l:52},{h:24,s:-119971,e:[2,7,8,17],l:52},{h:24,s:-120023,e:[2,7,13,15,16,17],l:52},{h:25,s:-120075,l:52},{h:25,s:-120127,l:52},{h:25,s:-120179,l:52},{h:25,s:-120231,l:52},{h:25,s:-120283,l:52},{h:25,s:-120335,l:52},{h:24,s:-119543,e:[17],l:56},{h:24,s:-119601,e:[17],l:58},{h:24,s:-119659,e:[17],l:58},{h:24,s:-119717,e:[17],l:58},{h:24,s:-119775,e:[17],l:58}],Gq=Ym("b5:3bc,c3:ff,7:73,2:253,5:254,3:256,1:257,5:259,1:25b,3:260,1:263,2:269,1:268,5:26f,1:272,2:275,7:280,3:283,5:288,3:28a,1:28b,5:292,3f:195,1:1bf,29:19e,125:3b9,8b:3b2,1:3b8,1:3c5,3:3c6,1:3c0,1a:3ba,1:3c1,1:3c3,2:3b8,1:3b5,1bc9:3b9,1c:1f76,1:1f77,f:1f7a,1:1f7b,d:1f78,1:1f79,1:1f7c,1:1f7d,107:63,5:25b,4:68,1:68,1:68,3:69,1:69,1:6c,3:6e,4:70,1:71,1:72,1:72,1:72,7:7a,2:3c9,2:7a,2:6b,1:e5,1:62,1:63,3:65,1:66,2:6d,b:3b3,1:3c0,6:64,1b574:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3"),Yq=Ym("179:1,2:1,2:1,5:1,2:1,a:4f,a:1,8:1,2:1,2:1,3:1,5:1,3:1,4:1,2:1,3:1,4:1,8:2,1:1,2:2,1:1,2:2,27:2,195:26,2:25,1:25,1:25,2:40,2:3f,1:3f,33:1,11:-6,1:-9,1ac7:-3a,6d:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,b:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,c:-8,2:-8,2:-8,2:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,49:-8,1:-8,1:-4a,1:-4a,d:-56,1:-56,1:-56,1:-56,d:-8,1:-8,f:-8,1:-8,3:-7"),Jq=Ym("df:00730073,51:00690307,19:02BC006E,a7:006A030C,18a:002003B9,16:03B903080301,20:03C503080301,1d7:05650582,190f:00680331,1:00740308,1:0077030A,1:0079030A,1:006102BE,b6:03C50313,2:03C503130300,2:03C503130301,2:03C503130342,2a:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,3:1F7003B9,1:03B103B9,1:03AC03B9,2:03B10342,1:03B1034203B9,5:03B103B9,6:1F7403B9,1:03B703B9,1:03AE03B9,2:03B70342,1:03B7034203B9,5:03B703B9,6:03B903080300,1:03B903080301,3:03B90342,1:03B903080342,b:03C503080300,1:03C503080301,1:03C10313,2:03C50342,1:03C503080342,b:1F7C03B9,1:03C903B9,1:03CE03B9,2:03C90342,1:03C9034203B9,5:03C903B9,ac:00720073,5b:00B00063,6:00B00066,d:006E006F,a:0073006D,1:00740065006C,1:0074006D,124f:006800700061,2:00610075,2:006F0076,b:00700061,1:006E0061,1:03BC0061,1:006D0061,1:006B0061,1:006B0062,1:006D0062,1:00670062,3:00700066,1:006E0066,1:03BC0066,4:0068007A,1:006B0068007A,1:006D0068007A,1:00670068007A,1:00740068007A,15:00700061,1:006B00700061,1:006D00700061,1:006700700061,8:00700076,1:006E0076,1:03BC0076,1:006D0076,1:006B0076,1:006D0076,1:00700077,1:006E0077,1:03BC0077,1:006D0077,1:006B0077,1:006D0077,1:006B03C9,1:006D03C9,2:00620071,3:00632215006B0067,1:0063006F002E,1:00640062,1:00670079,2:00680070,2:006B006B,1:006B006D,9:00700068,2:00700070006D,1:00700072,2:00730076,1:00770062,c723:00660066,1:00660069,1:0066006C,1:006600660069,1:00660066006C,1:00730074,1:00730074,d:05740576,1:05740565,1:0574056B,1:057E0576,1:0574056D",Wq),Zq=w_("80-20,2a0-,39c,32,f71,18e,7f2-f,19-7,30-4,7-5,f81-b,5,a800-20ff,4d1-1f,110,fa-6,d174-7,2e84-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,2,1f-5f,ff7f-20001");function Xq(r){return r.reduce((e,t)=>(t.forEach(n=>{e.push(n)}),e),[])}function Qq(r){return!!Jm(r,zq)}function eH(r){let e=Jm(r,Vq);if(e)return[r+e.s];let t=Gq[r];if(t)return t;let n=Yq[r];if(n)return[r+n[0]];let i=Jq[r];return i||null}function tH(r){return!!Jm(r,Zq)}function rH(r){if(r.match(/^[a-z0-9-]*$/i)&&r.length<=59)return r.toLowerCase();let e=th(r);e=Xq(e.map(n=>{if(Kq.indexOf(n)>=0)return[];if(n>=65024&&n<=65039)return[];let i=eH(n);return i||[n]})),e=th(Hg(e),fs.NFKC),e.forEach(n=>{if(tH(n))throw new Error("STRINGPREP_CONTAINS_PROHIBITED")}),e.forEach(n=>{if(Qq(n))throw new Error("STRINGPREP_CONTAINS_UNASSIGNED")});let t=Hg(e);if(t.substring(0,1)==="-"||t.substring(2,4)==="--"||t.substring(t.length-1)==="-")throw new Error("invalid hyphen");return t}const nH=Object.freeze(Object.defineProperty({__proto__:null,get UnicodeNormalizationForm(){return fs},Utf8ErrorFuncs:y_,get Utf8ErrorReason(){return Sn},_toEscapedUtf8String:jq,formatBytes32String:qq,nameprep:rH,parseBytes32String:Hq,toUtf8Bytes:ar,toUtf8CodePoints:th,toUtf8String:To},Symbol.toStringTag,{value:"Module"}));class iH extends h_{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,ar(t))}decode(e){return To(super.decode(e))}}class Vd extends Hs{constructor(e,t){let n=!1;const i=[];e.forEach(o=>{o.dynamic&&(n=!0),i.push(o.type)});const s="tuple("+i.join(",")+")";super("tuple",s,t,n),this.coders=e}defaultValue(){const e=[];this.coders.forEach(n=>{e.push(n.defaultValue())});const t=this.coders.reduce((n,i)=>{const s=i.localName;return s&&(n[s]||(n[s]=0),n[s]++),n},{});return this.coders.forEach((n,i)=>{let s=n.localName;!s||t[s]!==1||(s==="length"&&(s="_length"),e[s]==null&&(e[s]=e[i]))}),Object.freeze(e)}encode(e,t){return d_(e,this.coders,t)}decode(e){return e.coerce(this.name,f_(e,this.coders))}}const Gd=new K(hd),sH=new RegExp(/^bytes([0-9]*)$/),oH=new RegExp(/^(u?int)([0-9]*)$/);class x_{constructor(e){J(this,"coerceFunc",e||null)}_getCoder(e){switch(e.baseType){case"address":return new Sq(e.name);case"bool":return new Tq(e.name);case"string":return new iH(e.name);case"bytes":return new Pq(e.name);case"array":return new Iq(this._getCoder(e.arrayChildren),e.arrayLength,e.name);case"tuple":return new Vd((e.components||[]).map(n=>this._getCoder(n)),e.name);case"":return new Oq(e.name)}let t=e.type.match(oH);if(t){let n=parseInt(t[2]||"256");return(n===0||n>256||n%8!==0)&&Gd.throwArgumentError("invalid "+t[1]+" bit length","param",e),new Bq(n/8,t[1]==="int",e.name)}if(t=e.type.match(sH),t){let n=parseInt(t[1]);return(n===0||n>32)&&Gd.throwArgumentError("invalid bytes length","param",e),new Rq(n,e.name)}return Gd.throwArgumentError("invalid type","type",e.type)}_getWordSize(){return 32}_getReader(e,t){return new eh(e,this._getWordSize(),this.coerceFunc,t)}_getWriter(){return new qg(this._getWordSize())}getDefaultValue(e){const t=e.map(i=>this._getCoder(Er.from(i)));return new Vd(t,"_").defaultValue()}encode(e,t){e.length!==t.length&&Gd.throwError("types/values length mismatch",K.errors.INVALID_ARGUMENT,{count:{types:e.length,values:t.length},value:{types:e,values:t}});const n=e.map(o=>this._getCoder(Er.from(o))),i=new Vd(n,"_"),s=this._getWriter();return i.encode(s,t),s.data}decode(e,t,n){const i=e.map(o=>this._getCoder(Er.from(o)));return new Vd(i,"_").decode(this._getReader(te(t),n))}}const v_=new x_;function yo(r){return xt(ar(r))}const E_="hash/5.8.0";function Zm(r){r=atob(r);const e=[];for(let t=0;t<r.length;t++)e.push(r.charCodeAt(t));return te(e)}function Xm(r){r=te(r);let e="";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return btoa(e)}const aH=Object.freeze(Object.defineProperty({__proto__:null,decode:Zm,encode:Xm},Symbol.toStringTag,{value:"Module"}));function A_(r,e){e==null&&(e=1);const t=[],n=t.forEach,i=function(s,o){n.call(s,function(a){o>0&&Array.isArray(a)?i(a,o-1):t.push(a)})};return i(r,e),t}function cH(r){const e={};for(let t=0;t<r.length;t++){const n=r[t];e[n[0]]=n[1]}return e}function lH(r){let e=0;function t(){return r[e++]<<8|r[e++]}let n=t(),i=1,s=[0,1];for(let P=1;P<n;P++)s.push(i+=t());let o=t(),a=e;e+=o;let c=0,l=0;function u(){return c==0&&(l=l<<8|r[e++],c=8),l>>--c&1}const d=31,p=Math.pow(2,d),x=p>>>1,w=x>>1,b=p-1;let y=0;for(let P=0;P<d;P++)y=y<<1|u();let C=[],T=0,I=p;for(;;){let P=Math.floor(((y-T+1)*i-1)/I),O=0,q=n;for(;q-O>1;){let W=O+q>>>1;P<s[W]?q=W:O=W}if(O==0)break;C.push(O);let F=T+Math.floor(I*s[O]/i),B=T+Math.floor(I*s[O+1]/i)-1;for(;((F^B)&x)==0;)y=y<<1&b|u(),F=F<<1&b,B=B<<1&b|1;for(;F&~B&w;)y=y&x|y<<1&b>>>1|u(),F=F<<1^x,B=(B^x)<<1|x|1;T=F,I=1+B-F}let k=n-4;return C.map(P=>{switch(P-k){case 3:return k+65792+(r[a++]<<16|r[a++]<<8|r[a++]);case 2:return k+256+(r[a++]<<8|r[a++]);case 1:return k+r[a++];default:return P-1}})}function uH(r){let e=0;return()=>r[e++]}function dH(r){return uH(lH(r))}function fH(r){return r&1?~r>>1:r>>1}function hH(r,e){let t=Array(r);for(let n=0;n<r;n++)t[n]=1+e();return t}function Cx(r,e){let t=Array(r);for(let n=0,i=-1;n<r;n++)t[n]=i+=1+e();return t}function pH(r,e){let t=Array(r);for(let n=0,i=0;n<r;n++)t[n]=i+=fH(e());return t}function rh(r,e){let t=Cx(r(),r),n=r(),i=Cx(n,r),s=hH(n,r);for(let o=0;o<n;o++)for(let a=0;a<s[o];a++)t.push(i[o]+a);return e?t.map(o=>e[o]):t}function gH(r){let e=[];for(;;){let t=r();if(t==0)break;e.push(bH(t,r))}for(;;){let t=r()-1;if(t<0)break;e.push(yH(t,r))}return cH(A_(e))}function mH(r){let e=[];for(;;){let t=r();if(t==0)break;e.push(t)}return e}function __(r,e,t){let n=Array(r).fill(void 0).map(()=>[]);for(let i=0;i<e;i++)pH(r,t).forEach((s,o)=>n[o].push(s));return n}function bH(r,e){let t=1+e(),n=e(),i=mH(e),s=__(i.length,1+r,e);return A_(s.map((o,a)=>{const c=o[0],l=o.slice(1);return Array(i[a]).fill(void 0).map((u,d)=>{let p=d*n;return[c+d*t,l.map(x=>x+p)]})}))}function yH(r,e){let t=1+e();return __(t,1+r,e).map(i=>[i[0],i.slice(1)])}function wH(r){let e=rh(r).sort((n,i)=>n-i);return t();function t(){let n=[];for(;;){let l=rh(r,e);if(l.length==0)break;n.push({set:new Set(l),node:t()})}n.sort((l,u)=>u.set.size-l.set.size);let i=r(),s=i%3;i=i/3|0;let o=!!(i&1);i>>=1;let a=i==1,c=i==2;return{branches:n,valid:s,fe0f:o,save:a,check:c}}}function xH(){return dH(Zm("AEQF2AO2DEsA2wIrAGsBRABxAN8AZwCcAEwAqgA0AGwAUgByADcATAAVAFYAIQAyACEAKAAYAFgAGwAjABQAMAAmADIAFAAfABQAKwATACoADgAbAA8AHQAYABoAGQAxADgALAAoADwAEwA9ABMAGgARAA4ADwAWABMAFgAIAA8AHgQXBYMA5BHJAS8JtAYoAe4AExozi0UAH21tAaMnBT8CrnIyhrMDhRgDygIBUAEHcoFHUPe8AXBjAewCjgDQR8IICIcEcQLwATXCDgzvHwBmBoHNAqsBdBcUAykgDhAMShskMgo8AY8jqAQfAUAfHw8BDw87MioGlCIPBwZCa4ELatMAAMspJVgsDl8AIhckSg8XAHdvTwBcIQEiDT4OPhUqbyECAEoAS34Aej8Ybx83JgT/Xw8gHxZ/7w8RICxPHA9vBw+Pfw8PHwAPFv+fAsAvCc8vEr8ivwD/EQ8Bol8OEBa/A78hrwAPCU8vESNvvwWfHwNfAVoDHr+ZAAED34YaAdJPAK7PLwSEgDLHAGo1Pz8Pvx9fUwMrpb8O/58VTzAPIBoXIyQJNF8hpwIVAT8YGAUADDNBaX3RAMomJCg9EhUeA29MABsZBTMNJipjOhc19gcIDR8bBwQHEggCWi6DIgLuAQYA+BAFCha3A5XiAEsqM7UFFgFLhAMjFTMYE1Klnw74nRVBG/ASCm0BYRN/BrsU3VoWy+S0vV8LQx+vN8gF2AC2AK5EAWwApgYDKmAAroQ0NDQ0AT+OCg7wAAIHRAbpNgVcBV0APTA5BfbPFgMLzcYL/QqqA82eBALKCjQCjqYCht0/k2+OAsXQAoP3ASTKDgDw6ACKAUYCMpIKJpRaAE4A5womABzZvs0REEKiACIQAd5QdAECAj4Ywg/wGqY2AVgAYADYvAoCGAEubA0gvAY2ALAAbpbvqpyEAGAEpgQAJgAG7gAgAEACmghUFwCqAMpAINQIwC4DthRAAPcycKgApoIdABwBfCisABoATwBqASIAvhnSBP8aH/ECeAKXAq40NjgDBTwFYQU6AXs3oABgAD4XNgmcCY1eCl5tIFZeUqGgyoNHABgAEQAaABNwWQAmABMATPMa3T34ADldyprmM1M2XociUQgLzvwAXT3xABgAEQAaABNwIGFAnADD8AAgAD4BBJWzaCcIAIEBFMAWwKoAAdq9BWAF5wLQpALEtQAKUSGkahR4GnJM+gsAwCgeFAiUAECQ0BQuL8AAIAAAADKeIheclvFqQAAETr4iAMxIARMgAMIoHhQIAn0E0pDQFC4HhznoAAAAIAI2C0/4lvFqQAAETgBJJwYCAy4ABgYAFAA8MBKYEH4eRhTkAjYeFcgACAYAeABsOqyQ5gRwDayqugEgaIIAtgoACgDmEABmBAWGme5OBJJA2m4cDeoAmITWAXwrMgOgAGwBCh6CBXYF1Tzg1wKAAFdiuABRAFwAXQBsAG8AdgBrAHYAbwCEAHEwfxQBVE5TEQADVFhTBwBDANILAqcCzgLTApQCrQL6vAAMAL8APLhNBKkE6glGKTAU4Dr4N2EYEwBCkABKk8rHAbYBmwIoAiU4Ajf/Aq4CowCAANIChzgaNBsCsTgeODcFXrgClQKdAqQBiQGYAqsCsjTsNHsfNPA0ixsAWTWiOAMFPDQSNCk2BDZHNow2TTZUNhk28Jk9VzI3QkEoAoICoQKwAqcAQAAxBV4FXbS9BW47YkIXP1ciUqs05DS/FwABUwJW11e6nHuYZmSh/RAYA8oMKvZ8KASoUAJYWAJ6ILAsAZSoqjpgA0ocBIhmDgDWAAawRDQoAAcuAj5iAHABZiR2AIgiHgCaAU68ACxuHAG0ygM8MiZIAlgBdF4GagJqAPZOHAMuBgoATkYAsABiAHgAMLoGDPj0HpKEBAAOJgAuALggTAHWAeAMEDbd20Uege0ADwAWADkAQgA9OHd+2MUQZBBhBgNNDkxxPxUQArEPqwvqERoM1irQ090ANK4H8ANYB/ADWANYB/AH8ANYB/ADWANYA1gDWBwP8B/YxRBkD00EcgWTBZAE2wiIJk4RhgctCNdUEnQjHEwDSgEBIypJITuYMxAlR0wRTQgIATZHbKx9PQNMMbBU+pCnA9AyVDlxBgMedhKlAC8PeCE1uk6DekxxpQpQT7NX9wBFBgASqwAS5gBJDSgAUCwGPQBI4zTYABNGAE2bAE3KAExdGABKaAbgAFBXAFCOAFBJABI2SWdObALDOq0//QomCZhvwHdTBkIQHCemEPgMNAG2ATwN7kvZBPIGPATKH34ZGg/OlZ0Ipi3eDO4m5C6igFsj9iqEBe5L9TzeC05RaQ9aC2YJ5DpkgU8DIgEOIowK3g06CG4Q9ArKbA3mEUYHOgPWSZsApgcCCxIdNhW2JhFirQsKOXgG/Br3C5AmsBMqev0F1BoiBk4BKhsAANAu6IWxWjJcHU9gBgQLJiPIFKlQIQ0mQLh4SRocBxYlqgKSQ3FKiFE3HpQh9zw+DWcuFFF9B/Y8BhlQC4I8n0asRQ8R0z6OPUkiSkwtBDaALDAnjAnQD4YMunxzAVoJIgmyDHITMhEYN8YIOgcaLpclJxYIIkaWYJsE+KAD9BPSAwwFQAlCBxQDthwuEy8VKgUOgSXYAvQ21i60ApBWgQEYBcwPJh/gEFFH4Q7qCJwCZgOEJewALhUiABginAhEZABgj9lTBi7MCMhqbSN1A2gU6GIRdAeSDlgHqBw0FcAc4nDJXgyGCSiksAlcAXYJmgFgBOQICjVcjKEgQmdUi1kYnCBiQUBd/QIyDGYVoES+h3kCjA9sEhwBNgF0BzoNAgJ4Ee4RbBCWCOyGBTW2M/k6JgRQIYQgEgooA1BszwsoJvoM+WoBpBJjAw00PnfvZ6xgtyUX/gcaMsZBYSHyC5NPzgydGsIYQ1QvGeUHwAP0GvQn60FYBgADpAQUOk4z7wS+C2oIjAlAAEoOpBgH2BhrCnKM0QEyjAG4mgNYkoQCcJAGOAcMAGgMiAV65gAeAqgIpAAGANADWAA6Aq4HngAaAIZCAT4DKDABIuYCkAOUCDLMAZYwAfQqBBzEDBYA+DhuSwLDsgKAa2ajBd5ZAo8CSjYBTiYEBk9IUgOwcuIA3ABMBhTgSAEWrEvMG+REAeBwLADIAPwABjYHBkIBzgH0bgC4AWALMgmjtLYBTuoqAIQAFmwB2AKKAN4ANgCA8gFUAE4FWvoF1AJQSgESMhksWGIBvAMgATQBDgB6BsyOpsoIIARuB9QCEBwV4gLvLwe2AgMi4BPOQsYCvd9WADIXUu5eZwqoCqdeaAC0YTQHMnM9UQAPH6k+yAdy/BZIiQImSwBQ5gBQQzSaNTFWSTYBpwGqKQK38AFtqwBI/wK37gK3rQK3sAK6280C0gK33AK3zxAAUEIAUD9SklKDArekArw5AEQAzAHCO147WTteO1k7XjtZO147WTteO1kDmChYI03AVU0oJqkKbV9GYewMpw3VRMk6ShPcYFJgMxPJLbgUwhXPJVcZPhq9JwYl5VUKDwUt1GYxCC00dhe9AEApaYNCY4ceMQpMHOhTklT5LRwAskujM7ANrRsWREEFSHXuYisWDwojAmSCAmJDXE6wXDchAqH4AmiZAmYKAp+FOBwMAmY8AmYnBG8EgAN/FAN+kzkHOXgYOYM6JCQCbB4CMjc4CwJtyAJtr/CLADRoRiwBaADfAOIASwYHmQyOAP8MwwAOtgJ3MAJ2o0ACeUxEAni7Hl3cRa9G9AJ8QAJ6yQJ9CgJ88UgBSH5kJQAsFklZSlwWGErNAtECAtDNSygDiFADh+dExpEzAvKiXQQDA69Lz0wuJgTQTU1NsAKLQAKK2cIcCB5EaAa4Ao44Ao5dQZiCAo7aAo5deVG1UzYLUtVUhgKT/AKTDQDqAB1VH1WwVdEHLBwplocy4nhnRTw6ApegAu+zWCKpAFomApaQApZ9nQCqWa1aCoJOADwClrYClk9cRVzSApnMApllXMtdCBoCnJw5wzqeApwXAp+cAp65iwAeEDIrEAKd8gKekwC2PmE1YfACntQCoG8BqgKeoCACnk+mY8lkKCYsAiewAiZ/AqD8AqBN2AKmMAKlzwKoAAB+AqfzaH1osgAESmodatICrOQCrK8CrWgCrQMCVx4CVd0CseLYAx9PbJgCsr4OArLpGGzhbWRtSWADJc4Ctl08QG6RAylGArhfArlIFgK5K3hwN3DiAr0aAy2zAzISAr6JcgMDM3ICvhtzI3NQAsPMAsMFc4N0TDZGdOEDPKgDPJsDPcACxX0CxkgCxhGKAshqUgLIRQLJUALJLwJkngLd03h6YniveSZL0QMYpGcDAmH1GfSVJXsMXpNevBICz2wCz20wTFTT9BSgAMeuAs90ASrrA04TfkwGAtwoAtuLAtJQA1JdA1NgAQIDVY2AikABzBfuYUZ2AILPg44C2sgC2d+EEYRKpz0DhqYAMANkD4ZyWvoAVgLfZgLeuXR4AuIw7RUB8zEoAfScAfLTiALr9ALpcXoAAur6AurlAPpIAboC7ooC652Wq5cEAu5AA4XhmHpw4XGiAvMEAGoDjheZlAL3FAORbwOSiAL3mQL52gL4Z5odmqy8OJsfA52EAv77ARwAOp8dn7QDBY4DpmsDptoA0sYDBmuhiaIGCgMMSgFgASACtgNGAJwEgLpoBgC8BGzAEowcggCEDC6kdjoAJAM0C5IKRoABZCgiAIzw3AYBLACkfng9ogigkgNmWAN6AEQCvrkEVqTGAwCsBRbAA+4iQkMCHR072jI2PTbUNsk2RjY5NvA23TZKNiU3EDcZN5I+RTxDRTBCJkK5VBYKFhZfwQCWygU3AJBRHpu+OytgNxa61A40GMsYjsn7BVwFXQVcBV0FaAVdBVwFXQVcBV0FXAVdBVwFXUsaCNyKAK4AAQUHBwKU7oICoW1e7jAEzgPxA+YDwgCkBFDAwADABKzAAOxFLhitA1UFTDeyPkM+bj51QkRCuwTQWWQ8X+0AWBYzsACNA8xwzAGm7EZ/QisoCTAbLDs6fnLfb8H2GccsbgFw13M1HAVkBW/Jxsm9CNRO8E8FDD0FBQw9FkcClOYCoMFegpDfADgcMiA2AJQACB8AsigKAIzIEAJKeBIApY5yPZQIAKQiHb4fvj5BKSRPQrZCOz0oXyxgOywfKAnGbgMClQaCAkILXgdeCD9IIGUgQj5fPoY+dT52Ao5CM0dAX9BTVG9SDzFwWTQAbxBzJF/lOEIQQglCCkKJIAls5AcClQICoKPMODEFxhi6KSAbiyfIRrMjtCgdWCAkPlFBIitCsEJRzAbMAV/OEyQzDg0OAQQEJ36i328/Mk9AybDJsQlq3tDRApUKAkFzXf1d/j9uALYP6hCoFgCTGD8kPsFKQiobrm0+zj0KSD8kPnVCRBwMDyJRTHFgMTJa5rwXQiQ2YfI/JD7BMEJEHGINTw4TOFlIRzwJO0icMQpyPyQ+wzJCRBv6DVgnKB01NgUKj2bwYzMqCoBkznBgEF+zYDIocwRIX+NgHj4HICNfh2C4CwdwFWpTG/lgUhYGAwRfv2Ts8mAaXzVgml/XYIJfuWC4HI1gUF9pYJZgMR6ilQHMAOwLAlDRefC0in4AXAEJA6PjCwc0IamOANMMCAECRQDFNRTZBgd+CwQlRA+r6+gLBDEFBnwUBXgKATIArwAGRAAHA3cDdAN2A3kDdwN9A3oDdQN7A30DfAN4A3oDfQAYEAAlAtYASwMAUAFsAHcKAHcAmgB3AHUAdQB2AHVu8UgAygDAAHcAdQB1AHYAdQALCgB3AAsAmgB3AAsCOwB3AAtu8UgAygDAAHgKAJoAdwB3AHUAdQB2AHUAeAB1AHUAdgB1bvFIAMoAwAALCgCaAHcACwB3AAsCOwB3AAtu8UgAygDAAH4ACwGgALcBpwC6AahdAu0COwLtbvFIAMoAwAALCgCaAu0ACwLtAAsCOwLtAAtu8UgAygDAA24ACwNvAAu0VsQAAzsAABCkjUIpAAsAUIusOggWcgMeBxVsGwL67U/2HlzmWOEeOgALASvuAAseAfpKUpnpGgYJDCIZM6YyARUE9ThqAD5iXQgnAJYJPnOzw0ZAEZxEKsIAkA4DhAHnTAIDxxUDK0lxCQlPYgIvIQVYJQBVqE1GakUAKGYiDToSBA1EtAYAXQJYAIF8GgMHRyAAIAjOe9YncekRAA0KACUrjwE7Ayc6AAYWAqaiKG4McEcqANoN3+Mg9TwCBhIkuCny+JwUQ29L008JluRxu3K+oAdqiHOqFH0AG5SUIfUJ5SxCGfxdipRzqTmT4V5Zb+r1Uo4Vm+NqSSEl2mNvR2JhIa8SpYO6ntdwFXHCWTCK8f2+Hxo7uiG3drDycAuKIMP5bhi06ACnqArH1rz4Rqg//lm6SgJGEVbF9xJHISaR6HxqxSnkw6shDnelHKNEfGUXSJRJ1GcsmtJw25xrZMDK9gXSm1/YMkdX4/6NKYOdtk/NQ3/NnDASjTc3fPjIjW/5sVfVObX2oTDWkr1dF9f3kxBsD3/3aQO8hPfRz+e0uEiJqt1161griu7gz8hDDwtpy+F+BWtefnKHZPAxcZoWbnznhJpy0e842j36bcNzGnIEusgGX0a8ZxsnjcSsPDZ09yZ36fCQbriHeQ72JRMILNl6ePPf2HWoVwgWAm1fb3V2sAY0+B6rAXqSwPBgseVmoqsBTSrm91+XasMYYySI8eeRxH3ZvHkMz3BQ5aJ3iUVbYPNM3/7emRtjlsMgv/9VyTsyt/mK+8fgWeT6SoFaclXqn42dAIsvAarF5vNNWHzKSkKQ/8Hfk5ZWK7r9yliOsooyBjRhfkHP4Q2DkWXQi6FG/9r/IwbmkV5T7JSopHKn1pJwm9tb5Ot0oyN1Z2mPpKXHTxx2nlK08fKk1hEYA8WgVVWL5lgx0iTv+KdojJeU23ZDjmiubXOxVXJKKi2Wjuh2HLZOFLiSC7Tls5SMh4f+Pj6xUSrNjFqLGehRNB8lC0QSLNmkJJx/wSG3MnjE9T1CkPwJI0wH2lfzwETIiVqUxg0dfu5q39Gt+hwdcxkhhNvQ4TyrBceof3Mhs/IxFci1HmHr4FMZgXEEczPiGCx0HRwzAqDq2j9AVm1kwN0mRVLWLylgtoPNapF5cY4Y1wJh/e0BBwZj44YgZrDNqvD/9Hv7GFYdUQeDJuQ3EWI4HaKqavU1XjC/n41kT4L79kqGq0kLhdTZvgP3TA3fS0ozVz+5piZsoOtIvBUFoMKbNcmBL6YxxaUAusHB38XrS8dQMnQwJfUUkpRoGr5AUeWicvBTzyK9g77+yCkf5PAysL7r/JjcZgrbvRpMW9iyaxZvKO6ceZN2EwIxKwVFPuvFuiEPGCoagbMo+SpydLrXqBzNCDGFCrO/rkcwa2xhokQZ5CdZ0AsU3JfSqJ6n5I14YA+P/uAgfhPU84Tlw7cEFfp7AEE8ey4sP12PTt4Cods1GRgDOB5xvyiR5m+Bx8O5nBCNctU8BevfV5A08x6RHd5jcwPTMDSZJOedIZ1cGQ704lxbAzqZOP05ZxaOghzSdvFBHYqomATARyAADK4elP8Ly3IrUZKfWh23Xy20uBUmLS4Pfagu9+oyVa2iPgqRP3F2CTUsvJ7+RYnN8fFZbU/HVvxvcFFDKkiTqV5UBZ3Gz54JAKByi9hkKMZJvuGgcSYXFmw08UyoQyVdfTD1/dMkCHXcTGAKeROgArsvmRrQTLUOXioOHGK2QkjHuoYFgXciZoTJd6Fs5q1QX1G+p/e26hYsEf7QZD1nnIyl/SFkNtYYmmBhpBrxl9WbY0YpHWRuw2Ll/tj9mD8P4snVzJl4F9J+1arVeTb9E5r2ILH04qStjxQNwn3m4YNqxmaNbLAqW2TN6LidwuJRqS+NXbtqxoeDXpxeGWmxzSkWxjkyCkX4NQRme6q5SAcC+M7+9ETfA/EwrzQajKakCwYyeunP6ZFlxU2oMEn1Pz31zeStW74G406ZJFCl1wAXIoUKkWotYEpOuXB1uVNxJ63dpJEqfxBeptwIHNrPz8BllZoIcBoXwgfJ+8VAUnVPvRvexnw0Ma/WiGYuJO5y8QTvEYBigFmhUxY5RqzE8OcywN/8m4UYrlaniJO75XQ6KSo9+tWHlu+hMi0UVdiKQp7NelnoZUzNaIyBPVeOwK6GNp+FfHuPOoyhaWuNvTYFkvxscMQWDh+zeFCFkgwbXftiV23ywJ4+uwRqmg9k3KzwIQpzppt8DBBOMbrqwQM5Gb05sEwdKzMiAqOloaA/lr0KA+1pr0/+HiWoiIjHA/wir2nIuS3PeU/ji3O6ZwoxcR1SZ9FhtLC5S0FIzFhbBWcGVP/KpxOPSiUoAdWUpqKH++6Scz507iCcxYI6rdMBICPJZea7OcmeFw5mObJSiqpjg2UoWNIs+cFhyDSt6geV5qgi3FunmwwDoGSMgerFOZGX1m0dMCYo5XOruxO063dwENK9DbnVM9wYFREzh4vyU1WYYJ/LRRp6oxgjqP/X5a8/4Af6p6NWkQferzBmXme0zY/4nwMJm/wd1tIqSwGz+E3xPEAOoZlJit3XddD7/BT1pllzOx+8bmQtANQ/S6fZexc6qi3W+Q2xcmXTUhuS5mpHQRvcxZUN0S5+PL9lXWUAaRZhEH8hTdAcuNMMCuVNKTEGtSUKNi3O6KhSaTzck8csZ2vWRZ+d7mW8c4IKwXIYd25S/zIftPkwPzufjEvOHWVD1m+FjpDVUTV0DGDuHj6QnaEwLu/dEgdLQOg9E1Sro9XHJ8ykLAwtPu+pxqKDuFexqON1sKQm7rwbE1E68UCfA/erovrTCG+DBSNg0l4goDQvZN6uNlbyLpcZAwj2UclycvLpIZMgv4yRlpb3YuMftozorbcGVHt/VeDV3+Fdf1TP0iuaCsPi2G4XeGhsyF1ubVDxkoJhmniQ0/jSg/eYML9KLfnCFgISWkp91eauR3IQvED0nAPXK+6hPCYs+n3+hCZbiskmVMG2da+0EsZPonUeIY8EbfusQXjsK/eFDaosbPjEfQS0RKG7yj5GG69M7MeO1HmiUYocgygJHL6M1qzUDDwUSmr99V7Sdr2F3JjQAJY+F0yH33Iv3+C9M38eML7gTgmNu/r2bUMiPvpYbZ6v1/IaESirBHNa7mPKn4dEmYg7v/+HQgPN1G79jBQ1+soydfDC2r+h2Bl/KIc5KjMK7OH6nb1jLsNf0EHVe2KBiE51ox636uyG6Lho0t3J34L5QY/ilE3mikaF4HKXG1mG1rCevT1Vv6GavltxoQe/bMrpZvRggnBxSEPEeEzkEdOxTnPXHVjUYdw8JYvjB/o7Eegc3Ma+NUxLLnsK0kJlinPmUHzHGtrk5+CAbVzFOBqpyy3QVUnzTDfC/0XD94/okH+OB+i7g9lolhWIjSnfIb+Eq43ZXOWmwvjyV/qqD+t0e+7mTEM74qP/Ozt8nmC7mRpyu63OB4KnUzFc074SqoyPUAgM+/TJGFo6T44EHnQU4X4z6qannVqgw/U7zCpwcmXV1AubIrvOmkKHazJAR55ePjp5tLBsN8vAqs3NAHdcEHOR2xQ0lsNAFzSUuxFQCFYvXLZJdOj9p4fNq6p0HBGUik2YzaI4xySy91KzhQ0+q1hjxvImRwPRf76tChlRkhRCi74NXZ9qUNeIwP+s5p+3m5nwPdNOHgSLD79n7O9m1n1uDHiMntq4nkYwV5OZ1ENbXxFd4PgrlvavZsyUO4MqYlqqn1O8W/I1dEZq5dXhrbETLaZIbC2Kj/Aa/QM+fqUOHdf0tXAQ1huZ3cmWECWSXy/43j35+Mvq9xws7JKseriZ1pEWKc8qlzNrGPUGcVgOa9cPJYIJsGnJTAUsEcDOEVULO5x0rXBijc1lgXEzQQKhROf8zIV82w8eswc78YX11KYLWQRcgHNJElBxfXr72lS2RBSl07qTKorO2uUDZr3sFhYsvnhLZn0A94KRzJ/7DEGIAhW5ZWFpL8gEwu1aLA9MuWZzNwl8Oze9Y+bX+v9gywRVnoB5I/8kXTXU3141yRLYrIOOz6SOnyHNy4SieqzkBXharjfjqq1q6tklaEbA8Qfm2DaIPs7OTq/nvJBjKfO2H9bH2cCMh1+5gspfycu8f/cuuRmtDjyqZ7uCIMyjdV3a+p3fqmXsRx4C8lujezIFHnQiVTXLXuI1XrwN3+siYYj2HHTvESUx8DlOTXpak9qFRK+L3mgJ1WsD7F4cu1aJoFoYQnu+wGDMOjJM3kiBQWHCcvhJ/HRdxodOQp45YZaOTA22Nb4XKCVxqkbwMYFhzYQYIAnCW8FW14uf98jhUG2zrKhQQ0q0CEq0t5nXyvUyvR8DvD69LU+g3i+HFWQMQ8PqZuHD+sNKAV0+M6EJC0szq7rEr7B5bQ8BcNHzvDMc9eqB5ZCQdTf80Obn4uzjwpYU7SISdtV0QGa9D3Wrh2BDQtpBKxaNFV+/Cy2P/Sv+8s7Ud0Fd74X4+o/TNztWgETUapy+majNQ68Lq3ee0ZO48VEbTZYiH1Co4OlfWef82RWeyUXo7woM03PyapGfikTnQinoNq5z5veLpeMV3HCAMTaZmA1oGLAn7XS3XYsz+XK7VMQsc4XKrmDXOLU/pSXVNUq8dIqTba///3x6LiLS6xs1xuCAYSfcQ3+rQgmu7uvf3THKt5Ooo97TqcbRqxx7EASizaQCBQllG/rYxVapMLgtLbZS64w1MDBMXX+PQpBKNwqUKOf2DDRDUXQf9EhOS0Qj4nTmlA8dzSLz/G1d+Ud8MTy/6ghhdiLpeerGY/UlDOfiuqFsMUU5/UYlP+BAmgRLuNpvrUaLlVkrqDievNVEAwF+4CoM1MZTmjxjJMsKJq+u8Zd7tNCUFy6LiyYXRJQ4VyvEQFFaCGKsxIwQkk7EzZ6LTJq2hUuPhvAW+gQnSG6J+MszC+7QCRHcnqDdyNRJ6T9xyS87A6MDutbzKGvGktpbXqtzWtXb9HsfK2cBMomjN9a4y+TaJLnXxAeX/HWzmf4cR4vALt/P4w4qgKY04ml4ZdLOinFYS6cup3G/1ie4+t1eOnpBNlqGqs75ilzkT4+DsZQxNvaSKJ//6zIbbk/M7LOhFmRc/1R+kBtz7JFGdZm/COotIdvQoXpTqP/1uqEUmCb/QWoGLMwO5ANcHzxdY48IGP5+J+zKOTBFZ4Pid+GTM+Wq12MV/H86xEJptBa6T+p3kgpwLedManBHC2GgNrFpoN2xnrMz9WFWX/8/ygSBkavq2Uv7FdCsLEYLu9LLIvAU0bNRDtzYl+/vXmjpIvuJFYjmI0im6QEYqnIeMsNjXG4vIutIGHijeAG/9EDBozKV5cldkHbLxHh25vT+ZEzbhXlqvpzKJwcEgfNwLAKFeo0/pvEE10XDB+EXRTXtSzJozQKFFAJhMxYkVaCW+E9AL7tMeU8acxidHqzb6lX4691UsDpy/LLRmT+epgW56+5Cw8tB4kMUv6s9lh3eRKbyGs+H/4mQMaYzPTf2OOdokEn+zzgvoD3FqNKk8QqGAXVsqcGdXrT62fSPkR2vROFi68A6se86UxRUk4cajfPyCC4G5wDhD+zNq4jodQ4u4n/m37Lr36n4LIAAsVr02dFi9AiwA81MYs2rm4eDlDNmdMRvEKRHfBwW5DdMNp0jPFZMeARqF/wL4XBfd+EMLBfMzpH5GH6NaW+1vrvMdg+VxDzatk3MXgO3ro3P/DpcC6+Mo4MySJhKJhSR01SGGGp5hPWmrrUgrv3lDnP+HhcI3nt3YqBoVAVTBAQT5iuhTg8nvPtd8ZeYj6w1x6RqGUBrSku7+N1+BaasZvjTk64RoIDlL8brpEcJx3OmY7jLoZsswdtmhfC/G21llXhITOwmvRDDeTTPbyASOa16cF5/A1fZAidJpqju3wYAy9avPR1ya6eNp9K8XYrrtuxlqi+bDKwlfrYdR0RRiKRVTLOH85+ZY7XSmzRpfZBJjaTa81VDcJHpZnZnSQLASGYW9l51ZV/h7eVzTi3Hv6hUsgc/51AqJRTkpbFVLXXszoBL8nBX0u/0jBLT8nH+fJePbrwURT58OY+UieRjd1vs04w0VG5VN2U6MoGZkQzKN/ptz0Q366dxoTGmj7i1NQGHi9GgnquXFYdrCfZBmeb7s0T6yrdlZH5cZuwHFyIJ/kAtGsTg0xH5taAAq44BAk1CPk9KVVbqQzrCUiFdF/6gtlPQ8bHHc1G1W92MXGZ5HEHftyLYs8mbD/9xYRUWkHmlM0zC2ilJlnNgV4bfALpQghxOUoZL7VTqtCHIaQSXm+YUMnpkXybnV+A6xlm2CVy8fn0Xlm2XRa0+zzOa21JWWmixfiPMSCZ7qA4rS93VN3pkpF1s5TonQjisHf7iU9ZGvUPOAKZcR1pbeVf/Ul7OhepGCaId9wOtqo7pJ7yLcBZ0pFkOF28y4zEI/kcUNmutBHaQpBdNM8vjCS6HZRokkeo88TBAjGyG7SR+6vUgTcyK9Imalj0kuxz0wmK+byQU11AiJFk/ya5dNduRClcnU64yGu/ieWSeOos1t3ep+RPIWQ2pyTYVbZltTbsb7NiwSi3AV+8KLWk7LxCnfZUetEM8ThnsSoGH38/nyAwFguJp8FjvlHtcWZuU4hPva0rHfr0UhOOJ/F6vS62FW7KzkmRll2HEc7oUq4fyi5T70Vl7YVIfsPHUCdHesf9Lk7WNVWO75JDkYbMI8TOW8JKVtLY9d6UJRITO8oKo0xS+o99Yy04iniGHAaGj88kEWgwv0OrHdY/nr76DOGNS59hXCGXzTKUvDl9iKpLSWYN1lxIeyywdNpTkhay74w2jFT6NS8qkjo5CxA1yfSYwp6AJIZNKIeEK5PJAW7ORgWgwp0VgzYpqovMrWxbu+DGZ6Lhie1RAqpzm8VUzKJOH3mCzWuTOLsN3VT/dv2eeYe9UjbR8YTBsLz7q60VN1sU51k+um1f8JxD5pPhbhSC8rRaB454tmh6YUWrJI3+GWY0qeWioj/tbkYITOkJaeuGt4JrJvHA+l0Gu7kY7XOaa05alMnRWVCXqFgLIwSY4uF59Ue5SU4QKuc/HamDxbr0x6csCetXGoP7Qn1Bk/J9DsynO/UD6iZ1Hyrz+jit0hDCwi/E9OjgKTbB3ZQKQ/0ZOvevfNHG0NK4Aj3Cp7NpRk07RT1i/S0EL93Ag8GRgKI9CfpajKyK6+Jj/PI1KO5/85VAwz2AwzP8FTBb075IxCXv6T9RVvWT2tUaqxDS92zrGUbWzUYk9mSs82pECH+fkqsDt93VW++4YsR/dHCYcQSYTO/KaBMDj9LSD/J/+z20Kq8XvZUAIHtm9hRPP3ItbuAu2Hm5lkPs92pd7kCxgRs0xOVBnZ13ccdA0aunrwv9SdqElJRC3g+oCu+nXyCgmXUs9yMjTMAIHfxZV+aPKcZeUBWt057Xo85Ks1Ir5gzEHCWqZEhrLZMuF11ziGtFQUds/EESajhagzcKsxamcSZxGth4UII+adPhQkUnx2WyN+4YWR+r3f8MnkyGFuR4zjzxJS8WsQYR5PTyRaD9ixa6Mh741nBHbzfjXHskGDq179xaRNrCIB1z1xRfWfjqw2pHc1zk9xlPpL8sQWAIuETZZhbnmL54rceXVNRvUiKrrqIkeogsl0XXb17ylNb0f4GA9Wd44vffEG8FSZGHEL2fbaTGRcSiCeA8PmA/f6Hz8HCS76fXUHwgwkzSwlI71ekZ7Fapmlk/KC+Hs8hUcw3N2LN5LhkVYyizYFl/uPeVP5lsoJHhhfWvvSWruCUW1ZcJOeuTbrDgywJ/qG07gZJplnTvLcYdNaH0KMYOYMGX+rB4NGPFmQsNaIwlWrfCezxre8zXBrsMT+edVLbLqN1BqB76JH4BvZTqUIMfGwPGEn+EnmTV86fPBaYbFL3DFEhjB45CewkXEAtJxk4/Ms2pPXnaRqdky0HOYdcUcE2zcXq4vaIvW2/v0nHFJH2XXe22ueDmq/18XGtELSq85j9X8q0tcNSSKJIX8FTuJF/Pf8j5PhqG2u+osvsLxYrvvfeVJL+4tkcXcr9JV7v0ERmj/X6fM3NC4j6dS1+9Umr2oPavqiAydTZPLMNRGY23LO9zAVDly7jD+70G5TPPLdhRIl4WxcYjLnM+SNcJ26FOrkrISUtPObIz5Zb3AG612krnpy15RMW+1cQjlnWFI6538qky9axd2oJmHIHP08KyP0ubGO+TQNOYuv2uh17yCIvR8VcStw7o1g0NM60sk+8Tq7YfIBJrtp53GkvzXH7OA0p8/n/u1satf/VJhtR1l8Wa6Gmaug7haSpaCaYQax6ta0mkutlb+eAOSG1aobM81D9A4iS1RRlzBBoVX6tU1S6WE2N9ORY6DfeLRC4l9Rvr5h95XDWB2mR1d4WFudpsgVYwiTwT31ljskD8ZyDOlm5DkGh9N/UB/0AI5Xvb8ZBmai2hQ4BWMqFwYnzxwB26YHSOv9WgY3JXnvoN+2R4rqGVh/LLDMtpFP+SpMGJNWvbIl5SOodbCczW2RKleksPoUeGEzrjtKHVdtZA+kfqO+rVx/iclCqwoopepvJpSTDjT+b9GWylGRF8EDbGlw6eUzmJM95Ovoz+kwLX3c2fTjFeYEsE7vUZm3mqdGJuKh2w9/QGSaqRHs99aScGOdDqkFcACoqdbBoQqqjamhH6Q9ng39JCg3lrGJwd50Qk9ovnqBTr8MME7Ps2wiVfygUmPoUBJJfJWX5Nda0nuncbFkA=="))}const Rh=xH(),vH=new Set(rh(Rh)),EH=new Set(rh(Rh)),AH=gH(Rh),_H=wH(Rh),Sx=45,Nx=95;function C_(r){return th(r)}function CH(r){return r.filter(e=>e!=65039)}function S_(r){for(let e of r.split(".")){let t=C_(e);try{for(let n=t.lastIndexOf(Nx)-1;n>=0;n--)if(t[n]!==Nx)throw new Error("underscore only allowed at start");if(t.length>=4&&t.every(n=>n<128)&&t[2]===Sx&&t[3]===Sx)throw new Error("invalid label extension")}catch(n){throw new Error(`Invalid label "${e}": ${n.message}`)}}return r}function SH(r){return S_(NH(r,CH))}function NH(r,e){let t=C_(r).reverse(),n=[];for(;t.length;){let i=TH(t);if(i){n.push(...e(i));continue}let s=t.pop();if(vH.has(s)){n.push(s);continue}if(EH.has(s))continue;let o=AH[s];if(o){n.push(...o);continue}throw new Error(`Disallowed codepoint: 0x${s.toString(16).toUpperCase()}`)}return S_(IH(String.fromCodePoint(...n)))}function IH(r){return r.normalize("NFC")}function TH(r,e){var t;let n=_H,i,s,o=[],a=r.length;for(;a;){let c=r[--a];if(n=(t=n.branches.find(l=>l.set.has(c)))===null||t===void 0?void 0:t.node,!n)break;if(n.save)s=c;else if(n.check&&c===s)break;o.push(c),n.fe0f&&(o.push(65039),a>0&&r[a-1]==65039&&a--),n.valid&&(i=o.slice(),n.valid==2&&i.splice(1,1),r.length=a)}return i}const PH=new K(E_),N_=new Uint8Array(32);N_.fill(0);function Ix(r){if(r.length===0)throw new Error("invalid ENS name; empty component");return r}function Oh(r){const e=ar(SH(r)),t=[];if(r.length===0)return t;let n=0;for(let i=0;i<e.length;i++)e[i]===46&&(t.push(Ix(e.slice(n,i))),n=i+1);if(n>=e.length)throw new Error("invalid ENS name; empty component");return t.push(Ix(e.slice(n))),t}function RH(r){return Oh(r).map(e=>To(e)).join(".")}function OH(r){try{return Oh(r).length!==0}catch{}return!1}function Gl(r){typeof r!="string"&&PH.throwArgumentError("invalid ENS name; not a string","name",r);let e=N_;const t=Oh(r);for(;t.length;)e=xt(Nt([e,xt(t.pop())]));return oe(e)}function I_(r){return oe(Nt(Oh(r).map(e=>{if(e.length>63)throw new Error("invalid DNS encoded entry; length exceeds 63 bytes");const t=new Uint8Array(e.length+1);return t.set(e,1),t[0]=t.length-1,t})))+"00"}const T_=`Ethereum Signed Message:
`;function Qm(r){return typeof r=="string"&&(r=ar(r)),xt(Nt([ar(T_),ar(String(r.length)),r]))}var kH=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};const tr=new K(E_),P_=new Uint8Array(32);P_.fill(0);const DH=ie.from(-1),R_=ie.from(0),O_=ie.from(1),MH=ie.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function UH(r){const e=te(r),t=e.length%32;return t?an([e,P_.slice(t)]):oe(e)}const BH=Ct(O_.toHexString(),32),$H=Ct(R_.toHexString(),32),Tx={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},fp=["name","version","chainId","verifyingContract","salt"];function Px(r){return function(e){return typeof e!="string"&&tr.throwArgumentError(`invalid domain value for ${JSON.stringify(r)}`,`domain.${r}`,e),e}}const LH={name:Px("name"),version:Px("version"),chainId:function(r){try{return ie.from(r).toString()}catch{}return tr.throwArgumentError('invalid domain value for "chainId"',"domain.chainId",r)},verifyingContract:function(r){try{return pt(r).toLowerCase()}catch{}return tr.throwArgumentError('invalid domain value "verifyingContract"',"domain.verifyingContract",r)},salt:function(r){try{const e=te(r);if(e.length!==32)throw new Error("bad length");return oe(e)}catch{}return tr.throwArgumentError('invalid domain value "salt"',"domain.salt",r)}};function hp(r){{const e=r.match(/^(u?)int(\d*)$/);if(e){const t=e[1]==="",n=parseInt(e[2]||"256");(n%8!==0||n>256||e[2]&&e[2]!==String(n))&&tr.throwArgumentError("invalid numeric width","type",r);const i=MH.mask(t?n-1:n),s=t?i.add(O_).mul(DH):R_;return function(o){const a=ie.from(o);return(a.lt(s)||a.gt(i))&&tr.throwArgumentError(`value out-of-bounds for ${r}`,"value",o),Ct(a.toTwos(256).toHexString(),32)}}}{const e=r.match(/^bytes(\d+)$/);if(e){const t=parseInt(e[1]);return(t===0||t>32||e[1]!==String(t))&&tr.throwArgumentError("invalid bytes width","type",r),function(n){return te(n).length!==t&&tr.throwArgumentError(`invalid length for ${r}`,"value",n),UH(n)}}}switch(r){case"address":return function(e){return Ct(pt(e),32)};case"bool":return function(e){return e?BH:$H};case"bytes":return function(e){return xt(e)};case"string":return function(e){return yo(e)}}return null}function Rx(r,e){return`${r}(${e.map(({name:t,type:n})=>n+" "+t).join(",")})`}class $r{constructor(e){J(this,"types",Object.freeze(ds(e))),J(this,"_encoderCache",{}),J(this,"_types",{});const t={},n={},i={};Object.keys(e).forEach(a=>{t[a]={},n[a]=[],i[a]={}});for(const a in e){const c={};e[a].forEach(l=>{c[l.name]&&tr.throwArgumentError(`duplicate variable name ${JSON.stringify(l.name)} in ${JSON.stringify(a)}`,"types",e),c[l.name]=!0;const u=l.type.match(/^([^\x5b]*)(\x5b|$)/)[1];u===a&&tr.throwArgumentError(`circular type reference to ${JSON.stringify(u)}`,"types",e),!hp(u)&&(n[u]||tr.throwArgumentError(`unknown type ${JSON.stringify(u)}`,"types",e),n[u].push(a),t[a][u]=!0)})}const s=Object.keys(n).filter(a=>n[a].length===0);s.length===0?tr.throwArgumentError("missing primary type","types",e):s.length>1&&tr.throwArgumentError(`ambiguous primary types or unused types: ${s.map(a=>JSON.stringify(a)).join(", ")}`,"types",e),J(this,"primaryType",s[0]);function o(a,c){c[a]&&tr.throwArgumentError(`circular type reference to ${JSON.stringify(a)}`,"types",e),c[a]=!0,Object.keys(t[a]).forEach(l=>{n[l]&&(o(l,c),Object.keys(c).forEach(u=>{i[u][l]=!0}))}),delete c[a]}o(this.primaryType,{});for(const a in i){const c=Object.keys(i[a]);c.sort(),this._types[a]=Rx(a,e[a])+c.map(l=>Rx(l,e[l])).join("")}}getEncoder(e){let t=this._encoderCache[e];return t||(t=this._encoderCache[e]=this._getEncoder(e)),t}_getEncoder(e){{const i=hp(e);if(i)return i}const t=e.match(/^(.*)(\x5b(\d*)\x5d)$/);if(t){const i=t[1],s=this.getEncoder(i),o=parseInt(t[3]);return a=>{o>=0&&a.length!==o&&tr.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",a);let c=a.map(s);return this._types[i]&&(c=c.map(xt)),xt(an(c))}}const n=this.types[e];if(n){const i=yo(this._types[e]);return s=>{const o=n.map(({name:a,type:c})=>{const l=this.getEncoder(c)(s[a]);return this._types[c]?xt(l):l});return o.unshift(i),an(o)}}return tr.throwArgumentError(`unknown type: ${e}`,"type",e)}encodeType(e){const t=this._types[e];return t||tr.throwArgumentError(`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return xt(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,n){if(hp(e))return n(e,t);const i=e.match(/^(.*)(\x5b(\d*)\x5d)$/);if(i){const o=i[1],a=parseInt(i[3]);return a>=0&&t.length!==a&&tr.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",t),t.map(c=>this._visit(o,c,n))}const s=this.types[e];return s?s.reduce((o,{name:a,type:c})=>(o[a]=this._visit(c,t[a],n),o),{}):tr.throwArgumentError(`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new $r(e)}static getPrimaryType(e){return $r.from(e).primaryType}static hashStruct(e,t,n){return $r.from(t).hashStruct(e,n)}static hashDomain(e){const t=[];for(const n in e){const i=Tx[n];i||tr.throwArgumentError(`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",e),t.push({name:n,type:i})}return t.sort((n,i)=>fp.indexOf(n.name)-fp.indexOf(i.name)),$r.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,n){return an(["0x1901",$r.hashDomain(e),$r.from(t).hash(n)])}static hash(e,t,n){return xt($r.encode(e,t,n))}static resolveNames(e,t,n,i){return kH(this,void 0,void 0,function*(){e=mr(e);const s={};e.verifyingContract&&!We(e.verifyingContract,20)&&(s[e.verifyingContract]="0x");const o=$r.from(t);o.visit(n,(a,c)=>(a==="address"&&!We(c,20)&&(s[c]="0x"),c));for(const a in s)s[a]=yield i(a);return e.verifyingContract&&s[e.verifyingContract]&&(e.verifyingContract=s[e.verifyingContract]),n=o.visit(n,(a,c)=>a==="address"&&s[c]?s[c]:c),{domain:e,value:n}})}static getPayload(e,t,n){$r.hashDomain(e);const i={},s=[];fp.forEach(c=>{const l=e[c];l!=null&&(i[c]=LH[c](l),s.push({name:c,type:Tx[c]}))});const o=$r.from(t),a=mr(t);return a.EIP712Domain?tr.throwArgumentError("types must not contain EIP712Domain type","types.EIP712Domain",t):a.EIP712Domain=s,o.encode(n),{types:a,domain:i,primaryType:o.primaryType,message:o.visit(n,(c,l)=>{if(c.match(/^bytes(\d*)/))return oe(te(l));if(c.match(/^u?int/))return ie.from(l).toString();switch(c){case"address":return l.toLowerCase();case"bool":return!!l;case"string":return typeof l!="string"&&tr.throwArgumentError("invalid string","value",l),l}return tr.throwArgumentError("unsupported type","type",c)})}}}const FH=Object.freeze(Object.defineProperty({__proto__:null,_TypedDataEncoder:$r,dnsEncode:I_,ensNormalize:RH,hashMessage:Qm,id:yo,isValidName:OH,messagePrefix:T_,namehash:Gl},Symbol.toStringTag,{value:"Module"})),er=new K(hd);class k_ extends Io{}class D_ extends Io{}class jH extends Io{}class nh extends Io{static isIndexed(e){return!!(e&&e._isIndexed)}}const qH={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:!0},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"]}};function Ox(r,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${r}`);return t.error=e,t}class Wg{constructor(e){let t=[];typeof e=="string"?t=JSON.parse(e):t=e,J(this,"fragments",t.map(n=>ts.from(n)).filter(n=>n!=null)),J(this,"_abiCoder",Ti(new.target,"getAbiCoder")()),J(this,"functions",{}),J(this,"errors",{}),J(this,"events",{}),J(this,"structs",{}),this.fragments.forEach(n=>{let i=null;switch(n.type){case"constructor":if(this.deploy){er.warn("duplicate definition - constructor");return}J(this,"deploy",n);return;case"function":i=this.functions;break;case"event":i=this.events;break;case"error":i=this.errors;break;default:return}let s=n.format();if(i[s]){er.warn("duplicate definition - "+s);return}i[s]=n}),this.deploy||J(this,"deploy",Ci.from({payable:!1,type:"constructor"})),J(this,"_isInterface",!0)}format(e){e||(e=et.full),e===et.sighash&&er.throwArgumentError("interface does not support formatting sighash","format",e);const t=this.fragments.map(n=>n.format(e));return e===et.json?JSON.stringify(t.map(n=>JSON.parse(n))):t}static getAbiCoder(){return v_}static getAddress(e){return pt(e)}static getSighash(e){return dr(yo(e.format()),0,4)}static getEventTopic(e){return yo(e.format())}getFunction(e){if(We(e)){for(const n in this.functions)if(e===this.getSighash(n))return this.functions[n];er.throwArgumentError("no matching function","sighash",e)}if(e.indexOf("(")===-1){const n=e.trim(),i=Object.keys(this.functions).filter(s=>s.split("(")[0]===n);return i.length===0?er.throwArgumentError("no matching function","name",n):i.length>1&&er.throwArgumentError("multiple matching functions","name",n),this.functions[i[0]]}const t=this.functions[Si.fromString(e).format()];return t||er.throwArgumentError("no matching function","signature",e),t}getEvent(e){if(We(e)){const n=e.toLowerCase();for(const i in this.events)if(n===this.getEventTopic(i))return this.events[i];er.throwArgumentError("no matching event","topichash",n)}if(e.indexOf("(")===-1){const n=e.trim(),i=Object.keys(this.events).filter(s=>s.split("(")[0]===n);return i.length===0?er.throwArgumentError("no matching event","name",n):i.length>1&&er.throwArgumentError("multiple matching events","name",n),this.events[i[0]]}const t=this.events[Zi.fromString(e).format()];return t||er.throwArgumentError("no matching event","signature",e),t}getError(e){if(We(e)){const n=Ti(this.constructor,"getSighash");for(const i in this.errors){const s=this.errors[i];if(e===n(s))return this.errors[i]}er.throwArgumentError("no matching error","sighash",e)}if(e.indexOf("(")===-1){const n=e.trim(),i=Object.keys(this.errors).filter(s=>s.split("(")[0]===n);return i.length===0?er.throwArgumentError("no matching error","name",n):i.length>1&&er.throwArgumentError("multiple matching errors","name",n),this.errors[i[0]]}const t=this.errors[Si.fromString(e).format()];return t||er.throwArgumentError("no matching error","signature",e),t}getSighash(e){if(typeof e=="string")try{e=this.getFunction(e)}catch(t){try{e=this.getError(e)}catch{throw t}}return Ti(this.constructor,"getSighash")(e)}getEventTopic(e){return typeof e=="string"&&(e=this.getEvent(e)),Ti(this.constructor,"getEventTopic")(e)}_decodeParams(e,t){return this._abiCoder.decode(e,t)}_encodeParams(e,t){return this._abiCoder.encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){typeof e=="string"&&(e=this.getError(e));const n=te(t);return oe(n.slice(0,4))!==this.getSighash(e)&&er.throwArgumentError(`data signature does not match error ${e.name}.`,"data",oe(n)),this._decodeParams(e.inputs,n.slice(4))}encodeErrorResult(e,t){return typeof e=="string"&&(e=this.getError(e)),oe(Nt([this.getSighash(e),this._encodeParams(e.inputs,t||[])]))}decodeFunctionData(e,t){typeof e=="string"&&(e=this.getFunction(e));const n=te(t);return oe(n.slice(0,4))!==this.getSighash(e)&&er.throwArgumentError(`data signature does not match function ${e.name}.`,"data",oe(n)),this._decodeParams(e.inputs,n.slice(4))}encodeFunctionData(e,t){return typeof e=="string"&&(e=this.getFunction(e)),oe(Nt([this.getSighash(e),this._encodeParams(e.inputs,t||[])]))}decodeFunctionResult(e,t){typeof e=="string"&&(e=this.getFunction(e));let n=te(t),i=null,s="",o=null,a=null,c=null;switch(n.length%this._abiCoder._getWordSize()){case 0:try{return this._abiCoder.decode(e.outputs,n)}catch{}break;case 4:{const l=oe(n.slice(0,4)),u=qH[l];if(u)o=this._abiCoder.decode(u.inputs,n.slice(4)),a=u.name,c=u.signature,u.reason&&(i=o[0]),a==="Error"?s=`; VM Exception while processing transaction: reverted with reason string ${JSON.stringify(o[0])}`:a==="Panic"&&(s=`; VM Exception while processing transaction: reverted with panic code ${o[0]}`);else try{const d=this.getError(l);o=this._abiCoder.decode(d.inputs,n.slice(4)),a=d.name,c=d.format()}catch{}break}}return er.throwError("call revert exception"+s,K.errors.CALL_EXCEPTION,{method:e.format(),data:oe(t),errorArgs:o,errorName:a,errorSignature:c,reason:i})}encodeFunctionResult(e,t){return typeof e=="string"&&(e=this.getFunction(e)),oe(this._abiCoder.encode(e.outputs,t||[]))}encodeFilterTopics(e,t){typeof e=="string"&&(e=this.getEvent(e)),t.length>e.inputs.length&&er.throwError("too many arguments for "+e.format(),K.errors.UNEXPECTED_ARGUMENT,{argument:"values",value:t});let n=[];e.anonymous||n.push(this.getEventTopic(e));const i=(s,o)=>s.type==="string"?yo(o):s.type==="bytes"?xt(oe(o)):(s.type==="bool"&&typeof o=="boolean"&&(o=o?"0x01":"0x00"),s.type.match(/^u?int/)&&(o=ie.from(o).toHexString()),s.type==="address"&&this._abiCoder.encode(["address"],[o]),Ct(oe(o),32));for(t.forEach((s,o)=>{let a=e.inputs[o];if(!a.indexed){s!=null&&er.throwArgumentError("cannot filter non-indexed parameters; must be null","contract."+a.name,s);return}s==null?n.push(null):a.baseType==="array"||a.baseType==="tuple"?er.throwArgumentError("filtering with tuples or arrays not supported","contract."+a.name,s):Array.isArray(s)?n.push(s.map(c=>i(a,c))):n.push(i(a,s))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(e,t){typeof e=="string"&&(e=this.getEvent(e));const n=[],i=[],s=[];return e.anonymous||n.push(this.getEventTopic(e)),t.length!==e.inputs.length&&er.throwArgumentError("event arguments/values mismatch","values",t),e.inputs.forEach((o,a)=>{const c=t[a];if(o.indexed)if(o.type==="string")n.push(yo(c));else if(o.type==="bytes")n.push(xt(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");n.push(this._abiCoder.encode([o.type],[c]))}else i.push(o),s.push(c)}),{data:this._abiCoder.encode(i,s),topics:n}}decodeEventLog(e,t,n){if(typeof e=="string"&&(e=this.getEvent(e)),n!=null&&!e.anonymous){let p=this.getEventTopic(e);(!We(n[0],32)||n[0].toLowerCase()!==p)&&er.throwError("fragment/topic mismatch",K.errors.INVALID_ARGUMENT,{argument:"topics[0]",expected:p,value:n[0]}),n=n.slice(1)}let i=[],s=[],o=[];e.inputs.forEach((p,x)=>{p.indexed?p.type==="string"||p.type==="bytes"||p.baseType==="tuple"||p.baseType==="array"?(i.push(Er.fromObject({type:"bytes32",name:p.name})),o.push(!0)):(i.push(p),o.push(!1)):(s.push(p),o.push(!1))});let a=n!=null?this._abiCoder.decode(i,Nt(n)):null,c=this._abiCoder.decode(s,t,!0),l=[],u=0,d=0;e.inputs.forEach((p,x)=>{if(p.indexed)if(a==null)l[x]=new nh({_isIndexed:!0,hash:null});else if(o[x])l[x]=new nh({_isIndexed:!0,hash:a[d++]});else try{l[x]=a[d++]}catch(w){l[x]=w}else try{l[x]=c[u++]}catch(w){l[x]=w}if(p.name&&l[p.name]==null){const w=l[x];w instanceof Error?Object.defineProperty(l,p.name,{enumerable:!0,get:()=>{throw Ox(`property ${JSON.stringify(p.name)}`,w)}}):l[p.name]=w}});for(let p=0;p<l.length;p++){const x=l[p];x instanceof Error&&Object.defineProperty(l,p,{enumerable:!0,get:()=>{throw Ox(`index ${p}`,x)}})}return Object.freeze(l)}parseTransaction(e){let t=this.getFunction(e.data.substring(0,10).toLowerCase());return t?new D_({args:this._abiCoder.decode(t.inputs,"0x"+e.data.substring(10)),functionFragment:t,name:t.name,signature:t.format(),sighash:this.getSighash(t),value:ie.from(e.value||"0")}):null}parseLog(e){let t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new k_({eventFragment:t,name:t.name,signature:t.format(),topic:this.getEventTopic(t),args:this.decodeEventLog(t,e.data,e.topics)})}parseError(e){const t=oe(e);let n=this.getError(t.substring(0,10).toLowerCase());return n?new jH({args:this._abiCoder.decode(n.inputs,"0x"+t.substring(10)),errorFragment:n,name:n.name,signature:n.format(),sighash:this.getSighash(n)}):null}static isInterface(e){return!!(e&&e._isInterface)}}const HH=Object.freeze(Object.defineProperty({__proto__:null,AbiCoder:x_,ConstructorFragment:Ci,ErrorFragment:Rs,EventFragment:Zi,FormatTypes:et,Fragment:ts,FunctionFragment:Si,Indexed:nh,Interface:Wg,LogDescription:k_,ParamType:Er,TransactionDescription:D_,checkResultErrors:a_,defaultAbiCoder:v_},Symbol.toStringTag,{value:"Module"})),WH="abstract-provider/5.8.0";var zH=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};const KH=new K(WH);class VH extends Io{static isForkEvent(e){return!!(e&&e._isForkEvent)}}class pd{constructor(){KH.checkAbstract(new.target,pd),J(this,"_isProvider",!0)}getFeeData(){return zH(this,void 0,void 0,function*(){const{block:e,gasPrice:t}=yield or({block:this.getBlock("latest"),gasPrice:this.getGasPrice().catch(o=>null)});let n=null,i=null,s=null;return e&&e.baseFeePerGas&&(n=e.baseFeePerGas,s=ie.from("1500000000"),i=e.baseFeePerGas.mul(2).add(s)),{lastBaseFeePerGas:n,maxFeePerGas:i,maxPriorityFeePerGas:s,gasPrice:t}})}addListener(e,t){return this.on(e,t)}removeListener(e,t){return this.off(e,t)}static isProvider(e){return!!(e&&e._isProvider)}}const GH="abstract-signer/5.8.0";var mi=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};const Xn=new K(GH),YH=["accessList","ccipReadEnabled","chainId","customData","data","from","gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","nonce","to","type","value"],JH=[K.errors.INSUFFICIENT_FUNDS,K.errors.NONCE_EXPIRED,K.errors.REPLACEMENT_UNDERPRICED];class rl{constructor(){Xn.checkAbstract(new.target,rl),J(this,"_isSigner",!0)}getBalance(e){return mi(this,void 0,void 0,function*(){return this._checkProvider("getBalance"),yield this.provider.getBalance(this.getAddress(),e)})}getTransactionCount(e){return mi(this,void 0,void 0,function*(){return this._checkProvider("getTransactionCount"),yield this.provider.getTransactionCount(this.getAddress(),e)})}estimateGas(e){return mi(this,void 0,void 0,function*(){this._checkProvider("estimateGas");const t=yield or(this.checkTransaction(e));return yield this.provider.estimateGas(t)})}call(e,t){return mi(this,void 0,void 0,function*(){this._checkProvider("call");const n=yield or(this.checkTransaction(e));return yield this.provider.call(n,t)})}sendTransaction(e){return mi(this,void 0,void 0,function*(){this._checkProvider("sendTransaction");const t=yield this.populateTransaction(e),n=yield this.signTransaction(t);return yield this.provider.sendTransaction(n)})}getChainId(){return mi(this,void 0,void 0,function*(){return this._checkProvider("getChainId"),(yield this.provider.getNetwork()).chainId})}getGasPrice(){return mi(this,void 0,void 0,function*(){return this._checkProvider("getGasPrice"),yield this.provider.getGasPrice()})}getFeeData(){return mi(this,void 0,void 0,function*(){return this._checkProvider("getFeeData"),yield this.provider.getFeeData()})}resolveName(e){return mi(this,void 0,void 0,function*(){return this._checkProvider("resolveName"),yield this.provider.resolveName(e)})}checkTransaction(e){for(const n in e)YH.indexOf(n)===-1&&Xn.throwArgumentError("invalid transaction key: "+n,"transaction",e);const t=mr(e);return t.from==null?t.from=this.getAddress():t.from=Promise.all([Promise.resolve(t.from),this.getAddress()]).then(n=>(n[0].toLowerCase()!==n[1].toLowerCase()&&Xn.throwArgumentError("from address mismatch","transaction",e),n[0])),t}populateTransaction(e){return mi(this,void 0,void 0,function*(){const t=yield or(this.checkTransaction(e));t.to!=null&&(t.to=Promise.resolve(t.to).then(i=>mi(this,void 0,void 0,function*(){if(i==null)return null;const s=yield this.resolveName(i);return s==null&&Xn.throwArgumentError("provided ENS name resolves to null","tx.to",i),s})),t.to.catch(i=>{}));const n=t.maxFeePerGas!=null||t.maxPriorityFeePerGas!=null;if(t.gasPrice!=null&&(t.type===2||n)?Xn.throwArgumentError("eip-1559 transaction do not support gasPrice","transaction",e):(t.type===0||t.type===1)&&n&&Xn.throwArgumentError("pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","transaction",e),(t.type===2||t.type==null)&&t.maxFeePerGas!=null&&t.maxPriorityFeePerGas!=null)t.type=2;else if(t.type===0||t.type===1)t.gasPrice==null&&(t.gasPrice=this.getGasPrice());else{const i=yield this.getFeeData();if(t.type==null)if(i.maxFeePerGas!=null&&i.maxPriorityFeePerGas!=null)if(t.type=2,t.gasPrice!=null){const s=t.gasPrice;delete t.gasPrice,t.maxFeePerGas=s,t.maxPriorityFeePerGas=s}else t.maxFeePerGas==null&&(t.maxFeePerGas=i.maxFeePerGas),t.maxPriorityFeePerGas==null&&(t.maxPriorityFeePerGas=i.maxPriorityFeePerGas);else i.gasPrice!=null?(n&&Xn.throwError("network does not support EIP-1559",K.errors.UNSUPPORTED_OPERATION,{operation:"populateTransaction"}),t.gasPrice==null&&(t.gasPrice=i.gasPrice),t.type=0):Xn.throwError("failed to get consistent fee data",K.errors.UNSUPPORTED_OPERATION,{operation:"signer.getFeeData"});else t.type===2&&(t.maxFeePerGas==null&&(t.maxFeePerGas=i.maxFeePerGas),t.maxPriorityFeePerGas==null&&(t.maxPriorityFeePerGas=i.maxPriorityFeePerGas))}return t.nonce==null&&(t.nonce=this.getTransactionCount("pending")),t.gasLimit==null&&(t.gasLimit=this.estimateGas(t).catch(i=>{if(JH.indexOf(i.code)>=0)throw i;return Xn.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",K.errors.UNPREDICTABLE_GAS_LIMIT,{error:i,tx:t})})),t.chainId==null?t.chainId=this.getChainId():t.chainId=Promise.all([Promise.resolve(t.chainId),this.getChainId()]).then(i=>(i[1]!==0&&i[0]!==i[1]&&Xn.throwArgumentError("chainId address mismatch","transaction",e),i[0])),yield or(t)})}_checkProvider(e){this.provider||Xn.throwError("missing provider",K.errors.UNSUPPORTED_OPERATION,{operation:e||"_checkProvider"})}static isSigner(e){return!!(e&&e._isSigner)}}class eb extends rl{constructor(e,t){super(),J(this,"address",e),J(this,"provider",t||null)}getAddress(){return Promise.resolve(this.address)}_fail(e,t){return Promise.resolve().then(()=>{Xn.throwError(e,K.errors.UNSUPPORTED_OPERATION,{operation:t})})}signMessage(e){return this._fail("VoidSigner cannot sign messages","signMessage")}signTransaction(e){return this._fail("VoidSigner cannot sign transactions","signTransaction")}_signTypedData(e,t,n){return this._fail("VoidSigner cannot sign typed data","signTypedData")}connect(e){return new eb(this.address,e)}}var pp={},wt={},gp,kx;function gd(){if(kx)return gp;kx=1,gp=r;function r(e,t){if(!e)throw new Error(t||"Assertion failed")}return r.equal=function(t,n,i){if(t!=n)throw new Error(i||"Assertion failed: "+t+" != "+n)},gp}var Yd={exports:{}},Dx;function ZH(){return Dx||(Dx=1,typeof Object.create=="function"?Yd.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Yd.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),Yd.exports}var Mx;function hs(){if(Mx)return wt;Mx=1;var r=gd(),e=ZH();wt.inherits=e;function t(U,_){return(U.charCodeAt(_)&64512)!==55296||_<0||_+1>=U.length?!1:(U.charCodeAt(_+1)&64512)===56320}function n(U,_){if(Array.isArray(U))return U.slice();if(!U)return[];var f=[];if(typeof U=="string")if(_){if(_==="hex")for(U=U.replace(/[^a-z0-9]+/ig,""),U.length%2!==0&&(U="0"+U),m=0;m<U.length;m+=2)f.push(parseInt(U[m]+U[m+1],16))}else for(var h=0,m=0;m<U.length;m++){var A=U.charCodeAt(m);A<128?f[h++]=A:A<2048?(f[h++]=A>>6|192,f[h++]=A&63|128):t(U,m)?(A=65536+((A&1023)<<10)+(U.charCodeAt(++m)&1023),f[h++]=A>>18|240,f[h++]=A>>12&63|128,f[h++]=A>>6&63|128,f[h++]=A&63|128):(f[h++]=A>>12|224,f[h++]=A>>6&63|128,f[h++]=A&63|128)}else for(m=0;m<U.length;m++)f[m]=U[m]|0;return f}wt.toArray=n;function i(U){for(var _="",f=0;f<U.length;f++)_+=a(U[f].toString(16));return _}wt.toHex=i;function s(U){var _=U>>>24|U>>>8&65280|U<<8&16711680|(U&255)<<24;return _>>>0}wt.htonl=s;function o(U,_){for(var f="",h=0;h<U.length;h++){var m=U[h];_==="little"&&(m=s(m)),f+=c(m.toString(16))}return f}wt.toHex32=o;function a(U){return U.length===1?"0"+U:U}wt.zero2=a;function c(U){return U.length===7?"0"+U:U.length===6?"00"+U:U.length===5?"000"+U:U.length===4?"0000"+U:U.length===3?"00000"+U:U.length===2?"000000"+U:U.length===1?"0000000"+U:U}wt.zero8=c;function l(U,_,f,h){var m=f-_;r(m%4===0);for(var A=new Array(m/4),S=0,R=_;S<A.length;S++,R+=4){var M;h==="big"?M=U[R]<<24|U[R+1]<<16|U[R+2]<<8|U[R+3]:M=U[R+3]<<24|U[R+2]<<16|U[R+1]<<8|U[R],A[S]=M>>>0}return A}wt.join32=l;function u(U,_){for(var f=new Array(U.length*4),h=0,m=0;h<U.length;h++,m+=4){var A=U[h];_==="big"?(f[m]=A>>>24,f[m+1]=A>>>16&255,f[m+2]=A>>>8&255,f[m+3]=A&255):(f[m+3]=A>>>24,f[m+2]=A>>>16&255,f[m+1]=A>>>8&255,f[m]=A&255)}return f}wt.split32=u;function d(U,_){return U>>>_|U<<32-_}wt.rotr32=d;function p(U,_){return U<<_|U>>>32-_}wt.rotl32=p;function x(U,_){return U+_>>>0}wt.sum32=x;function w(U,_,f){return U+_+f>>>0}wt.sum32_3=w;function b(U,_,f,h){return U+_+f+h>>>0}wt.sum32_4=b;function y(U,_,f,h,m){return U+_+f+h+m>>>0}wt.sum32_5=y;function C(U,_,f,h){var m=U[_],A=U[_+1],S=h+A>>>0,R=(S<h?1:0)+f+m;U[_]=R>>>0,U[_+1]=S}wt.sum64=C;function T(U,_,f,h){var m=_+h>>>0,A=(m<_?1:0)+U+f;return A>>>0}wt.sum64_hi=T;function I(U,_,f,h){var m=_+h;return m>>>0}wt.sum64_lo=I;function k(U,_,f,h,m,A,S,R){var M=0,E=_;E=E+h>>>0,M+=E<_?1:0,E=E+A>>>0,M+=E<A?1:0,E=E+R>>>0,M+=E<R?1:0;var g=U+f+m+S+M;return g>>>0}wt.sum64_4_hi=k;function P(U,_,f,h,m,A,S,R){var M=_+h+A+R;return M>>>0}wt.sum64_4_lo=P;function O(U,_,f,h,m,A,S,R,M,E){var g=0,N=_;N=N+h>>>0,g+=N<_?1:0,N=N+A>>>0,g+=N<A?1:0,N=N+R>>>0,g+=N<R?1:0,N=N+E>>>0,g+=N<E?1:0;var L=U+f+m+S+M+g;return L>>>0}wt.sum64_5_hi=O;function q(U,_,f,h,m,A,S,R,M,E){var g=_+h+A+R+E;return g>>>0}wt.sum64_5_lo=q;function F(U,_,f){var h=_<<32-f|U>>>f;return h>>>0}wt.rotr64_hi=F;function B(U,_,f){var h=U<<32-f|_>>>f;return h>>>0}wt.rotr64_lo=B;function W(U,_,f){return U>>>f}wt.shr64_hi=W;function j(U,_,f){var h=U<<32-f|_>>>f;return h>>>0}return wt.shr64_lo=j,wt}var mp={},Ux;function md(){if(Ux)return mp;Ux=1;var r=hs(),e=gd();function t(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}return mp.BlockHash=t,t.prototype.update=function(i,s){if(i=r.toArray(i,s),this.pending?this.pending=this.pending.concat(i):this.pending=i,this.pendingTotal+=i.length,this.pending.length>=this._delta8){i=this.pending;var o=i.length%this._delta8;this.pending=i.slice(i.length-o,i.length),this.pending.length===0&&(this.pending=null),i=r.join32(i,0,i.length-o,this.endian);for(var a=0;a<i.length;a+=this._delta32)this._update(i,a,a+this._delta32)}return this},t.prototype.digest=function(i){return this.update(this._pad()),e(this.pending===null),this._digest(i)},t.prototype._pad=function(){var i=this.pendingTotal,s=this._delta8,o=s-(i+this.padLength)%s,a=new Array(o+this.padLength);a[0]=128;for(var c=1;c<o;c++)a[c]=0;if(i<<=3,this.endian==="big"){for(var l=8;l<this.padLength;l++)a[c++]=0;a[c++]=0,a[c++]=0,a[c++]=0,a[c++]=0,a[c++]=i>>>24&255,a[c++]=i>>>16&255,a[c++]=i>>>8&255,a[c++]=i&255}else for(a[c++]=i&255,a[c++]=i>>>8&255,a[c++]=i>>>16&255,a[c++]=i>>>24&255,a[c++]=0,a[c++]=0,a[c++]=0,a[c++]=0,l=8;l<this.padLength;l++)a[c++]=0;return a},mp}var Go={},qi={},Bx;function M_(){if(Bx)return qi;Bx=1;var r=hs(),e=r.rotr32;function t(u,d,p,x){if(u===0)return n(d,p,x);if(u===1||u===3)return s(d,p,x);if(u===2)return i(d,p,x)}qi.ft_1=t;function n(u,d,p){return u&d^~u&p}qi.ch32=n;function i(u,d,p){return u&d^u&p^d&p}qi.maj32=i;function s(u,d,p){return u^d^p}qi.p32=s;function o(u){return e(u,2)^e(u,13)^e(u,22)}qi.s0_256=o;function a(u){return e(u,6)^e(u,11)^e(u,25)}qi.s1_256=a;function c(u){return e(u,7)^e(u,18)^u>>>3}qi.g0_256=c;function l(u){return e(u,17)^e(u,19)^u>>>10}return qi.g1_256=l,qi}var bp,$x;function XH(){if($x)return bp;$x=1;var r=hs(),e=md(),t=M_(),n=r.rotl32,i=r.sum32,s=r.sum32_5,o=t.ft_1,a=e.BlockHash,c=[1518500249,1859775393,2400959708,3395469782];function l(){if(!(this instanceof l))return new l;a.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}return r.inherits(l,a),bp=l,l.blockSize=512,l.outSize=160,l.hmacStrength=80,l.padLength=64,l.prototype._update=function(d,p){for(var x=this.W,w=0;w<16;w++)x[w]=d[p+w];for(;w<x.length;w++)x[w]=n(x[w-3]^x[w-8]^x[w-14]^x[w-16],1);var b=this.h[0],y=this.h[1],C=this.h[2],T=this.h[3],I=this.h[4];for(w=0;w<x.length;w++){var k=~~(w/20),P=s(n(b,5),o(k,y,C,T),I,x[w],c[k]);I=T,T=C,C=n(y,30),y=b,b=P}this.h[0]=i(this.h[0],b),this.h[1]=i(this.h[1],y),this.h[2]=i(this.h[2],C),this.h[3]=i(this.h[3],T),this.h[4]=i(this.h[4],I)},l.prototype._digest=function(d){return d==="hex"?r.toHex32(this.h,"big"):r.split32(this.h,"big")},bp}var yp,Lx;function U_(){if(Lx)return yp;Lx=1;var r=hs(),e=md(),t=M_(),n=gd(),i=r.sum32,s=r.sum32_4,o=r.sum32_5,a=t.ch32,c=t.maj32,l=t.s0_256,u=t.s1_256,d=t.g0_256,p=t.g1_256,x=e.BlockHash,w=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function b(){if(!(this instanceof b))return new b;x.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=w,this.W=new Array(64)}return r.inherits(b,x),yp=b,b.blockSize=512,b.outSize=256,b.hmacStrength=192,b.padLength=64,b.prototype._update=function(C,T){for(var I=this.W,k=0;k<16;k++)I[k]=C[T+k];for(;k<I.length;k++)I[k]=s(p(I[k-2]),I[k-7],d(I[k-15]),I[k-16]);var P=this.h[0],O=this.h[1],q=this.h[2],F=this.h[3],B=this.h[4],W=this.h[5],j=this.h[6],U=this.h[7];for(n(this.k.length===I.length),k=0;k<I.length;k++){var _=o(U,u(B),a(B,W,j),this.k[k],I[k]),f=i(l(P),c(P,O,q));U=j,j=W,W=B,B=i(F,_),F=q,q=O,O=P,P=i(_,f)}this.h[0]=i(this.h[0],P),this.h[1]=i(this.h[1],O),this.h[2]=i(this.h[2],q),this.h[3]=i(this.h[3],F),this.h[4]=i(this.h[4],B),this.h[5]=i(this.h[5],W),this.h[6]=i(this.h[6],j),this.h[7]=i(this.h[7],U)},b.prototype._digest=function(C){return C==="hex"?r.toHex32(this.h,"big"):r.split32(this.h,"big")},yp}var wp,Fx;function QH(){if(Fx)return wp;Fx=1;var r=hs(),e=U_();function t(){if(!(this instanceof t))return new t;e.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}return r.inherits(t,e),wp=t,t.blockSize=512,t.outSize=224,t.hmacStrength=192,t.padLength=64,t.prototype._digest=function(i){return i==="hex"?r.toHex32(this.h.slice(0,7),"big"):r.split32(this.h.slice(0,7),"big")},wp}var xp,jx;function B_(){if(jx)return xp;jx=1;var r=hs(),e=md(),t=gd(),n=r.rotr64_hi,i=r.rotr64_lo,s=r.shr64_hi,o=r.shr64_lo,a=r.sum64,c=r.sum64_hi,l=r.sum64_lo,u=r.sum64_4_hi,d=r.sum64_4_lo,p=r.sum64_5_hi,x=r.sum64_5_lo,w=e.BlockHash,b=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function y(){if(!(this instanceof y))return new y;w.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=b,this.W=new Array(160)}r.inherits(y,w),xp=y,y.blockSize=1024,y.outSize=512,y.hmacStrength=192,y.padLength=128,y.prototype._prepareBlock=function(f,h){for(var m=this.W,A=0;A<32;A++)m[A]=f[h+A];for(;A<m.length;A+=2){var S=j(m[A-4],m[A-3]),R=U(m[A-4],m[A-3]),M=m[A-14],E=m[A-13],g=B(m[A-30],m[A-29]),N=W(m[A-30],m[A-29]),L=m[A-32],v=m[A-31];m[A]=u(S,R,M,E,g,N,L,v),m[A+1]=d(S,R,M,E,g,N,L,v)}},y.prototype._update=function(f,h){this._prepareBlock(f,h);var m=this.W,A=this.h[0],S=this.h[1],R=this.h[2],M=this.h[3],E=this.h[4],g=this.h[5],N=this.h[6],L=this.h[7],v=this.h[8],H=this.h[9],V=this.h[10],z=this.h[11],G=this.h[12],re=this.h[13],X=this.h[14],ne=this.h[15];t(this.k.length===m.length);for(var Fe=0;Fe<m.length;Fe+=2){var ue=X,Ce=ne,rn=q(v,H),Je=F(v,H),dt=C(v,H,V,z,G),Rn=T(v,H,V,z,G,re),ct=this.k[Fe],tt=this.k[Fe+1],On=m[Fe],lt=m[Fe+1],Ze=p(ue,Ce,rn,Je,dt,Rn,ct,tt,On,lt),nn=x(ue,Ce,rn,Je,dt,Rn,ct,tt,On,lt);ue=P(A,S),Ce=O(A,S),rn=I(A,S,R,M,E),Je=k(A,S,R,M,E,g);var ut=c(ue,Ce,rn,Je),ft=l(ue,Ce,rn,Je);X=G,ne=re,G=V,re=z,V=v,z=H,v=c(N,L,Ze,nn),H=l(L,L,Ze,nn),N=E,L=g,E=R,g=M,R=A,M=S,A=c(Ze,nn,ut,ft),S=l(Ze,nn,ut,ft)}a(this.h,0,A,S),a(this.h,2,R,M),a(this.h,4,E,g),a(this.h,6,N,L),a(this.h,8,v,H),a(this.h,10,V,z),a(this.h,12,G,re),a(this.h,14,X,ne)},y.prototype._digest=function(f){return f==="hex"?r.toHex32(this.h,"big"):r.split32(this.h,"big")};function C(_,f,h,m,A){var S=_&h^~_&A;return S<0&&(S+=4294967296),S}function T(_,f,h,m,A,S){var R=f&m^~f&S;return R<0&&(R+=4294967296),R}function I(_,f,h,m,A){var S=_&h^_&A^h&A;return S<0&&(S+=4294967296),S}function k(_,f,h,m,A,S){var R=f&m^f&S^m&S;return R<0&&(R+=4294967296),R}function P(_,f){var h=n(_,f,28),m=n(f,_,2),A=n(f,_,7),S=h^m^A;return S<0&&(S+=4294967296),S}function O(_,f){var h=i(_,f,28),m=i(f,_,2),A=i(f,_,7),S=h^m^A;return S<0&&(S+=4294967296),S}function q(_,f){var h=n(_,f,14),m=n(_,f,18),A=n(f,_,9),S=h^m^A;return S<0&&(S+=4294967296),S}function F(_,f){var h=i(_,f,14),m=i(_,f,18),A=i(f,_,9),S=h^m^A;return S<0&&(S+=4294967296),S}function B(_,f){var h=n(_,f,1),m=n(_,f,8),A=s(_,f,7),S=h^m^A;return S<0&&(S+=4294967296),S}function W(_,f){var h=i(_,f,1),m=i(_,f,8),A=o(_,f,7),S=h^m^A;return S<0&&(S+=4294967296),S}function j(_,f){var h=n(_,f,19),m=n(f,_,29),A=s(_,f,6),S=h^m^A;return S<0&&(S+=4294967296),S}function U(_,f){var h=i(_,f,19),m=i(f,_,29),A=o(_,f,6),S=h^m^A;return S<0&&(S+=4294967296),S}return xp}var vp,qx;function eW(){if(qx)return vp;qx=1;var r=hs(),e=B_();function t(){if(!(this instanceof t))return new t;e.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}return r.inherits(t,e),vp=t,t.blockSize=1024,t.outSize=384,t.hmacStrength=192,t.padLength=128,t.prototype._digest=function(i){return i==="hex"?r.toHex32(this.h.slice(0,12),"big"):r.split32(this.h.slice(0,12),"big")},vp}var Hx;function tW(){return Hx||(Hx=1,Go.sha1=XH(),Go.sha224=QH(),Go.sha256=U_(),Go.sha384=eW(),Go.sha512=B_()),Go}var Ep={},Wx;function rW(){if(Wx)return Ep;Wx=1;var r=hs(),e=md(),t=r.rotl32,n=r.sum32,i=r.sum32_3,s=r.sum32_4,o=e.BlockHash;function a(){if(!(this instanceof a))return new a;o.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}r.inherits(a,o),Ep.ripemd160=a,a.blockSize=512,a.outSize=160,a.hmacStrength=192,a.padLength=64,a.prototype._update=function(y,C){for(var T=this.h[0],I=this.h[1],k=this.h[2],P=this.h[3],O=this.h[4],q=T,F=I,B=k,W=P,j=O,U=0;U<80;U++){var _=n(t(s(T,c(U,I,k,P),y[d[U]+C],l(U)),x[U]),O);T=O,O=P,P=t(k,10),k=I,I=_,_=n(t(s(q,c(79-U,F,B,W),y[p[U]+C],u(U)),w[U]),j),q=j,j=W,W=t(B,10),B=F,F=_}_=i(this.h[1],k,W),this.h[1]=i(this.h[2],P,j),this.h[2]=i(this.h[3],O,q),this.h[3]=i(this.h[4],T,F),this.h[4]=i(this.h[0],I,B),this.h[0]=_},a.prototype._digest=function(y){return y==="hex"?r.toHex32(this.h,"little"):r.split32(this.h,"little")};function c(b,y,C,T){return b<=15?y^C^T:b<=31?y&C|~y&T:b<=47?(y|~C)^T:b<=63?y&T|C&~T:y^(C|~T)}function l(b){return b<=15?0:b<=31?1518500249:b<=47?1859775393:b<=63?2400959708:2840853838}function u(b){return b<=15?1352829926:b<=31?1548603684:b<=47?1836072691:b<=63?2053994217:0}var d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],x=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],w=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];return Ep}var Ap,zx;function nW(){if(zx)return Ap;zx=1;var r=hs(),e=gd();function t(n,i,s){if(!(this instanceof t))return new t(n,i,s);this.Hash=n,this.blockSize=n.blockSize/8,this.outSize=n.outSize/8,this.inner=null,this.outer=null,this._init(r.toArray(i,s))}return Ap=t,t.prototype._init=function(i){i.length>this.blockSize&&(i=new this.Hash().update(i).digest()),e(i.length<=this.blockSize);for(var s=i.length;s<this.blockSize;s++)i.push(0);for(s=0;s<i.length;s++)i[s]^=54;for(this.inner=new this.Hash().update(i),s=0;s<i.length;s++)i[s]^=106;this.outer=new this.Hash().update(i)},t.prototype.update=function(i,s){return this.inner.update(i,s),this},t.prototype.digest=function(i){return this.outer.update(this.inner.digest()),this.outer.digest(i)},Ap}var Kx;function iW(){return Kx||(Kx=1,(function(r){var e=r;e.utils=hs(),e.common=md(),e.sha=tW(),e.ripemd=rW(),e.hmac=nW(),e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160})(pp)),pp}var sW=iW();const An=qs(sW);function nl(r,e,t){return t={path:e,exports:{},require:function(n,i){return oW(n,i??t.path)}},r(t,t.exports),t.exports}function oW(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var tb=$_;function $_(r,e){if(!r)throw new Error(e||"Assertion failed")}$_.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)};var Pi=nl(function(r,e){var t=e;function n(o,a){if(Array.isArray(o))return o.slice();if(!o)return[];var c=[];if(typeof o!="string"){for(var l=0;l<o.length;l++)c[l]=o[l]|0;return c}if(a==="hex"){o=o.replace(/[^a-z0-9]+/ig,""),o.length%2!==0&&(o="0"+o);for(var l=0;l<o.length;l+=2)c.push(parseInt(o[l]+o[l+1],16))}else for(var l=0;l<o.length;l++){var u=o.charCodeAt(l),d=u>>8,p=u&255;d?c.push(d,p):c.push(p)}return c}t.toArray=n;function i(o){return o.length===1?"0"+o:o}t.zero2=i;function s(o){for(var a="",c=0;c<o.length;c++)a+=i(o[c].toString(16));return a}t.toHex=s,t.encode=function(a,c){return c==="hex"?s(a):a}}),Kn=nl(function(r,e){var t=e;t.assert=tb,t.toArray=Pi.toArray,t.zero2=Pi.zero2,t.toHex=Pi.toHex,t.encode=Pi.encode;function n(c,l,u){var d=new Array(Math.max(c.bitLength(),u)+1),p;for(p=0;p<d.length;p+=1)d[p]=0;var x=1<<l+1,w=c.clone();for(p=0;p<d.length;p++){var b,y=w.andln(x-1);w.isOdd()?(y>(x>>1)-1?b=(x>>1)-y:b=y,w.isubn(b)):b=0,d[p]=b,w.iushrn(1)}return d}t.getNAF=n;function i(c,l){var u=[[],[]];c=c.clone(),l=l.clone();for(var d=0,p=0,x;c.cmpn(-d)>0||l.cmpn(-p)>0;){var w=c.andln(3)+d&3,b=l.andln(3)+p&3;w===3&&(w=-1),b===3&&(b=-1);var y;(w&1)===0?y=0:(x=c.andln(7)+d&7,(x===3||x===5)&&b===2?y=-w:y=w),u[0].push(y);var C;(b&1)===0?C=0:(x=l.andln(7)+p&7,(x===3||x===5)&&w===2?C=-b:C=b),u[1].push(C),2*d===y+1&&(d=1-d),2*p===C+1&&(p=1-p),c.iushrn(1),l.iushrn(1)}return u}t.getJSF=i;function s(c,l,u){var d="_"+l;c.prototype[l]=function(){return this[d]!==void 0?this[d]:this[d]=u.call(this)}}t.cachedProperty=s;function o(c){return typeof c=="string"?t.toArray(c,"hex"):c}t.parseBytes=o;function a(c){return new Re(c,"hex","le")}t.intFromLE=a}),ih=Kn.getNAF,aW=Kn.getJSF,sh=Kn.assert;function Po(r,e){this.type=r,this.p=new Re(e.p,16),this.red=e.prime?Re.red(e.prime):Re.mont(this.p),this.zero=new Re(0).toRed(this.red),this.one=new Re(1).toRed(this.red),this.two=new Re(2).toRed(this.red),this.n=e.n&&new Re(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var La=Po;Po.prototype.point=function(){throw new Error("Not implemented")};Po.prototype.validate=function(){throw new Error("Not implemented")};Po.prototype._fixedNafMul=function(e,t){sh(e.precomputed);var n=e._getDoubles(),i=ih(t,1,this._bitLength),s=(1<<n.step+1)-(n.step%2===0?2:1);s/=3;var o=[],a,c;for(a=0;a<i.length;a+=n.step){c=0;for(var l=a+n.step-1;l>=a;l--)c=(c<<1)+i[l];o.push(c)}for(var u=this.jpoint(null,null,null),d=this.jpoint(null,null,null),p=s;p>0;p--){for(a=0;a<o.length;a++)c=o[a],c===p?d=d.mixedAdd(n.points[a]):c===-p&&(d=d.mixedAdd(n.points[a].neg()));u=u.add(d)}return u.toP()};Po.prototype._wnafMul=function(e,t){var n=4,i=e._getNAFPoints(n);n=i.wnd;for(var s=i.points,o=ih(t,n,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var l=0;c>=0&&o[c]===0;c--)l++;if(c>=0&&l++,a=a.dblp(l),c<0)break;var u=o[c];sh(u!==0),e.type==="affine"?u>0?a=a.mixedAdd(s[u-1>>1]):a=a.mixedAdd(s[-u-1>>1].neg()):u>0?a=a.add(s[u-1>>1]):a=a.add(s[-u-1>>1].neg())}return e.type==="affine"?a.toP():a};Po.prototype._wnafMulAdd=function(e,t,n,i,s){var o=this._wnafT1,a=this._wnafT2,c=this._wnafT3,l=0,u,d,p;for(u=0;u<i;u++){p=t[u];var x=p._getNAFPoints(e);o[u]=x.wnd,a[u]=x.points}for(u=i-1;u>=1;u-=2){var w=u-1,b=u;if(o[w]!==1||o[b]!==1){c[w]=ih(n[w],o[w],this._bitLength),c[b]=ih(n[b],o[b],this._bitLength),l=Math.max(c[w].length,l),l=Math.max(c[b].length,l);continue}var y=[t[w],null,null,t[b]];t[w].y.cmp(t[b].y)===0?(y[1]=t[w].add(t[b]),y[2]=t[w].toJ().mixedAdd(t[b].neg())):t[w].y.cmp(t[b].y.redNeg())===0?(y[1]=t[w].toJ().mixedAdd(t[b]),y[2]=t[w].add(t[b].neg())):(y[1]=t[w].toJ().mixedAdd(t[b]),y[2]=t[w].toJ().mixedAdd(t[b].neg()));var C=[-3,-1,-5,-7,0,7,5,1,3],T=aW(n[w],n[b]);for(l=Math.max(T[0].length,l),c[w]=new Array(l),c[b]=new Array(l),d=0;d<l;d++){var I=T[0][d]|0,k=T[1][d]|0;c[w][d]=C[(I+1)*3+(k+1)],c[b][d]=0,a[w]=y}}var P=this.jpoint(null,null,null),O=this._wnafT4;for(u=l;u>=0;u--){for(var q=0;u>=0;){var F=!0;for(d=0;d<i;d++)O[d]=c[d][u]|0,O[d]!==0&&(F=!1);if(!F)break;q++,u--}if(u>=0&&q++,P=P.dblp(q),u<0)break;for(d=0;d<i;d++){var B=O[d];B!==0&&(B>0?p=a[d][B-1>>1]:B<0&&(p=a[d][-B-1>>1].neg()),p.type==="affine"?P=P.mixedAdd(p):P=P.add(p))}}for(u=0;u<i;u++)a[u]=null;return s?P:P.toP()};function di(r,e){this.curve=r,this.type=e,this.precomputed=null}Po.BasePoint=di;di.prototype.eq=function(){throw new Error("Not implemented")};di.prototype.validate=function(){return this.curve.validate(this)};Po.prototype.decodePoint=function(e,t){e=Kn.toArray(e,t);var n=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*n){e[0]===6?sh(e[e.length-1]%2===0):e[0]===7&&sh(e[e.length-1]%2===1);var i=this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));return i}else if((e[0]===2||e[0]===3)&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),e[0]===3);throw new Error("Unknown point format")};di.prototype.encodeCompressed=function(e){return this.encode(e,!0)};di.prototype._encode=function(e){var t=this.curve.p.byteLength(),n=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",t))};di.prototype.encode=function(e,t){return Kn.encode(this._encode(t),e)};di.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};di.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};di.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,s=0;s<t;s+=e){for(var o=0;o<e;o++)i=i.dbl();n.push(i)}return{step:e,points:n}};di.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],n=(1<<e)-1,i=n===1?null:this.dbl(),s=1;s<n;s++)t[s]=t[s-1].add(i);return{wnd:e,points:t}};di.prototype._getBeta=function(){return null};di.prototype.dblp=function(e){for(var t=this,n=0;n<e;n++)t=t.dbl();return t};var rb=nl(function(r){typeof Object.create=="function"?r.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:r.exports=function(t,n){if(n){t.super_=n;var i=function(){};i.prototype=n.prototype,t.prototype=new i,t.prototype.constructor=t}}}),cW=Kn.assert;function fi(r){La.call(this,"short",r),this.a=new Re(r.a,16).toRed(this.red),this.b=new Re(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}rb(fi,La);var lW=fi;fi.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,n;if(e.beta)t=new Re(e.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);t=i[0].cmp(i[1])<0?i[0]:i[1],t=t.toRed(this.red)}if(e.lambda)n=new Re(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))===0?n=s[0]:(n=s[1],cW(this.g.mul(n).x.cmp(this.g.x.redMul(t))===0))}var o;return e.basis?o=e.basis.map(function(a){return{a:new Re(a.a,16),b:new Re(a.b,16)}}):o=this._getEndoBasis(n),{beta:t,lambda:n,basis:o}}};fi.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:Re.mont(e),n=new Re(2).toRed(t).redInvm(),i=n.redNeg(),s=new Re(3).toRed(t).redNeg().redSqrt().redMul(n),o=i.redAdd(s).fromRed(),a=i.redSub(s).fromRed();return[o,a]};fi.prototype._getEndoBasis=function(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=e,i=this.n.clone(),s=new Re(1),o=new Re(0),a=new Re(0),c=new Re(1),l,u,d,p,x,w,b,y=0,C,T;n.cmpn(0)!==0;){var I=i.div(n);C=i.sub(I.mul(n)),T=a.sub(I.mul(s));var k=c.sub(I.mul(o));if(!d&&C.cmp(t)<0)l=b.neg(),u=s,d=C.neg(),p=T;else if(d&&++y===2)break;b=C,i=n,n=C,a=s,s=T,c=o,o=k}x=C.neg(),w=T;var P=d.sqr().add(p.sqr()),O=x.sqr().add(w.sqr());return O.cmp(P)>=0&&(x=l,w=u),d.negative&&(d=d.neg(),p=p.neg()),x.negative&&(x=x.neg(),w=w.neg()),[{a:d,b:p},{a:x,b:w}]};fi.prototype._endoSplit=function(e){var t=this.endo.basis,n=t[0],i=t[1],s=i.b.mul(e).divRound(this.n),o=n.b.neg().mul(e).divRound(this.n),a=s.mul(n.a),c=o.mul(i.a),l=s.mul(n.b),u=o.mul(i.b),d=e.sub(a).sub(c),p=l.add(u).neg();return{k1:d,k2:p}};fi.prototype.pointFromX=function(e,t){e=new Re(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var s=i.fromRed().isOdd();return(t&&!s||!t&&s)&&(i=i.redNeg()),this.point(e,i)};fi.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,n=e.y,i=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(s).cmpn(0)===0};fi.prototype._endoWnafMulAdd=function(e,t,n){for(var i=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var a=this._endoSplit(t[o]),c=e[o],l=c._getBeta();a.k1.negative&&(a.k1.ineg(),c=c.neg(!0)),a.k2.negative&&(a.k2.ineg(),l=l.neg(!0)),i[o*2]=c,i[o*2+1]=l,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var u=this._wnafMulAdd(1,i,s,o*2,n),d=0;d<o*2;d++)i[d]=null,s[d]=null;return u};function Pr(r,e,t,n){La.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Re(e,16),this.y=new Re(t,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}rb(Pr,La.BasePoint);fi.prototype.point=function(e,t,n){return new Pr(this,e,t,n)};fi.prototype.pointFromJSON=function(e,t){return Pr.fromJSON(this,e,t)};Pr.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,i=function(s){return n.point(s.x.redMul(n.endo.beta),s.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return t}};Pr.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Pr.fromJSON=function(e,t,n){typeof t=="string"&&(t=JSON.parse(t));var i=e.point(t[0],t[1],n);if(!t[2])return i;function s(a){return e.point(a[0],a[1],n)}var o=t[2];return i.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[i].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[i].concat(o.naf.points.map(s))}},i};Pr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Pr.prototype.isInfinity=function(){return this.inf};Pr.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var n=t.redSqr().redISub(this.x).redISub(e.x),i=t.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)};Pr.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,n=this.x.redSqr(),i=e.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(t).redMul(i),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)};Pr.prototype.getX=function(){return this.x.fromRed()};Pr.prototype.getY=function(){return this.y.fromRed()};Pr.prototype.mul=function(e){return e=new Re(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Pr.prototype.mulAdd=function(e,t,n){var i=[this,t],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)};Pr.prototype.jmulAdd=function(e,t,n){var i=[this,t],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)};Pr.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Pr.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,i=function(s){return s.neg()};t.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return t};Pr.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Hr(r,e,t,n){La.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Re(0)):(this.x=new Re(e,16),this.y=new Re(t,16),this.z=new Re(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}rb(Hr,La.BasePoint);fi.prototype.jpoint=function(e,t,n){return new Hr(this,e,t,n)};Hr.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),n=this.x.redMul(t),i=this.y.redMul(t).redMul(e);return this.curve.point(n,i)};Hr.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Hr.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(t),s=e.x.redMul(n),o=this.y.redMul(t.redMul(e.z)),a=e.y.redMul(n.redMul(this.z)),c=i.redSub(s),l=o.redSub(a);if(c.cmpn(0)===0)return l.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=c.redSqr(),d=u.redMul(c),p=i.redMul(u),x=l.redSqr().redIAdd(d).redISub(p).redISub(p),w=l.redMul(p.redISub(x)).redISub(o.redMul(d)),b=this.z.redMul(e.z).redMul(c);return this.curve.jpoint(x,w,b)};Hr.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),n=this.x,i=e.x.redMul(t),s=this.y,o=e.y.redMul(t).redMul(this.z),a=n.redSub(i),c=s.redSub(o);if(a.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=a.redSqr(),u=l.redMul(a),d=n.redMul(l),p=c.redSqr().redIAdd(u).redISub(d).redISub(d),x=c.redMul(d.redISub(p)).redISub(s.redMul(u)),w=this.z.redMul(a);return this.curve.jpoint(p,x,w)};Hr.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var n=this;for(t=0;t<e;t++)n=n.dbl();return n}var i=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,c=this.z,l=c.redSqr().redSqr(),u=a.redAdd(a);for(t=0;t<e;t++){var d=o.redSqr(),p=u.redSqr(),x=p.redSqr(),w=d.redAdd(d).redIAdd(d).redIAdd(i.redMul(l)),b=o.redMul(p),y=w.redSqr().redISub(b.redAdd(b)),C=b.redISub(y),T=w.redMul(C);T=T.redIAdd(T).redISub(x);var I=u.redMul(c);t+1<e&&(l=l.redMul(x)),o=y,c=I,u=T}return this.curve.jpoint(o,u.redMul(s),c)};Hr.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Hr.prototype._zeroDbl=function(){var e,t,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var c=i.redAdd(i).redIAdd(i),l=c.redSqr().redISub(a).redISub(a),u=o.redIAdd(o);u=u.redIAdd(u),u=u.redIAdd(u),e=l,t=c.redMul(a.redISub(l)).redISub(u),n=this.y.redAdd(this.y)}else{var d=this.x.redSqr(),p=this.y.redSqr(),x=p.redSqr(),w=this.x.redAdd(p).redSqr().redISub(d).redISub(x);w=w.redIAdd(w);var b=d.redAdd(d).redIAdd(d),y=b.redSqr(),C=x.redIAdd(x);C=C.redIAdd(C),C=C.redIAdd(C),e=y.redISub(w).redISub(w),t=b.redMul(w.redISub(e)).redISub(C),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(e,t,n)};Hr.prototype._threeDbl=function(){var e,t,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var c=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),l=c.redSqr().redISub(a).redISub(a);e=l;var u=o.redIAdd(o);u=u.redIAdd(u),u=u.redIAdd(u),t=c.redMul(a.redISub(l)).redISub(u),n=this.y.redAdd(this.y)}else{var d=this.z.redSqr(),p=this.y.redSqr(),x=this.x.redMul(p),w=this.x.redSub(d).redMul(this.x.redAdd(d));w=w.redAdd(w).redIAdd(w);var b=x.redIAdd(x);b=b.redIAdd(b);var y=b.redAdd(b);e=w.redSqr().redISub(y),n=this.y.redAdd(this.z).redSqr().redISub(p).redISub(d);var C=p.redSqr();C=C.redIAdd(C),C=C.redIAdd(C),C=C.redIAdd(C),t=w.redMul(b.redISub(e)).redISub(C)}return this.curve.jpoint(e,t,n)};Hr.prototype._dbl=function(){var e=this.curve.a,t=this.x,n=this.y,i=this.z,s=i.redSqr().redSqr(),o=t.redSqr(),a=n.redSqr(),c=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),l=t.redAdd(t);l=l.redIAdd(l);var u=l.redMul(a),d=c.redSqr().redISub(u.redAdd(u)),p=u.redISub(d),x=a.redSqr();x=x.redIAdd(x),x=x.redIAdd(x),x=x.redIAdd(x);var w=c.redMul(p).redISub(x),b=n.redAdd(n).redMul(i);return this.curve.jpoint(d,w,b)};Hr.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr(),i=t.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),a=this.x.redAdd(t).redSqr().redISub(e).redISub(i);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var c=a.redSqr(),l=i.redIAdd(i);l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l);var u=s.redIAdd(a).redSqr().redISub(o).redISub(c).redISub(l),d=t.redMul(u);d=d.redIAdd(d),d=d.redIAdd(d);var p=this.x.redMul(c).redISub(d);p=p.redIAdd(p),p=p.redIAdd(p);var x=this.y.redMul(u.redMul(l.redISub(u)).redISub(a.redMul(c)));x=x.redIAdd(x),x=x.redIAdd(x),x=x.redIAdd(x);var w=this.z.redAdd(a).redSqr().redISub(n).redISub(c);return this.curve.jpoint(p,x,w)};Hr.prototype.mul=function(e,t){return e=new Re(e,t),this.curve._wnafMul(this,e)};Hr.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),n=e.z.redSqr();if(this.x.redMul(n).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var i=t.redMul(this.z),s=n.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(i)).cmpn(0)===0};Hr.prototype.eqXToP=function(e){var t=this.z.redSqr(),n=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(n)===0)return!0;for(var i=e.clone(),s=this.curve.redN.redMul(t);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),this.x.cmp(n)===0)return!0}};Hr.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Hr.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var gf=nl(function(r,e){var t=e;t.base=La,t.short=lW,t.mont=null,t.edwards=null}),mf=nl(function(r,e){var t=e,n=Kn.assert;function i(a){a.type==="short"?this.curve=new gf.short(a):a.type==="edwards"?this.curve=new gf.edwards(a):this.curve=new gf.mont(a),this.g=this.curve.g,this.n=this.curve.n,this.hash=a.hash,n(this.g.validate(),"Invalid curve"),n(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}t.PresetCurve=i;function s(a,c){Object.defineProperty(t,a,{configurable:!0,enumerable:!0,get:function(){var l=new i(c);return Object.defineProperty(t,a,{configurable:!0,enumerable:!0,value:l}),l}})}s("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:An.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),s("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:An.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),s("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:An.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),s("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:An.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),s("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:An.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),s("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:An.sha256,gRed:!1,g:["9"]}),s("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:An.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var o;try{o=null.crash()}catch{o=void 0}s("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:An.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",o]})});function So(r){if(!(this instanceof So))return new So(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Pi.toArray(r.entropy,r.entropyEnc||"hex"),t=Pi.toArray(r.nonce,r.nonceEnc||"hex"),n=Pi.toArray(r.pers,r.persEnc||"hex");tb(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,n)}var L_=So;So.prototype._init=function(e,t,n){var i=e.concat(t).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656};So.prototype._hmac=function(){return new An.hmac(this.hash,this.K)};So.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};So.prototype.reseed=function(e,t,n,i){typeof t!="string"&&(i=n,n=t,t=null),e=Pi.toArray(e,t),n=Pi.toArray(n,i),tb(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(n||[])),this._reseed=1};So.prototype.generate=function(e,t,n,i){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(i=n,n=t,t=null),n&&(n=Pi.toArray(n,i||"hex"),this._update(n));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(n),this._reseed++,Pi.encode(o,t)};var zg=Kn.assert;function Xr(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var nb=Xr;Xr.fromPublic=function(e,t,n){return t instanceof Xr?t:new Xr(e,{pub:t,pubEnc:n})};Xr.fromPrivate=function(e,t,n){return t instanceof Xr?t:new Xr(e,{priv:t,privEnc:n})};Xr.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};Xr.prototype.getPublic=function(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};Xr.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};Xr.prototype._importPrivate=function(e,t){this.priv=new Re(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};Xr.prototype._importPublic=function(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?zg(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&zg(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};Xr.prototype.derive=function(e){return e.validate()||zg(e.validate(),"public point not validated"),e.mul(this.priv).getX()};Xr.prototype.sign=function(e,t,n){return this.ec.sign(e,this,t,n)};Xr.prototype.verify=function(e,t,n){return this.ec.verify(e,t,this,void 0,n)};Xr.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var uW=Kn.assert;function kh(r,e){if(r instanceof kh)return r;this._importDER(r,e)||(uW(r.r&&r.s,"Signature without r or s"),this.r=new Re(r.r,16),this.s=new Re(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}var Dh=kh;function dW(){this.place=0}function _p(r,e){var t=r[e.place++];if(!(t&128))return t;var n=t&15;if(n===0||n>4||r[e.place]===0)return!1;for(var i=0,s=0,o=e.place;s<n;s++,o++)i<<=8,i|=r[o],i>>>=0;return i<=127?!1:(e.place=o,i)}function Vx(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}kh.prototype._importDER=function(e,t){e=Kn.toArray(e,t);var n=new dW;if(e[n.place++]!==48)return!1;var i=_p(e,n);if(i===!1||i+n.place!==e.length||e[n.place++]!==2)return!1;var s=_p(e,n);if(s===!1||(e[n.place]&128)!==0)return!1;var o=e.slice(n.place,s+n.place);if(n.place+=s,e[n.place++]!==2)return!1;var a=_p(e,n);if(a===!1||e.length!==a+n.place||(e[n.place]&128)!==0)return!1;var c=e.slice(n.place,a+n.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new Re(o),this.s=new Re(c),this.recoveryParam=null,!0};function Cp(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}kh.prototype.toDER=function(e){var t=this.r.toArray(),n=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),n[0]&128&&(n=[0].concat(n)),t=Vx(t),n=Vx(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];Cp(i,t.length),i=i.concat(t),i.push(2),Cp(i,n.length);var s=i.concat(n),o=[48];return Cp(o,s.length),o=o.concat(s),Kn.encode(o,e)};var fW=(function(){throw new Error("unsupported")}),ta=Kn.assert;function ai(r){if(!(this instanceof ai))return new ai(r);typeof r=="string"&&(ta(Object.prototype.hasOwnProperty.call(mf,r),"Unknown curve "+r),r=mf[r]),r instanceof mf.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}var hW=ai;ai.prototype.keyPair=function(e){return new nb(this,e)};ai.prototype.keyFromPrivate=function(e,t){return nb.fromPrivate(this,e,t)};ai.prototype.keyFromPublic=function(e,t){return nb.fromPublic(this,e,t)};ai.prototype.genKeyPair=function(e){e||(e={});for(var t=new L_({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||fW(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new Re(2));;){var s=new Re(t.generate(n));if(!(s.cmp(i)>0))return s.iaddn(1),this.keyFromPrivate(s)}};ai.prototype._truncateToN=function(e,t,n){var i;if(Re.isBN(e)||typeof e=="number")e=new Re(e,16),i=e.byteLength();else if(typeof e=="object")i=e.length,e=new Re(e,16);else{var s=e.toString();i=s.length+1>>>1,e=new Re(s,16)}typeof n!="number"&&(n=i*8);var o=n-this.n.bitLength();return o>0&&(e=e.ushrn(o)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e};ai.prototype.sign=function(e,t,n,i){if(typeof n=="object"&&(i=n,n=null),i||(i={}),typeof e!="string"&&typeof e!="number"&&!Re.isBN(e)){ta(typeof e=="object"&&e&&typeof e.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),ta(e.length>>>0===e.length);for(var s=0;s<e.length;s++)ta((e[s]&255)===e[s])}t=this.keyFromPrivate(t,n),e=this._truncateToN(e,!1,i.msgBitLength),ta(!e.isNeg(),"Can not sign a negative message");var o=this.n.byteLength(),a=t.getPrivate().toArray("be",o),c=e.toArray("be",o);ta(new Re(c).eq(e),"Can not sign message");for(var l=new L_({hash:this.hash,entropy:a,nonce:c,pers:i.pers,persEnc:i.persEnc||"utf8"}),u=this.n.sub(new Re(1)),d=0;;d++){var p=i.k?i.k(d):new Re(l.generate(this.n.byteLength()));if(p=this._truncateToN(p,!0),!(p.cmpn(1)<=0||p.cmp(u)>=0)){var x=this.g.mul(p);if(!x.isInfinity()){var w=x.getX(),b=w.umod(this.n);if(b.cmpn(0)!==0){var y=p.invm(this.n).mul(b.mul(t.getPrivate()).iadd(e));if(y=y.umod(this.n),y.cmpn(0)!==0){var C=(x.getY().isOdd()?1:0)|(w.cmp(b)!==0?2:0);return i.canonical&&y.cmp(this.nh)>0&&(y=this.n.sub(y),C^=1),new Dh({r:b,s:y,recoveryParam:C})}}}}}};ai.prototype.verify=function(e,t,n,i,s){s||(s={}),e=this._truncateToN(e,!1,s.msgBitLength),n=this.keyFromPublic(n,i),t=new Dh(t,"hex");var o=t.r,a=t.s;if(o.cmpn(1)<0||o.cmp(this.n)>=0||a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var c=a.invm(this.n),l=c.mul(e).umod(this.n),u=c.mul(o).umod(this.n),d;return this.curve._maxwellTrick?(d=this.g.jmulAdd(l,n.getPublic(),u),d.isInfinity()?!1:d.eqXToP(o)):(d=this.g.mulAdd(l,n.getPublic(),u),d.isInfinity()?!1:d.getX().umod(this.n).cmp(o)===0)};ai.prototype.recoverPubKey=function(r,e,t,n){ta((3&t)===t,"The recovery param is more than two bits"),e=new Dh(e,n);var i=this.n,s=new Re(r),o=e.r,a=e.s,c=t&1,l=t>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");l?o=this.curve.pointFromX(o.add(this.curve.n),c):o=this.curve.pointFromX(o,c);var u=e.r.invm(i),d=i.sub(s).mul(u).umod(i),p=a.mul(u).umod(i);return this.g.mulAdd(d,o,p)};ai.prototype.getKeyRecoveryParam=function(r,e,t,n){if(e=new Dh(e,n),e.recoveryParam!==null)return e.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(r,e,i)}catch{continue}if(s.eq(t))return i}throw new Error("Unable to find valid recovery factor")};var pW=nl(function(r,e){var t=e;t.version="6.6.1",t.utils=Kn,t.rand=(function(){throw new Error("unsupported")}),t.curve=gf,t.curves=mf,t.ec=hW,t.eddsa=null}),gW=pW.ec;const mW="signing-key/5.8.0",Kg=new K(mW);let Sp=null;function Yi(){return Sp||(Sp=new gW("secp256k1")),Sp}class pa{constructor(e){J(this,"curve","secp256k1"),J(this,"privateKey",oe(e)),us(this.privateKey)!==32&&Kg.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const t=Yi().keyFromPrivate(te(this.privateKey));J(this,"publicKey","0x"+t.getPublic(!1,"hex")),J(this,"compressedPublicKey","0x"+t.getPublic(!0,"hex")),J(this,"_isSigningKey",!0)}_addPoint(e){const t=Yi().keyFromPublic(te(this.publicKey)),n=Yi().keyFromPublic(te(e));return"0x"+t.pub.add(n.pub).encodeCompressed("hex")}signDigest(e){const t=Yi().keyFromPrivate(te(this.privateKey)),n=te(e);n.length!==32&&Kg.throwArgumentError("bad digest length","digest",e);const i=t.sign(n,{canonical:!0});return $a({recoveryParam:i.recoveryParam,r:Ct("0x"+i.r.toString(16),32),s:Ct("0x"+i.s.toString(16),32)})}computeSharedSecret(e){const t=Yi().keyFromPrivate(te(this.privateKey)),n=Yi().keyFromPublic(te(ib(e)));return Ct("0x"+t.derive(n.getPublic()).toString(16),32)}static isSigningKey(e){return!!(e&&e._isSigningKey)}}function F_(r,e){const t=$a(e),n={r:te(t.r),s:te(t.s)};return"0x"+Yi().recoverPubKey(te(r),n,t.recoveryParam).encode("hex",!1)}function ib(r,e){const t=te(r);if(t.length===32){const n=new pa(t);return e?"0x"+Yi().keyFromPrivate(t).getPublic(!0,"hex"):n.publicKey}else{if(t.length===33)return e?oe(t):"0x"+Yi().keyFromPublic(t).getPublic(!1,"hex");if(t.length===65)return e?"0x"+Yi().keyFromPublic(t).getPublic(!0,"hex"):oe(t)}return Kg.throwArgumentError("invalid public or private key","key","[REDACTED]")}const bW=Object.freeze(Object.defineProperty({__proto__:null,SigningKey:pa,computePublicKey:ib,recoverPublicKey:F_},Symbol.toStringTag,{value:"Module"})),yW="transactions/5.8.0",Zr=new K(yW);var Vg;(function(r){r[r.legacy=0]="legacy",r[r.eip2930=1]="eip2930",r[r.eip1559=2]="eip1559"})(Vg||(Vg={}));function sb(r){return r==="0x"?null:pt(r)}function Jr(r){return r==="0x"?p_:ie.from(r)}const wW=[{name:"nonce",maxLength:32,numeric:!0},{name:"gasPrice",maxLength:32,numeric:!0},{name:"gasLimit",maxLength:32,numeric:!0},{name:"to",length:20},{name:"value",maxLength:32,numeric:!0},{name:"data"}],xW={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,type:!0,value:!0};function xo(r){const e=ib(r);return pt(dr(xt(dr(e,1)),12))}function bd(r,e){return xo(F_(te(r),e))}function Bn(r,e){const t=os(ie.from(r).toHexString());return t.length>32&&Zr.throwArgumentError("invalid length for "+e,"transaction:"+e,r),t}function Np(r,e){return{address:pt(r),storageKeys:(e||[]).map((t,n)=>(us(t)!==32&&Zr.throwArgumentError("invalid access list storageKey",`accessList[${r}:${n}]`,t),t.toLowerCase()))}}function Fa(r){if(Array.isArray(r))return r.map((t,n)=>Array.isArray(t)?(t.length>2&&Zr.throwArgumentError("access list expected to be [ address, storageKeys[] ]",`value[${n}]`,t),Np(t[0],t[1])):Np(t.address,t.storageKeys));const e=Object.keys(r).map(t=>{const n=r[t].reduce((i,s)=>(i[s]=!0,i),{});return Np(t,Object.keys(n).sort())});return e.sort((t,n)=>t.address.localeCompare(n.address)),e}function j_(r){return Fa(r).map(e=>[e.address,e.storageKeys])}function q_(r,e){if(r.gasPrice!=null){const n=ie.from(r.gasPrice),i=ie.from(r.maxFeePerGas||0);n.eq(i)||Zr.throwArgumentError("mismatch EIP-1559 gasPrice != maxFeePerGas","tx",{gasPrice:n,maxFeePerGas:i})}const t=[Bn(r.chainId||0,"chainId"),Bn(r.nonce||0,"nonce"),Bn(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Bn(r.maxFeePerGas||0,"maxFeePerGas"),Bn(r.gasLimit||0,"gasLimit"),r.to!=null?pt(r.to):"0x",Bn(r.value||0,"value"),r.data||"0x",j_(r.accessList||[])];if(e){const n=$a(e);t.push(Bn(n.recoveryParam,"recoveryParam")),t.push(os(n.r)),t.push(os(n.s))}return an(["0x02",Na(t)])}function H_(r,e){const t=[Bn(r.chainId||0,"chainId"),Bn(r.nonce||0,"nonce"),Bn(r.gasPrice||0,"gasPrice"),Bn(r.gasLimit||0,"gasLimit"),r.to!=null?pt(r.to):"0x",Bn(r.value||0,"value"),r.data||"0x",j_(r.accessList||[])];if(e){const n=$a(e);t.push(Bn(n.recoveryParam,"recoveryParam")),t.push(os(n.r)),t.push(os(n.s))}return an(["0x01",Na(t)])}function vW(r,e){Wm(r,xW);const t=[];wW.forEach(function(o){let a=r[o.name]||[];const c={};o.numeric&&(c.hexPad="left"),a=te(oe(a,c)),o.length&&a.length!==o.length&&a.length>0&&Zr.throwArgumentError("invalid length for "+o.name,"transaction:"+o.name,a),o.maxLength&&(a=os(a),a.length>o.maxLength&&Zr.throwArgumentError("invalid length for "+o.name,"transaction:"+o.name,a)),t.push(oe(a))});let n=0;if(r.chainId!=null?(n=r.chainId,typeof n!="number"&&Zr.throwArgumentError("invalid transaction.chainId","transaction",r)):e&&!fd(e)&&e.v>28&&(n=Math.floor((e.v-35)/2)),n!==0&&(t.push(oe(n)),t.push("0x"),t.push("0x")),!e)return Na(t);const i=$a(e);let s=27+i.recoveryParam;return n!==0?(t.pop(),t.pop(),t.pop(),s+=n*2+8,i.v>28&&i.v!==s&&Zr.throwArgumentError("transaction.chainId/signature.v mismatch","signature",e)):i.v!==s&&Zr.throwArgumentError("transaction.chainId/signature.v mismatch","signature",e),t.push(oe(s)),t.push(os(te(i.r))),t.push(os(te(i.s))),Na(t)}function Gg(r,e){if(r.type==null||r.type===0)return r.accessList!=null&&Zr.throwArgumentError("untyped transactions do not support accessList; include type: 1","transaction",r),vW(r,e);switch(r.type){case 1:return H_(r,e);case 2:return q_(r,e)}return Zr.throwError(`unsupported transaction type: ${r.type}`,K.errors.UNSUPPORTED_OPERATION,{operation:"serializeTransaction",transactionType:r.type})}function W_(r,e,t){try{const n=Jr(e[0]).toNumber();if(n!==0&&n!==1)throw new Error("bad recid");r.v=n}catch{Zr.throwArgumentError("invalid v for transaction type: 1","v",e[0])}r.r=Ct(e[1],32),r.s=Ct(e[2],32);try{const n=xt(t(r));r.from=bd(n,{r:r.r,s:r.s,recoveryParam:r.v})}catch{}}function EW(r){const e=Ph(r.slice(1));e.length!==9&&e.length!==12&&Zr.throwArgumentError("invalid component count for transaction type: 2","payload",oe(r));const t=Jr(e[2]),n=Jr(e[3]),i={type:2,chainId:Jr(e[0]).toNumber(),nonce:Jr(e[1]).toNumber(),maxPriorityFeePerGas:t,maxFeePerGas:n,gasPrice:null,gasLimit:Jr(e[4]),to:sb(e[5]),value:Jr(e[6]),data:e[7],accessList:Fa(e[8])};return e.length===9||(i.hash=xt(r),W_(i,e.slice(9),q_)),i}function AW(r){const e=Ph(r.slice(1));e.length!==8&&e.length!==11&&Zr.throwArgumentError("invalid component count for transaction type: 1","payload",oe(r));const t={type:1,chainId:Jr(e[0]).toNumber(),nonce:Jr(e[1]).toNumber(),gasPrice:Jr(e[2]),gasLimit:Jr(e[3]),to:sb(e[4]),value:Jr(e[5]),data:e[6],accessList:Fa(e[7])};return e.length===8||(t.hash=xt(r),W_(t,e.slice(8),H_)),t}function _W(r){const e=Ph(r);e.length!==9&&e.length!==6&&Zr.throwArgumentError("invalid raw transaction","rawTransaction",r);const t={nonce:Jr(e[0]).toNumber(),gasPrice:Jr(e[1]),gasLimit:Jr(e[2]),to:sb(e[3]),value:Jr(e[4]),data:e[5],chainId:0};if(e.length===6)return t;try{t.v=ie.from(e[6]).toNumber()}catch{return t}if(t.r=Ct(e[7],32),t.s=Ct(e[8],32),ie.from(t.r).isZero()&&ie.from(t.s).isZero())t.chainId=t.v,t.v=0;else{t.chainId=Math.floor((t.v-35)/2),t.chainId<0&&(t.chainId=0);let n=t.v-27;const i=e.slice(0,6);t.chainId!==0&&(i.push(oe(t.chainId)),i.push("0x"),i.push("0x"),n-=t.chainId*2+8);const s=xt(Na(i));try{t.from=bd(s,{r:oe(t.r),s:oe(t.s),recoveryParam:n})}catch{}t.hash=xt(r)}return t.type=null,t}function z_(r){const e=te(r);if(e[0]>127)return _W(e);switch(e[0]){case 1:return AW(e);case 2:return EW(e)}return Zr.throwError(`unsupported transaction type: ${e[0]}`,K.errors.UNSUPPORTED_OPERATION,{operation:"parseTransaction",transactionType:e[0]})}const CW=Object.freeze(Object.defineProperty({__proto__:null,get TransactionTypes(){return Vg},accessListify:Fa,computeAddress:xo,parse:z_,recoverAddress:bd,serialize:Gg},Symbol.toStringTag,{value:"Module"})),SW="contracts/5.8.0";var Ia=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};const cr=new K(SW);function oh(r,e){return Ia(this,void 0,void 0,function*(){const t=yield e;typeof t!="string"&&cr.throwArgumentError("invalid address or ENS name","name",t);try{return pt(t)}catch{}r||cr.throwError("a provider or signer is needed to resolve ENS names",K.errors.UNSUPPORTED_OPERATION,{operation:"resolveName"});const n=yield r.resolveName(t);return n==null&&cr.throwArgumentError("resolver or addr is not configured for ENS name","name",t),n})}function bf(r,e,t){return Ia(this,void 0,void 0,function*(){return Array.isArray(t)?yield Promise.all(t.map((n,i)=>bf(r,Array.isArray(e)?e[i]:e[n.name],n))):t.type==="address"?yield oh(r,e):t.type==="tuple"?yield bf(r,e,t.components):t.baseType==="array"?Array.isArray(e)?yield Promise.all(e.map(n=>bf(r,n,t.arrayChildren))):Promise.reject(cr.makeError("invalid value for array",K.errors.INVALID_ARGUMENT,{argument:"value",value:e})):e})}function Mh(r,e,t){return Ia(this,void 0,void 0,function*(){let n={};t.length===e.inputs.length+1&&typeof t[t.length-1]=="object"&&(n=mr(t.pop())),cr.checkArgumentCount(t.length,e.inputs.length,"passed to contract"),r.signer?n.from?n.from=or({override:oh(r.signer,n.from),signer:r.signer.getAddress()}).then(l=>Ia(this,void 0,void 0,function*(){return pt(l.signer)!==l.override&&cr.throwError("Contract with a Signer cannot override from",K.errors.UNSUPPORTED_OPERATION,{operation:"overrides.from"}),l.override})):n.from=r.signer.getAddress():n.from&&(n.from=oh(r.provider,n.from));const i=yield or({args:bf(r.signer||r.provider,t,e.inputs),address:r.resolvedAddress,overrides:or(n)||{}}),s=r.interface.encodeFunctionData(e,i.args),o={data:s,to:i.address},a=i.overrides;if(a.nonce!=null&&(o.nonce=ie.from(a.nonce).toNumber()),a.gasLimit!=null&&(o.gasLimit=ie.from(a.gasLimit)),a.gasPrice!=null&&(o.gasPrice=ie.from(a.gasPrice)),a.maxFeePerGas!=null&&(o.maxFeePerGas=ie.from(a.maxFeePerGas)),a.maxPriorityFeePerGas!=null&&(o.maxPriorityFeePerGas=ie.from(a.maxPriorityFeePerGas)),a.from!=null&&(o.from=a.from),a.type!=null&&(o.type=a.type),a.accessList!=null&&(o.accessList=Fa(a.accessList)),o.gasLimit==null&&e.gas!=null){let l=21e3;const u=te(s);for(let d=0;d<u.length;d++)l+=4,u[d]&&(l+=64);o.gasLimit=ie.from(e.gas).add(l)}if(a.value){const l=ie.from(a.value);!l.isZero()&&!e.payable&&cr.throwError("non-payable method cannot override value",K.errors.UNSUPPORTED_OPERATION,{operation:"overrides.value",value:n.value}),o.value=l}a.customData&&(o.customData=mr(a.customData)),a.ccipReadEnabled&&(o.ccipReadEnabled=!!a.ccipReadEnabled),delete n.nonce,delete n.gasLimit,delete n.gasPrice,delete n.from,delete n.value,delete n.type,delete n.accessList,delete n.maxFeePerGas,delete n.maxPriorityFeePerGas,delete n.customData,delete n.ccipReadEnabled;const c=Object.keys(n).filter(l=>n[l]!=null);return c.length&&cr.throwError(`cannot override ${c.map(l=>JSON.stringify(l)).join(",")}`,K.errors.UNSUPPORTED_OPERATION,{operation:"overrides",overrides:c}),o})}function NW(r,e){return function(...t){return Mh(r,e,t)}}function IW(r,e){const t=r.signer||r.provider;return function(...n){return Ia(this,void 0,void 0,function*(){t||cr.throwError("estimate require a provider or signer",K.errors.UNSUPPORTED_OPERATION,{operation:"estimateGas"});const i=yield Mh(r,e,n);return yield t.estimateGas(i)})}}function TW(r,e){const t=e.wait.bind(e);e.wait=n=>t(n).then(i=>(i.events=i.logs.map(s=>{let o=ds(s),a=null;try{a=r.interface.parseLog(s)}catch{}return a&&(o.args=a.args,o.decode=(c,l)=>r.interface.decodeEventLog(a.eventFragment,c,l),o.event=a.name,o.eventSignature=a.signature),o.removeListener=()=>r.provider,o.getBlock=()=>r.provider.getBlock(i.blockHash),o.getTransaction=()=>r.provider.getTransaction(i.transactionHash),o.getTransactionReceipt=()=>Promise.resolve(i),o}),i))}function K_(r,e,t){const n=r.signer||r.provider;return function(...i){return Ia(this,void 0,void 0,function*(){let s;if(i.length===e.inputs.length+1&&typeof i[i.length-1]=="object"){const c=mr(i.pop());c.blockTag!=null&&(s=yield c.blockTag),delete c.blockTag,i.push(c)}r.deployTransaction!=null&&(yield r._deployed(s));const o=yield Mh(r,e,i),a=yield n.call(o,s);try{let c=r.interface.decodeFunctionResult(e,a);return t&&e.outputs.length===1&&(c=c[0]),c}catch(c){throw c.code===K.errors.CALL_EXCEPTION&&(c.address=r.address,c.args=i,c.transaction=o),c}})}}function PW(r,e){return function(...t){return Ia(this,void 0,void 0,function*(){r.signer||cr.throwError("sending a transaction requires a signer",K.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction"}),r.deployTransaction!=null&&(yield r._deployed());const n=yield Mh(r,e,t),i=yield r.signer.sendTransaction(n);return TW(r,i),i})}}function Gx(r,e,t){return e.constant?K_(r,e,t):PW(r,e)}function V_(r){return r.address&&(r.topics==null||r.topics.length===0)?"*":(r.address||"*")+"@"+(r.topics?r.topics.map(e=>Array.isArray(e)?e.join("|"):e).join(":"):"")}class Ku{constructor(e,t){J(this,"tag",e),J(this,"filter",t),this._listeners=[]}addListener(e,t){this._listeners.push({listener:e,once:t})}removeListener(e){let t=!1;this._listeners=this._listeners.filter(n=>t||n.listener!==e?!0:(t=!0,!1))}removeAllListeners(){this._listeners=[]}listeners(){return this._listeners.map(e=>e.listener)}listenerCount(){return this._listeners.length}run(e){const t=this.listenerCount();return this._listeners=this._listeners.filter(n=>{const i=e.slice();return setTimeout(()=>{n.listener.apply(this,i)},0),!n.once}),t}prepareEvent(e){}getEmit(e){return[e]}}class RW extends Ku{constructor(){super("error",null)}}class Yx extends Ku{constructor(e,t,n,i){const s={address:e};let o=t.getEventTopic(n);i?(o!==i[0]&&cr.throwArgumentError("topic mismatch","topics",i),s.topics=i.slice()):s.topics=[o],super(V_(s),s),J(this,"address",e),J(this,"interface",t),J(this,"fragment",n)}prepareEvent(e){super.prepareEvent(e),e.event=this.fragment.name,e.eventSignature=this.fragment.format(),e.decode=(t,n)=>this.interface.decodeEventLog(this.fragment,t,n);try{e.args=this.interface.decodeEventLog(this.fragment,e.data,e.topics)}catch(t){e.args=null,e.decodeError=t}}getEmit(e){const t=a_(e.args);if(t.length)throw t[0].error;const n=(e.args||[]).slice();return n.push(e),n}}class Jx extends Ku{constructor(e,t){super("*",{address:e}),J(this,"address",e),J(this,"interface",t)}prepareEvent(e){super.prepareEvent(e);try{const t=this.interface.parseLog(e);e.event=t.name,e.eventSignature=t.signature,e.decode=(n,i)=>this.interface.decodeEventLog(t.eventFragment,n,i),e.args=t.args}catch{}}}class OW{constructor(e,t,n){J(this,"interface",Ti(new.target,"getInterface")(t)),n==null?(J(this,"provider",null),J(this,"signer",null)):rl.isSigner(n)?(J(this,"provider",n.provider||null),J(this,"signer",n)):pd.isProvider(n)?(J(this,"provider",n),J(this,"signer",null)):cr.throwArgumentError("invalid signer or provider","signerOrProvider",n),J(this,"callStatic",{}),J(this,"estimateGas",{}),J(this,"functions",{}),J(this,"populateTransaction",{}),J(this,"filters",{});{const o={};Object.keys(this.interface.events).forEach(a=>{const c=this.interface.events[a];J(this.filters,a,(...l)=>({address:this.address,topics:this.interface.encodeFilterTopics(c,l)})),o[c.name]||(o[c.name]=[]),o[c.name].push(a)}),Object.keys(o).forEach(a=>{const c=o[a];c.length===1?J(this.filters,a,this.filters[c[0]]):cr.warn(`Duplicate definition of ${a} (${c.join(", ")})`)})}if(J(this,"_runningEvents",{}),J(this,"_wrappedEmits",{}),e==null&&cr.throwArgumentError("invalid contract address or ENS name","addressOrName",e),J(this,"address",e),this.provider)J(this,"resolvedAddress",oh(this.provider,e));else try{J(this,"resolvedAddress",Promise.resolve(pt(e)))}catch{cr.throwError("provider is required to use ENS name as contract address",K.errors.UNSUPPORTED_OPERATION,{operation:"new Contract"})}this.resolvedAddress.catch(o=>{});const i={},s={};Object.keys(this.interface.functions).forEach(o=>{const a=this.interface.functions[o];if(s[o]){cr.warn(`Duplicate ABI entry for ${JSON.stringify(o)}`);return}s[o]=!0;{const c=a.name;i[`%${c}`]||(i[`%${c}`]=[]),i[`%${c}`].push(o)}this[o]==null&&J(this,o,Gx(this,a,!0)),this.functions[o]==null&&J(this.functions,o,Gx(this,a,!1)),this.callStatic[o]==null&&J(this.callStatic,o,K_(this,a,!0)),this.populateTransaction[o]==null&&J(this.populateTransaction,o,NW(this,a)),this.estimateGas[o]==null&&J(this.estimateGas,o,IW(this,a))}),Object.keys(i).forEach(o=>{const a=i[o];if(a.length>1)return;o=o.substring(1);const c=a[0];try{this[o]==null&&J(this,o,this[c])}catch{}this.functions[o]==null&&J(this.functions,o,this.functions[c]),this.callStatic[o]==null&&J(this.callStatic,o,this.callStatic[c]),this.populateTransaction[o]==null&&J(this.populateTransaction,o,this.populateTransaction[c]),this.estimateGas[o]==null&&J(this.estimateGas,o,this.estimateGas[c])})}static getContractAddress(e){return Vm(e)}static getInterface(e){return Wg.isInterface(e)?e:new Wg(e)}deployed(){return this._deployed()}_deployed(e){return this._deployedPromise||(this.deployTransaction?this._deployedPromise=this.deployTransaction.wait().then(()=>this):this._deployedPromise=this.provider.getCode(this.address,e).then(t=>(t==="0x"&&cr.throwError("contract not deployed",K.errors.UNSUPPORTED_OPERATION,{contractAddress:this.address,operation:"getDeployed"}),this))),this._deployedPromise}fallback(e){this.signer||cr.throwError("sending a transactions require a signer",K.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction(fallback)"});const t=mr(e||{});return["from","to"].forEach(function(n){t[n]!=null&&cr.throwError("cannot override "+n,K.errors.UNSUPPORTED_OPERATION,{operation:n})}),t.to=this.resolvedAddress,this.deployed().then(()=>this.signer.sendTransaction(t))}connect(e){typeof e=="string"&&(e=new eb(e,this.provider));const t=new this.constructor(this.address,this.interface,e);return this.deployTransaction&&J(t,"deployTransaction",this.deployTransaction),t}attach(e){return new this.constructor(e,this.interface,this.signer||this.provider)}static isIndexed(e){return nh.isIndexed(e)}_normalizeRunningEvent(e){return this._runningEvents[e.tag]?this._runningEvents[e.tag]:e}_getRunningEvent(e){if(typeof e=="string"){if(e==="error")return this._normalizeRunningEvent(new RW);if(e==="event")return this._normalizeRunningEvent(new Ku("event",null));if(e==="*")return this._normalizeRunningEvent(new Jx(this.address,this.interface));const t=this.interface.getEvent(e);return this._normalizeRunningEvent(new Yx(this.address,this.interface,t))}if(e.topics&&e.topics.length>0){try{const n=e.topics[0];if(typeof n!="string")throw new Error("invalid topic");const i=this.interface.getEvent(n);return this._normalizeRunningEvent(new Yx(this.address,this.interface,i,e.topics))}catch{}const t={address:this.address,topics:e.topics};return this._normalizeRunningEvent(new Ku(V_(t),t))}return this._normalizeRunningEvent(new Jx(this.address,this.interface))}_checkRunningEvents(e){if(e.listenerCount()===0){delete this._runningEvents[e.tag];const t=this._wrappedEmits[e.tag];t&&e.filter&&(this.provider.off(e.filter,t),delete this._wrappedEmits[e.tag])}}_wrapEvent(e,t,n){const i=ds(t);return i.removeListener=()=>{n&&(e.removeListener(n),this._checkRunningEvents(e))},i.getBlock=()=>this.provider.getBlock(t.blockHash),i.getTransaction=()=>this.provider.getTransaction(t.transactionHash),i.getTransactionReceipt=()=>this.provider.getTransactionReceipt(t.transactionHash),e.prepareEvent(i),i}_addEventListener(e,t,n){if(this.provider||cr.throwError("events require a provider or a signer with a provider",K.errors.UNSUPPORTED_OPERATION,{operation:"once"}),e.addListener(t,n),this._runningEvents[e.tag]=e,!this._wrappedEmits[e.tag]){const i=s=>{let o=this._wrapEvent(e,s,t);if(o.decodeError==null)try{const a=e.getEmit(o);this.emit(e.filter,...a)}catch(a){o.decodeError=a.error}e.filter!=null&&this.emit("event",o),o.decodeError!=null&&this.emit("error",o.decodeError,o)};this._wrappedEmits[e.tag]=i,e.filter!=null&&this.provider.on(e.filter,i)}}queryFilter(e,t,n){const i=this._getRunningEvent(e),s=mr(i.filter);return typeof t=="string"&&We(t,32)?(n!=null&&cr.throwArgumentError("cannot specify toBlock with blockhash","toBlock",n),s.blockHash=t):(s.fromBlock=t??0,s.toBlock=n??"latest"),this.provider.getLogs(s).then(o=>o.map(a=>this._wrapEvent(i,a,null)))}on(e,t){return this._addEventListener(this._getRunningEvent(e),t,!1),this}once(e,t){return this._addEventListener(this._getRunningEvent(e),t,!0),this}emit(e,...t){if(!this.provider)return!1;const n=this._getRunningEvent(e),i=n.run(t)>0;return this._checkRunningEvents(n),i}listenerCount(e){return this.provider?e==null?Object.keys(this._runningEvents).reduce((t,n)=>t+this._runningEvents[n].listenerCount(),0):this._getRunningEvent(e).listenerCount():0}listeners(e){if(!this.provider)return[];if(e==null){const t=[];for(let n in this._runningEvents)this._runningEvents[n].listeners().forEach(i=>{t.push(i)});return t}return this._getRunningEvent(e).listeners()}removeAllListeners(e){if(!this.provider)return this;if(e==null){for(const n in this._runningEvents){const i=this._runningEvents[n];i.removeAllListeners(),this._checkRunningEvents(i)}return this}const t=this._getRunningEvent(e);return t.removeAllListeners(),this._checkRunningEvents(t),this}off(e,t){if(!this.provider)return this;const n=this._getRunningEvent(e);return n.removeListener(t),this._checkRunningEvents(n),this}removeListener(e,t){return this.off(e,t)}}class kW extends OW{}class ob{constructor(e){J(this,"alphabet",e),J(this,"base",e.length),J(this,"_alphabetMap",{}),J(this,"_leader",e.charAt(0));for(let t=0;t<e.length;t++)this._alphabetMap[e.charAt(t)]=t}encode(e){let t=te(e);if(t.length===0)return"";let n=[0];for(let s=0;s<t.length;++s){let o=t[s];for(let a=0;a<n.length;++a)o+=n[a]<<8,n[a]=o%this.base,o=o/this.base|0;for(;o>0;)n.push(o%this.base),o=o/this.base|0}let i="";for(let s=0;t[s]===0&&s<t.length-1;++s)i+=this._leader;for(let s=n.length-1;s>=0;--s)i+=this.alphabet[n[s]];return i}decode(e){if(typeof e!="string")throw new TypeError("Expected String");let t=[];if(e.length===0)return new Uint8Array(t);t.push(0);for(let n=0;n<e.length;n++){let i=this._alphabetMap[e[n]];if(i===void 0)throw new Error("Non-base"+this.base+" character");let s=i;for(let o=0;o<t.length;++o)s+=t[o]*this.base,t[o]=s&255,s>>=8;for(;s>0;)t.push(s&255),s>>=8}for(let n=0;e[n]===this._leader&&n<e.length-1;++n)t.push(0);return te(new Uint8Array(t.reverse()))}}const DW=new ob("abcdefghijklmnopqrstuvwxyz234567"),Hc=new ob("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),MW=Object.freeze(Object.defineProperty({__proto__:null,Base32:DW,Base58:Hc,BaseX:ob},Symbol.toStringTag,{value:"Module"}));var Wc;(function(r){r.sha256="sha256",r.sha512="sha512"})(Wc||(Wc={}));const UW="sha2/5.8.0",BW=new K(UW);function G_(r){return"0x"+An.ripemd160().update(te(r)).digest("hex")}function js(r){return"0x"+An.sha256().update(te(r)).digest("hex")}function $W(r){return"0x"+An.sha512().update(te(r)).digest("hex")}function Vu(r,e,t){return Wc[r]||BW.throwError("unsupported algorithm "+r,K.errors.UNSUPPORTED_OPERATION,{operation:"hmac",algorithm:r}),"0x"+An.hmac(An[r],te(e)).update(te(t)).digest("hex")}const LW=Object.freeze(Object.defineProperty({__proto__:null,get SupportedAlgorithm(){return Wc},computeHmac:Vu,ripemd160:G_,sha256:js,sha512:$W},Symbol.toStringTag,{value:"Module"}));function ab(r,e,t,n,i){r=te(r),e=te(e);let s,o=1;const a=new Uint8Array(n),c=new Uint8Array(e.length+4);c.set(e);let l,u;for(let d=1;d<=o;d++){c[e.length]=d>>24&255,c[e.length+1]=d>>16&255,c[e.length+2]=d>>8&255,c[e.length+3]=d&255;let p=te(Vu(i,r,c));s||(s=p.length,u=new Uint8Array(s),o=Math.ceil(n/s),l=n-(o-1)*s),u.set(p);for(let b=1;b<t;b++){p=te(Vu(i,r,p));for(let y=0;y<s;y++)u[y]^=p[y]}const x=(d-1)*s,w=d===o?l:s;a.set(te(u).slice(0,w),x)}return oe(a)}const FW="wordlists/5.8.0",jW=new K(FW);class yd{constructor(e){jW.checkAbstract(new.target,yd),J(this,"locale",e)}split(e){return e.toLowerCase().split(/ +/g)}join(e){return e.join(" ")}static check(e){const t=[];for(let n=0;n<2048;n++){const i=e.getWord(n);if(n!==e.getWordIndex(i))return"0x";t.push(i)}return yo(t.join(`
`)+`
`)}static register(e,t){t||(t=e.locale)}}const qW="AbandonAbilityAbleAboutAboveAbsentAbsorbAbstractAbsurdAbuseAccessAccidentAccountAccuseAchieveAcidAcousticAcquireAcrossActActionActorActressActualAdaptAddAddictAddressAdjustAdmitAdultAdvanceAdviceAerobicAffairAffordAfraidAgainAgeAgentAgreeAheadAimAirAirportAisleAlarmAlbumAlcoholAlertAlienAllAlleyAllowAlmostAloneAlphaAlreadyAlsoAlterAlwaysAmateurAmazingAmongAmountAmusedAnalystAnchorAncientAngerAngleAngryAnimalAnkleAnnounceAnnualAnotherAnswerAntennaAntiqueAnxietyAnyApartApologyAppearAppleApproveAprilArchArcticAreaArenaArgueArmArmedArmorArmyAroundArrangeArrestArriveArrowArtArtefactArtistArtworkAskAspectAssaultAssetAssistAssumeAsthmaAthleteAtomAttackAttendAttitudeAttractAuctionAuditAugustAuntAuthorAutoAutumnAverageAvocadoAvoidAwakeAwareAwayAwesomeAwfulAwkwardAxisBabyBachelorBaconBadgeBagBalanceBalconyBallBambooBananaBannerBarBarelyBargainBarrelBaseBasicBasketBattleBeachBeanBeautyBecauseBecomeBeefBeforeBeginBehaveBehindBelieveBelowBeltBenchBenefitBestBetrayBetterBetweenBeyondBicycleBidBikeBindBiologyBirdBirthBitterBlackBladeBlameBlanketBlastBleakBlessBlindBloodBlossomBlouseBlueBlurBlushBoardBoatBodyBoilBombBoneBonusBookBoostBorderBoringBorrowBossBottomBounceBoxBoyBracketBrainBrandBrassBraveBreadBreezeBrickBridgeBriefBrightBringBriskBroccoliBrokenBronzeBroomBrotherBrownBrushBubbleBuddyBudgetBuffaloBuildBulbBulkBulletBundleBunkerBurdenBurgerBurstBusBusinessBusyButterBuyerBuzzCabbageCabinCableCactusCageCakeCallCalmCameraCampCanCanalCancelCandyCannonCanoeCanvasCanyonCapableCapitalCaptainCarCarbonCardCargoCarpetCarryCartCaseCashCasinoCastleCasualCatCatalogCatchCategoryCattleCaughtCauseCautionCaveCeilingCeleryCementCensusCenturyCerealCertainChairChalkChampionChangeChaosChapterChargeChaseChatCheapCheckCheeseChefCherryChestChickenChiefChildChimneyChoiceChooseChronicChuckleChunkChurnCigarCinnamonCircleCitizenCityCivilClaimClapClarifyClawClayCleanClerkCleverClickClientCliffClimbClinicClipClockClogCloseClothCloudClownClubClumpClusterClutchCoachCoastCoconutCodeCoffeeCoilCoinCollectColorColumnCombineComeComfortComicCommonCompanyConcertConductConfirmCongressConnectConsiderControlConvinceCookCoolCopperCopyCoralCoreCornCorrectCostCottonCouchCountryCoupleCourseCousinCoverCoyoteCrackCradleCraftCramCraneCrashCraterCrawlCrazyCreamCreditCreekCrewCricketCrimeCrispCriticCropCrossCrouchCrowdCrucialCruelCruiseCrumbleCrunchCrushCryCrystalCubeCultureCupCupboardCuriousCurrentCurtainCurveCushionCustomCuteCycleDadDamageDampDanceDangerDaringDashDaughterDawnDayDealDebateDebrisDecadeDecemberDecideDeclineDecorateDecreaseDeerDefenseDefineDefyDegreeDelayDeliverDemandDemiseDenialDentistDenyDepartDependDepositDepthDeputyDeriveDescribeDesertDesignDeskDespairDestroyDetailDetectDevelopDeviceDevoteDiagramDialDiamondDiaryDiceDieselDietDifferDigitalDignityDilemmaDinnerDinosaurDirectDirtDisagreeDiscoverDiseaseDishDismissDisorderDisplayDistanceDivertDivideDivorceDizzyDoctorDocumentDogDollDolphinDomainDonateDonkeyDonorDoorDoseDoubleDoveDraftDragonDramaDrasticDrawDreamDressDriftDrillDrinkDripDriveDropDrumDryDuckDumbDuneDuringDustDutchDutyDwarfDynamicEagerEagleEarlyEarnEarthEasilyEastEasyEchoEcologyEconomyEdgeEditEducateEffortEggEightEitherElbowElderElectricElegantElementElephantElevatorEliteElseEmbarkEmbodyEmbraceEmergeEmotionEmployEmpowerEmptyEnableEnactEndEndlessEndorseEnemyEnergyEnforceEngageEngineEnhanceEnjoyEnlistEnoughEnrichEnrollEnsureEnterEntireEntryEnvelopeEpisodeEqualEquipEraEraseErodeErosionErrorEruptEscapeEssayEssenceEstateEternalEthicsEvidenceEvilEvokeEvolveExactExampleExcessExchangeExciteExcludeExcuseExecuteExerciseExhaustExhibitExileExistExitExoticExpandExpectExpireExplainExposeExpressExtendExtraEyeEyebrowFabricFaceFacultyFadeFaintFaithFallFalseFameFamilyFamousFanFancyFantasyFarmFashionFatFatalFatherFatigueFaultFavoriteFeatureFebruaryFederalFeeFeedFeelFemaleFenceFestivalFetchFeverFewFiberFictionFieldFigureFileFilmFilterFinalFindFineFingerFinishFireFirmFirstFiscalFishFitFitnessFixFlagFlameFlashFlatFlavorFleeFlightFlipFloatFlockFloorFlowerFluidFlushFlyFoamFocusFogFoilFoldFollowFoodFootForceForestForgetForkFortuneForumForwardFossilFosterFoundFoxFragileFrameFrequentFreshFriendFringeFrogFrontFrostFrownFrozenFruitFuelFunFunnyFurnaceFuryFutureGadgetGainGalaxyGalleryGameGapGarageGarbageGardenGarlicGarmentGasGaspGateGatherGaugeGazeGeneralGeniusGenreGentleGenuineGestureGhostGiantGiftGiggleGingerGiraffeGirlGiveGladGlanceGlareGlassGlideGlimpseGlobeGloomGloryGloveGlowGlueGoatGoddessGoldGoodGooseGorillaGospelGossipGovernGownGrabGraceGrainGrantGrapeGrassGravityGreatGreenGridGriefGritGroceryGroupGrowGruntGuardGuessGuideGuiltGuitarGunGymHabitHairHalfHammerHamsterHandHappyHarborHardHarshHarvestHatHaveHawkHazardHeadHealthHeartHeavyHedgehogHeightHelloHelmetHelpHenHeroHiddenHighHillHintHipHireHistoryHobbyHockeyHoldHoleHolidayHollowHomeHoneyHoodHopeHornHorrorHorseHospitalHostHotelHourHoverHubHugeHumanHumbleHumorHundredHungryHuntHurdleHurryHurtHusbandHybridIceIconIdeaIdentifyIdleIgnoreIllIllegalIllnessImageImitateImmenseImmuneImpactImposeImproveImpulseInchIncludeIncomeIncreaseIndexIndicateIndoorIndustryInfantInflictInformInhaleInheritInitialInjectInjuryInmateInnerInnocentInputInquiryInsaneInsectInsideInspireInstallIntactInterestIntoInvestInviteInvolveIronIslandIsolateIssueItemIvoryJacketJaguarJarJazzJealousJeansJellyJewelJobJoinJokeJourneyJoyJudgeJuiceJumpJungleJuniorJunkJustKangarooKeenKeepKetchupKeyKickKidKidneyKindKingdomKissKitKitchenKiteKittenKiwiKneeKnifeKnockKnowLabLabelLaborLadderLadyLakeLampLanguageLaptopLargeLaterLatinLaughLaundryLavaLawLawnLawsuitLayerLazyLeaderLeafLearnLeaveLectureLeftLegLegalLegendLeisureLemonLendLengthLensLeopardLessonLetterLevelLiarLibertyLibraryLicenseLifeLiftLightLikeLimbLimitLinkLionLiquidListLittleLiveLizardLoadLoanLobsterLocalLockLogicLonelyLongLoopLotteryLoudLoungeLoveLoyalLuckyLuggageLumberLunarLunchLuxuryLyricsMachineMadMagicMagnetMaidMailMainMajorMakeMammalManManageMandateMangoMansionManualMapleMarbleMarchMarginMarineMarketMarriageMaskMassMasterMatchMaterialMathMatrixMatterMaximumMazeMeadowMeanMeasureMeatMechanicMedalMediaMelodyMeltMemberMemoryMentionMenuMercyMergeMeritMerryMeshMessageMetalMethodMiddleMidnightMilkMillionMimicMindMinimumMinorMinuteMiracleMirrorMiseryMissMistakeMixMixedMixtureMobileModelModifyMomMomentMonitorMonkeyMonsterMonthMoonMoralMoreMorningMosquitoMotherMotionMotorMountainMouseMoveMovieMuchMuffinMuleMultiplyMuscleMuseumMushroomMusicMustMutualMyselfMysteryMythNaiveNameNapkinNarrowNastyNationNatureNearNeckNeedNegativeNeglectNeitherNephewNerveNestNetNetworkNeutralNeverNewsNextNiceNightNobleNoiseNomineeNoodleNormalNorthNoseNotableNoteNothingNoticeNovelNowNuclearNumberNurseNutOakObeyObjectObligeObscureObserveObtainObviousOccurOceanOctoberOdorOffOfferOfficeOftenOilOkayOldOliveOlympicOmitOnceOneOnionOnlineOnlyOpenOperaOpinionOpposeOptionOrangeOrbitOrchardOrderOrdinaryOrganOrientOriginalOrphanOstrichOtherOutdoorOuterOutputOutsideOvalOvenOverOwnOwnerOxygenOysterOzonePactPaddlePagePairPalacePalmPandaPanelPanicPantherPaperParadeParentParkParrotPartyPassPatchPathPatientPatrolPatternPausePavePaymentPeacePeanutPearPeasantPelicanPenPenaltyPencilPeoplePepperPerfectPermitPersonPetPhonePhotoPhrasePhysicalPianoPicnicPicturePiecePigPigeonPillPilotPinkPioneerPipePistolPitchPizzaPlacePlanetPlasticPlatePlayPleasePledgePluckPlugPlungePoemPoetPointPolarPolePolicePondPonyPoolPopularPortionPositionPossiblePostPotatoPotteryPovertyPowderPowerPracticePraisePredictPreferPreparePresentPrettyPreventPricePridePrimaryPrintPriorityPrisonPrivatePrizeProblemProcessProduceProfitProgramProjectPromoteProofPropertyProsperProtectProudProvidePublicPuddingPullPulpPulsePumpkinPunchPupilPuppyPurchasePurityPurposePursePushPutPuzzlePyramidQualityQuantumQuarterQuestionQuickQuitQuizQuoteRabbitRaccoonRaceRackRadarRadioRailRainRaiseRallyRampRanchRandomRangeRapidRareRateRatherRavenRawRazorReadyRealReasonRebelRebuildRecallReceiveRecipeRecordRecycleReduceReflectReformRefuseRegionRegretRegularRejectRelaxReleaseReliefRelyRemainRememberRemindRemoveRenderRenewRentReopenRepairRepeatReplaceReportRequireRescueResembleResistResourceResponseResultRetireRetreatReturnReunionRevealReviewRewardRhythmRibRibbonRiceRichRideRidgeRifleRightRigidRingRiotRippleRiskRitualRivalRiverRoadRoastRobotRobustRocketRomanceRoofRookieRoomRoseRotateRoughRoundRouteRoyalRubberRudeRugRuleRunRunwayRuralSadSaddleSadnessSafeSailSaladSalmonSalonSaltSaluteSameSampleSandSatisfySatoshiSauceSausageSaveSayScaleScanScareScatterSceneSchemeSchoolScienceScissorsScorpionScoutScrapScreenScriptScrubSeaSearchSeasonSeatSecondSecretSectionSecuritySeedSeekSegmentSelectSellSeminarSeniorSenseSentenceSeriesServiceSessionSettleSetupSevenShadowShaftShallowShareShedShellSheriffShieldShiftShineShipShiverShockShoeShootShopShortShoulderShoveShrimpShrugShuffleShySiblingSickSideSiegeSightSignSilentSilkSillySilverSimilarSimpleSinceSingSirenSisterSituateSixSizeSkateSketchSkiSkillSkinSkirtSkullSlabSlamSleepSlenderSliceSlideSlightSlimSloganSlotSlowSlushSmallSmartSmileSmokeSmoothSnackSnakeSnapSniffSnowSoapSoccerSocialSockSodaSoftSolarSoldierSolidSolutionSolveSomeoneSongSoonSorrySortSoulSoundSoupSourceSouthSpaceSpareSpatialSpawnSpeakSpecialSpeedSpellSpendSphereSpiceSpiderSpikeSpinSpiritSplitSpoilSponsorSpoonSportSpotSpraySpreadSpringSpySquareSqueezeSquirrelStableStadiumStaffStageStairsStampStandStartStateStaySteakSteelStemStepStereoStickStillStingStockStomachStoneStoolStoryStoveStrategyStreetStrikeStrongStruggleStudentStuffStumbleStyleSubjectSubmitSubwaySuccessSuchSuddenSufferSugarSuggestSuitSummerSunSunnySunsetSuperSupplySupremeSureSurfaceSurgeSurpriseSurroundSurveySuspectSustainSwallowSwampSwapSwarmSwearSweetSwiftSwimSwingSwitchSwordSymbolSymptomSyrupSystemTableTackleTagTailTalentTalkTankTapeTargetTaskTasteTattooTaxiTeachTeamTellTenTenantTennisTentTermTestTextThankThatThemeThenTheoryThereTheyThingThisThoughtThreeThriveThrowThumbThunderTicketTideTigerTiltTimberTimeTinyTipTiredTissueTitleToastTobaccoTodayToddlerToeTogetherToiletTokenTomatoTomorrowToneTongueTonightToolToothTopTopicToppleTorchTornadoTortoiseTossTotalTouristTowardTowerTownToyTrackTradeTrafficTragicTrainTransferTrapTrashTravelTrayTreatTreeTrendTrialTribeTrickTriggerTrimTripTrophyTroubleTruckTrueTrulyTrumpetTrustTruthTryTubeTuitionTumbleTunaTunnelTurkeyTurnTurtleTwelveTwentyTwiceTwinTwistTwoTypeTypicalUglyUmbrellaUnableUnawareUncleUncoverUnderUndoUnfairUnfoldUnhappyUniformUniqueUnitUniverseUnknownUnlockUntilUnusualUnveilUpdateUpgradeUpholdUponUpperUpsetUrbanUrgeUsageUseUsedUsefulUselessUsualUtilityVacantVacuumVagueValidValleyValveVanVanishVaporVariousVastVaultVehicleVelvetVendorVentureVenueVerbVerifyVersionVeryVesselVeteranViableVibrantViciousVictoryVideoViewVillageVintageViolinVirtualVirusVisaVisitVisualVitalVividVocalVoiceVoidVolcanoVolumeVoteVoyageWageWagonWaitWalkWallWalnutWantWarfareWarmWarriorWashWaspWasteWaterWaveWayWealthWeaponWearWeaselWeatherWebWeddingWeekendWeirdWelcomeWestWetWhaleWhatWheatWheelWhenWhereWhipWhisperWideWidthWifeWildWillWinWindowWineWingWinkWinnerWinterWireWisdomWiseWishWitnessWolfWomanWonderWoodWoolWordWorkWorldWorryWorthWrapWreckWrestleWristWriteWrongYardYearYellowYouYoungYouthZebraZeroZoneZoo";let Yl=null;function Zx(r){if(Yl==null&&(Yl=qW.replace(/([A-Z])/g," $1").toLowerCase().substring(1).split(" "),yd.check(r)!=="0x3c8acc1e7b08d8e76f9fda015ef48dc8c710a73cb7e0f77b2c18a9b5a7adde60"))throw Yl=null,new Error("BIP39 Wordlist for en (English) FAILED")}class HW extends yd{constructor(){super("en")}getWord(e){return Zx(this),Yl[e]}getWordIndex(e){return Zx(this),Yl.indexOf(e)}}const Y_=new HW;yd.register(Y_);const Xx={en:Y_},WW="hdnode/5.8.0",Gu=new K(WW),zW=ie.from("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),KW=ar("Bitcoin seed"),bc=2147483648;function J_(r){return(1<<r)-1<<8-r}function VW(r){return(1<<r)-1}function Jd(r){return Ct(oe(r),32)}function Qx(r){return Hc.encode(Nt([r,dr(js(js(r)),0,4)]))}function cb(r){if(r==null)return Xx.en;if(typeof r=="string"){const e=Xx[r];return e==null&&Gu.throwArgumentError("unknown locale","wordlist",r),e}return r}const cc={},zc="m/44'/60'/0'/0/0";class $n{constructor(e,t,n,i,s,o,a,c){if(e!==cc)throw new Error("HDNode constructor cannot be called directly");if(t){const l=new pa(t);J(this,"privateKey",l.privateKey),J(this,"publicKey",l.compressedPublicKey)}else J(this,"privateKey",null),J(this,"publicKey",oe(n));J(this,"parentFingerprint",i),J(this,"fingerprint",dr(G_(js(this.publicKey)),0,4)),J(this,"address",xo(this.publicKey)),J(this,"chainCode",s),J(this,"index",o),J(this,"depth",a),c==null?(J(this,"mnemonic",null),J(this,"path",null)):typeof c=="string"?(J(this,"mnemonic",null),J(this,"path",c)):(J(this,"mnemonic",c),J(this,"path",c.path))}get extendedKey(){if(this.depth>=256)throw new Error("Depth too large!");return Qx(Nt([this.privateKey!=null?"0x0488ADE4":"0x0488B21E",oe(this.depth),this.parentFingerprint,Ct(oe(this.index),4),this.chainCode,this.privateKey!=null?Nt(["0x00",this.privateKey]):this.publicKey]))}neuter(){return new $n(cc,null,this.publicKey,this.parentFingerprint,this.chainCode,this.index,this.depth,this.path)}_derive(e){if(e>4294967295)throw new Error("invalid index - "+String(e));let t=this.path;t&&(t+="/"+(e&~bc));const n=new Uint8Array(37);if(e&bc){if(!this.privateKey)throw new Error("cannot derive child of neutered node");n.set(te(this.privateKey),1),t&&(t+="'")}else n.set(te(this.publicKey));for(let d=24;d>=0;d-=8)n[33+(d>>3)]=e>>24-d&255;const i=te(Vu(Wc.sha512,this.chainCode,n)),s=i.slice(0,32),o=i.slice(32);let a=null,c=null;this.privateKey?a=Jd(ie.from(s).add(this.privateKey).mod(zW)):c=new pa(oe(s))._addPoint(this.publicKey);let l=t;const u=this.mnemonic;return u&&(l=Object.freeze({phrase:u.phrase,path:t,locale:u.locale||"en"})),new $n(cc,a,c,this.fingerprint,Jd(o),e,this.depth+1,l)}derivePath(e){const t=e.split("/");if(t.length===0||t[0]==="m"&&this.depth!==0)throw new Error("invalid path - "+e);t[0]==="m"&&t.shift();let n=this;for(let i=0;i<t.length;i++){const s=t[i];if(s.match(/^[0-9]+'$/)){const o=parseInt(s.substring(0,s.length-1));if(o>=bc)throw new Error("invalid path index - "+s);n=n._derive(bc+o)}else if(s.match(/^[0-9]+$/)){const o=parseInt(s);if(o>=bc)throw new Error("invalid path index - "+s);n=n._derive(o)}else throw new Error("invalid path component - "+s)}return n}static _fromSeed(e,t){const n=te(e);if(n.length<16||n.length>64)throw new Error("invalid seed");const i=te(Vu(Wc.sha512,KW,n));return new $n(cc,Jd(i.slice(0,32)),null,"0x00000000",Jd(i.slice(32)),0,0,t)}static fromMnemonic(e,t,n){return n=cb(n),e=Bh(Uh(e,n),n),$n._fromSeed(Z_(e,t),{phrase:e,path:"m",locale:n.locale})}static fromSeed(e){return $n._fromSeed(e,null)}static fromExtendedKey(e){const t=Hc.decode(e);(t.length!==82||Qx(t.slice(0,78))!==e)&&Gu.throwArgumentError("invalid extended key","extendedKey","[REDACTED]");const n=t[4],i=oe(t.slice(5,9)),s=parseInt(oe(t.slice(9,13)).substring(2),16),o=oe(t.slice(13,45)),a=t.slice(45,78);switch(oe(t.slice(0,4))){case"0x0488b21e":case"0x043587cf":return new $n(cc,null,oe(a),i,o,s,n,null);case"0x0488ade4":case"0x04358394 ":if(a[0]!==0)break;return new $n(cc,oe(a.slice(1)),null,i,o,s,n,null)}return Gu.throwArgumentError("invalid extended key","extendedKey","[REDACTED]")}}function Z_(r,e){e||(e="");const t=ar("mnemonic"+e,fs.NFKD);return ab(ar(r,fs.NFKD),t,2048,64,"sha512")}function Uh(r,e){e=cb(e),Gu.checkNormalize();const t=e.split(r);if(t.length%3!==0)throw new Error("invalid mnemonic");const n=te(new Uint8Array(Math.ceil(11*t.length/8)));let i=0;for(let l=0;l<t.length;l++){let u=e.getWordIndex(t[l].normalize("NFKD"));if(u===-1)throw new Error("invalid mnemonic");for(let d=0;d<11;d++)u&1<<10-d&&(n[i>>3]|=1<<7-i%8),i++}const s=32*t.length/3,o=t.length/3,a=J_(o);if((te(js(n.slice(0,s/8)))[0]&a)!==(n[n.length-1]&a))throw new Error("invalid checksum");return oe(n.slice(0,s/8))}function Bh(r,e){if(e=cb(e),r=te(r),r.length%4!==0||r.length<16||r.length>32)throw new Error("invalid entropy");const t=[0];let n=11;for(let o=0;o<r.length;o++)n>8?(t[t.length-1]<<=8,t[t.length-1]|=r[o],n-=8):(t[t.length-1]<<=n,t[t.length-1]|=r[o]>>8-n,t.push(r[o]&VW(8-n)),n+=3);const i=r.length/4,s=te(js(r))[0]&J_(i);return t[t.length-1]<<=i,t[t.length-1]|=s>>8-i,e.join(t.map(o=>e.getWord(o)))}function GW(r,e){try{return Uh(r,e),!0}catch{}return!1}function YW(r){return(typeof r!="number"||r<0||r>=bc||r%1)&&Gu.throwArgumentError("invalid account index","index",r),`m/44'/60'/${r}'/0/0`}const JW=Object.freeze(Object.defineProperty({__proto__:null,HDNode:$n,defaultPath:zc,entropyToMnemonic:Bh,getAccountPath:YW,isValidMnemonic:GW,mnemonicToEntropy:Uh,mnemonicToSeed:Z_},Symbol.toStringTag,{value:"Module"})),ZW="random/5.8.0",Yg=new K(ZW);function XW(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const ev=XW();let yf=ev.crypto||ev.msCrypto;(!yf||!yf.getRandomValues)&&(Yg.warn("WARNING: Missing strong random number source"),yf={getRandomValues:function(r){return Yg.throwError("no secure random source avaialble",K.errors.UNSUPPORTED_OPERATION,{operation:"crypto.getRandomValues"})}});function _c(r){(r<=0||r>1024||r%1||r!=r)&&Yg.throwArgumentError("invalid length","length",r);const e=new Uint8Array(r);return yf.getRandomValues(e),te(e)}function QW(r){r=r.slice();for(let e=r.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1)),n=r[e];r[e]=r[t],r[t]=n}return r}const ez=Object.freeze(Object.defineProperty({__proto__:null,randomBytes:_c,shuffled:QW},Symbol.toStringTag,{value:"Module"}));var Ip={exports:{}},tv;function tz(){return tv||(tv=1,(function(r,e){(function(t){function n(E){return parseInt(E)===E}function i(E){if(!n(E.length))return!1;for(var g=0;g<E.length;g++)if(!n(E[g])||E[g]<0||E[g]>255)return!1;return!0}function s(E,g){if(E.buffer&&ArrayBuffer.isView(E)&&E.name==="Uint8Array")return g&&(E.slice?E=E.slice():E=Array.prototype.slice.call(E)),E;if(Array.isArray(E)){if(!i(E))throw new Error("Array contains invalid value: "+E);return new Uint8Array(E)}if(n(E.length)&&i(E))return new Uint8Array(E);throw new Error("unsupported array-like object")}function o(E){return new Uint8Array(E)}function a(E,g,N,L,v){(L!=null||v!=null)&&(E.slice?E=E.slice(L,v):E=Array.prototype.slice.call(E,L,v)),g.set(E,N)}var c=(function(){function E(N){var L=[],v=0;for(N=encodeURI(N);v<N.length;){var H=N.charCodeAt(v++);H===37?(L.push(parseInt(N.substr(v,2),16)),v+=2):L.push(H)}return s(L)}function g(N){for(var L=[],v=0;v<N.length;){var H=N[v];H<128?(L.push(String.fromCharCode(H)),v++):H>191&&H<224?(L.push(String.fromCharCode((H&31)<<6|N[v+1]&63)),v+=2):(L.push(String.fromCharCode((H&15)<<12|(N[v+1]&63)<<6|N[v+2]&63)),v+=3)}return L.join("")}return{toBytes:E,fromBytes:g}})(),l=(function(){function E(L){for(var v=[],H=0;H<L.length;H+=2)v.push(parseInt(L.substr(H,2),16));return v}var g="0123456789abcdef";function N(L){for(var v=[],H=0;H<L.length;H++){var V=L[H];v.push(g[(V&240)>>4]+g[V&15])}return v.join("")}return{toBytes:E,fromBytes:N}})(),u={16:10,24:12,32:14},d=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],p=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],x=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],w=[3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986],b=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766],y=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126],C=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436],T=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890],I=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935],k=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600],P=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480],O=[0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795],q=[0,185469197,370938394,487725847,741876788,657861945,975451694,824852259,1483753576,1400783205,1315723890,1164071807,1950903388,2135319889,1649704518,1767536459,2967507152,3152976349,2801566410,2918353863,2631447780,2547432937,2328143614,2177544179,3901806776,3818836405,4270639778,4118987695,3299409036,3483825537,3535072918,3652904859,2077965243,1893020342,1841768865,1724457132,1474502543,1559041666,1107234197,1257309336,598438867,681933534,901210569,1052338372,261314535,77422314,428819965,310463728,3409685355,3224740454,3710368113,3593056380,3875770207,3960309330,4045380933,4195456072,2471224067,2554718734,2237133081,2388260884,3212035895,3028143674,2842678573,2724322336,4138563181,4255350624,3769721975,3955191162,3667219033,3516619604,3431546947,3347532110,2933734917,2782082824,3099667487,3016697106,2196052529,2313884476,2499348523,2683765030,1179510461,1296297904,1347548327,1533017514,1786102409,1635502980,2087309459,2003294622,507358933,355706840,136428751,53458370,839224033,957055980,605657339,790073846,2373340630,2256028891,2607439820,2422494913,2706270690,2856345839,3075636216,3160175349,3573941694,3725069491,3273267108,3356761769,4181598602,4063242375,4011996048,3828103837,1033297158,915985419,730517276,545572369,296679730,446754879,129166120,213705253,1709610350,1860738147,1945798516,2029293177,1239331162,1120974935,1606591296,1422699085,4148292826,4233094615,3781033664,3931371469,3682191598,3497509347,3446004468,3328955385,2939266226,2755636671,3106780840,2988687269,2198438022,2282195339,2501218972,2652609425,1201765386,1286567175,1371368976,1521706781,1805211710,1620529459,2105887268,1988838185,533804130,350174575,164439672,46346101,870912086,954669403,636813900,788204353,2358957921,2274680428,2592523643,2441661558,2695033685,2880240216,3065962831,3182487618,3572145929,3756299780,3270937875,3388507166,4174560061,4091327024,4006521127,3854606378,1014646705,930369212,711349675,560487590,272786309,457992840,106852767,223377554,1678381017,1862534868,1914052035,2031621326,1211247597,1128014560,1580087799,1428173050,32283319,182621114,401639597,486441376,768917123,651868046,1003007129,818324884,1503449823,1385356242,1333838021,1150208456,1973745387,2125135846,1673061617,1756818940,2970356327,3120694122,2802849917,2887651696,2637442643,2520393566,2334669897,2149987652,3917234703,3799141122,4284502037,4100872472,3309594171,3460984630,3545789473,3629546796,2050466060,1899603969,1814803222,1730525723,1443857720,1560382517,1075025698,1260232239,575138148,692707433,878443390,1062597235,243256656,91341917,409198410,325965383,3403100636,3252238545,3704300486,3620022987,3874428392,3990953189,4042459122,4227665663,2460449204,2578018489,2226875310,2411029155,3198115200,3046200461,2827177882,2743944855],F=[0,218828297,437656594,387781147,875313188,958871085,775562294,590424639,1750626376,1699970625,1917742170,2135253587,1551124588,1367295589,1180849278,1265195639,3501252752,3720081049,3399941250,3350065803,3835484340,3919042237,4270507174,4085369519,3102249176,3051593425,2734591178,2952102595,2361698556,2177869557,2530391278,2614737639,3145456443,3060847922,2708326185,2892417312,2404901663,2187128086,2504130317,2555048196,3542330227,3727205754,3375740769,3292445032,3876557655,3926170974,4246310725,4027744588,1808481195,1723872674,1910319033,2094410160,1608975247,1391201670,1173430173,1224348052,59984867,244860394,428169201,344873464,935293895,984907214,766078933,547512796,1844882806,1627235199,2011214180,2062270317,1507497298,1423022939,1137477952,1321699145,95345982,145085239,532201772,313773861,830661914,1015671571,731183368,648017665,3175501286,2957853679,2807058932,2858115069,2305455554,2220981195,2474404304,2658625497,3575528878,3625268135,3473416636,3254988725,3778151818,3963161475,4213447064,4130281361,3599595085,3683022916,3432737375,3247465558,3802222185,4020912224,4172763771,4122762354,3201631749,3017672716,2764249623,2848461854,2331590177,2280796200,2431590963,2648976442,104699613,188127444,472615631,287343814,840019705,1058709744,671593195,621591778,1852171925,1668212892,1953757831,2037970062,1514790577,1463996600,1080017571,1297403050,3673637356,3623636965,3235995134,3454686199,4007360968,3822090177,4107101658,4190530515,2997825956,3215212461,2830708150,2779915199,2256734592,2340947849,2627016082,2443058075,172466556,122466165,273792366,492483431,1047239e3,861968209,612205898,695634755,1646252340,1863638845,2013908262,1963115311,1446242576,1530455833,1277555970,1093597963,1636604631,1820824798,2073724613,1989249228,1436590835,1487645946,1337376481,1119727848,164948639,81781910,331544205,516552836,1039717051,821288114,669961897,719700128,2973530695,3157750862,2871682645,2787207260,2232435299,2283490410,2667994737,2450346104,3647212047,3564045318,3279033885,3464042516,3980931627,3762502690,4150144569,4199882800,3070356634,3121275539,2904027272,2686254721,2200818878,2384911031,2570832044,2486224549,3747192018,3528626907,3310321856,3359936201,3950355702,3867060991,4049844452,4234721005,1739656202,1790575107,2108100632,1890328081,1402811438,1586903591,1233856572,1149249077,266959938,48394827,369057872,418672217,1002783846,919489135,567498868,752375421,209336225,24197544,376187827,459744698,945164165,895287692,574624663,793451934,1679968233,1764313568,2117360635,1933530610,1343127501,1560637892,1243112415,1192455638,3704280881,3519142200,3336358691,3419915562,3907448597,3857572124,4075877127,4294704398,3029510009,3113855344,2927934315,2744104290,2159976285,2377486676,2594734927,2544078150],B=[0,151849742,303699484,454499602,607398968,758720310,908999204,1059270954,1214797936,1097159550,1517440620,1400849762,1817998408,1699839814,2118541908,2001430874,2429595872,2581445614,2194319100,2345119218,3034881240,3186202582,2801699524,2951971274,3635996816,3518358430,3399679628,3283088770,4237083816,4118925222,4002861748,3885750714,1002142683,850817237,698445255,548169417,529487843,377642221,227885567,77089521,1943217067,2061379749,1640576439,1757691577,1474760595,1592394909,1174215055,1290801793,2875968315,2724642869,3111247143,2960971305,2405426947,2253581325,2638606623,2487810577,3808662347,3926825029,4044981591,4162096729,3342319475,3459953789,3576539503,3693126241,1986918061,2137062819,1685577905,1836772287,1381620373,1532285339,1078185097,1229899655,1040559837,923313619,740276417,621982671,439452389,322734571,137073913,19308535,3871163981,4021308739,4104605777,4255800159,3263785589,3414450555,3499326569,3651041127,2933202493,2815956275,3167684641,3049390895,2330014213,2213296395,2566595609,2448830231,1305906550,1155237496,1607244650,1455525988,1776460110,1626319424,2079897426,1928707164,96392454,213114376,396673818,514443284,562755902,679998e3,865136418,983426092,3708173718,3557504664,3474729866,3323011204,4180808110,4030667424,3945269170,3794078908,2507040230,2623762152,2272556026,2390325492,2975484382,3092726480,2738905026,2857194700,3973773121,3856137295,4274053469,4157467219,3371096953,3252932727,3673476453,3556361835,2763173681,2915017791,3064510765,3215307299,2156299017,2307622919,2459735317,2610011675,2081048481,1963412655,1846563261,1729977011,1480485785,1362321559,1243905413,1126790795,878845905,1030690015,645401037,796197571,274084841,425408743,38544885,188821243,3613494426,3731654548,3313212038,3430322568,4082475170,4200115116,3780097726,3896688048,2668221674,2516901860,2366882550,2216610296,3141400786,2989552604,2837966542,2687165888,1202797690,1320957812,1437280870,1554391400,1669664834,1787304780,1906247262,2022837584,265905162,114585348,499347990,349075736,736970802,585122620,972512814,821712160,2595684844,2478443234,2293045232,2174754046,3196267988,3079546586,2895723464,2777952454,3537852828,3687994002,3234156416,3385345166,4142626212,4293295786,3841024952,3992742070,174567692,57326082,410887952,292596766,777231668,660510266,1011452712,893681702,1108339068,1258480242,1343618912,1494807662,1715193156,1865862730,1948373848,2100090966,2701949495,2818666809,3004591147,3122358053,2235061775,2352307457,2535604243,2653899549,3915653703,3764988233,4219352155,4067639125,3444575871,3294430577,3746175075,3594982253,836553431,953270745,600235211,718002117,367585007,484830689,133361907,251657213,2041877159,1891211689,1806599355,1654886325,1568718495,1418573201,1335535747,1184342925];function W(E){for(var g=[],N=0;N<E.length;N+=4)g.push(E[N]<<24|E[N+1]<<16|E[N+2]<<8|E[N+3]);return g}var j=function(E){if(!(this instanceof j))throw Error("AES must be instanitated with `new`");Object.defineProperty(this,"key",{value:s(E,!0)}),this._prepare()};j.prototype._prepare=function(){var E=u[this.key.length];if(E==null)throw new Error("invalid key size (must be 16, 24 or 32 bytes)");this._Ke=[],this._Kd=[];for(var g=0;g<=E;g++)this._Ke.push([0,0,0,0]),this._Kd.push([0,0,0,0]);for(var N=(E+1)*4,L=this.key.length/4,v=W(this.key),H,g=0;g<L;g++)H=g>>2,this._Ke[H][g%4]=v[g],this._Kd[E-H][g%4]=v[g];for(var V=0,z=L,G;z<N;){if(G=v[L-1],v[0]^=p[G>>16&255]<<24^p[G>>8&255]<<16^p[G&255]<<8^p[G>>24&255]^d[V]<<24,V+=1,L!=8)for(var g=1;g<L;g++)v[g]^=v[g-1];else{for(var g=1;g<L/2;g++)v[g]^=v[g-1];G=v[L/2-1],v[L/2]^=p[G&255]^p[G>>8&255]<<8^p[G>>16&255]<<16^p[G>>24&255]<<24;for(var g=L/2+1;g<L;g++)v[g]^=v[g-1]}for(var g=0,re,X;g<L&&z<N;)re=z>>2,X=z%4,this._Ke[re][X]=v[g],this._Kd[E-re][X]=v[g++],z++}for(var re=1;re<E;re++)for(var X=0;X<4;X++)G=this._Kd[re][X],this._Kd[re][X]=O[G>>24&255]^q[G>>16&255]^F[G>>8&255]^B[G&255]},j.prototype.encrypt=function(E){if(E.length!=16)throw new Error("invalid plaintext size (must be 16 bytes)");for(var g=this._Ke.length-1,N=[0,0,0,0],L=W(E),v=0;v<4;v++)L[v]^=this._Ke[0][v];for(var H=1;H<g;H++){for(var v=0;v<4;v++)N[v]=w[L[v]>>24&255]^b[L[(v+1)%4]>>16&255]^y[L[(v+2)%4]>>8&255]^C[L[(v+3)%4]&255]^this._Ke[H][v];L=N.slice()}for(var V=o(16),z,v=0;v<4;v++)z=this._Ke[g][v],V[4*v]=(p[L[v]>>24&255]^z>>24)&255,V[4*v+1]=(p[L[(v+1)%4]>>16&255]^z>>16)&255,V[4*v+2]=(p[L[(v+2)%4]>>8&255]^z>>8)&255,V[4*v+3]=(p[L[(v+3)%4]&255]^z)&255;return V},j.prototype.decrypt=function(E){if(E.length!=16)throw new Error("invalid ciphertext size (must be 16 bytes)");for(var g=this._Kd.length-1,N=[0,0,0,0],L=W(E),v=0;v<4;v++)L[v]^=this._Kd[0][v];for(var H=1;H<g;H++){for(var v=0;v<4;v++)N[v]=T[L[v]>>24&255]^I[L[(v+3)%4]>>16&255]^k[L[(v+2)%4]>>8&255]^P[L[(v+1)%4]&255]^this._Kd[H][v];L=N.slice()}for(var V=o(16),z,v=0;v<4;v++)z=this._Kd[g][v],V[4*v]=(x[L[v]>>24&255]^z>>24)&255,V[4*v+1]=(x[L[(v+3)%4]>>16&255]^z>>16)&255,V[4*v+2]=(x[L[(v+2)%4]>>8&255]^z>>8)&255,V[4*v+3]=(x[L[(v+1)%4]&255]^z)&255;return V};var U=function(E){if(!(this instanceof U))throw Error("AES must be instanitated with `new`");this.description="Electronic Code Block",this.name="ecb",this._aes=new j(E)};U.prototype.encrypt=function(E){if(E=s(E),E.length%16!==0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var g=o(E.length),N=o(16),L=0;L<E.length;L+=16)a(E,N,0,L,L+16),N=this._aes.encrypt(N),a(N,g,L);return g},U.prototype.decrypt=function(E){if(E=s(E),E.length%16!==0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var g=o(E.length),N=o(16),L=0;L<E.length;L+=16)a(E,N,0,L,L+16),N=this._aes.decrypt(N),a(N,g,L);return g};var _=function(E,g){if(!(this instanceof _))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Block Chaining",this.name="cbc",!g)g=o(16);else if(g.length!=16)throw new Error("invalid initialation vector size (must be 16 bytes)");this._lastCipherblock=s(g,!0),this._aes=new j(E)};_.prototype.encrypt=function(E){if(E=s(E),E.length%16!==0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var g=o(E.length),N=o(16),L=0;L<E.length;L+=16){a(E,N,0,L,L+16);for(var v=0;v<16;v++)N[v]^=this._lastCipherblock[v];this._lastCipherblock=this._aes.encrypt(N),a(this._lastCipherblock,g,L)}return g},_.prototype.decrypt=function(E){if(E=s(E),E.length%16!==0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var g=o(E.length),N=o(16),L=0;L<E.length;L+=16){a(E,N,0,L,L+16),N=this._aes.decrypt(N);for(var v=0;v<16;v++)g[L+v]=N[v]^this._lastCipherblock[v];a(E,this._lastCipherblock,0,L,L+16)}return g};var f=function(E,g,N){if(!(this instanceof f))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Feedback",this.name="cfb",!g)g=o(16);else if(g.length!=16)throw new Error("invalid initialation vector size (must be 16 size)");N||(N=1),this.segmentSize=N,this._shiftRegister=s(g,!0),this._aes=new j(E)};f.prototype.encrypt=function(E){if(E.length%this.segmentSize!=0)throw new Error("invalid plaintext size (must be segmentSize bytes)");for(var g=s(E,!0),N,L=0;L<g.length;L+=this.segmentSize){N=this._aes.encrypt(this._shiftRegister);for(var v=0;v<this.segmentSize;v++)g[L+v]^=N[v];a(this._shiftRegister,this._shiftRegister,0,this.segmentSize),a(g,this._shiftRegister,16-this.segmentSize,L,L+this.segmentSize)}return g},f.prototype.decrypt=function(E){if(E.length%this.segmentSize!=0)throw new Error("invalid ciphertext size (must be segmentSize bytes)");for(var g=s(E,!0),N,L=0;L<g.length;L+=this.segmentSize){N=this._aes.encrypt(this._shiftRegister);for(var v=0;v<this.segmentSize;v++)g[L+v]^=N[v];a(this._shiftRegister,this._shiftRegister,0,this.segmentSize),a(E,this._shiftRegister,16-this.segmentSize,L,L+this.segmentSize)}return g};var h=function(E,g){if(!(this instanceof h))throw Error("AES must be instanitated with `new`");if(this.description="Output Feedback",this.name="ofb",!g)g=o(16);else if(g.length!=16)throw new Error("invalid initialation vector size (must be 16 bytes)");this._lastPrecipher=s(g,!0),this._lastPrecipherIndex=16,this._aes=new j(E)};h.prototype.encrypt=function(E){for(var g=s(E,!0),N=0;N<g.length;N++)this._lastPrecipherIndex===16&&(this._lastPrecipher=this._aes.encrypt(this._lastPrecipher),this._lastPrecipherIndex=0),g[N]^=this._lastPrecipher[this._lastPrecipherIndex++];return g},h.prototype.decrypt=h.prototype.encrypt;var m=function(E){if(!(this instanceof m))throw Error("Counter must be instanitated with `new`");E!==0&&!E&&(E=1),typeof E=="number"?(this._counter=o(16),this.setValue(E)):this.setBytes(E)};m.prototype.setValue=function(E){if(typeof E!="number"||parseInt(E)!=E)throw new Error("invalid counter value (must be an integer)");for(var g=15;g>=0;--g)this._counter[g]=E%256,E=E>>8},m.prototype.setBytes=function(E){if(E=s(E,!0),E.length!=16)throw new Error("invalid counter bytes size (must be 16 bytes)");this._counter=E},m.prototype.increment=function(){for(var E=15;E>=0;E--)if(this._counter[E]===255)this._counter[E]=0;else{this._counter[E]++;break}};var A=function(E,g){if(!(this instanceof A))throw Error("AES must be instanitated with `new`");this.description="Counter",this.name="ctr",g instanceof m||(g=new m(g)),this._counter=g,this._remainingCounter=null,this._remainingCounterIndex=16,this._aes=new j(E)};A.prototype.encrypt=function(E){for(var g=s(E,!0),N=0;N<g.length;N++)this._remainingCounterIndex===16&&(this._remainingCounter=this._aes.encrypt(this._counter._counter),this._remainingCounterIndex=0,this._counter.increment()),g[N]^=this._remainingCounter[this._remainingCounterIndex++];return g},A.prototype.decrypt=A.prototype.encrypt;function S(E){E=s(E,!0);var g=16-E.length%16,N=o(E.length+g);a(E,N);for(var L=E.length;L<N.length;L++)N[L]=g;return N}function R(E){if(E=s(E,!0),E.length<16)throw new Error("PKCS#7 invalid length");var g=E[E.length-1];if(g>16)throw new Error("PKCS#7 padding byte out of range");for(var N=E.length-g,L=0;L<g;L++)if(E[N+L]!==g)throw new Error("PKCS#7 invalid padding byte");var v=o(N);return a(E,v,0,0,N),v}var M={AES:j,Counter:m,ModeOfOperation:{ecb:U,cbc:_,cfb:f,ofb:h,ctr:A},utils:{hex:l,utf8:c},padding:{pkcs7:{pad:S,strip:R}},_arrayTest:{coerceArray:s,createArray:o,copyArray:a}};r.exports=M})()})(Ip)),Ip.exports}var rz=tz();const rs=qs(rz),X_="json-wallets/5.8.0";function ga(r){return typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),te(r)}function El(r,e){for(r=String(r);r.length<e;)r="0"+r;return r}function lb(r){return typeof r=="string"?ar(r,fs.NFKC):te(r)}function lr(r,e){let t=r;const n=e.toLowerCase().split("/");for(let i=0;i<n.length;i++){let s=null;for(const o in t)if(o.toLowerCase()===n[i]){s=t[o];break}if(s===null)return null;t=s}return t}function nz(r){const e=te(r);e[6]=e[6]&15|64,e[8]=e[8]&63|128;const t=oe(e);return[t.substring(2,10),t.substring(10,14),t.substring(14,18),t.substring(18,22),t.substring(22,34)].join("-")}const iz=new K(X_);class sz extends Io{isCrowdsaleAccount(e){return!!(e&&e._isCrowdsaleAccount)}}function ub(r,e){const t=JSON.parse(r);e=lb(e);const n=pt(lr(t,"ethaddr")),i=ga(lr(t,"encseed"));(!i||i.length%16!==0)&&iz.throwArgumentError("invalid encseed","json",r);const s=te(ab(e,e,2e3,32,"sha256")).slice(0,16),o=i.slice(0,16),a=i.slice(16),c=new rs.ModeOfOperation.cbc(s,o),l=rs.padding.pkcs7.strip(te(c.decrypt(a)));let u="";for(let x=0;x<l.length;x++)u+=String.fromCharCode(l[x]);const d=ar(u),p=xt(d);return new sz({_isCrowdsaleAccount:!0,address:n,privateKey:p})}function $h(r){let e=null;try{e=JSON.parse(r)}catch{return!1}return e.encseed&&e.ethaddr}function Lh(r){let e=null;try{e=JSON.parse(r)}catch{return!1}return!(!e.version||parseInt(e.version)!==e.version||parseInt(e.version)!==3)}function oz(r){if($h(r))try{return pt(JSON.parse(r).ethaddr)}catch{return null}if(Lh(r))try{return pt(JSON.parse(r).address)}catch{return null}return null}var Tp={exports:{}},rv;function az(){return rv||(rv=1,(function(r,e){(function(t){function i(b){const y=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);let C=1779033703,T=3144134277,I=1013904242,k=2773480762,P=1359893119,O=2600822924,q=528734635,F=1541459225;const B=new Uint32Array(64);function W(A){let S=0,R=A.length;for(;R>=64;){let M=C,E=T,g=I,N=k,L=P,v=O,H=q,V=F,z,G,re,X,ne;for(G=0;G<16;G++)re=S+G*4,B[G]=(A[re]&255)<<24|(A[re+1]&255)<<16|(A[re+2]&255)<<8|A[re+3]&255;for(G=16;G<64;G++)z=B[G-2],X=(z>>>17|z<<15)^(z>>>19|z<<13)^z>>>10,z=B[G-15],ne=(z>>>7|z<<25)^(z>>>18|z<<14)^z>>>3,B[G]=(X+B[G-7]|0)+(ne+B[G-16]|0)|0;for(G=0;G<64;G++)X=(((L>>>6|L<<26)^(L>>>11|L<<21)^(L>>>25|L<<7))+(L&v^~L&H)|0)+(V+(y[G]+B[G]|0)|0)|0,ne=((M>>>2|M<<30)^(M>>>13|M<<19)^(M>>>22|M<<10))+(M&E^M&g^E&g)|0,V=H,H=v,v=L,L=N+X|0,N=g,g=E,E=M,M=X+ne|0;C=C+M|0,T=T+E|0,I=I+g|0,k=k+N|0,P=P+L|0,O=O+v|0,q=q+H|0,F=F+V|0,S+=64,R-=64}}W(b);let j,U=b.length%64,_=b.length/536870912|0,f=b.length<<3,h=U<56?56:120,m=b.slice(b.length-U,b.length);for(m.push(128),j=U+1;j<h;j++)m.push(0);return m.push(_>>>24&255),m.push(_>>>16&255),m.push(_>>>8&255),m.push(_>>>0&255),m.push(f>>>24&255),m.push(f>>>16&255),m.push(f>>>8&255),m.push(f>>>0&255),W(m),[C>>>24&255,C>>>16&255,C>>>8&255,C>>>0&255,T>>>24&255,T>>>16&255,T>>>8&255,T>>>0&255,I>>>24&255,I>>>16&255,I>>>8&255,I>>>0&255,k>>>24&255,k>>>16&255,k>>>8&255,k>>>0&255,P>>>24&255,P>>>16&255,P>>>8&255,P>>>0&255,O>>>24&255,O>>>16&255,O>>>8&255,O>>>0&255,q>>>24&255,q>>>16&255,q>>>8&255,q>>>0&255,F>>>24&255,F>>>16&255,F>>>8&255,F>>>0&255]}function s(b,y,C){b=b.length<=64?b:i(b);const T=64+y.length+4,I=new Array(T),k=new Array(64);let P,O=[];for(P=0;P<64;P++)I[P]=54;for(P=0;P<b.length;P++)I[P]^=b[P];for(P=0;P<y.length;P++)I[64+P]=y[P];for(P=T-4;P<T;P++)I[P]=0;for(P=0;P<64;P++)k[P]=92;for(P=0;P<b.length;P++)k[P]^=b[P];function q(){for(let F=T-1;F>=T-4;F--){if(I[F]++,I[F]<=255)return;I[F]=0}}for(;C>=32;)q(),O=O.concat(i(k.concat(i(I)))),C-=32;return C>0&&(q(),O=O.concat(i(k.concat(i(I))).slice(0,C))),O}function o(b,y,C,T,I){let k;for(u(b,(2*C-1)*16,I,0,16),k=0;k<2*C;k++)l(b,k*16,I,16),c(I,T),u(I,0,b,y+k*16,16);for(k=0;k<C;k++)u(b,y+k*2*16,b,k*16,16);for(k=0;k<C;k++)u(b,y+(k*2+1)*16,b,(k+C)*16,16)}function a(b,y){return b<<y|b>>>32-y}function c(b,y){u(b,0,y,0,16);for(let C=8;C>0;C-=2)y[4]^=a(y[0]+y[12],7),y[8]^=a(y[4]+y[0],9),y[12]^=a(y[8]+y[4],13),y[0]^=a(y[12]+y[8],18),y[9]^=a(y[5]+y[1],7),y[13]^=a(y[9]+y[5],9),y[1]^=a(y[13]+y[9],13),y[5]^=a(y[1]+y[13],18),y[14]^=a(y[10]+y[6],7),y[2]^=a(y[14]+y[10],9),y[6]^=a(y[2]+y[14],13),y[10]^=a(y[6]+y[2],18),y[3]^=a(y[15]+y[11],7),y[7]^=a(y[3]+y[15],9),y[11]^=a(y[7]+y[3],13),y[15]^=a(y[11]+y[7],18),y[1]^=a(y[0]+y[3],7),y[2]^=a(y[1]+y[0],9),y[3]^=a(y[2]+y[1],13),y[0]^=a(y[3]+y[2],18),y[6]^=a(y[5]+y[4],7),y[7]^=a(y[6]+y[5],9),y[4]^=a(y[7]+y[6],13),y[5]^=a(y[4]+y[7],18),y[11]^=a(y[10]+y[9],7),y[8]^=a(y[11]+y[10],9),y[9]^=a(y[8]+y[11],13),y[10]^=a(y[9]+y[8],18),y[12]^=a(y[15]+y[14],7),y[13]^=a(y[12]+y[15],9),y[14]^=a(y[13]+y[12],13),y[15]^=a(y[14]+y[13],18);for(let C=0;C<16;++C)b[C]+=y[C]}function l(b,y,C,T){for(let I=0;I<T;I++)C[I]^=b[y+I]}function u(b,y,C,T,I){for(;I--;)C[T++]=b[y++]}function d(b){if(!b||typeof b.length!="number")return!1;for(let y=0;y<b.length;y++){const C=b[y];if(typeof C!="number"||C%1||C<0||C>=256)return!1}return!0}function p(b,y){if(typeof b!="number"||b%1)throw new Error("invalid "+y);return b}function x(b,y,C,T,I,k,P){if(C=p(C,"N"),T=p(T,"r"),I=p(I,"p"),k=p(k,"dkLen"),C===0||(C&C-1)!==0)throw new Error("N must be power of 2");if(C>2147483647/128/T)throw new Error("N too large");if(T>2147483647/128/I)throw new Error("r too large");if(!d(b))throw new Error("password must be an array or buffer");if(b=Array.prototype.slice.call(b),!d(y))throw new Error("salt must be an array or buffer");y=Array.prototype.slice.call(y);let O=s(b,y,I*128*T);const q=new Uint32Array(I*32*T);for(let L=0;L<q.length;L++){const v=L*4;q[L]=(O[v+3]&255)<<24|(O[v+2]&255)<<16|(O[v+1]&255)<<8|(O[v+0]&255)<<0}const F=new Uint32Array(64*T),B=new Uint32Array(32*T*C),W=32*T,j=new Uint32Array(16),U=new Uint32Array(16),_=I*C*2;let f=0,h=null,m=!1,A=0,S=0,R,M;const E=P?parseInt(1e3/T):4294967295,g=typeof setImmediate<"u"?setImmediate:setTimeout,N=function(){if(m)return P(new Error("cancelled"),f/_);let L;switch(A){case 0:M=S*32*T,u(q,M,F,0,W),A=1,R=0;case 1:L=C-R,L>E&&(L=E);for(let H=0;H<L;H++)u(F,0,B,(R+H)*W,W),o(F,W,T,j,U);if(R+=L,f+=L,P){const H=parseInt(1e3*f/_);if(H!==h){if(m=P(null,f/_),m)break;h=H}}if(R<C)break;R=0,A=2;case 2:L=C-R,L>E&&(L=E);for(let H=0;H<L;H++){const V=(2*T-1)*16,z=F[V]&C-1;l(B,z*W,F,W),o(F,W,T,j,U)}if(R+=L,f+=L,P){const H=parseInt(1e3*f/_);if(H!==h){if(m=P(null,f/_),m)break;h=H}}if(R<C)break;if(u(F,0,q,M,W),S++,S<I){A=0;break}O=[];for(let H=0;H<q.length;H++)O.push(q[H]>>0&255),O.push(q[H]>>8&255),O.push(q[H]>>16&255),O.push(q[H]>>24&255);const v=s(b,O,k);return P&&P(null,1,v),v}P&&g(N)};if(!P)for(;;){const L=N();if(L!=null)return L}N()}const w={scrypt:function(b,y,C,T,I,k,P){return new Promise(function(O,q){let F=0;P&&P(0),x(b,y,C,T,I,k,function(B,W,j){if(B)q(B);else if(j)P&&F!==1&&P(1),O(new Uint8Array(j));else if(P&&W!==F)return F=W,P(W)})})},syncScrypt:function(b,y,C,T,I,k){return new Uint8Array(x(b,y,C,T,I,k))}};r.exports=w})()})(Tp)),Tp.exports}var cz=az();const db=qs(cz);var lz=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};const Jg=new K(X_);function nv(r){return r!=null&&r.mnemonic&&r.mnemonic.phrase}class uz extends Io{isKeystoreAccount(e){return!!(e&&e._isKeystoreAccount)}}function dz(r,e,t){if(lr(r,"crypto/cipher")==="aes-128-ctr"){const i=ga(lr(r,"crypto/cipherparams/iv")),s=new rs.Counter(i),o=new rs.ModeOfOperation.ctr(e,s);return te(o.decrypt(t))}return null}function Q_(r,e){const t=ga(lr(r,"crypto/ciphertext"));if(oe(xt(Nt([e.slice(16,32),t]))).substring(2)!==lr(r,"crypto/mac").toLowerCase())throw new Error("invalid password");const i=dz(r,e.slice(0,16),t);i||Jg.throwError("unsupported cipher",K.errors.UNSUPPORTED_OPERATION,{operation:"decrypt"});const s=e.slice(32,64),o=xo(i);if(r.address){let c=r.address.toLowerCase();if(c.substring(0,2)!=="0x"&&(c="0x"+c),pt(c)!==o)throw new Error("address mismatch")}const a={_isKeystoreAccount:!0,address:o,privateKey:oe(i)};if(lr(r,"x-ethers/version")==="0.1"){const c=ga(lr(r,"x-ethers/mnemonicCiphertext")),l=ga(lr(r,"x-ethers/mnemonicCounter")),u=new rs.Counter(l),d=new rs.ModeOfOperation.ctr(s,u),p=lr(r,"x-ethers/path")||zc,x=lr(r,"x-ethers/locale")||"en",w=te(d.decrypt(c));try{const b=Bh(w,x),y=$n.fromMnemonic(b,null,x).derivePath(p);if(y.privateKey!=a.privateKey)throw new Error("mnemonic mismatch");a.mnemonic=y.mnemonic}catch(b){if(b.code!==K.errors.INVALID_ARGUMENT||b.argument!=="wordlist")throw b}}return new uz(a)}function eC(r,e,t,n,i){return te(ab(r,e,t,n,i))}function fz(r,e,t,n,i){return Promise.resolve(eC(r,e,t,n,i))}function tC(r,e,t,n,i){const s=lb(e),o=lr(r,"crypto/kdf");if(o&&typeof o=="string"){const a=function(c,l){return Jg.throwArgumentError("invalid key-derivation function parameters",c,l)};if(o.toLowerCase()==="scrypt"){const c=ga(lr(r,"crypto/kdfparams/salt")),l=parseInt(lr(r,"crypto/kdfparams/n")),u=parseInt(lr(r,"crypto/kdfparams/r")),d=parseInt(lr(r,"crypto/kdfparams/p"));(!l||!u||!d)&&a("kdf",o),(l&l-1)!==0&&a("N",l);const p=parseInt(lr(r,"crypto/kdfparams/dklen"));return p!==32&&a("dklen",p),n(s,c,l,u,d,64,i)}else if(o.toLowerCase()==="pbkdf2"){const c=ga(lr(r,"crypto/kdfparams/salt"));let l=null;const u=lr(r,"crypto/kdfparams/prf");u==="hmac-sha256"?l="sha256":u==="hmac-sha512"?l="sha512":a("prf",u);const d=parseInt(lr(r,"crypto/kdfparams/c")),p=parseInt(lr(r,"crypto/kdfparams/dklen"));return p!==32&&a("dklen",p),t(s,c,d,p,l)}}return Jg.throwArgumentError("unsupported key-derivation function","kdf",o)}function rC(r,e){const t=JSON.parse(r),n=tC(t,e,eC,db.syncScrypt);return Q_(t,n)}function nC(r,e,t){return lz(this,void 0,void 0,function*(){const n=JSON.parse(r),i=yield tC(n,e,fz,db.scrypt,t);return Q_(n,i)})}function iC(r,e,t,n){try{if(pt(r.address)!==xo(r.privateKey))throw new Error("address/privateKey mismatch");if(nv(r)){const y=r.mnemonic;if($n.fromMnemonic(y.phrase,null,y.locale).derivePath(y.path||zc).privateKey!=r.privateKey)throw new Error("mnemonic mismatch")}}catch(y){return Promise.reject(y)}typeof t=="function"&&!n&&(n=t,t={}),t||(t={});const i=te(r.privateKey),s=lb(e);let o=null,a=null,c=null;if(nv(r)){const y=r.mnemonic;o=te(Uh(y.phrase,y.locale||"en")),a=y.path||zc,c=y.locale||"en"}let l=t.client;l||(l="ethers.js");let u=null;t.salt?u=te(t.salt):u=_c(32);let d=null;if(t.iv){if(d=te(t.iv),d.length!==16)throw new Error("invalid iv")}else d=_c(16);let p=null;if(t.uuid){if(p=te(t.uuid),p.length!==16)throw new Error("invalid uuid")}else p=_c(16);let x=1<<17,w=8,b=1;return t.scrypt&&(t.scrypt.N&&(x=t.scrypt.N),t.scrypt.r&&(w=t.scrypt.r),t.scrypt.p&&(b=t.scrypt.p)),db.scrypt(s,u,x,w,b,64,n).then(y=>{y=te(y);const C=y.slice(0,16),T=y.slice(16,32),I=y.slice(32,64),k=new rs.Counter(d),P=new rs.ModeOfOperation.ctr(C,k),O=te(P.encrypt(i)),q=xt(Nt([T,O])),F={address:r.address.substring(2).toLowerCase(),id:nz(p),version:3,crypto:{cipher:"aes-128-ctr",cipherparams:{iv:oe(d).substring(2)},ciphertext:oe(O).substring(2),kdf:"scrypt",kdfparams:{salt:oe(u).substring(2),n:x,dklen:32,p:b,r:w},mac:q.substring(2)}};if(o){const B=_c(16),W=new rs.Counter(B),j=new rs.ModeOfOperation.ctr(I,W),U=te(j.encrypt(o)),_=new Date,f=_.getUTCFullYear()+"-"+El(_.getUTCMonth()+1,2)+"-"+El(_.getUTCDate(),2)+"T"+El(_.getUTCHours(),2)+"-"+El(_.getUTCMinutes(),2)+"-"+El(_.getUTCSeconds(),2)+".0Z";F["x-ethers"]={client:l,gethFilename:"UTC--"+f+"--"+F.address,mnemonicCounter:oe(B).substring(2),mnemonicCiphertext:oe(U).substring(2),path:a,locale:c,version:"0.1"}}return JSON.stringify(F)})}function sC(r,e,t){if($h(r)){t&&t(0);const n=ub(r,e);return t&&t(1),Promise.resolve(n)}return Lh(r)?nC(r,e,t):Promise.reject(new Error("invalid JSON wallet"))}function oC(r,e){if($h(r))return ub(r,e);if(Lh(r))return rC(r,e);throw new Error("invalid JSON wallet")}const hz=Object.freeze(Object.defineProperty({__proto__:null,decryptCrowdsale:ub,decryptJsonWallet:sC,decryptJsonWalletSync:oC,decryptKeystore:nC,decryptKeystoreSync:rC,encryptKeystore:iC,getJsonWalletAddress:oz,isCrowdsaleWallet:$h,isKeystoreWallet:Lh},Symbol.toStringTag,{value:"Module"})),pz="wallet/5.8.0";var iv=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};const lc=new K(pz);function gz(r){return r!=null&&We(r.privateKey,32)&&r.address!=null}function mz(r){const e=r.mnemonic;return e&&e.phrase}class ra extends rl{constructor(e,t){if(super(),gz(e)){const n=new pa(e.privateKey);if(J(this,"_signingKey",()=>n),J(this,"address",xo(this.publicKey)),this.address!==pt(e.address)&&lc.throwArgumentError("privateKey/address mismatch","privateKey","[REDACTED]"),mz(e)){const i=e.mnemonic;J(this,"_mnemonic",()=>({phrase:i.phrase,path:i.path||zc,locale:i.locale||"en"}));const s=this.mnemonic,o=$n.fromMnemonic(s.phrase,null,s.locale).derivePath(s.path);xo(o.privateKey)!==this.address&&lc.throwArgumentError("mnemonic/address mismatch","privateKey","[REDACTED]")}else J(this,"_mnemonic",()=>null)}else{if(pa.isSigningKey(e))e.curve!=="secp256k1"&&lc.throwArgumentError("unsupported curve; must be secp256k1","privateKey","[REDACTED]"),J(this,"_signingKey",()=>e);else{typeof e=="string"&&e.match(/^[0-9a-f]*$/i)&&e.length===64&&(e="0x"+e);const n=new pa(e);J(this,"_signingKey",()=>n)}J(this,"_mnemonic",()=>null),J(this,"address",xo(this.publicKey))}t&&!pd.isProvider(t)&&lc.throwArgumentError("invalid provider","provider",t),J(this,"provider",t||null)}get mnemonic(){return this._mnemonic()}get privateKey(){return this._signingKey().privateKey}get publicKey(){return this._signingKey().publicKey}getAddress(){return Promise.resolve(this.address)}connect(e){return new ra(this,e)}signTransaction(e){return or(e).then(t=>{t.from!=null&&(pt(t.from)!==this.address&&lc.throwArgumentError("transaction from address mismatch","transaction.from",e.from),delete t.from);const n=this._signingKey().signDigest(xt(Gg(t)));return Gg(t,n)})}signMessage(e){return iv(this,void 0,void 0,function*(){return jg(this._signingKey().signDigest(Qm(e)))})}_signTypedData(e,t,n){return iv(this,void 0,void 0,function*(){const i=yield $r.resolveNames(e,t,n,s=>(this.provider==null&&lc.throwError("cannot resolve ENS names without a provider",K.errors.UNSUPPORTED_OPERATION,{operation:"resolveName",value:s}),this.provider.resolveName(s)));return jg(this._signingKey().signDigest($r.hash(i.domain,t,i.value)))})}encrypt(e,t,n){if(typeof t=="function"&&!n&&(n=t,t={}),n&&typeof n!="function")throw new Error("invalid callback");return t||(t={}),iC(this,e,t,n)}static createRandom(e){let t=_c(16);e||(e={}),e.extraEntropy&&(t=te(dr(xt(Nt([t,e.extraEntropy])),0,16)));const n=Bh(t,e.locale);return ra.fromMnemonic(n,e.path,e.locale)}static fromEncryptedJson(e,t,n){return sC(e,t,n).then(i=>new ra(i))}static fromEncryptedJsonSync(e,t){return new ra(oC(e,t))}static fromMnemonic(e,t,n){return t||(t=zc),new ra($n.fromMnemonic(e,null,n).derivePath(t))}}function bz(r,e){return bd(Qm(r),e)}function yz(r,e,t,n){return bd($r.hash(r,e,t),n)}const wz=Object.freeze(Object.defineProperty({__proto__:null,Wallet:ra,verifyMessage:bz,verifyTypedData:yz},Symbol.toStringTag,{value:"Module"})),xz="networks/5.8.0",sv=new K(xz);function vz(r){return r&&typeof r.renetwork=="function"}function vi(r){const e=function(t,n){n==null&&(n={});const i=[];if(t.InfuraProvider&&n.infura!=="-")try{i.push(new t.InfuraProvider(r,n.infura))}catch{}if(t.EtherscanProvider&&n.etherscan!=="-")try{i.push(new t.EtherscanProvider(r,n.etherscan))}catch{}if(t.AlchemyProvider&&n.alchemy!=="-")try{i.push(new t.AlchemyProvider(r,n.alchemy))}catch{}if(t.PocketProvider&&n.pocket!=="-"){const s=["goerli","ropsten","rinkeby","sepolia"];try{const o=new t.PocketProvider(r,n.pocket);o.network&&s.indexOf(o.network.name)===-1&&i.push(o)}catch{}}if(t.CloudflareProvider&&n.cloudflare!=="-")try{i.push(new t.CloudflareProvider(r))}catch{}if(t.AnkrProvider&&n.ankr!=="-")try{const s=["ropsten"],o=new t.AnkrProvider(r,n.ankr);o.network&&s.indexOf(o.network.name)===-1&&i.push(o)}catch{}if(t.QuickNodeProvider&&n.quicknode!=="-")try{i.push(new t.QuickNodeProvider(r,n.quicknode))}catch{}if(i.length===0)return null;if(t.FallbackProvider){let s=1;return n.quorum!=null?s=n.quorum:r==="homestead"&&(s=2),new t.FallbackProvider(i,s)}return i[0]};return e.renetwork=function(t){return vi(t)},e}function ah(r,e){const t=function(n,i){return n.JsonRpcProvider?new n.JsonRpcProvider(r,e):null};return t.renetwork=function(n){return ah(r,n)},t}const ov={chainId:1,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"homestead",_defaultProvider:vi("homestead")},av={chainId:3,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"ropsten",_defaultProvider:vi("ropsten")},cv={chainId:63,name:"classicMordor",_defaultProvider:ah("https://www.ethercluster.com/mordor","classicMordor")},Zd={unspecified:{chainId:0,name:"unspecified"},homestead:ov,mainnet:ov,morden:{chainId:2,name:"morden"},ropsten:av,testnet:av,rinkeby:{chainId:4,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"rinkeby",_defaultProvider:vi("rinkeby")},kovan:{chainId:42,name:"kovan",_defaultProvider:vi("kovan")},goerli:{chainId:5,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"goerli",_defaultProvider:vi("goerli")},kintsugi:{chainId:1337702,name:"kintsugi"},sepolia:{chainId:11155111,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"sepolia",_defaultProvider:vi("sepolia")},holesky:{chainId:17e3,name:"holesky",_defaultProvider:vi("holesky")},classic:{chainId:61,name:"classic",_defaultProvider:ah("https://www.ethercluster.com/etc","classic")},classicMorden:{chainId:62,name:"classicMorden"},classicMordor:cv,classicTestnet:cv,classicKotti:{chainId:6,name:"classicKotti",_defaultProvider:ah("https://www.ethercluster.com/kotti","classicKotti")},xdai:{chainId:100,name:"xdai"},matic:{chainId:137,name:"matic",_defaultProvider:vi("matic")},maticmum:{chainId:80001,name:"maticmum",_defaultProvider:vi("maticmum")},optimism:{chainId:10,name:"optimism",_defaultProvider:vi("optimism")},"optimism-kovan":{chainId:69,name:"optimism-kovan"},"optimism-goerli":{chainId:420,name:"optimism-goerli"},"optimism-sepolia":{chainId:11155420,name:"optimism-sepolia"},arbitrum:{chainId:42161,name:"arbitrum"},"arbitrum-rinkeby":{chainId:421611,name:"arbitrum-rinkeby"},"arbitrum-goerli":{chainId:421613,name:"arbitrum-goerli"},"arbitrum-sepolia":{chainId:421614,name:"arbitrum-sepolia"},bnb:{chainId:56,name:"bnb"},bnbt:{chainId:97,name:"bnbt"}};function Ez(r){if(r==null)return null;if(typeof r=="number"){for(const n in Zd){const i=Zd[n];if(i.chainId===r)return{name:i.name,chainId:i.chainId,ensAddress:i.ensAddress||null,_defaultProvider:i._defaultProvider||null}}return{chainId:r,name:"unknown"}}if(typeof r=="string"){const n=Zd[r];return n==null?null:{name:n.name,chainId:n.chainId,ensAddress:n.ensAddress,_defaultProvider:n._defaultProvider||null}}const e=Zd[r.name];if(!e)return typeof r.chainId!="number"&&sv.throwArgumentError("invalid network chainId","network",r),r;r.chainId!==0&&r.chainId!==e.chainId&&sv.throwArgumentError("network chainId mismatch","network",r);let t=r._defaultProvider||null;return t==null&&e._defaultProvider&&(vz(e._defaultProvider)?t=e._defaultProvider.renetwork(r):t=e._defaultProvider),{name:r.name,chainId:e.chainId,ensAddress:r.ensAddress||e.ensAddress||null,_defaultProvider:t}}const Az="web/5.8.0";var _z=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};function Cz(r,e){return _z(this,void 0,void 0,function*(){e==null&&(e={});const t={method:e.method||"GET",headers:e.headers||{},body:e.body||void 0};if(e.skipFetchSetup!==!0&&(t.mode="cors",t.cache="no-cache",t.credentials="same-origin",t.redirect="follow",t.referrer="client"),e.fetchOptions!=null){const o=e.fetchOptions;o.mode&&(t.mode=o.mode),o.cache&&(t.cache=o.cache),o.credentials&&(t.credentials=o.credentials),o.redirect&&(t.redirect=o.redirect),o.referrer&&(t.referrer=o.referrer)}const n=yield fetch(r,t),i=yield n.arrayBuffer(),s={};return n.headers.forEach?n.headers.forEach((o,a)=>{s[a.toLowerCase()]=o}):n.headers.keys().forEach(o=>{s[o.toLowerCase()]=n.headers.get(o)}),{headers:s,statusCode:n.status,statusMessage:n.statusText,body:te(new Uint8Array(i))}})}var Sz=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};const yi=new K(Az);function lv(r){return new Promise(e=>{setTimeout(e,r)})}function oo(r,e){if(r==null)return null;if(typeof r=="string")return r;if(fd(r)){if(e&&(e.split("/")[0]==="text"||e.split(";")[0].trim()==="application/json"))try{return To(r)}catch{}return oe(r)}return r}function Nz(r){return ar(r.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function aC(r,e,t){const n=typeof r=="object"&&r.throttleLimit!=null?r.throttleLimit:12;yi.assertArgument(n>0&&n%1===0,"invalid connection throttle limit","connection.throttleLimit",n);const i=typeof r=="object"?r.throttleCallback:null,s=typeof r=="object"&&typeof r.throttleSlotInterval=="number"?r.throttleSlotInterval:100;yi.assertArgument(s>0&&s%1===0,"invalid connection throttle slot interval","connection.throttleSlotInterval",s);const o=typeof r=="object"?!!r.errorPassThrough:!1,a={};let c=null;const l={method:"GET"};let u=!1,d=120*1e3;if(typeof r=="string")c=r;else if(typeof r=="object"){if((r==null||r.url==null)&&yi.throwArgumentError("missing URL","connection.url",r),c=r.url,typeof r.timeout=="number"&&r.timeout>0&&(d=r.timeout),r.headers)for(const C in r.headers)a[C.toLowerCase()]={key:C,value:String(r.headers[C])},["if-none-match","if-modified-since"].indexOf(C.toLowerCase())>=0&&(u=!0);if(l.allowGzip=!!r.allowGzip,r.user!=null&&r.password!=null){c.substring(0,6)!=="https:"&&r.allowInsecureAuthentication!==!0&&yi.throwError("basic authentication requires a secure https url",K.errors.INVALID_ARGUMENT,{argument:"url",url:c,user:r.user,password:"[REDACTED]"});const C=r.user+":"+r.password;a.authorization={key:"Authorization",value:"Basic "+Xm(ar(C))}}r.skipFetchSetup!=null&&(l.skipFetchSetup=!!r.skipFetchSetup),r.fetchOptions!=null&&(l.fetchOptions=mr(r.fetchOptions))}const p=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),x=c?c.match(p):null;if(x)try{const C={statusCode:200,statusMessage:"OK",headers:{"content-type":x[1]||"text/plain"},body:x[2]?Zm(x[3]):Nz(x[3])};let T=C.body;return t&&(T=t(C.body,C)),Promise.resolve(T)}catch(C){yi.throwError("processing response error",K.errors.SERVER_ERROR,{body:oo(x[1],x[2]),error:C,requestBody:null,requestMethod:"GET",url:c})}e&&(l.method="POST",l.body=e,a["content-type"]==null&&(a["content-type"]={key:"Content-Type",value:"application/octet-stream"}),a["content-length"]==null&&(a["content-length"]={key:"Content-Length",value:String(e.length)}));const w={};Object.keys(a).forEach(C=>{const T=a[C];w[T.key]=T.value}),l.headers=w;const b=(function(){let C=null;return{promise:new Promise(function(k,P){d&&(C=setTimeout(()=>{C!=null&&(C=null,P(yi.makeError("timeout",K.errors.TIMEOUT,{requestBody:oo(l.body,w["content-type"]),requestMethod:l.method,timeout:d,url:c})))},d))}),cancel:function(){C!=null&&(clearTimeout(C),C=null)}}})(),y=(function(){return Sz(this,void 0,void 0,function*(){for(let C=0;C<n;C++){let T=null;try{if(T=yield Cz(c,l),C<n){if(T.statusCode===301||T.statusCode===302){const k=T.headers.location||"";if(l.method==="GET"&&k.match(/^https:/)){c=T.headers.location;continue}}else if(T.statusCode===429){let k=!0;if(i&&(k=yield i(C,c)),k){let P=0;const O=T.headers["retry-after"];typeof O=="string"&&O.match(/^[1-9][0-9]*$/)?P=parseInt(O)*1e3:P=s*parseInt(String(Math.random()*Math.pow(2,C))),yield lv(P);continue}}}}catch(k){T=k.response,T==null&&(b.cancel(),yi.throwError("missing response",K.errors.SERVER_ERROR,{requestBody:oo(l.body,w["content-type"]),requestMethod:l.method,serverError:k,url:c}))}let I=T.body;if(u&&T.statusCode===304?I=null:!o&&(T.statusCode<200||T.statusCode>=300)&&(b.cancel(),yi.throwError("bad response",K.errors.SERVER_ERROR,{status:T.statusCode,headers:T.headers,body:oo(I,T.headers?T.headers["content-type"]:null),requestBody:oo(l.body,w["content-type"]),requestMethod:l.method,url:c})),t)try{const k=yield t(I,T);return b.cancel(),k}catch(k){if(k.throttleRetry&&C<n){let P=!0;if(i&&(P=yield i(C,c)),P){const O=s*parseInt(String(Math.random()*Math.pow(2,C)));yield lv(O);continue}}b.cancel(),yi.throwError("processing response error",K.errors.SERVER_ERROR,{body:oo(I,T.headers?T.headers["content-type"]:null),error:k,requestBody:oo(l.body,w["content-type"]),requestMethod:l.method,url:c})}return b.cancel(),I}return yi.throwError("failed response",K.errors.SERVER_ERROR,{requestBody:oo(l.body,w["content-type"]),requestMethod:l.method,url:c})})})();return Promise.race([b.promise,y])}function Fh(r,e,t){let n=(s,o)=>{let a=null;if(s!=null)try{a=JSON.parse(To(s))}catch(c){yi.throwError("invalid JSON",K.errors.SERVER_ERROR,{body:s,error:c})}return t&&(a=t(a,o)),a},i=null;if(e!=null){i=ar(e);const s=typeof r=="string"?{url:r}:mr(r);s.headers?Object.keys(s.headers).filter(a=>a.toLowerCase()==="content-type").length!==0||(s.headers=mr(s.headers),s.headers["content-type"]="application/json"):s.headers={"content-type":"application/json"},r=s}return aC(r,i,n)}function Cc(r,e){return e||(e={}),e=mr(e),e.floor==null&&(e.floor=0),e.ceiling==null&&(e.ceiling=1e4),e.interval==null&&(e.interval=250),new Promise(function(t,n){let i=null,s=!1;const o=()=>s?!1:(s=!0,i&&clearTimeout(i),!0);e.timeout&&(i=setTimeout(()=>{o()&&n(new Error("timeout"))},e.timeout));const a=e.retryLimit;let c=0;function l(){return r().then(function(u){if(u!==void 0)o()&&t(u);else if(e.oncePoll)e.oncePoll.once("poll",l);else if(e.onceBlock)e.onceBlock.once("block",l);else if(!s){if(c++,c>a){o()&&n(new Error("retry limit reached"));return}let d=e.interval*parseInt(String(Math.random()*Math.pow(2,c)));d<e.floor&&(d=e.floor),d>e.ceiling&&(d=e.ceiling),setTimeout(l,d)}return null},function(u){o()&&n(u)})}l()})}const Iz=Object.freeze(Object.defineProperty({__proto__:null,_fetchData:aC,fetchJson:Fh,poll:Cc},Symbol.toStringTag,{value:"Module"}));var Pp,uv;function Tz(){if(uv)return Pp;uv=1;for(var r="qpzry9x8gf2tvdw0s3jn54khce6mua7l",e={},t=0;t<r.length;t++){var n=r.charAt(t);if(e[n]!==void 0)throw new TypeError(n+" is ambiguous");e[n]=t}function i(b){var y=b>>25;return(b&33554431)<<5^-(y>>0&1)&996825010^-(y>>1&1)&642813549^-(y>>2&1)&513874426^-(y>>3&1)&1027748829^-(y>>4&1)&705979059}function s(b){for(var y=1,C=0;C<b.length;++C){var T=b.charCodeAt(C);if(T<33||T>126)return"Invalid prefix ("+b+")";y=i(y)^T>>5}for(y=i(y),C=0;C<b.length;++C){var I=b.charCodeAt(C);y=i(y)^I&31}return y}function o(b,y,C){if(C=C||90,b.length+7+y.length>C)throw new TypeError("Exceeds length limit");b=b.toLowerCase();var T=s(b);if(typeof T=="string")throw new Error(T);for(var I=b+"1",k=0;k<y.length;++k){var P=y[k];if(P>>5!==0)throw new Error("Non 5-bit word");T=i(T)^P,I+=r.charAt(P)}for(k=0;k<6;++k)T=i(T);for(T^=1,k=0;k<6;++k){var O=T>>(5-k)*5&31;I+=r.charAt(O)}return I}function a(b,y){if(y=y||90,b.length<8)return b+" too short";if(b.length>y)return"Exceeds length limit";var C=b.toLowerCase(),T=b.toUpperCase();if(b!==C&&b!==T)return"Mixed-case string "+b;b=C;var I=b.lastIndexOf("1");if(I===-1)return"No separator character for "+b;if(I===0)return"Missing prefix for "+b;var k=b.slice(0,I),P=b.slice(I+1);if(P.length<6)return"Data too short";var O=s(k);if(typeof O=="string")return O;for(var q=[],F=0;F<P.length;++F){var B=P.charAt(F),W=e[B];if(W===void 0)return"Unknown character "+B;O=i(O)^W,!(F+6>=P.length)&&q.push(W)}return O!==1?"Invalid checksum for "+b:{prefix:k,words:q}}function c(){var b=a.apply(null,arguments);if(typeof b=="object")return b}function l(b){var y=a.apply(null,arguments);if(typeof y=="object")return y;throw new Error(y)}function u(b,y,C,T){for(var I=0,k=0,P=(1<<C)-1,O=[],q=0;q<b.length;++q)for(I=I<<y|b[q],k+=y;k>=C;)k-=C,O.push(I>>k&P);if(T)k>0&&O.push(I<<C-k&P);else{if(k>=y)return"Excess padding";if(I<<C-k&P)return"Non-zero padding"}return O}function d(b){var y=u(b,8,5,!0);if(Array.isArray(y))return y}function p(b){var y=u(b,8,5,!0);if(Array.isArray(y))return y;throw new Error(y)}function x(b){var y=u(b,5,8,!1);if(Array.isArray(y))return y}function w(b){var y=u(b,5,8,!1);if(Array.isArray(y))return y;throw new Error(y)}return Pp={decodeUnsafe:c,decode:l,encode:o,toWordsUnsafe:d,toWords:p,fromWordsUnsafe:x,fromWords:w},Pp}var Pz=Tz();const dv=qs(Pz),jh="providers/5.8.0",Al=new K(jh);class ve{constructor(){this.formats=this.getDefaultFormats()}getDefaultFormats(){const e={},t=this.address.bind(this),n=this.bigNumber.bind(this),i=this.blockTag.bind(this),s=this.data.bind(this),o=this.hash.bind(this),a=this.hex.bind(this),c=this.number.bind(this),l=this.type.bind(this),u=d=>this.data(d,!0);return e.transaction={hash:o,type:l,accessList:ve.allowNull(this.accessList.bind(this),null),blockHash:ve.allowNull(o,null),blockNumber:ve.allowNull(c,null),transactionIndex:ve.allowNull(c,null),confirmations:ve.allowNull(c,null),from:t,gasPrice:ve.allowNull(n),maxPriorityFeePerGas:ve.allowNull(n),maxFeePerGas:ve.allowNull(n),gasLimit:n,to:ve.allowNull(t,null),value:n,nonce:c,data:s,r:ve.allowNull(this.uint256),s:ve.allowNull(this.uint256),v:ve.allowNull(c),creates:ve.allowNull(t,null),raw:ve.allowNull(s)},e.transactionRequest={from:ve.allowNull(t),nonce:ve.allowNull(c),gasLimit:ve.allowNull(n),gasPrice:ve.allowNull(n),maxPriorityFeePerGas:ve.allowNull(n),maxFeePerGas:ve.allowNull(n),to:ve.allowNull(t),value:ve.allowNull(n),data:ve.allowNull(u),type:ve.allowNull(c),accessList:ve.allowNull(this.accessList.bind(this),null)},e.receiptLog={transactionIndex:c,blockNumber:c,transactionHash:o,address:t,topics:ve.arrayOf(o),data:s,logIndex:c,blockHash:o},e.receipt={to:ve.allowNull(this.address,null),from:ve.allowNull(this.address,null),contractAddress:ve.allowNull(t,null),transactionIndex:c,root:ve.allowNull(a),gasUsed:n,logsBloom:ve.allowNull(s),blockHash:o,transactionHash:o,logs:ve.arrayOf(this.receiptLog.bind(this)),blockNumber:c,confirmations:ve.allowNull(c,null),cumulativeGasUsed:n,effectiveGasPrice:ve.allowNull(n),status:ve.allowNull(c),type:l},e.block={hash:ve.allowNull(o),parentHash:o,number:c,timestamp:c,nonce:ve.allowNull(a),difficulty:this.difficulty.bind(this),gasLimit:n,gasUsed:n,miner:ve.allowNull(t),extraData:s,transactions:ve.allowNull(ve.arrayOf(o)),baseFeePerGas:ve.allowNull(n)},e.blockWithTransactions=mr(e.block),e.blockWithTransactions.transactions=ve.allowNull(ve.arrayOf(this.transactionResponse.bind(this))),e.filter={fromBlock:ve.allowNull(i,void 0),toBlock:ve.allowNull(i,void 0),blockHash:ve.allowNull(o,void 0),address:ve.allowNull(t,void 0),topics:ve.allowNull(this.topics.bind(this),void 0)},e.filterLog={blockNumber:ve.allowNull(c),blockHash:ve.allowNull(o),transactionIndex:c,removed:ve.allowNull(this.boolean.bind(this)),address:t,data:ve.allowFalsish(s,"0x"),topics:ve.arrayOf(o),transactionHash:o,logIndex:c},e}accessList(e){return Fa(e||[])}number(e){return e==="0x"?0:ie.from(e).toNumber()}type(e){return e==="0x"||e==null?0:ie.from(e).toNumber()}bigNumber(e){return ie.from(e)}boolean(e){if(typeof e=="boolean")return e;if(typeof e=="string"){if(e=e.toLowerCase(),e==="true")return!0;if(e==="false")return!1}throw new Error("invalid boolean - "+e)}hex(e,t){return typeof e=="string"&&(!t&&e.substring(0,2)!=="0x"&&(e="0x"+e),We(e))?e.toLowerCase():Al.throwArgumentError("invalid hash","value",e)}data(e,t){const n=this.hex(e,t);if(n.length%2!==0)throw new Error("invalid data; odd-length - "+e);return n}address(e){return pt(e)}callAddress(e){if(!We(e,32))return null;const t=pt(dr(e,12));return t===kq?null:t}contractAddress(e){return Vm(e)}blockTag(e){if(e==null)return"latest";if(e==="earliest")return"0x0";switch(e){case"earliest":return"0x0";case"latest":case"pending":case"safe":case"finalized":return e}if(typeof e=="number"||We(e))return Th(e);throw new Error("invalid blockTag")}hash(e,t){const n=this.hex(e,t);return us(n)!==32?Al.throwArgumentError("invalid hash","value",e):n}difficulty(e){if(e==null)return null;const t=ie.from(e);try{return t.toNumber()}catch{}return null}uint256(e){if(!We(e))throw new Error("invalid uint256");return Ct(e,32)}_block(e,t){e.author!=null&&e.miner==null&&(e.miner=e.author);const n=e._difficulty!=null?e._difficulty:e.difficulty,i=ve.check(t,e);return i._difficulty=n==null?null:ie.from(n),i}block(e){return this._block(e,this.formats.block)}blockWithTransactions(e){return this._block(e,this.formats.blockWithTransactions)}transactionRequest(e){return ve.check(this.formats.transactionRequest,e)}transactionResponse(e){e.gas!=null&&e.gasLimit==null&&(e.gasLimit=e.gas),e.to&&ie.from(e.to).isZero()&&(e.to="0x0000000000000000000000000000000000000000"),e.input!=null&&e.data==null&&(e.data=e.input),e.to==null&&e.creates==null&&(e.creates=this.contractAddress(e)),(e.type===1||e.type===2)&&e.accessList==null&&(e.accessList=[]);const t=ve.check(this.formats.transaction,e);if(e.chainId!=null){let n=e.chainId;We(n)&&(n=ie.from(n).toNumber()),t.chainId=n}else{let n=e.networkId;n==null&&t.v==null&&(n=e.chainId),We(n)&&(n=ie.from(n).toNumber()),typeof n!="number"&&t.v!=null&&(n=(t.v-35)/2,n<0&&(n=0),n=parseInt(n)),typeof n!="number"&&(n=0),t.chainId=n}return t.blockHash&&t.blockHash.replace(/0/g,"")==="x"&&(t.blockHash=null),t}transaction(e){return z_(e)}receiptLog(e){return ve.check(this.formats.receiptLog,e)}receipt(e){const t=ve.check(this.formats.receipt,e);if(t.root!=null)if(t.root.length<=4){const n=ie.from(t.root).toNumber();n===0||n===1?(t.status!=null&&t.status!==n&&Al.throwArgumentError("alt-root-status/status mismatch","value",{root:t.root,status:t.status}),t.status=n,delete t.root):Al.throwArgumentError("invalid alt-root-status","value.root",t.root)}else t.root.length!==66&&Al.throwArgumentError("invalid root hash","value.root",t.root);return t.status!=null&&(t.byzantium=!0),t}topics(e){return Array.isArray(e)?e.map(t=>this.topics(t)):e!=null?this.hash(e,!0):null}filter(e){return ve.check(this.formats.filter,e)}filterLog(e){return ve.check(this.formats.filterLog,e)}static check(e,t){const n={};for(const i in e)try{const s=e[i](t[i]);s!==void 0&&(n[i]=s)}catch(s){throw s.checkKey=i,s.checkValue=t[i],s}return n}static allowNull(e,t){return(function(n){return n==null?t:e(n)})}static allowFalsish(e,t){return(function(n){return n?e(n):t})}static arrayOf(e){return(function(t){if(!Array.isArray(t))throw new Error("not an array");const n=[];return t.forEach(function(i){n.push(e(i))}),n})}}var Oe=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};const $e=new K(jh),Rz=10;function fv(r){return r==null?"null":(us(r)!==32&&$e.throwArgumentError("invalid topic","topic",r),r.toLowerCase())}function hv(r){for(r=r.slice();r.length>0&&r[r.length-1]==null;)r.pop();return r.map(e=>{if(Array.isArray(e)){const t={};e.forEach(i=>{t[fv(i)]=!0});const n=Object.keys(t);return n.sort(),n.join("|")}else return fv(e)}).join("&")}function Oz(r){return r===""?[]:r.split(/&/g).map(e=>{if(e==="")return[];const t=e.split("|").map(n=>n==="null"?null:n);return t.length===1?t[0]:t})}function uc(r){if(typeof r=="string"){if(r=r.toLowerCase(),us(r)===32)return"tx:"+r;if(r.indexOf(":")===-1)return r}else{if(Array.isArray(r))return"filter:*:"+hv(r);if(VH.isForkEvent(r))throw $e.warn("not implemented"),new Error("not implemented");if(r&&typeof r=="object")return"filter:"+(r.address||"*")+":"+hv(r.topics||[])}throw new Error("invalid event - "+r)}function _l(){return new Date().getTime()}function pv(r){return new Promise(e=>{setTimeout(e,r)})}const kz=["block","network","pending","poll"];let Dz=class{constructor(e,t,n){J(this,"tag",e),J(this,"listener",t),J(this,"once",n),this._lastBlockNumber=-2,this._inflight=!1}get event(){switch(this.type){case"tx":return this.hash;case"filter":return this.filter}return this.tag}get type(){return this.tag.split(":")[0]}get hash(){const e=this.tag.split(":");return e[0]!=="tx"?null:e[1]}get filter(){const e=this.tag.split(":");if(e[0]!=="filter")return null;const t=e[1],n=Oz(e[2]),i={};return n.length>0&&(i.topics=n),t&&t!=="*"&&(i.address=t),i}pollable(){return this.tag.indexOf(":")>=0||kz.indexOf(this.tag)>=0}};const Mz={0:{symbol:"btc",p2pkh:0,p2sh:5,prefix:"bc"},2:{symbol:"ltc",p2pkh:48,p2sh:50,prefix:"ltc"},3:{symbol:"doge",p2pkh:30,p2sh:22},60:{symbol:"eth",ilk:"eth"},61:{symbol:"etc",ilk:"eth"},700:{symbol:"xdai",ilk:"eth"}};function Rp(r){return Ct(ie.from(r).toHexString(),32)}function gv(r){return Hc.encode(Nt([r,dr(js(js(r)),0,4)]))}const cC=new RegExp("^(ipfs)://(.*)$","i"),mv=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),cC,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];function wf(r,e){try{return To(Yu(r,e))}catch{}return null}function Yu(r,e){if(r==="0x")return null;const t=ie.from(dr(r,e,e+32)).toNumber(),n=ie.from(dr(r,t,t+32)).toNumber();return dr(r,t+32,t+32+n)}function Op(r){return r.match(/^ipfs:\/\/ipfs\//i)?r=r.substring(12):r.match(/^ipfs:\/\//i)?r=r.substring(7):$e.throwArgumentError("unsupported IPFS format","link",r),`https://gateway.ipfs.io/ipfs/${r}`}function bv(r){const e=te(r);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function Uz(r){if(r.length%32===0)return r;const e=new Uint8Array(Math.ceil(r.length/32)*32);return e.set(r),e}function lC(r){const e=[];let t=0;for(let n=0;n<r.length;n++)e.push(null),t+=32;for(let n=0;n<r.length;n++){const i=te(r[n]);e[n]=bv(t),e.push(bv(i.length)),e.push(Uz(i)),t+=32+Math.ceil(i.length/32)*32}return an(e)}class yv{constructor(e,t,n,i){J(this,"provider",e),J(this,"name",n),J(this,"address",e.formatter.address(t)),J(this,"_resolvedAddress",i)}supportsWildcard(){return this._supportsEip2544||(this._supportsEip2544=this.provider.call({to:this.address,data:"0x01ffc9a79061b92300000000000000000000000000000000000000000000000000000000"}).then(e=>ie.from(e).eq(1)).catch(e=>{if(e.code===K.errors.CALL_EXCEPTION)return!1;throw this._supportsEip2544=null,e})),this._supportsEip2544}_fetch(e,t){return Oe(this,void 0,void 0,function*(){const n={to:this.address,ccipReadEnabled:!0,data:an([e,Gl(this.name),t||"0x"])};let i=!1;(yield this.supportsWildcard())&&(i=!0,n.data=an(["0x9061b923",lC([I_(this.name),n.data])]));try{let s=yield this.provider.call(n);return te(s).length%32===4&&$e.throwError("resolver threw error",K.errors.CALL_EXCEPTION,{transaction:n,data:s}),i&&(s=Yu(s,0)),s}catch(s){if(s.code===K.errors.CALL_EXCEPTION)return null;throw s}})}_fetchBytes(e,t){return Oe(this,void 0,void 0,function*(){const n=yield this._fetch(e,t);return n!=null?Yu(n,0):null})}_getAddress(e,t){const n=Mz[String(e)];if(n==null&&$e.throwError(`unsupported coin type: ${e}`,K.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${e})`}),n.ilk==="eth")return this.provider.formatter.address(t);const i=te(t);if(n.p2pkh!=null){const s=t.match(/^0x76a9([0-9a-f][0-9a-f])([0-9a-f]*)88ac$/);if(s){const o=parseInt(s[1],16);if(s[2].length===o*2&&o>=1&&o<=75)return gv(Nt([[n.p2pkh],"0x"+s[2]]))}}if(n.p2sh!=null){const s=t.match(/^0xa9([0-9a-f][0-9a-f])([0-9a-f]*)87$/);if(s){const o=parseInt(s[1],16);if(s[2].length===o*2&&o>=1&&o<=75)return gv(Nt([[n.p2sh],"0x"+s[2]]))}}if(n.prefix!=null){const s=i[1];let o=i[0];if(o===0?s!==20&&s!==32&&(o=-1):o=-1,o>=0&&i.length===2+s&&s>=1&&s<=75){const a=dv.toWords(i.slice(2));return a.unshift(o),dv.encode(n.prefix,a)}}return null}getAddress(e){return Oe(this,void 0,void 0,function*(){if(e==null&&(e=60),e===60)try{const i=yield this._fetch("0x3b3b57de");return i==="0x"||i===g_?null:this.provider.formatter.callAddress(i)}catch(i){if(i.code===K.errors.CALL_EXCEPTION)return null;throw i}const t=yield this._fetchBytes("0xf1cb7e06",Rp(e));if(t==null||t==="0x")return null;const n=this._getAddress(e,t);return n==null&&$e.throwError("invalid or unsupported coin data",K.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${e})`,coinType:e,data:t}),n})}getAvatar(){return Oe(this,void 0,void 0,function*(){const e=[{type:"name",content:this.name}];try{const t=yield this.getText("avatar");if(t==null)return null;for(let n=0;n<mv.length;n++){const i=t.match(mv[n]);if(i==null)continue;const s=i[1].toLowerCase();switch(s){case"https":return e.push({type:"url",content:t}),{linkage:e,url:t};case"data":return e.push({type:"data",content:t}),{linkage:e,url:t};case"ipfs":return e.push({type:"ipfs",content:t}),{linkage:e,url:Op(t)};case"erc721":case"erc1155":{const o=s==="erc721"?"0xc87b56dd":"0x0e89341c";e.push({type:s,content:t});const a=this._resolvedAddress||(yield this.getAddress()),c=(i[2]||"").split("/");if(c.length!==2)return null;const l=yield this.provider.formatter.address(c[0]),u=Ct(ie.from(c[1]).toHexString(),32);if(s==="erc721"){const b=this.provider.formatter.callAddress(yield this.provider.call({to:l,data:an(["0x6352211e",u])}));if(a!==b)return null;e.push({type:"owner",content:b})}else if(s==="erc1155"){const b=ie.from(yield this.provider.call({to:l,data:an(["0x00fdd58e",Ct(a,32),u])}));if(b.isZero())return null;e.push({type:"balance",content:b.toString()})}const d={to:this.provider.formatter.address(c[0]),data:an([o,u])};let p=wf(yield this.provider.call(d),0);if(p==null)return null;e.push({type:"metadata-url-base",content:p}),s==="erc1155"&&(p=p.replace("{id}",u.substring(2)),e.push({type:"metadata-url-expanded",content:p})),p.match(/^ipfs:/i)&&(p=Op(p)),e.push({type:"metadata-url",content:p});const x=yield Fh(p);if(!x)return null;e.push({type:"metadata",content:JSON.stringify(x)});let w=x.image;if(typeof w!="string")return null;if(!w.match(/^(https:\/\/|data:)/i)){if(w.match(cC)==null)return null;e.push({type:"url-ipfs",content:w}),w=Op(w)}return e.push({type:"url",content:w}),{linkage:e,url:w}}}}}catch{}return null})}getContentHash(){return Oe(this,void 0,void 0,function*(){const e=yield this._fetchBytes("0xbc1c58d1");if(e==null||e==="0x")return null;const t=e.match(/^0xe3010170(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const o=parseInt(t[3],16);if(t[4].length===o*2)return"ipfs://"+Hc.encode("0x"+t[1])}const n=e.match(/^0xe5010172(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(n){const o=parseInt(n[3],16);if(n[4].length===o*2)return"ipns://"+Hc.encode("0x"+n[1])}const i=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(i&&i[1].length===64)return"bzz://"+i[1];const s=e.match(/^0x90b2c605([0-9a-f]*)$/);if(s&&s[1].length===68){const o={"=":"","+":"-","/":"_"};return"sia://"+Xm("0x"+s[1]).replace(/[=+\/]/g,c=>o[c])}return $e.throwError("invalid or unsupported content hash data",K.errors.UNSUPPORTED_OPERATION,{operation:"getContentHash()",data:e})})}getText(e){return Oe(this,void 0,void 0,function*(){let t=ar(e);t=Nt([Rp(64),Rp(t.length),t]),t.length%32!==0&&(t=Nt([t,Ct("0x",32-e.length%32)]));const n=yield this._fetchBytes("0x59d1d43c",oe(t));return n==null||n==="0x"?null:To(n)})}}let kp=null,Bz=1;class $z extends pd{constructor(e){if(super(),this._events=[],this._emitted={block:-2},this.disableCcipRead=!1,this.formatter=new.target.getFormatter(),J(this,"anyNetwork",e==="any"),this.anyNetwork&&(e=this.detectNetwork()),e instanceof Promise)this._networkPromise=e,e.catch(t=>{}),this._ready().catch(t=>{});else{const t=Ti(new.target,"getNetwork")(e);t?(J(this,"_network",t),this.emit("network",t,null)):$e.throwArgumentError("invalid network","network",e)}this._maxInternalBlockNumber=-1024,this._lastBlockNumber=-2,this._maxFilterBlockRange=10,this._pollingInterval=4e3,this._fastQueryDate=0}_ready(){return Oe(this,void 0,void 0,function*(){if(this._network==null){let e=null;if(this._networkPromise)try{e=yield this._networkPromise}catch{}e==null&&(e=yield this.detectNetwork()),e||$e.throwError("no network detected",K.errors.UNKNOWN_ERROR,{}),this._network==null&&(this.anyNetwork?this._network=e:J(this,"_network",e),this.emit("network",e,null))}return this._network})}get ready(){return Cc(()=>this._ready().then(e=>e,e=>{if(!(e.code===K.errors.NETWORK_ERROR&&e.event==="noNetwork"))throw e}))}static getFormatter(){return kp==null&&(kp=new ve),kp}static getNetwork(e){return Ez(e??"homestead")}ccipReadFetch(e,t,n){return Oe(this,void 0,void 0,function*(){if(this.disableCcipRead||n.length===0)return null;const i=e.to.toLowerCase(),s=t.toLowerCase(),o=[];for(let a=0;a<n.length;a++){const c=n[a],l=c.replace("{sender}",i).replace("{data}",s),u=c.indexOf("{data}")>=0?null:JSON.stringify({data:s,sender:i}),d=yield Fh({url:l,errorPassThrough:!0},u,(x,w)=>(x.status=w.statusCode,x));if(d.data)return d.data;const p=d.message||"unknown error";if(d.status>=400&&d.status<500)return $e.throwError(`response not found during CCIP fetch: ${p}`,K.errors.SERVER_ERROR,{url:c,errorMessage:p});o.push(p)}return $e.throwError(`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,K.errors.SERVER_ERROR,{urls:n,errorMessages:o})})}_getInternalBlockNumber(e){return Oe(this,void 0,void 0,function*(){if(yield this._ready(),e>0)for(;this._internalBlockNumber;){const i=this._internalBlockNumber;try{const s=yield i;if(_l()-s.respTime<=e)return s.blockNumber;break}catch{if(this._internalBlockNumber===i)break}}const t=_l(),n=or({blockNumber:this.perform("getBlockNumber",{}),networkError:this.getNetwork().then(i=>null,i=>i)}).then(({blockNumber:i,networkError:s})=>{if(s)throw this._internalBlockNumber===n&&(this._internalBlockNumber=null),s;const o=_l();return i=ie.from(i).toNumber(),i<this._maxInternalBlockNumber&&(i=this._maxInternalBlockNumber),this._maxInternalBlockNumber=i,this._setFastBlockNumber(i),{blockNumber:i,reqTime:t,respTime:o}});return this._internalBlockNumber=n,n.catch(i=>{this._internalBlockNumber===n&&(this._internalBlockNumber=null)}),(yield n).blockNumber})}poll(){return Oe(this,void 0,void 0,function*(){const e=Bz++,t=[];let n=null;try{n=yield this._getInternalBlockNumber(100+this.pollingInterval/2)}catch(i){this.emit("error",i);return}if(this._setFastBlockNumber(n),this.emit("poll",e,n),n===this._lastBlockNumber){this.emit("didPoll",e);return}if(this._emitted.block===-2&&(this._emitted.block=n-1),Math.abs(this._emitted.block-n)>1e3)$e.warn(`network block skew detected; skipping block events (emitted=${this._emitted.block} blockNumber${n})`),this.emit("error",$e.makeError("network block skew detected",K.errors.NETWORK_ERROR,{blockNumber:n,event:"blockSkew",previousBlockNumber:this._emitted.block})),this.emit("block",n);else for(let i=this._emitted.block+1;i<=n;i++)this.emit("block",i);this._emitted.block!==n&&(this._emitted.block=n,Object.keys(this._emitted).forEach(i=>{if(i==="block")return;const s=this._emitted[i];s!=="pending"&&n-s>12&&delete this._emitted[i]})),this._lastBlockNumber===-2&&(this._lastBlockNumber=n-1),this._events.forEach(i=>{switch(i.type){case"tx":{const s=i.hash;let o=this.getTransactionReceipt(s).then(a=>(!a||a.blockNumber==null||(this._emitted["t:"+s]=a.blockNumber,this.emit(s,a)),null)).catch(a=>{this.emit("error",a)});t.push(o);break}case"filter":{if(!i._inflight){i._inflight=!0,i._lastBlockNumber===-2&&(i._lastBlockNumber=n-1);const s=i.filter;s.fromBlock=i._lastBlockNumber+1,s.toBlock=n;const o=s.toBlock-this._maxFilterBlockRange;o>s.fromBlock&&(s.fromBlock=o),s.fromBlock<0&&(s.fromBlock=0);const a=this.getLogs(s).then(c=>{i._inflight=!1,c.length!==0&&c.forEach(l=>{l.blockNumber>i._lastBlockNumber&&(i._lastBlockNumber=l.blockNumber),this._emitted["b:"+l.blockHash]=l.blockNumber,this._emitted["t:"+l.transactionHash]=l.blockNumber,this.emit(s,l)})}).catch(c=>{this.emit("error",c),i._inflight=!1});t.push(a)}break}}}),this._lastBlockNumber=n,Promise.all(t).then(()=>{this.emit("didPoll",e)}).catch(i=>{this.emit("error",i)})})}resetEventsBlock(e){this._lastBlockNumber=e-1,this.polling&&this.poll()}get network(){return this._network}detectNetwork(){return Oe(this,void 0,void 0,function*(){return $e.throwError("provider does not support network detection",K.errors.UNSUPPORTED_OPERATION,{operation:"provider.detectNetwork"})})}getNetwork(){return Oe(this,void 0,void 0,function*(){const e=yield this._ready(),t=yield this.detectNetwork();if(e.chainId!==t.chainId){if(this.anyNetwork)return this._network=t,this._lastBlockNumber=-2,this._fastBlockNumber=null,this._fastBlockNumberPromise=null,this._fastQueryDate=0,this._emitted.block=-2,this._maxInternalBlockNumber=-1024,this._internalBlockNumber=null,this.emit("network",t,e),yield pv(0),this._network;const n=$e.makeError("underlying network changed",K.errors.NETWORK_ERROR,{event:"changed",network:e,detectedNetwork:t});throw this.emit("error",n),n}return e})}get blockNumber(){return this._getInternalBlockNumber(100+this.pollingInterval/2).then(e=>{this._setFastBlockNumber(e)},e=>{}),this._fastBlockNumber!=null?this._fastBlockNumber:-1}get polling(){return this._poller!=null}set polling(e){e&&!this._poller?(this._poller=setInterval(()=>{this.poll()},this.pollingInterval),this._bootstrapPoll||(this._bootstrapPoll=setTimeout(()=>{this.poll(),this._bootstrapPoll=setTimeout(()=>{this._poller||this.poll(),this._bootstrapPoll=null},this.pollingInterval)},0))):!e&&this._poller&&(clearInterval(this._poller),this._poller=null)}get pollingInterval(){return this._pollingInterval}set pollingInterval(e){if(typeof e!="number"||e<=0||parseInt(String(e))!=e)throw new Error("invalid polling interval");this._pollingInterval=e,this._poller&&(clearInterval(this._poller),this._poller=setInterval(()=>{this.poll()},this._pollingInterval))}_getFastBlockNumber(){const e=_l();return e-this._fastQueryDate>2*this._pollingInterval&&(this._fastQueryDate=e,this._fastBlockNumberPromise=this.getBlockNumber().then(t=>((this._fastBlockNumber==null||t>this._fastBlockNumber)&&(this._fastBlockNumber=t),this._fastBlockNumber))),this._fastBlockNumberPromise}_setFastBlockNumber(e){this._fastBlockNumber!=null&&e<this._fastBlockNumber||(this._fastQueryDate=_l(),(this._fastBlockNumber==null||e>this._fastBlockNumber)&&(this._fastBlockNumber=e,this._fastBlockNumberPromise=Promise.resolve(e)))}waitForTransaction(e,t,n){return Oe(this,void 0,void 0,function*(){return this._waitForTransaction(e,t??1,n||0,null)})}_waitForTransaction(e,t,n,i){return Oe(this,void 0,void 0,function*(){const s=yield this.getTransactionReceipt(e);return(s?s.confirmations:0)>=t?s:new Promise((o,a)=>{const c=[];let l=!1;const u=function(){return l?!0:(l=!0,c.forEach(p=>{p()}),!1)},d=p=>{p.confirmations<t||u()||o(p)};if(this.on(e,d),c.push(()=>{this.removeListener(e,d)}),i){let p=i.startBlock,x=null;const w=b=>Oe(this,void 0,void 0,function*(){l||(yield pv(1e3),this.getTransactionCount(i.from).then(y=>Oe(this,void 0,void 0,function*(){if(!l){if(y<=i.nonce)p=b;else{{const C=yield this.getTransaction(e);if(C&&C.blockNumber!=null)return}for(x==null&&(x=p-3,x<i.startBlock&&(x=i.startBlock));x<=b;){if(l)return;const C=yield this.getBlockWithTransactions(x);for(let T=0;T<C.transactions.length;T++){const I=C.transactions[T];if(I.hash===e)return;if(I.from===i.from&&I.nonce===i.nonce){if(l)return;const k=yield this.waitForTransaction(I.hash,t);if(u())return;let P="replaced";I.data===i.data&&I.to===i.to&&I.value.eq(i.value)?P="repriced":I.data==="0x"&&I.from===I.to&&I.value.isZero()&&(P="cancelled"),a($e.makeError("transaction was replaced",K.errors.TRANSACTION_REPLACED,{cancelled:P==="replaced"||P==="cancelled",reason:P,replacement:this._wrapTransaction(I),hash:e,receipt:k}));return}}x++}}l||this.once("block",w)}}),y=>{l||this.once("block",w)}))});if(l)return;this.once("block",w),c.push(()=>{this.removeListener("block",w)})}if(typeof n=="number"&&n>0){const p=setTimeout(()=>{u()||a($e.makeError("timeout exceeded",K.errors.TIMEOUT,{timeout:n}))},n);p.unref&&p.unref(),c.push(()=>{clearTimeout(p)})}})})}getBlockNumber(){return Oe(this,void 0,void 0,function*(){return this._getInternalBlockNumber(0)})}getGasPrice(){return Oe(this,void 0,void 0,function*(){yield this.getNetwork();const e=yield this.perform("getGasPrice",{});try{return ie.from(e)}catch(t){return $e.throwError("bad result from backend",K.errors.SERVER_ERROR,{method:"getGasPrice",result:e,error:t})}})}getBalance(e,t){return Oe(this,void 0,void 0,function*(){yield this.getNetwork();const n=yield or({address:this._getAddress(e),blockTag:this._getBlockTag(t)}),i=yield this.perform("getBalance",n);try{return ie.from(i)}catch(s){return $e.throwError("bad result from backend",K.errors.SERVER_ERROR,{method:"getBalance",params:n,result:i,error:s})}})}getTransactionCount(e,t){return Oe(this,void 0,void 0,function*(){yield this.getNetwork();const n=yield or({address:this._getAddress(e),blockTag:this._getBlockTag(t)}),i=yield this.perform("getTransactionCount",n);try{return ie.from(i).toNumber()}catch(s){return $e.throwError("bad result from backend",K.errors.SERVER_ERROR,{method:"getTransactionCount",params:n,result:i,error:s})}})}getCode(e,t){return Oe(this,void 0,void 0,function*(){yield this.getNetwork();const n=yield or({address:this._getAddress(e),blockTag:this._getBlockTag(t)}),i=yield this.perform("getCode",n);try{return oe(i)}catch(s){return $e.throwError("bad result from backend",K.errors.SERVER_ERROR,{method:"getCode",params:n,result:i,error:s})}})}getStorageAt(e,t,n){return Oe(this,void 0,void 0,function*(){yield this.getNetwork();const i=yield or({address:this._getAddress(e),blockTag:this._getBlockTag(n),position:Promise.resolve(t).then(o=>Th(o))}),s=yield this.perform("getStorageAt",i);try{return oe(s)}catch(o){return $e.throwError("bad result from backend",K.errors.SERVER_ERROR,{method:"getStorageAt",params:i,result:s,error:o})}})}_wrapTransaction(e,t,n){if(t!=null&&us(t)!==32)throw new Error("invalid response - sendTransaction");const i=e;return t!=null&&e.hash!==t&&$e.throwError("Transaction hash mismatch from Provider.sendTransaction.",K.errors.UNKNOWN_ERROR,{expectedHash:e.hash,returnedHash:t}),i.wait=(s,o)=>Oe(this,void 0,void 0,function*(){s==null&&(s=1),o==null&&(o=0);let a;s!==0&&n!=null&&(a={data:e.data,from:e.from,nonce:e.nonce,to:e.to,value:e.value,startBlock:n});const c=yield this._waitForTransaction(e.hash,s,o,a);return c==null&&s===0?null:(this._emitted["t:"+e.hash]=c.blockNumber,c.status===0&&$e.throwError("transaction failed",K.errors.CALL_EXCEPTION,{transactionHash:e.hash,transaction:e,receipt:c}),c)}),i}sendTransaction(e){return Oe(this,void 0,void 0,function*(){yield this.getNetwork();const t=yield Promise.resolve(e).then(s=>oe(s)),n=this.formatter.transaction(e);n.confirmations==null&&(n.confirmations=0);const i=yield this._getInternalBlockNumber(100+2*this.pollingInterval);try{const s=yield this.perform("sendTransaction",{signedTransaction:t});return this._wrapTransaction(n,s,i)}catch(s){throw s.transaction=n,s.transactionHash=n.hash,s}})}_getTransactionRequest(e){return Oe(this,void 0,void 0,function*(){const t=yield e,n={};return["from","to"].forEach(i=>{t[i]!=null&&(n[i]=Promise.resolve(t[i]).then(s=>s?this._getAddress(s):null))}),["gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","value"].forEach(i=>{t[i]!=null&&(n[i]=Promise.resolve(t[i]).then(s=>s?ie.from(s):null))}),["type"].forEach(i=>{t[i]!=null&&(n[i]=Promise.resolve(t[i]).then(s=>s??null))}),t.accessList&&(n.accessList=this.formatter.accessList(t.accessList)),["data"].forEach(i=>{t[i]!=null&&(n[i]=Promise.resolve(t[i]).then(s=>s?oe(s):null))}),this.formatter.transactionRequest(yield or(n))})}_getFilter(e){return Oe(this,void 0,void 0,function*(){e=yield e;const t={};return e.address!=null&&(t.address=this._getAddress(e.address)),["blockHash","topics"].forEach(n=>{e[n]!=null&&(t[n]=e[n])}),["fromBlock","toBlock"].forEach(n=>{e[n]!=null&&(t[n]=this._getBlockTag(e[n]))}),this.formatter.filter(yield or(t))})}_call(e,t,n){return Oe(this,void 0,void 0,function*(){n>=Rz&&$e.throwError("CCIP read exceeded maximum redirections",K.errors.SERVER_ERROR,{redirects:n,transaction:e});const i=e.to,s=yield this.perform("call",{transaction:e,blockTag:t});if(n>=0&&t==="latest"&&i!=null&&s.substring(0,10)==="0x556f1830"&&us(s)%32===4)try{const o=dr(s,4),a=dr(o,0,32);ie.from(a).eq(i)||$e.throwError("CCIP Read sender did not match",K.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:s});const c=[],l=ie.from(dr(o,32,64)).toNumber(),u=ie.from(dr(o,l,l+32)).toNumber(),d=dr(o,l+32);for(let C=0;C<u;C++){const T=wf(d,C*32);T==null&&$e.throwError("CCIP Read contained corrupt URL string",K.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:s}),c.push(T)}const p=Yu(o,64);ie.from(dr(o,100,128)).isZero()||$e.throwError("CCIP Read callback selector included junk",K.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:s});const x=dr(o,96,100),w=Yu(o,128),b=yield this.ccipReadFetch(e,p,c);b==null&&$e.throwError("CCIP Read disabled or provided no URLs",K.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:s});const y={to:i,data:an([x,lC([b,w])])};return this._call(y,t,n+1)}catch(o){if(o.code===K.errors.SERVER_ERROR)throw o}try{return oe(s)}catch(o){return $e.throwError("bad result from backend",K.errors.SERVER_ERROR,{method:"call",params:{transaction:e,blockTag:t},result:s,error:o})}})}call(e,t){return Oe(this,void 0,void 0,function*(){yield this.getNetwork();const n=yield or({transaction:this._getTransactionRequest(e),blockTag:this._getBlockTag(t),ccipReadEnabled:Promise.resolve(e.ccipReadEnabled)});return this._call(n.transaction,n.blockTag,n.ccipReadEnabled?0:-1)})}estimateGas(e){return Oe(this,void 0,void 0,function*(){yield this.getNetwork();const t=yield or({transaction:this._getTransactionRequest(e)}),n=yield this.perform("estimateGas",t);try{return ie.from(n)}catch(i){return $e.throwError("bad result from backend",K.errors.SERVER_ERROR,{method:"estimateGas",params:t,result:n,error:i})}})}_getAddress(e){return Oe(this,void 0,void 0,function*(){e=yield e,typeof e!="string"&&$e.throwArgumentError("invalid address or ENS name","name",e);const t=yield this.resolveName(e);return t==null&&$e.throwError("ENS name not configured",K.errors.UNSUPPORTED_OPERATION,{operation:`resolveName(${JSON.stringify(e)})`}),t})}_getBlock(e,t){return Oe(this,void 0,void 0,function*(){yield this.getNetwork(),e=yield e;let n=-128;const i={includeTransactions:!!t};if(We(e,32))i.blockHash=e;else try{i.blockTag=yield this._getBlockTag(e),We(i.blockTag)&&(n=parseInt(i.blockTag.substring(2),16))}catch{$e.throwArgumentError("invalid block hash or block tag","blockHashOrBlockTag",e)}return Cc(()=>Oe(this,void 0,void 0,function*(){const s=yield this.perform("getBlock",i);if(s==null)return i.blockHash!=null&&this._emitted["b:"+i.blockHash]==null||i.blockTag!=null&&n>this._emitted.block?null:void 0;if(t){let o=null;for(let c=0;c<s.transactions.length;c++){const l=s.transactions[c];if(l.blockNumber==null)l.confirmations=0;else if(l.confirmations==null){o==null&&(o=yield this._getInternalBlockNumber(100+2*this.pollingInterval));let u=o-l.blockNumber+1;u<=0&&(u=1),l.confirmations=u}}const a=this.formatter.blockWithTransactions(s);return a.transactions=a.transactions.map(c=>this._wrapTransaction(c)),a}return this.formatter.block(s)}),{oncePoll:this})})}getBlock(e){return this._getBlock(e,!1)}getBlockWithTransactions(e){return this._getBlock(e,!0)}getTransaction(e){return Oe(this,void 0,void 0,function*(){yield this.getNetwork(),e=yield e;const t={transactionHash:this.formatter.hash(e,!0)};return Cc(()=>Oe(this,void 0,void 0,function*(){const n=yield this.perform("getTransaction",t);if(n==null)return this._emitted["t:"+e]==null?null:void 0;const i=this.formatter.transactionResponse(n);if(i.blockNumber==null)i.confirmations=0;else if(i.confirmations==null){let o=(yield this._getInternalBlockNumber(100+2*this.pollingInterval))-i.blockNumber+1;o<=0&&(o=1),i.confirmations=o}return this._wrapTransaction(i)}),{oncePoll:this})})}getTransactionReceipt(e){return Oe(this,void 0,void 0,function*(){yield this.getNetwork(),e=yield e;const t={transactionHash:this.formatter.hash(e,!0)};return Cc(()=>Oe(this,void 0,void 0,function*(){const n=yield this.perform("getTransactionReceipt",t);if(n==null)return this._emitted["t:"+e]==null?null:void 0;if(n.blockHash==null)return;const i=this.formatter.receipt(n);if(i.blockNumber==null)i.confirmations=0;else if(i.confirmations==null){let o=(yield this._getInternalBlockNumber(100+2*this.pollingInterval))-i.blockNumber+1;o<=0&&(o=1),i.confirmations=o}return i}),{oncePoll:this})})}getLogs(e){return Oe(this,void 0,void 0,function*(){yield this.getNetwork();const t=yield or({filter:this._getFilter(e)}),n=yield this.perform("getLogs",t);return n.forEach(i=>{i.removed==null&&(i.removed=!1)}),ve.arrayOf(this.formatter.filterLog.bind(this.formatter))(n)})}getEtherPrice(){return Oe(this,void 0,void 0,function*(){return yield this.getNetwork(),this.perform("getEtherPrice",{})})}_getBlockTag(e){return Oe(this,void 0,void 0,function*(){if(e=yield e,typeof e=="number"&&e<0){e%1&&$e.throwArgumentError("invalid BlockTag","blockTag",e);let t=yield this._getInternalBlockNumber(100+2*this.pollingInterval);return t+=e,t<0&&(t=0),this.formatter.blockTag(t)}return this.formatter.blockTag(e)})}getResolver(e){return Oe(this,void 0,void 0,function*(){let t=e;for(;;){if(t===""||t==="."||e!=="eth"&&t==="eth")return null;const n=yield this._getResolver(t,"getResolver");if(n!=null){const i=new yv(this,n,e);return t!==e&&!(yield i.supportsWildcard())?null:i}t=t.split(".").slice(1).join(".")}})}_getResolver(e,t){return Oe(this,void 0,void 0,function*(){t==null&&(t="ENS");const n=yield this.getNetwork();n.ensAddress||$e.throwError("network does not support ENS",K.errors.UNSUPPORTED_OPERATION,{operation:t,network:n.name});try{const i=yield this.call({to:n.ensAddress,data:"0x0178b8bf"+Gl(e).substring(2)});return this.formatter.callAddress(i)}catch{}return null})}resolveName(e){return Oe(this,void 0,void 0,function*(){e=yield e;try{return Promise.resolve(this.formatter.address(e))}catch(n){if(We(e))throw n}typeof e!="string"&&$e.throwArgumentError("invalid ENS name","name",e);const t=yield this.getResolver(e);return t?yield t.getAddress():null})}lookupAddress(e){return Oe(this,void 0,void 0,function*(){e=yield e,e=this.formatter.address(e);const t=e.substring(2).toLowerCase()+".addr.reverse",n=yield this._getResolver(t,"lookupAddress");if(n==null)return null;const i=wf(yield this.call({to:n,data:"0x691f3431"+Gl(t).substring(2)}),0);return(yield this.resolveName(i))!=e?null:i})}getAvatar(e){return Oe(this,void 0,void 0,function*(){let t=null;if(We(e)){const s=this.formatter.address(e).substring(2).toLowerCase()+".addr.reverse",o=yield this._getResolver(s,"getAvatar");if(!o)return null;t=new yv(this,o,s);try{const a=yield t.getAvatar();if(a)return a.url}catch(a){if(a.code!==K.errors.CALL_EXCEPTION)throw a}try{const a=wf(yield this.call({to:o,data:"0x691f3431"+Gl(s).substring(2)}),0);t=yield this.getResolver(a)}catch(a){if(a.code!==K.errors.CALL_EXCEPTION)throw a;return null}}else if(t=yield this.getResolver(e),!t)return null;const n=yield t.getAvatar();return n==null?null:n.url})}perform(e,t){return $e.throwError(e+" not implemented",K.errors.NOT_IMPLEMENTED,{operation:e})}_startEvent(e){this.polling=this._events.filter(t=>t.pollable()).length>0}_stopEvent(e){this.polling=this._events.filter(t=>t.pollable()).length>0}_addEventListener(e,t,n){const i=new Dz(uc(e),t,n);return this._events.push(i),this._startEvent(i),this}on(e,t){return this._addEventListener(e,t,!1)}once(e,t){return this._addEventListener(e,t,!0)}emit(e,...t){let n=!1,i=[],s=uc(e);return this._events=this._events.filter(o=>o.tag!==s?!0:(setTimeout(()=>{o.listener.apply(this,t)},0),n=!0,o.once?(i.push(o),!1):!0)),i.forEach(o=>{this._stopEvent(o)}),n}listenerCount(e){if(!e)return this._events.length;let t=uc(e);return this._events.filter(n=>n.tag===t).length}listeners(e){if(e==null)return this._events.map(n=>n.listener);let t=uc(e);return this._events.filter(n=>n.tag===t).map(n=>n.listener)}off(e,t){if(t==null)return this.removeAllListeners(e);const n=[];let i=!1,s=uc(e);return this._events=this._events.filter(o=>o.tag!==s||o.listener!=t||i?!0:(i=!0,n.push(o),!1)),n.forEach(o=>{this._stopEvent(o)}),this}removeAllListeners(e){let t=[];if(e==null)t=this._events,this._events=[];else{const n=uc(e);this._events=this._events.filter(i=>i.tag!==n?!0:(t.push(i),!1))}return t.forEach(n=>{this._stopEvent(n)}),this}}var Ts=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};const pr=new K(jh),Lz=["call","estimateGas"];function Jl(r,e){if(r==null)return null;if(typeof r.message=="string"&&r.message.match("reverted")){const t=We(r.data)?r.data:null;if(!e||t)return{message:r.message,data:t}}if(typeof r=="object"){for(const t in r){const n=Jl(r[t],e);if(n)return n}return null}if(typeof r=="string")try{return Jl(JSON.parse(r),e)}catch{}return null}function uC(r,e,t){const n=t.transaction||t.signedTransaction;if(r==="call"){const s=Jl(e,!0);if(s)return s.data;pr.throwError("missing revert data in call exception; Transaction reverted without a reason string",K.errors.CALL_EXCEPTION,{data:"0x",transaction:n,error:e})}if(r==="estimateGas"){let s=Jl(e.body,!1);s==null&&(s=Jl(e,!1)),s&&pr.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",K.errors.UNPREDICTABLE_GAS_LIMIT,{reason:s.message,method:r,transaction:n,error:e})}let i=e.message;throw e.code===K.errors.SERVER_ERROR&&e.error&&typeof e.error.message=="string"?i=e.error.message:typeof e.body=="string"?i=e.body:typeof e.responseText=="string"&&(i=e.responseText),i=(i||"").toLowerCase(),i.match(/insufficient funds|base fee exceeds gas limit|InsufficientFunds/i)&&pr.throwError("insufficient funds for intrinsic transaction cost",K.errors.INSUFFICIENT_FUNDS,{error:e,method:r,transaction:n}),i.match(/nonce (is )?too low/i)&&pr.throwError("nonce has already been used",K.errors.NONCE_EXPIRED,{error:e,method:r,transaction:n}),i.match(/replacement transaction underpriced|transaction gas price.*too low/i)&&pr.throwError("replacement fee too low",K.errors.REPLACEMENT_UNDERPRICED,{error:e,method:r,transaction:n}),i.match(/only replay-protected/i)&&pr.throwError("legacy pre-eip-155 transactions not supported",K.errors.UNSUPPORTED_OPERATION,{error:e,method:r,transaction:n}),Lz.indexOf(r)>=0&&i.match(/gas required exceeds allowance|always failing transaction|execution reverted|revert/)&&pr.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",K.errors.UNPREDICTABLE_GAS_LIMIT,{error:e,method:r,transaction:n}),e}function wv(r){return new Promise(function(e){setTimeout(e,r)})}function Fz(r){if(r.error){const e=new Error(r.error.message);throw e.code=r.error.code,e.data=r.error.data,e}return r.result}function Cl(r){return r&&r.toLowerCase()}const Zg={};class dC extends rl{constructor(e,t,n){if(super(),e!==Zg)throw new Error("do not call the JsonRpcSigner constructor directly; use provider.getSigner");J(this,"provider",t),n==null&&(n=0),typeof n=="string"?(J(this,"_address",this.provider.formatter.address(n)),J(this,"_index",null)):typeof n=="number"?(J(this,"_index",n),J(this,"_address",null)):pr.throwArgumentError("invalid address or index","addressOrIndex",n)}connect(e){return pr.throwError("cannot alter JSON-RPC Signer connection",K.errors.UNSUPPORTED_OPERATION,{operation:"connect"})}connectUnchecked(){return new jz(Zg,this.provider,this._address||this._index)}getAddress(){return this._address?Promise.resolve(this._address):this.provider.send("eth_accounts",[]).then(e=>(e.length<=this._index&&pr.throwError("unknown account #"+this._index,K.errors.UNSUPPORTED_OPERATION,{operation:"getAddress"}),this.provider.formatter.address(e[this._index])))}sendUncheckedTransaction(e){e=mr(e);const t=this.getAddress().then(n=>(n&&(n=n.toLowerCase()),n));if(e.gasLimit==null){const n=mr(e);n.from=t,e.gasLimit=this.provider.estimateGas(n)}return e.to!=null&&(e.to=Promise.resolve(e.to).then(n=>Ts(this,void 0,void 0,function*(){if(n==null)return null;const i=yield this.provider.resolveName(n);return i==null&&pr.throwArgumentError("provided ENS name resolves to null","tx.to",n),i}))),or({tx:or(e),sender:t}).then(({tx:n,sender:i})=>{n.from!=null?n.from.toLowerCase()!==i&&pr.throwArgumentError("from address mismatch","transaction",e):n.from=i;const s=this.provider.constructor.hexlifyTransaction(n,{from:!0});return this.provider.send("eth_sendTransaction",[s]).then(o=>o,o=>(typeof o.message=="string"&&o.message.match(/user denied/i)&&pr.throwError("user rejected transaction",K.errors.ACTION_REJECTED,{action:"sendTransaction",transaction:n}),uC("sendTransaction",o,s)))})}signTransaction(e){return pr.throwError("signing transactions is unsupported",K.errors.UNSUPPORTED_OPERATION,{operation:"signTransaction"})}sendTransaction(e){return Ts(this,void 0,void 0,function*(){const t=yield this.provider._getInternalBlockNumber(100+2*this.provider.pollingInterval),n=yield this.sendUncheckedTransaction(e);try{return yield Cc(()=>Ts(this,void 0,void 0,function*(){const i=yield this.provider.getTransaction(n);if(i!==null)return this.provider._wrapTransaction(i,n,t)}),{oncePoll:this.provider})}catch(i){throw i.transactionHash=n,i}})}signMessage(e){return Ts(this,void 0,void 0,function*(){const t=typeof e=="string"?ar(e):e,n=yield this.getAddress();try{return yield this.provider.send("personal_sign",[oe(t),n.toLowerCase()])}catch(i){throw typeof i.message=="string"&&i.message.match(/user denied/i)&&pr.throwError("user rejected signing",K.errors.ACTION_REJECTED,{action:"signMessage",from:n,messageData:e}),i}})}_legacySignMessage(e){return Ts(this,void 0,void 0,function*(){const t=typeof e=="string"?ar(e):e,n=yield this.getAddress();try{return yield this.provider.send("eth_sign",[n.toLowerCase(),oe(t)])}catch(i){throw typeof i.message=="string"&&i.message.match(/user denied/i)&&pr.throwError("user rejected signing",K.errors.ACTION_REJECTED,{action:"_legacySignMessage",from:n,messageData:e}),i}})}_signTypedData(e,t,n){return Ts(this,void 0,void 0,function*(){const i=yield $r.resolveNames(e,t,n,o=>this.provider.resolveName(o)),s=yield this.getAddress();try{return yield this.provider.send("eth_signTypedData_v4",[s.toLowerCase(),JSON.stringify($r.getPayload(i.domain,t,i.value))])}catch(o){throw typeof o.message=="string"&&o.message.match(/user denied/i)&&pr.throwError("user rejected signing",K.errors.ACTION_REJECTED,{action:"_signTypedData",from:s,messageData:{domain:i.domain,types:t,value:i.value}}),o}})}unlock(e){return Ts(this,void 0,void 0,function*(){const t=this.provider,n=yield this.getAddress();return t.send("personal_unlockAccount",[n.toLowerCase(),e,null])})}}class jz extends dC{sendTransaction(e){return this.sendUncheckedTransaction(e).then(t=>({hash:t,nonce:null,gasLimit:null,gasPrice:null,data:null,value:null,chainId:null,confirmations:0,from:null,wait:n=>this.provider.waitForTransaction(t,n)}))}}const qz={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,value:!0,type:!0,accessList:!0,maxFeePerGas:!0,maxPriorityFeePerGas:!0};class fC extends $z{constructor(e,t){let n=t;n==null&&(n=new Promise((i,s)=>{setTimeout(()=>{this.detectNetwork().then(o=>{i(o)},o=>{s(o)})},0)})),super(n),e||(e=Ti(this.constructor,"defaultUrl")()),typeof e=="string"?J(this,"connection",Object.freeze({url:e})):J(this,"connection",Object.freeze(mr(e))),this._nextId=42}get _cache(){return this._eventLoopCache==null&&(this._eventLoopCache={}),this._eventLoopCache}static defaultUrl(){return"http://localhost:8545"}detectNetwork(){return this._cache.detectNetwork||(this._cache.detectNetwork=this._uncachedDetectNetwork(),setTimeout(()=>{this._cache.detectNetwork=null},0)),this._cache.detectNetwork}_uncachedDetectNetwork(){return Ts(this,void 0,void 0,function*(){yield wv(0);let e=null;try{e=yield this.send("eth_chainId",[])}catch{try{e=yield this.send("net_version",[])}catch{}}if(e!=null){const t=Ti(this.constructor,"getNetwork");try{return t(ie.from(e).toNumber())}catch(n){return pr.throwError("could not detect network",K.errors.NETWORK_ERROR,{chainId:e,event:"invalidNetwork",serverError:n})}}return pr.throwError("could not detect network",K.errors.NETWORK_ERROR,{event:"noNetwork"})})}getSigner(e){return new dC(Zg,this,e)}getUncheckedSigner(e){return this.getSigner(e).connectUnchecked()}listAccounts(){return this.send("eth_accounts",[]).then(e=>e.map(t=>this.formatter.address(t)))}send(e,t){const n={method:e,params:t,id:this._nextId++,jsonrpc:"2.0"};this.emit("debug",{action:"request",request:ds(n),provider:this});const i=["eth_chainId","eth_blockNumber"].indexOf(e)>=0;if(i&&this._cache[e])return this._cache[e];const s=Fh(this.connection,JSON.stringify(n),Fz).then(o=>(this.emit("debug",{action:"response",request:n,response:o,provider:this}),o),o=>{throw this.emit("debug",{action:"response",error:o,request:n,provider:this}),o});return i&&(this._cache[e]=s,setTimeout(()=>{this._cache[e]=null},0)),s}prepareRequest(e,t){switch(e){case"getBlockNumber":return["eth_blockNumber",[]];case"getGasPrice":return["eth_gasPrice",[]];case"getBalance":return["eth_getBalance",[Cl(t.address),t.blockTag]];case"getTransactionCount":return["eth_getTransactionCount",[Cl(t.address),t.blockTag]];case"getCode":return["eth_getCode",[Cl(t.address),t.blockTag]];case"getStorageAt":return["eth_getStorageAt",[Cl(t.address),Ct(t.position,32),t.blockTag]];case"sendTransaction":return["eth_sendRawTransaction",[t.signedTransaction]];case"getBlock":return t.blockTag?["eth_getBlockByNumber",[t.blockTag,!!t.includeTransactions]]:t.blockHash?["eth_getBlockByHash",[t.blockHash,!!t.includeTransactions]]:null;case"getTransaction":return["eth_getTransactionByHash",[t.transactionHash]];case"getTransactionReceipt":return["eth_getTransactionReceipt",[t.transactionHash]];case"call":return["eth_call",[Ti(this.constructor,"hexlifyTransaction")(t.transaction,{from:!0}),t.blockTag]];case"estimateGas":return["eth_estimateGas",[Ti(this.constructor,"hexlifyTransaction")(t.transaction,{from:!0})]];case"getLogs":return t.filter&&t.filter.address!=null&&(t.filter.address=Cl(t.filter.address)),["eth_getLogs",[t.filter]]}return null}perform(e,t){return Ts(this,void 0,void 0,function*(){if(e==="call"||e==="estimateGas"){const i=t.transaction;if(i&&i.type!=null&&ie.from(i.type).isZero()&&i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null){const s=yield this.getFeeData();s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null&&(t=mr(t),t.transaction=mr(i),delete t.transaction.type)}}const n=this.prepareRequest(e,t);n==null&&pr.throwError(e+" not implemented",K.errors.NOT_IMPLEMENTED,{operation:e});try{return yield this.send(n[0],n[1])}catch(i){return uC(e,i,t)}})}_startEvent(e){e.tag==="pending"&&this._startPending(),super._startEvent(e)}_startPending(){if(this._pendingFilter!=null)return;const e=this,t=this.send("eth_newPendingTransactionFilter",[]);this._pendingFilter=t,t.then(function(n){function i(){e.send("eth_getFilterChanges",[n]).then(function(s){if(e._pendingFilter!=t)return null;let o=Promise.resolve();return s.forEach(function(a){e._emitted["t:"+a.toLowerCase()]="pending",o=o.then(function(){return e.getTransaction(a).then(function(c){return e.emit("pending",c),null})})}),o.then(function(){return wv(1e3)})}).then(function(){if(e._pendingFilter!=t){e.send("eth_uninstallFilter",[n]);return}return setTimeout(function(){i()},0),null}).catch(s=>{})}return i(),n}).catch(n=>{})}_stopEvent(e){e.tag==="pending"&&this.listenerCount("pending")===0&&(this._pendingFilter=null),super._stopEvent(e)}static hexlifyTransaction(e,t){const n=mr(qz);if(t)for(const s in t)t[s]&&(n[s]=!0);Wm(e,n);const i={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(function(s){if(e[s]==null)return;const o=Th(ie.from(e[s]));s==="gasLimit"&&(s="gas"),i[s]=o}),["from","to","data"].forEach(function(s){e[s]!=null&&(i[s]=oe(e[s]))}),e.accessList&&(i.accessList=Fa(e.accessList)),i}}const xv=new K(jh);let Hz=1;function vv(r,e){const t="Web3LegacyFetcher";return function(n,i){const s={method:n,params:i,id:Hz++,jsonrpc:"2.0"};return new Promise((o,a)=>{this.emit("debug",{action:"request",fetcher:t,request:ds(s),provider:this}),e(s,(c,l)=>{if(c)return this.emit("debug",{action:"response",fetcher:t,error:c,request:s,provider:this}),a(c);if(this.emit("debug",{action:"response",fetcher:t,request:s,response:l,provider:this}),l.error){const u=new Error(l.error.message);return u.code=l.error.code,u.data=l.error.data,a(u)}o(l.result)})})}}function Wz(r){return function(e,t){t==null&&(t=[]);const n={method:e,params:t};return this.emit("debug",{action:"request",fetcher:"Eip1193Fetcher",request:ds(n),provider:this}),r.request(n).then(i=>(this.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:n,response:i,provider:this}),i),i=>{throw this.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:n,error:i,provider:this}),i})}}class xf extends fC{constructor(e,t){e==null&&xv.throwArgumentError("missing provider","provider",e);let n=null,i=null,s=null;typeof e=="function"?(n="unknown:",i=e):(n=e.host||e.path||"",!n&&e.isMetaMask&&(n="metamask"),s=e,e.request?(n===""&&(n="eip-1193:"),i=Wz(e)):e.sendAsync?i=vv(e,e.sendAsync.bind(e)):e.send?i=vv(e,e.send.bind(e)):xv.throwArgumentError("unsupported provider","provider",e),n||(n="unknown:")),super(n,t),J(this,"jsonRpcFetchFunc",i),J(this,"provider",s)}send(e,t){return this.jsonRpcFetchFunc(e,t)}}const zz="solidity/5.8.0",Kz=new RegExp("^bytes([0-9]+)$"),Vz=new RegExp("^(u?int)([0-9]*)$"),Gz=new RegExp("^(.*)\\[([0-9]*)\\]$"),Yz="0000000000000000000000000000000000000000000000000000000000000000",yc=new K(zz);function hC(r,e,t){switch(r){case"address":return t?zl(e,32):te(e);case"string":return ar(e);case"bytes":return te(e);case"bool":return e=e?"0x01":"0x00",t?zl(e,32):te(e)}let n=r.match(Vz);if(n){let i=parseInt(n[2]||"256");return(n[2]&&String(i)!==n[2]||i%8!==0||i===0||i>256)&&yc.throwArgumentError("invalid number type","type",r),t&&(i=256),e=ie.from(e).toTwos(i),zl(e,i/8)}if(n=r.match(Kz),n){const i=parseInt(n[1]);return(String(i)!==n[1]||i===0||i>32)&&yc.throwArgumentError("invalid bytes type","type",r),te(e).byteLength!==i&&yc.throwArgumentError(`invalid value for ${r}`,"value",e),t?te((e+Yz).substring(0,66)):e}if(n=r.match(Gz),n&&Array.isArray(e)){const i=n[1];parseInt(n[2]||String(e.length))!=e.length&&yc.throwArgumentError(`invalid array length for ${r}`,"value",e);const o=[];return e.forEach(function(a){o.push(hC(i,a,!0))}),Nt(o)}return yc.throwArgumentError("invalid type","type",r)}function fb(r,e){r.length!=e.length&&yc.throwArgumentError("wrong number of values; expected ${ types.length }","values",e);const t=[];return r.forEach(function(n,i){t.push(hC(n,e[i]))}),oe(Nt(t))}function Jz(r,e){return xt(fb(r,e))}function Zz(r,e){return js(fb(r,e))}const Xz=Object.freeze(Object.defineProperty({__proto__:null,keccak256:Jz,pack:fb,sha256:Zz},Symbol.toStringTag,{value:"Module"})),Qz="units/5.8.0",pC=new K(Qz),gC=["wei","kwei","mwei","gwei","szabo","finney","ether"];function eK(r){const e=String(r).split(".");(e.length>2||!e[0].match(/^-?[0-9]*$/)||e[1]&&!e[1].match(/^[0-9]*$/)||r==="."||r==="-.")&&pC.throwArgumentError("invalid value","value",r);let t=e[0],n="";for(t.substring(0,1)==="-"&&(n="-",t=t.substring(1));t.substring(0,1)==="0";)t=t.substring(1);t===""&&(t="0");let i="";for(e.length===2&&(i="."+(e[1]||"0"));i.length>2&&i[i.length-1]==="0";)i=i.substring(0,i.length-1);const s=[];for(;t.length;)if(t.length<=3){s.unshift(t);break}else{const o=t.length-3;s.unshift(t.substring(o)),t=t.substring(0,o)}return n+s.join(",")+i}function hb(r,e){if(typeof e=="string"){const t=gC.indexOf(e);t!==-1&&(e=3*t)}return hf(r,e??18)}function pb(r,e){if(typeof r!="string"&&pC.throwArgumentError("value must be a string","value",r),typeof e=="string"){const t=gC.indexOf(e);t!==-1&&(e=3*t)}return Wi(r,e??18)}function tK(r){return hb(r,18)}function mC(r){return pb(r,18)}const rK=Object.freeze(Object.defineProperty({__proto__:null,commify:eK,formatEther:tK,formatUnits:hb,parseEther:mC,parseUnits:pb},Symbol.toStringTag,{value:"Module"}));var As={};const nK=nr(HH),iK=nr(Cq),sK=nr(aH),oK=nr(MW),aK=nr(Xj),cK=nr(FH),lK=nr(JW),uK=nr(hz),dK=nr(mq),fK=nr(Jj),Ev=nr(LW),hK=nr(Xz),pK=nr(ez),gK=nr(aq),mK=nr(yq),bK=nr(bW),Av=nr(nH),yK=nr(CW),wK=nr(rK),xK=nr(wz),vK=nr(Iz);var _v;function EK(){return _v||(_v=1,(function(r){var e=As&&As.__createBinding||(Object.create?(function(j,U,_,f){f===void 0&&(f=_),Object.defineProperty(j,f,{enumerable:!0,get:function(){return U[_]}})}):(function(j,U,_,f){f===void 0&&(f=_),j[f]=U[_]})),t=As&&As.__setModuleDefault||(Object.create?(function(j,U){Object.defineProperty(j,"default",{enumerable:!0,value:U})}):function(j,U){j.default=U}),n=As&&As.__importStar||function(j){if(j&&j.__esModule)return j;var U={};if(j!=null)for(var _ in j)_!=="default"&&Object.prototype.hasOwnProperty.call(j,_)&&e(U,j,_);return t(U,j),U};Object.defineProperty(r,"__esModule",{value:!0}),r.formatBytes32String=r.Utf8ErrorFuncs=r.toUtf8String=r.toUtf8CodePoints=r.toUtf8Bytes=r._toEscapedUtf8String=r.nameprep=r.hexDataSlice=r.hexDataLength=r.hexZeroPad=r.hexValue=r.hexStripZeros=r.hexConcat=r.isHexString=r.hexlify=r.base64=r.base58=r.TransactionDescription=r.LogDescription=r.Interface=r.SigningKey=r.HDNode=r.defaultPath=r.isBytesLike=r.isBytes=r.zeroPad=r.stripZeros=r.concat=r.arrayify=r.shallowCopy=r.resolveProperties=r.getStatic=r.defineReadOnly=r.deepCopy=r.checkProperties=r.poll=r.fetchJson=r._fetchData=r.RLP=r.Logger=r.checkResultErrors=r.FormatTypes=r.ParamType=r.FunctionFragment=r.EventFragment=r.ErrorFragment=r.ConstructorFragment=r.Fragment=r.defaultAbiCoder=r.AbiCoder=void 0,r.Indexed=r.Utf8ErrorReason=r.UnicodeNormalizationForm=r.SupportedAlgorithm=r.mnemonicToSeed=r.isValidMnemonic=r.entropyToMnemonic=r.mnemonicToEntropy=r.getAccountPath=r.verifyTypedData=r.verifyMessage=r.recoverPublicKey=r.computePublicKey=r.recoverAddress=r.computeAddress=r.getJsonWalletAddress=r.TransactionTypes=r.serializeTransaction=r.parseTransaction=r.accessListify=r.joinSignature=r.splitSignature=r.soliditySha256=r.solidityKeccak256=r.solidityPack=r.shuffled=r.randomBytes=r.sha512=r.sha256=r.ripemd160=r.keccak256=r.computeHmac=r.commify=r.parseUnits=r.formatUnits=r.parseEther=r.formatEther=r.isAddress=r.getCreate2Address=r.getContractAddress=r.getIcapAddress=r.getAddress=r._TypedDataEncoder=r.id=r.isValidName=r.namehash=r.hashMessage=r.dnsEncode=r.parseBytes32String=void 0;var i=nK;Object.defineProperty(r,"AbiCoder",{enumerable:!0,get:function(){return i.AbiCoder}}),Object.defineProperty(r,"checkResultErrors",{enumerable:!0,get:function(){return i.checkResultErrors}}),Object.defineProperty(r,"ConstructorFragment",{enumerable:!0,get:function(){return i.ConstructorFragment}}),Object.defineProperty(r,"defaultAbiCoder",{enumerable:!0,get:function(){return i.defaultAbiCoder}}),Object.defineProperty(r,"ErrorFragment",{enumerable:!0,get:function(){return i.ErrorFragment}}),Object.defineProperty(r,"EventFragment",{enumerable:!0,get:function(){return i.EventFragment}}),Object.defineProperty(r,"FormatTypes",{enumerable:!0,get:function(){return i.FormatTypes}}),Object.defineProperty(r,"Fragment",{enumerable:!0,get:function(){return i.Fragment}}),Object.defineProperty(r,"FunctionFragment",{enumerable:!0,get:function(){return i.FunctionFragment}}),Object.defineProperty(r,"Indexed",{enumerable:!0,get:function(){return i.Indexed}}),Object.defineProperty(r,"Interface",{enumerable:!0,get:function(){return i.Interface}}),Object.defineProperty(r,"LogDescription",{enumerable:!0,get:function(){return i.LogDescription}}),Object.defineProperty(r,"ParamType",{enumerable:!0,get:function(){return i.ParamType}}),Object.defineProperty(r,"TransactionDescription",{enumerable:!0,get:function(){return i.TransactionDescription}});var s=iK;Object.defineProperty(r,"getAddress",{enumerable:!0,get:function(){return s.getAddress}}),Object.defineProperty(r,"getCreate2Address",{enumerable:!0,get:function(){return s.getCreate2Address}}),Object.defineProperty(r,"getContractAddress",{enumerable:!0,get:function(){return s.getContractAddress}}),Object.defineProperty(r,"getIcapAddress",{enumerable:!0,get:function(){return s.getIcapAddress}}),Object.defineProperty(r,"isAddress",{enumerable:!0,get:function(){return s.isAddress}});var o=n(sK);r.base64=o;var a=oK;Object.defineProperty(r,"base58",{enumerable:!0,get:function(){return a.Base58}});var c=aK;Object.defineProperty(r,"arrayify",{enumerable:!0,get:function(){return c.arrayify}}),Object.defineProperty(r,"concat",{enumerable:!0,get:function(){return c.concat}}),Object.defineProperty(r,"hexConcat",{enumerable:!0,get:function(){return c.hexConcat}}),Object.defineProperty(r,"hexDataSlice",{enumerable:!0,get:function(){return c.hexDataSlice}}),Object.defineProperty(r,"hexDataLength",{enumerable:!0,get:function(){return c.hexDataLength}}),Object.defineProperty(r,"hexlify",{enumerable:!0,get:function(){return c.hexlify}}),Object.defineProperty(r,"hexStripZeros",{enumerable:!0,get:function(){return c.hexStripZeros}}),Object.defineProperty(r,"hexValue",{enumerable:!0,get:function(){return c.hexValue}}),Object.defineProperty(r,"hexZeroPad",{enumerable:!0,get:function(){return c.hexZeroPad}}),Object.defineProperty(r,"isBytes",{enumerable:!0,get:function(){return c.isBytes}}),Object.defineProperty(r,"isBytesLike",{enumerable:!0,get:function(){return c.isBytesLike}}),Object.defineProperty(r,"isHexString",{enumerable:!0,get:function(){return c.isHexString}}),Object.defineProperty(r,"joinSignature",{enumerable:!0,get:function(){return c.joinSignature}}),Object.defineProperty(r,"zeroPad",{enumerable:!0,get:function(){return c.zeroPad}}),Object.defineProperty(r,"splitSignature",{enumerable:!0,get:function(){return c.splitSignature}}),Object.defineProperty(r,"stripZeros",{enumerable:!0,get:function(){return c.stripZeros}});var l=cK;Object.defineProperty(r,"_TypedDataEncoder",{enumerable:!0,get:function(){return l._TypedDataEncoder}}),Object.defineProperty(r,"dnsEncode",{enumerable:!0,get:function(){return l.dnsEncode}}),Object.defineProperty(r,"hashMessage",{enumerable:!0,get:function(){return l.hashMessage}}),Object.defineProperty(r,"id",{enumerable:!0,get:function(){return l.id}}),Object.defineProperty(r,"isValidName",{enumerable:!0,get:function(){return l.isValidName}}),Object.defineProperty(r,"namehash",{enumerable:!0,get:function(){return l.namehash}});var u=lK;Object.defineProperty(r,"defaultPath",{enumerable:!0,get:function(){return u.defaultPath}}),Object.defineProperty(r,"entropyToMnemonic",{enumerable:!0,get:function(){return u.entropyToMnemonic}}),Object.defineProperty(r,"getAccountPath",{enumerable:!0,get:function(){return u.getAccountPath}}),Object.defineProperty(r,"HDNode",{enumerable:!0,get:function(){return u.HDNode}}),Object.defineProperty(r,"isValidMnemonic",{enumerable:!0,get:function(){return u.isValidMnemonic}}),Object.defineProperty(r,"mnemonicToEntropy",{enumerable:!0,get:function(){return u.mnemonicToEntropy}}),Object.defineProperty(r,"mnemonicToSeed",{enumerable:!0,get:function(){return u.mnemonicToSeed}});var d=uK;Object.defineProperty(r,"getJsonWalletAddress",{enumerable:!0,get:function(){return d.getJsonWalletAddress}});var p=dK;Object.defineProperty(r,"keccak256",{enumerable:!0,get:function(){return p.keccak256}});var x=fK;Object.defineProperty(r,"Logger",{enumerable:!0,get:function(){return x.Logger}});var w=Ev;Object.defineProperty(r,"computeHmac",{enumerable:!0,get:function(){return w.computeHmac}}),Object.defineProperty(r,"ripemd160",{enumerable:!0,get:function(){return w.ripemd160}}),Object.defineProperty(r,"sha256",{enumerable:!0,get:function(){return w.sha256}}),Object.defineProperty(r,"sha512",{enumerable:!0,get:function(){return w.sha512}});var b=hK;Object.defineProperty(r,"solidityKeccak256",{enumerable:!0,get:function(){return b.keccak256}}),Object.defineProperty(r,"solidityPack",{enumerable:!0,get:function(){return b.pack}}),Object.defineProperty(r,"soliditySha256",{enumerable:!0,get:function(){return b.sha256}});var y=pK;Object.defineProperty(r,"randomBytes",{enumerable:!0,get:function(){return y.randomBytes}}),Object.defineProperty(r,"shuffled",{enumerable:!0,get:function(){return y.shuffled}});var C=gK;Object.defineProperty(r,"checkProperties",{enumerable:!0,get:function(){return C.checkProperties}}),Object.defineProperty(r,"deepCopy",{enumerable:!0,get:function(){return C.deepCopy}}),Object.defineProperty(r,"defineReadOnly",{enumerable:!0,get:function(){return C.defineReadOnly}}),Object.defineProperty(r,"getStatic",{enumerable:!0,get:function(){return C.getStatic}}),Object.defineProperty(r,"resolveProperties",{enumerable:!0,get:function(){return C.resolveProperties}}),Object.defineProperty(r,"shallowCopy",{enumerable:!0,get:function(){return C.shallowCopy}});var T=n(mK);r.RLP=T;var I=bK;Object.defineProperty(r,"computePublicKey",{enumerable:!0,get:function(){return I.computePublicKey}}),Object.defineProperty(r,"recoverPublicKey",{enumerable:!0,get:function(){return I.recoverPublicKey}}),Object.defineProperty(r,"SigningKey",{enumerable:!0,get:function(){return I.SigningKey}});var k=Av;Object.defineProperty(r,"formatBytes32String",{enumerable:!0,get:function(){return k.formatBytes32String}}),Object.defineProperty(r,"nameprep",{enumerable:!0,get:function(){return k.nameprep}}),Object.defineProperty(r,"parseBytes32String",{enumerable:!0,get:function(){return k.parseBytes32String}}),Object.defineProperty(r,"_toEscapedUtf8String",{enumerable:!0,get:function(){return k._toEscapedUtf8String}}),Object.defineProperty(r,"toUtf8Bytes",{enumerable:!0,get:function(){return k.toUtf8Bytes}}),Object.defineProperty(r,"toUtf8CodePoints",{enumerable:!0,get:function(){return k.toUtf8CodePoints}}),Object.defineProperty(r,"toUtf8String",{enumerable:!0,get:function(){return k.toUtf8String}}),Object.defineProperty(r,"Utf8ErrorFuncs",{enumerable:!0,get:function(){return k.Utf8ErrorFuncs}});var P=yK;Object.defineProperty(r,"accessListify",{enumerable:!0,get:function(){return P.accessListify}}),Object.defineProperty(r,"computeAddress",{enumerable:!0,get:function(){return P.computeAddress}}),Object.defineProperty(r,"parseTransaction",{enumerable:!0,get:function(){return P.parse}}),Object.defineProperty(r,"recoverAddress",{enumerable:!0,get:function(){return P.recoverAddress}}),Object.defineProperty(r,"serializeTransaction",{enumerable:!0,get:function(){return P.serialize}}),Object.defineProperty(r,"TransactionTypes",{enumerable:!0,get:function(){return P.TransactionTypes}});var O=wK;Object.defineProperty(r,"commify",{enumerable:!0,get:function(){return O.commify}}),Object.defineProperty(r,"formatEther",{enumerable:!0,get:function(){return O.formatEther}}),Object.defineProperty(r,"parseEther",{enumerable:!0,get:function(){return O.parseEther}}),Object.defineProperty(r,"formatUnits",{enumerable:!0,get:function(){return O.formatUnits}}),Object.defineProperty(r,"parseUnits",{enumerable:!0,get:function(){return O.parseUnits}});var q=xK;Object.defineProperty(r,"verifyMessage",{enumerable:!0,get:function(){return q.verifyMessage}}),Object.defineProperty(r,"verifyTypedData",{enumerable:!0,get:function(){return q.verifyTypedData}});var F=vK;Object.defineProperty(r,"_fetchData",{enumerable:!0,get:function(){return F._fetchData}}),Object.defineProperty(r,"fetchJson",{enumerable:!0,get:function(){return F.fetchJson}}),Object.defineProperty(r,"poll",{enumerable:!0,get:function(){return F.poll}});var B=Ev;Object.defineProperty(r,"SupportedAlgorithm",{enumerable:!0,get:function(){return B.SupportedAlgorithm}});var W=Av;Object.defineProperty(r,"UnicodeNormalizationForm",{enumerable:!0,get:function(){return W.UnicodeNormalizationForm}}),Object.defineProperty(r,"Utf8ErrorReason",{enumerable:!0,get:function(){return W.Utf8ErrorReason}})})(As)),As}var AK=EK();const dc={signMessage:async(r,e,t)=>{if(!e)throw new Error("signMessage - provider is undefined");const n=We(r)?r:oe(ar(r));return await e.request({method:"personal_sign",params:[n,t]})},estimateGas:async(r,e,t,n)=>{if(!e)throw new Error("estimateGas - provider is undefined");if(!t)throw new Error("estimateGas - address is undefined");if(r.chainNamespace&&r.chainNamespace!=="eip155")throw new Error("estimateGas - chainNamespace is not eip155");const i={from:r.address,to:r.to,data:r.data,type:0};return(await new xf(e,n).getSigner(t).estimateGas(i)).toBigInt()},sendTransaction:async(r,e,t,n)=>{if(!e)throw new Error("sendTransaction - provider is undefined");if(!t)throw new Error("sendTransaction - address is undefined");if(r.chainNamespace&&r.chainNamespace!=="eip155")throw new Error("sendTransaction - chainNamespace is not eip155");const i={to:r.to,value:r.value,gasLimit:r.gas,gasPrice:r.gasPrice,data:r.data,type:0};return(await(await new xf(e,n).getSigner(t).sendTransaction(i)).wait())?.blockHash||null},writeContract:async(r,e,t,n)=>{if(!e)throw new Error("writeContract - provider is undefined");if(!t)throw new Error("writeContract - address is undefined");const s=new xf(e,n).getSigner(t),o=new kW(r.tokenAddress,r.abi,s);if(!o||!r.method)throw new Error("Contract method is undefined");const a=o[r.method];if(a)return await a(...r.args);throw new Error("Contract method is undefined")},parseWalletCapabilities:r=>{try{return JSON.parse(r)}catch{throw new Error("Error parsing wallet capabilities")}},parseUnits:(r,e)=>pb(r,e).toBigInt(),formatUnits:hb};class _K extends JA{constructor(){super({adapterType:Y.ADAPTER_TYPES.ETHERS5,namespace:Y.CHAIN.EVM}),this.balancePromises={}}async createEthersConfig(e){if(!e.metadata)return;let t;function n(){if(t)return t;if(!(typeof window>"u")&&window.ethereum)return t=window.ethereum,t}async function i(){const{SafeProvider:a}=await Nr(async()=>{const{SafeProvider:p}=await import("./SafeProvider-YgSjvcj1.js");return{SafeProvider:p}},__vite__mapDeps([50,51,52])),{default:c}=await Nr(async()=>{const{default:p}=await import("./index-CAnVjETY.js");return{default:p}},__vite__mapDeps([53,51])),l=new c,u=await l.safe.getInfo(),d=new a(u,l);return await d.connect().catch(p=>{console.info("Failed to auto-connect to Safe:",p)}),d}async function s(){try{const{createCoinbaseWalletSDK:a}=await Nr(async()=>{const{createCoinbaseWalletSDK:l}=await import("./index-CjE2T-ii.js");return{createCoinbaseWalletSDK:l}},__vite__mapDeps([54,52,1]));return typeof window>"u"?void 0:a({appName:e?.metadata?.name,appLogoUrl:e?.metadata?.icons[0],appChainIds:e.networks?.map(l=>l.id)||[1,84532],preference:{options:e.coinbasePreference??"all"}}).getProvider()}catch(a){console.error("Failed to import Coinbase Wallet SDK:",a);return}}const o={metadata:e.metadata};if(e.enableInjected!==!1&&(o.injected=n()),e.enableCoinbase!==!1){const a=await s();a&&(o.coinbase=a)}if(be.isSafeApp()){const a=await i();a&&(o.safe=a)}return o.EIP6963=e.enableEIP6963!==!1,o}async signMessage(e){const{message:t,address:n,provider:i}=e;if(!i)throw new Error("Provider is undefined");try{return{signature:await dc.signMessage(t,i,n)}}catch{throw new Error("EthersAdapter:signMessage - Sign message failed")}}async sendTransaction(e){if(!e.provider)throw new Error("Provider is undefined");return{hash:await dc.sendTransaction({value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),to:e.to,data:e.data?e.data:"0x",gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,address:ye.state.address},e.provider,ye.state.address,Number(e.caipNetwork?.id))}}async writeContract(e){if(!e.provider)throw new Error("Provider is undefined");const{address:t}=on.parseCaipAddress(e.caipAddress);return{hash:await dc.writeContract(e,e.provider,t,Number(e.caipNetwork?.id))}}async estimateGas(e){const{provider:t,caipNetwork:n,address:i}=e;if(!t)throw new Error("Provider is undefined");try{return{gas:await dc.estimateGas({data:e.data,to:e.to,address:i},t,i,Number(n?.id))}}catch{throw new Error("EthersAdapter:estimateGas - Estimate gas failed")}}parseUnits(e){return dc.parseUnits(e.value,e.decimals)}formatUnits(e){return dc.formatUnits(e.value,e.decimals)}async syncConnection(e){const{id:t,chainId:n}=e,i=this.connectors.find(c=>c.id===t),s=i?.provider;if(!s)throw new Error("Provider not found");const o=await s.request({method:"eth_requestAccounts"}),a=await s.request({method:"eth_chainId"});if(this.listenProviderEvents(t,s),!o[0])throw new Error("No accounts found");if(!i?.type)throw new Error("Connector type not found");return{address:this.toChecksummedAddress(o[0]),chainId:Number(a)||Number(n),provider:s,type:i.type,id:t}}async syncConnectors(e){this.ethersConfig=await this.createEthersConfig(e),this.ethersConfig?.EIP6963&&this.listenInjectedConnector(!0),Object.keys(this.ethersConfig||{}).filter(n=>n!=="metadata"&&n!=="EIP6963").forEach(n=>{const i=n==="coinbase"?"coinbaseWalletSDK":n,s=n===Y.CONNECTOR_ID.INJECTED;this.namespace&&this.addConnector({id:i,explorerId:Ji.ConnectorExplorerIds[i],imageUrl:e?.connectorImages?.[i],name:Ji.ConnectorNamesMap[i]||"Unknown",imageId:Ji.ConnectorImageIds[i],type:Ji.ConnectorTypesMap[i]??"EXTERNAL",info:s?void 0:{rdns:i},chain:this.namespace,chains:[],provider:this.ethersConfig?.[n]})})}async disconnectAll(){return{connections:await Promise.all(this.connections.map(async t=>{const n=this.connectors.find(i=>Ar.isLowerCaseMatch(i.id,t.connectorId));if(!n)throw new Error("Connector not found");return await this.disconnect({id:n.id}),t}))}}async syncConnections({connectToFirstConnector:e,getConnectorStorageInfo:t}){await this.connectionManager?.syncConnections({connectors:this.connectors,caipNetworks:this.getCaipNetworks(),universalProvider:this.universalProvider,onConnection:this.addConnection.bind(this),onListenProvider:this.listenProviderEvents.bind(this),getConnectionStatusInfo(n){return t(n)}}),e&&this.emitFirstAvailableConnection()}async setUniversalProvider(e){this.universalProvider=e;const t=Y.CONNECTOR_ID.WALLET_CONNECT;return Us.listenWcProvider({universalProvider:e,namespace:Y.CHAIN.EVM,onConnect:n=>this.onConnect(n,t),onDisconnect:()=>this.onDisconnect(t),onAccountsChanged:n=>this.onAccountsChanged(n,t,!1),onChainChanged:n=>this.onChainChanged(n,t)}),this.addConnector(new qm({provider:e,caipNetworks:this.getCaipNetworks(),namespace:Y.CHAIN.EVM})),Promise.resolve()}eip6963EventHandler(e){if(e.detail){const{info:t,provider:n}=e.detail;if(!this.connectors?.find(s=>s.name===t?.name)){const s=Ji.ConnectorTypesMap[Y.CONNECTOR_ID.EIP6963],o=t?.rdns||t?.name||t?.uuid;this.namespace&&o&&this.addConnector({id:o,type:s,imageUrl:t?.icon,name:t?.name||"Unknown",provider:n,info:t,chain:this.namespace,chains:[]})}}}listenInjectedConnector(e){if(typeof window<"u"&&e){const t=this.eip6963EventHandler.bind(this);window.addEventListener(Ye.EIP6963_ANNOUNCE_EVENT,t),window.dispatchEvent(new Event(Ye.EIP6963_REQUEST_EVENT))}}async connect({id:e,address:t,type:n,chainId:i,socialUri:s}){const o=this.connectors.find(d=>Ar.isLowerCaseMatch(d.id,e));if(!o)throw new Error("Connector not found");const a=this.connectionManager?.getConnection({address:t,connectorId:e,connections:this.connections,connectors:this.connectors});if(a){const d=a.caipNetwork;if(!d)throw new Error("Ethers5Adapter:connect - could not find the caipNetwork to connect");if(a.account)return this.emit("accountChanged",{address:this.toChecksummedAddress(a.account.address),chainId:d.id,connector:o}),{address:this.toChecksummedAddress(a.account.address),chainId:d.id,provider:o.provider,type:o.type,id:e}}const c=o?.provider;if(!c)throw new Error("Provider not found");let l=[],u;if(n==="AUTH"){const{address:d,accounts:p}=await Ln.authConnectorAuthenticate({authConnector:c,chainNamespace:Y.CHAIN.EVM,chainId:i,socialUri:s,preferredAccountType:qn("eip155")}),x=this.getCaipNetworks().find(w=>w.id.toString()===i?.toString());l=[d],this.addConnection({connectorId:e,accounts:p?p.map(w=>({address:w.address})):l.map(w=>({address:w})),caipNetwork:x,auth:{name:Q.getConnectedSocialProvider(),username:Q.getConnectedSocialUsername()}}),this.emit("accountChanged",{address:this.toChecksummedAddress(l[0]),chainId:Number(i),connector:o})}else{l=await c.request({method:"eth_requestAccounts"}),u=await c.request({method:"eth_chainId"});const d=this.getCaipNetworks().find(p=>p.id.toString()===i?.toString());if(u!==i){if(!d)throw new Error("Ethers5Adapter:connect - could not find the caipNetwork to switch");try{await this.switchNetwork({caipNetwork:d,provider:c,providerType:n})}catch{throw new Error("Ethers5Adapter:connect - Switch network failed")}}this.emit("accountChanged",{address:this.toChecksummedAddress(l[0]),chainId:Number(i),connector:o}),this.addConnection({connectorId:e,accounts:l.map(p=>({address:p})),caipNetwork:d}),o.id!==Y.CONNECTOR_ID.WALLET_CONNECT&&this.listenProviderEvents(e,c)}return{address:this.toChecksummedAddress(l[0]),chainId:Number(i),provider:c,type:n,id:e}}async getAccounts(e){const t=this.connectors.find(o=>o.id===e.id),n=t?.provider;if(!n||!t)throw new Error("Provider not found");const i=this.connectionManager?.getConnection({connectorId:e.id,connections:this.connections,connectors:this.connectors});if(i)return{accounts:i.accounts.map(({address:o})=>be.createAccount(Y.CHAIN.EVM,o,"eoa"))};if(e.id===Y.CONNECTOR_ID.AUTH){const o=t.provider;if(!o.user)return{accounts:[]};const{accounts:a,address:c}=o.user;return Promise.resolve({accounts:(a||[{address:c,type:"eoa"}]).map(l=>be.createAccount(Y.CHAIN.EVM,l.address,l.type))})}return{accounts:(await n.request({method:"eth_requestAccounts"})).map(o=>be.createAccount(Y.CHAIN.EVM,o,"eoa"))}}async reconnect(e){const{id:t,chainId:n}=e,i=this.connectors.find(s=>s.id===t);i&&i.type==="AUTH"&&n&&await Ln.authConnectorAuthenticate({authConnector:i.provider,chainNamespace:Y.CHAIN.EVM,chainId:n,preferredAccountType:qn("eip155")})}async disconnect(e){if(e.id){const t=this.connectors.find(i=>Ar.isLowerCaseMatch(i.id,e.id));if(!t)throw new Error("Connector not found");const n=this.connectionManager?.getConnection({connectorId:e.id,connections:this.connections,connectors:this.connectors});switch(t.type){case Ye.CONNECTOR_TYPE_WALLET_CONNECT:t.provider.session&&t.provider.disconnect();break;case Ye.CONNECTOR_TYPE_AUTH:await t.provider?.disconnect();break;case Ye.CONNECTOR_TYPE_ANNOUNCED:case Ye.CONNECTOR_TYPE_EXTERNAL:await this.revokeProviderPermissions(t.provider);break;default:throw new Error("Unsupported provider type")}return t.id&&(this.removeProviderListeners(t.id),this.deleteConnection(t.id)),this.connections.length===0?this.emit("disconnect"):this.emitFirstAvailableConnection(),{connections:n?[n]:[]}}return this.disconnectAll()}async getBalance(e){const t=e.address,n=this.getCaipNetworks().find(i=>i.id.toString()===e.chainId?.toString());if(!t)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(n){const i=`${n.caipNetworkId}:${t}`,s=this.balancePromises[i];if(s)return s;const o=Q.getNativeBalanceCacheForCaipAddress(i);if(o)return{balance:o.balance,symbol:o.symbol};const a=new fC(n.rpcUrls.default.http[0],{chainId:n.id,name:n.name});if(a)try{return this.balancePromises[i]=new Promise(async c=>{try{const l=await a.getBalance(t),u=AK.formatEther(l);Q.updateNativeBalanceCache({caipAddress:i,balance:u,symbol:n.nativeCurrency.symbol,timestamp:Date.now()}),c({balance:u,symbol:n.nativeCurrency.symbol})}catch{c({balance:"0.00",symbol:"ETH"})}}).finally(()=>{delete this.balancePromises[i]}),this.balancePromises[i]||{balance:"0.00",symbol:"ETH"}}catch{return{balance:"0.00",symbol:"ETH"}}}return{balance:"0.00",symbol:"ETH"}}async switchNetwork(e){const{caipNetwork:t,provider:n,providerType:i}=e;if(i==="AUTH"){await super.switchNetwork(e);return}try{await n.request({method:"wallet_switchEthereumChain",params:[{chainId:Ic.numberToHexString(t.id)}]})}catch(s){if(s.code===Os.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||s.code===Os.ERROR_INVALID_CHAIN_ID||s.code===Os.ERROR_CODE_DEFAULT||s?.data?.originalError?.code===Os.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)await Ic.addEthereumChain(n,t);else if(i==="ANNOUNCED"||i==="EXTERNAL"||i==="INJECTED")throw new Error("Chain is not supported")}}getWalletConnectProvider(){return this.connectors.find(e=>e.type==="WALLET_CONNECT")?.provider}async revokeProviderPermissions(e){try{(await e.request({method:"wallet_getPermissions"})).find(i=>i.parentCapability==="eth_accounts")&&await e.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]})}catch(t){console.info("Could not revoke permissions from wallet. Disconnecting...",t)}}async getCapabilities(e){const t=Ve.getProvider(Y.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){const t=Ve.getProvider(Y.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){const t=Ve.getProvider(Y.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_revokePermissions",params:[e]})}async walletGetAssets(e){const t=Ve.getProvider(Y.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_getAssets",params:[e]})}toChecksummedAddress(e){try{return pt(e.toLowerCase())}catch{return e}}}const CK="d657fc2caf26f35212226268cf9745d0",SK={name:"My Laravel 8 DApp",description:"Laravel 8 + Vite + AppKit",url:window.location.origin,icons:["https://example.com/icon.png"]},Cv=jj({adapters:[new _K],metadata:SK,networks:[Pj,Ij,Tj],projectId:CK,features:{analytics:!0}});window.sendTransaction=async function(){try{const r=await Cv.subscribeProviders(s=>s.eip155),e=await Cv.subscribeAccount(s=>s);if(!r)throw new Error("No provider found");if(!e)throw new Error("No account found");const i=await new xf(r).getSigner().sendTransaction({to:"0x0a1ad99042f75253faaaA5a448325e7c0069E9fd",value:mC("0.0001")});console.log("✅ Transaction sent:",i)}catch(r){console.error("❌ Transaction failed:",r)}};export{Ye as $,ye as A,Ie as B,be as C,B3 as D,Ir as E,qv as F,K3 as G,z3 as H,kK as I,JF as J,Ov as K,Q as L,He as M,$C as N,Z as O,on as P,Fn as Q,Te as R,Xi as S,vn as T,Ae as U,Se as V,_r as W,RK as X,Af as Y,UK as Z,MK as _,Qe as a,YF as a0,Yr as a1,OV as a2,Ve as a3,qC as a4,Ql as a5,kl as a6,Fp as a7,Ai as a8,Ke as a9,cf as aA,Ef as aB,Ar as aC,Ug as aD,hc as aE,A6 as aF,nr as aG,T6 as aH,Nv as aI,Nl as aJ,Ln as aa,_e as ab,DV as ac,qs as ad,Xd as ae,HA as af,Bg as ag,Nr as ah,jc as ai,Mi as aj,Ab as ak,v3 as al,I3 as am,Lv as an,Qg as ao,r6 as ap,_b as aq,n6 as ar,NK as as,E3 as at,N3 as au,_3 as av,jv as aw,Fv as ax,ua as ay,DK as az,$ as b,kV as c,Ge as d,UV as e,Lr as f,Dv as g,po as h,uf as i,de as j,Y as k,qn as l,b3 as m,Br as n,im as o,It as p,ae as q,MV as r,en as s,OK as t,Sb as u,Sj as v,Wn as w,RV as x,Hv as y,kc as z};
